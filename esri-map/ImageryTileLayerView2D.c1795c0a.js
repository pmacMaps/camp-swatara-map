!function(){function e(e,t,r,i){Object.defineProperty(e,t,{get:r,set:i,enumerable:!0,configurable:!0})}var t=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire594f;t.register("firbt",(function(r,i){var n;n=r.exports,Object.defineProperty(n,"__esModule",{value:!0,configurable:!0}),e(r.exports,"default",(function(){return b}));var s=t("7eJjO"),o=t("bsvXr"),a=t("jHOLN"),l=t("10vEZ"),u=t("lKPaD"),c=t("iho5X");t("iJAIC"),t("lNwWH"),t("2VlWd");var h=t("fcwIv"),d=t("9m6jq"),f=t("bmS2f"),p=t("dIFqf"),m=t("24w4l"),g=t("cvwLd"),v=t("9M3e1"),y=t("afdWM"),x=t("30vBn"),_=t("hfthk");let T=class extends((0,y.default)((0,_.default)((0,p.LayerView2DMixin)(x.default)))){get useWebGLForProcessing(){return this._useWebGLForProcessing}set useWebGLForProcessing(e){this._useWebGLForProcessing=e,this.subview&&"useWebGLForProcessing"in this.subview&&(this.subview.useWebGLForProcessing=e)}get useProgressiveUpdate(){return this._useWebGLForProcessing}set useProgressiveUpdate(e){this._useProgressiveUpdate=e,this.subview&&"useProgressiveUpdate"in this.subview&&(this.subview.useProgressiveUpdate=e)}get displayParameters(){const{layer:e}=this,t=this._get("displayParameters");return e.renderer?{bandIds:e.bandIds,renderer:e.renderer,interpolation:e.interpolation,multidimensionalDefinition:e.multidimensionalDefinition,rasterFunction:"imagery-tile"===e.type?e.rasterFunction:null}:t}update(e){var t;null===(t=this.subview)||void 0===t||t.update(e),this.notifyChange("updating")}isUpdating(){return!this.subview||this.subview.updating}attach(){var e,t,r;this.layer.increaseRasterJobHandlerUsage(),this._updateSubview(),this.addAttachHandles([(0,u.watch)((()=>this.displayParameters),((e,t)=>{var r,i;const n=e.interpolation!==(null==t?void 0:t.interpolation)&&("majority"===e.interpolation||"majority"===(null==t?void 0:t.interpolation))&&(0,v.canUseMajorityInterpolationOnDataSource)(this.layer),s=e.renderer!==(null==t?void 0:t.renderer)&&(null==t||null===(r=t.renderer)||void 0===r?void 0:r.type)!==(null===(i=e.renderer)||void 0===i?void 0:i.type);s&&this._updateSubview();const o=e.multidimensionalDefinition!==(null==t?void 0:t.multidimensionalDefinition),u=e.rasterFunction!==(null==t?void 0:t.rasterFunction),c=u&&!this._useWebGLForProcessing,h=o||n||s||c;this.subview.redrawOrRefetch({refetch:h,reprocess:u}).catch((e=>{(0,l.isAbortError)(e)||a.default.getLogger(this).error(e)})),this.notifyChange("updating")})),(0,u.watch)((()=>null!==(e=this.layer.blendMode)&&void 0!==e?e:"normal"),(e=>{this.subview.container.blendMode=e}),u.syncAndInitial),(0,u.watch)((()=>null!==(t=this.layer.effect)&&void 0!==t?t:null),(e=>{this.subview.container.effect=e}),u.syncAndInitial),(0,u.watch)((()=>null!==(r=this.layer.multidimensionalSubset)&&void 0!==r?r:null),((e,t)=>{const{multidimensionalDefinition:r}=this.layer;null!=r&&(0,d.hasExcludedVariableOrDimension)(r,e)!==(0,d.hasExcludedVariableOrDimension)(r,t)&&(this.subview.redrawOrRefetch({refetch:!0}).catch((e=>{(0,l.isAbortError)(e)||a.default.getLogger(this).error(e)})),this.notifyChange("updating"))}),u.sync),(0,u.watch)((()=>this.timeExtent),(()=>{this.subview.timeExtent=this.timeExtent,this.subview.redrawOrRefetch({refetch:!0}).catch((e=>{(0,l.isAbortError)(e)||a.default.getLogger(this).error(e)}))}),u.initial)])}detach(){var e;this.layer.decreaseRasterJobHandlerUsage(),this._detachSubview(this.subview),null===(e=this.subview)||void 0===e||e.destroy(),this.subview=null}moveStart(){this.requestUpdate()}viewChange(){this.requestUpdate()}moveEnd(){this.subview.moveEnd()}async hitTest(e,t){return[{type:"graphic",layer:this.layer,mapPoint:e,graphic:new(0,o.default)({attributes:{},geometry:e.clone()})}]}doRefresh(){return this.subview?this.subview.doRefresh():Promise.resolve()}_updateSubview(){var e;const t=null===(e=this.layer.renderer)||void 0===e?void 0:e.type;if(!t)return;const r="vector-field"===t?"rasterVF":"flow"===t?"flow":"raster";if(this.subview){var i;if(this.subview.type===r)return void this._attachSubview(this.subview);this._detachSubview(this.subview),null===(i=this.subview)||void 0===i||i.destroy(),this.subview=null}const{layer:n}=this;let s;if(s="rasterVF"===r?new(0,g.default)({layer:n,layerView:this}):"flow"===r?new(0,f.default)({layer:n,layerView:this}):new(0,m.default)({layer:n,layerView:this}),"useWebGLForProcessing"in s&&(s.useWebGLForProcessing=this._useWebGLForProcessing),"useProgressiveUpdate"in s&&(s.useProgressiveUpdate=this._useProgressiveUpdate),"previousLOD"in s){const{subview:e}=this;s.previousLOD=e&&"previousLOD"in e?e.previousLOD:null}this._attachSubview(s),this.subview=s,this.requestUpdate()}_attachSubview(e){e&&!e.attached&&(e.attach(),e.attached=!0,this.container.addChildAt(e.container,0),e.container.blendMode=this.layer.blendMode,e.container.effect=this.layer.effect)}_detachSubview(e){(null==e?void 0:e.attached)&&(this.container.removeChild(e.container),e.detach(),e.attached=!1)}constructor(){super(...arguments),this._useWebGLForProcessing=!0,this._useProgressiveUpdate=!0,this.subview=null}};(0,s._)([(0,c.property)()],T.prototype,"subview",void 0),(0,s._)([(0,c.property)()],T.prototype,"useWebGLForProcessing",null),(0,s._)([(0,c.property)()],T.prototype,"useProgressiveUpdate",null),(0,s._)([(0,c.property)({readOnly:!0})],T.prototype,"displayParameters",null),T=(0,s._)([(0,h.subclass)("esri.views.2d.layers.ImageryTileLayerView2D")],T);const b=T})),t.register("9m6jq",(function(r,i){e(r.exports,"createSlices",(function(){return a})),e(r.exports,"getSliceIds",(function(){return l})),e(r.exports,"hasExcludedVariableOrDimension",(function(){return f})),e(r.exports,"intersectMultimensionalSubset",(function(){return p})),e(r.exports,"getDefaultVariablInfo",(function(){return m})),e(r.exports,"getDefaultMultidimensionalDefinition",(function(){return g})),e(r.exports,"isMultiSliceOrRangeDefinition",(function(){return v})),e(r.exports,"getSubsetVariablesFromMdInfo",(function(){return y})),e(r.exports,"getSliceIndex",(function(){return T}));var n=t("lNwWH"),s=t("d3QQf");function o(e,t,r){const i=t.shift();if(0===r.length){const e=[];r.push({sliceId:-1,multidimensionalDefinition:e})}const n=r.length;for(let t=0;t<n;t++){var s;const t=r.shift().multidimensionalDefinition;null===(s=i.values)||void 0===s||s.forEach((n=>{r.push({sliceId:-1,multidimensionalDefinition:[...t,{variableName:e,dimensionName:i.name,values:[n]}]})}))}t.length&&o(e,t,r)}function a(e,t){const r=[];let i=0;return(t?e.variables.filter((e=>e.name.toLowerCase()===t.toLowerCase())):[...e.variables].sort(((e,t)=>e.name>t.name?1:-1))).forEach((e=>{const t=[],n=[...e.dimensions].sort(((e,t)=>e.name>t.name?-1:1));o(e.name,n,t),t.forEach((e=>{r.push({...e,sliceId:i++})}))})),r}function l(e,t,r){let i=e;if(t&&(t=[...t].sort(((e,t)=>e.dimensionName<t.dimensionName?-1:1))).forEach((({dimensionName:e,values:t,isSlice:r})=>{t.length&&(i=i.filter((i=>{const n=i.multidimensionalDefinition.find((t=>t.dimensionName===e));if(null==n)return!1;const s=n.values[0];return"number"==typeof s?"number"==typeof t[0]?t.includes(s):t.some((e=>e[0]<=s&&e[1]>=s)):"number"==typeof t[0]?t.some((e=>s[0]<=e&&s[1]>=e)):r?t.some((e=>e[0]===s[0]&&e[0]===s[1])):t.some((e=>e[0]>=s[0]&&e[0]<=s[1]||e[1]>=s[0]&&e[1]<=s[1]||e[0]<s[0]&&e[1]>s[1]))})))})),i.length&&r&&null!=r.start&&null!=r.end){const e=r.start.getTime(),t=r.end.getTime(),n=i[0].multidimensionalDefinition.findIndex((e=>"StdTime"===e.dimensionName));n>-1&&(i=i.filter((r=>{const i=r.multidimensionalDefinition[n].values[0];return e<=i&&t>=i})))}return i.map((e=>e.sliceId))}function u(e,t){return Array.isArray(e)?t[0]===t[1]?e[0]===t[0]||e[1]===t[0]:e[0]>=t[0]&&e[0]<=t[1]&&e[1]>=t[0]&&e[1]<=t[1]:e>=t[0]&&e<=t[1]}function c(e,t){return e[0]<=t[0]&&e[1]>=t[0]||e[0]<=t[1]&&e[1]>=t[1]||e[0]>=t[0]&&e[1]<=t[1]}function h(e){return 1===e.length?[e[0],e[0]]:[e[0],e[e.length-1]]}function d(e,t,r){var i;if(!(null==t||null===(i=t.subsetDefinitions)||void 0===i?void 0:i.length))return e;let n;if(r){var s;const{variables:i}=t;if(i.length&&!i.includes(r))return null;const o=t.subsetDefinitions.find((t=>t.dimensionName===e.name&&t.variableName===r));if(!(null==o||null===(s=o.values)||void 0===s?void 0:s.length))return e;n=h(o.values)}else{const r=t.dimensions.find((({name:t})=>t===e.name));n=null==r?void 0:r.extent}const o=n;if(!o||!(null==o?void 0:o.length))return e;const a=e.values.filter((e=>u(e,o)));return{...e,extent:[...o],values:a}}function f(e,t,r){var i;if(!(null==t||null===(i=t.subsetDefinitions)||void 0===i?void 0:i.length))return!1;const{variables:n}=t;if(n.length&&e.some((({variableName:e})=>e&&!n.includes(e))))return!0;for(let i=0;i<e.length;i++){const n=e[i],s=t.subsetDefinitions.find((e=>(""===n.variableName||e.variableName===n.variableName)&&e.dimensionName===n.dimensionName));if(null==s?void 0:s.values.length){const e=h(s.values);if(n.isSlice||2!==n.values.length||Array.isArray(n.values[0])||n.values[0]===n.values[1]||!r){if(n.values.some((t=>!u(t,e))))return!0}else if(!c(n.values,e))return!0}}return!1}function p(e,t){if(null==e)return{isOutside:!1};const{geometry:r,timeExtent:i,multidimensionalDefinition:n}=t;let o=null;if(null!=i&&(o=function(e,t){const r=e.dimensions.find((({name:e})=>"StdTime"===e));if(null==r||null==t.start&&null==t.end)return t;t=t.clone();const{start:i,end:n}=t.toJSON(),o=i===n?[i]:null!=i&&null!=n?[i,n]:[null!=i?i:n];var a,l;return 2===o.length&&(null==r?void 0:r.extent.length)&&(o[0]=Math.max(o[0],r.extent[0]),o[1]=Math.min(o[1],null!==(a=r.extent[1])&&void 0!==a?a:r.extent[0]),o[1]<o[0])||f([new(0,s.default)({variableName:"",dimensionName:"StdTime",isSlice:1===o.length,values:o})],e,!0)?null:(t.start=new Date(o[0]),t.end=new Date(null!==(l=o[1])&&void 0!==l?l:o[0]),t)}(e,i),null==o))return{isOutside:!0};const{areaOfInterest:a}=e;if(a&&r){const e="point"===r.type?r:"extent"===r.type?r.center:"polygon"===r.type?r.centroid:null;if(e&&!a.contains(e))return{isOutside:!0}}return null!=n&&n.length&&f(n,e,!0)?{isOutside:!0}:{isOutside:!1,intersection:{geometry:r,timeExtent:o,multidimensionalDefinition:n}}}function m(e,t={}){var r,i;const{multidimensionalInfo:n,keyProperties:s}=e;if(null==n)return null;const{variableName:o,multidimensionalSubset:a,multidimensionalDefinition:l}=t,u=null!=l?null===(r=l[0])||void 0===r?void 0:r.variableName:null,c=o||u||(null==s?void 0:s.DefaultVariable);let{variables:h}=n;var d;return(null==a||null===(i=a.variables)||void 0===i?void 0:i.length)&&(h=h.filter((({name:e})=>a.variables.includes(e)))),c&&null!==(d=h.find((({name:e})=>e===c)))&&void 0!==d?d:h[0]}function g(e,t={}){const r=m(e,t);if(!r)return null;const i=[],{dimensions:n,name:o}=r;if(0===n.length)return[new(0,s.default)({variableName:o,dimensionName:"",values:[],isSlice:!0})];for(let e=0;e<n.length;e++){const r=d(n[e],t.multidimensionalSubset,o);if(!r)return null;const{values:l,extent:u}=r;var a;let c=null!==(a=null==l?void 0:l[0])&&void 0!==a?a:u[0];"stdz"===r.name.toLowerCase()&&!r.hasRanges&&Math.abs(u[1])<=Math.abs(u[0])&&(c=(null==l?void 0:l.length)?l[l.length-1]:u[1]),i.push(new(0,s.default)({variableName:o,dimensionName:r.name,values:[c],isSlice:!t.useRangeForRangedDimensionInfo||!!r.hasRanges}))}return i}function v(e){return!(null==e||!e.length)&&e.some((e=>{if(null==e.values)return!0;const t=e.values.length;return 0===t||t>1||!e.isSlice&&Array.isArray(e.values[0])}))}function y(e,t){var r;if(null==t||null==e)return null;let i=t.variables.map((e=>({...e})));return(null==e||null===(r=e.variables)||void 0===r?void 0:r.length)&&(i=i.filter((({name:t})=>e.variables.includes(t))),i.forEach((t=>{t.dimensions=t.dimensions.map((r=>d(r,e,t.name))).filter(n.isSome)}))),i}function x(e,t){var r;const{values:i}=t;if(null==i?void 0:i.length){const t=Array.isArray(i[0]),r=Array.isArray(e);return t!==r?-1:t&&r?i.findIndex((t=>t[0]===e[0]&&t[1]===e[1])):i.indexOf(e)}const{extent:n}=t;if(Array.isArray(e)||e<n[0]||e>n[1])return-1;const s=t.interval||1;if("ISO8601"!==t.unit)return Math.round((e-n[0])/s);const o=n[0];let a=-1;switch((null===(r=t.intervalUnit)||void 0===r?void 0:r.toLowerCase())||"seconds"){case"seconds":a=Math.round((e-o)/1e3/s);break;case"minutes":a=Math.round((e-o)/6e4/s);break;case"hours":a=Math.round((e-o)/36e5/s);break;case"days":a=Math.round((e-o)/864e5/s);break;case"months":{const t=new Date(e).getUTCFullYear()-new Date(o).getUTCFullYear(),r=new Date(o).getUTCMonth(),i=new Date(e).getUTCMonth();a=0===t?i-r:i+11-r+12*(t-1)}break;case"years":a=Math.round((new Date(e).getUTCFullYear()-new Date(o).getUTCFullYear())/s);break;case"decades":a=Math.round((new Date(e).getUTCFullYear()-new Date(o).getUTCFullYear())/10/s)}return a}function _(e){var t,r;let i=null===(t=e.values)||void 0===t?void 0:t.length;if(i)return i;const{extent:n,unit:s}=e,o=e.interval||1,a=n?n[1]-n[0]:0;if("ISO8601"!==s)return Math.round(a/o);var l;switch(null!==(l=null===(r=e.intervalUnit)||void 0===r?void 0:r.toLowerCase())&&void 0!==l?l:"seconds"){case"seconds":i=Math.round(a/1e3/o);break;case"minutes":i=Math.round(a/6e4/o);break;case"hours":i=Math.round(a/36e5/o);break;case"days":i=Math.round(a/864e5/o);break;case"months":{const e=new Date(n[1]).getUTCFullYear()-new Date(n[0]).getUTCFullYear(),t=new Date(n[0]).getUTCMonth(),r=new Date(n[1]).getUTCMonth();i=0===e?r-t+1:r+11-t+12*(e-1)+1}break;case"years":i=Math.round((new Date(n[1]).getUTCFullYear()-new Date(n[0]).getUTCFullYear())/o);break;case"decades":i=Math.round((new Date(n[1]).getUTCFullYear()-new Date(n[0]).getUTCFullYear())/10/o);break;default:i=0}return i}function T(e,t){let r=0;const i=e[0].variableName,n=[...t.variables].sort(((e,t)=>e.name>t.name?1:-1));for(let t=0;t<n.length;t++){const s=n[t],o=[...s.dimensions].sort(((e,t)=>e.name>t.name?-1:1));if(s.name!==i){r+=o.map((e=>_(e))).reduce(((e,t)=>e*t));continue}const a=o.map((e=>_(e))),l=o.length;for(let t=0;t<l;t++){const i=e.find((e=>e.dimensionName===o[t].name));if(null==i)return null;const n=x(i.values[0],o[t]);if(-1===n)return null;a.shift(),r+=t===l-1?n:n*a.reduce(((e,t)=>e*t))}break}return r}})),t.register("d3QQf",(function(r,i){e(r.exports,"default",(function(){return d}));var n,s=t("7eJjO"),o=t("1XAcN"),a=t("flPLJ"),l=t("iho5X"),u=t("iJAIC"),c=t("fcwIv");let h=n=class extends o.JSONSupport{clone(){return new n({variableName:this.variableName,dimensionName:this.dimensionName,values:(0,a.clone)(this.values),isSlice:this.isSlice})}constructor(e){super(e),this.variableName=null,this.dimensionName=null,this.values=[],this.isSlice=!1}};(0,s._)([(0,l.property)({type:String,json:{write:!0}})],h.prototype,"variableName",void 0),(0,s._)([(0,l.property)({type:String,json:{write:!0}})],h.prototype,"dimensionName",void 0),(0,s._)([(0,l.property)({type:u.types.array(u.types.oneOf([u.types.native(Number),u.types.array(u.types.native(Number))])),json:{write:!0}})],h.prototype,"values",void 0),(0,s._)([(0,l.property)({type:Boolean,json:{write:!0}})],h.prototype,"isSlice",void 0),h=n=(0,s._)([(0,c.subclass)("esri.layers.support.DimensionalDefinition")],h);const d=h})),t.register("24w4l",(function(r,i){e(r.exports,"default",(function(){return h}));var n=t("7eJjO"),s=t("iho5X");t("iJAIC"),t("lNwWH"),t("2VlWd");var o=t("fcwIv"),a=t("3ygTk"),l=t("5QZs5"),u=t("9M3e1");let c=class extends l.BaseImageryTileSubView2D{attach(){super.attach(),this.container=new(0,a.RasterTileContainer)(this._tileInfoView),this.container.isCustomTilingScheme=this._isCustomTilingScheme,this.updateRasterFunctionParameters()}detach(){super.detach(),this.container.removeAllChildren(),this.container=null}canUseWebGLForProcessing(){var e,t;const{symbolizer:r}=this.layer,i=null===(e=r.lookup)||void 0===e||null===(t=e.colormapLut)||void 0===t?void 0:t.indexedColormap,n=i&&i.length>this._maxIndexedColormapSize;return this.useWebGLForProcessing&&r.canRenderInWebGL&&!n&&!("majority"===this.layer.interpolation&&(0,u.canUseMajorityInterpolationOnDataSource)(this.layer))}fetchTile(e,t){return this.layer.fetchTile(e.level,e.row,e.col,t)}updateRasterFunctionParameters(){const{raster:e,type:t}=this.layer,{container:r}=this;if("Function"!==e.datasetFormat||"wcs"===t)return r.rasterFunctionChain=null,r.children.forEach((e=>{const{bitmap:t}=e;t&&(t.suspended=!0,t.processed=!1,t.projected&&(t.invalidateTexture(),t.rasterTexture=null))})),void(this._rasterFunctionState="na");const i=this._rasterFunctionState,{rasterFunction:n,primaryRasters:s}=e,o=n.supportsGPU&&(!s||s.rasters.length<=1),a=o?n.flatWebGLFunctionChain:null,{renderer:l}=this.layer,u=!o||!(null==a?void 0:a.functions.length)||"raster-stretch"===(null==l?void 0:l.type)&&l.dynamicRangeAdjustment||!this.canUseWebGLForProcessing();r.rasterFunctionChain=u?null:a;const c=null==n?"na":r.rasterFunctionChain?"gpu":"cpu";r.children.forEach((e=>{const{bitmap:t}=e;t&&(t.suspended=i!==c,t.processed=!1,t.processedTexture=null)})),this._rasterFunctionState=c}async updateTileSource(e,t){const r=this._getBandIds(),i=this._getLayerInterpolation(),n=this.canUseWebGLForProcessing(),{source:s,globalSymbolizerParams:o,suspended:a,coords:l,resolution:u}=t,c=this.layerView.hasTilingEffects?o:t.symbolizerParams,{bitmap:h}=e;if([h.x,h.y]=l,h.resolution=u,s&&null!=s&&null!=s.pixelBlock){const e={extent:s.extent,pixelBlock:s.pixelBlock};if(h.rawPixelData=e,n)h.source=s.pixelBlock,h.isRendereredSource=!1;else{const t=await this.layer.applyRenderer(e,"stretch"===(null==o?void 0:o.type)?o:void 0);h.source=t,h.isRendereredSource=!0}h.symbolizerParameters=n?c:null,n?h.transformGrid||(h.transformGrid=s.transformGrid):h.transformGrid=null}else{const e=this.createEmptyTilePixelBlock();h.source=e,h.symbolizerParameters=n?c:null,h.transformGrid=null}h.bandIds=n?r:null,h.width=this._tileInfoView.tileInfo.size[0],h.height=this._tileInfoView.tileInfo.size[1],h.interpolation=i,h.suspended=a,h.invalidateTexture()}async updateTileSymbolizerParameters(e,t){const{local:r,global:i}=t,n=this._getBandIds(),s=this._getLayerInterpolation(),o=this.canUseWebGLForProcessing(),{bitmap:a}=e,{rawPixelData:l}=a;o||null==l?(a.isRendereredSource&&null!=l&&(a.source=l.pixelBlock),a.isRendereredSource=!1):(a.source=await this.layer.applyRenderer(l,"stretch"===(null==i?void 0:i.type)?i:void 0),a.isRendereredSource=!0),a.symbolizerParameters=o?this.layerView.hasTilingEffects?i:r:null,a.bandIds=o?n:null,a.interpolation=s,a.suspended=!1}_getLayerInterpolation(){const{interpolation:e,renderer:t}=this.layer;if(!t)return e;const r=t.type;return"raster-colormap"===r||"unique-value"===r||"class-breaks"===r?"nearest":"raster-stretch"===t.type&&null!=t.colorRamp?"bilinear"===e||"cubic"===e?"bilinear":"nearest":e}constructor(){super(...arguments),this.type="raster"}};(0,n._)([(0,s.property)()],c.prototype,"container",void 0),(0,n._)([(0,s.property)()],c.prototype,"layer",void 0),(0,n._)([(0,s.property)()],c.prototype,"type",void 0),c=(0,n._)([(0,o.subclass)("esri.views.2d.layers.imagery.ImageryTileView2D")],c);const h=c})),t.register("3ygTk",(function(r,i){e(r.exports,"RasterTileContainer",(function(){return c}));var n=t("8TwEW"),s=t("hgO8t"),o=t("bhyfQ"),a=t("9Qv38"),l=t("66IJZ"),u=t("3v0eQ");class c extends u.default{createTile(e){const t=this._getTileBounds(e),[r,i]=this._tileInfoView.tileInfo.size,n=this._tileInfoView.getTileResolution(e.level);return new(0,a.RasterTile)(e,n,t[0],t[3],r,i)}prepareRenderPasses(e){const t=e.registerRenderPass({name:"imagery (tile)",brushes:[o.default],target:()=>this.children.map((e=>e.bitmap)),drawPhase:l.WGLDrawPhase.MAP});return[...super.prepareRenderPasses(e),t]}doRender(e){if(!this.visible||e.drawPhase!==l.WGLDrawPhase.MAP)return;const{rasterFunctionChain:t}=this;if(!t)return e.renderPass="raster-bitmap",void super.doRender(e);const[r,i]=this._tileInfoView.tileInfo.size;if(e.renderPass="raster",e.rasterFunction={name:"Reproject",parameters:{targetImageSize:[r,i],requireBilinear:t.hasSurfaceFunction},pixelType:"f32",id:0,isNoopProcess:!1},super.doRender(e),null==t?void 0:t.functions.length){const{functions:r,hasBranches:i}=t;for(let t=0;t<r.length;t++){const n=r[t];"Constant"!==n.name&&"Identity"!==n.name&&(e.renderPass="raster",e.rasterFunction=n,e.hasBranches=i,super.doRender(e))}}e.rasterFunction=null,e.renderPass="bitmap",super.doRender(e)}_getTileBounds(e){const t=this._tileInfoView.getTileBounds((0,n.create)(),e);if(this.isCustomTilingScheme&&e.world){const{tileInfo:r}=this._tileInfoView,i=(0,s.getWorldWidth)(r.spatialReference);if(i){const n=r.lodAt(e.level);if(!n)return t;const{resolution:s}=n,o=i/s%r.size[0],a=o?(r.size[0]-o)*s:0;t[0]-=a*e.world,t[2]-=a*e.world}}return t}constructor(){super(...arguments),this.isCustomTilingScheme=!1}}})),t.register("bhyfQ",(function(r,i){e(r.exports,"default",(function(){return p}));var n=t("7qybv"),s=t("cz22x"),o=t("grNni"),a=t("49aaT"),l=t("4WoSm"),u=t("a1l1E"),c=t("eeeSS"),h=t("8JzMA"),d=t("72d6A"),f=t("bv6V3");class p extends c.default{dispose(){(0,n.disposeMaybe)(this._quad),(0,n.disposeMaybe)(this._fbo)}prepareState(e){const{context:t,renderPass:r}=e,i="raster"===r;t.setBlendingEnabled(!i),t.setBlendFunctionSeparate(h.BlendFactor.ONE,h.BlendFactor.ONE_MINUS_SRC_ALPHA,h.BlendFactor.ONE,h.BlendFactor.ONE_MINUS_SRC_ALPHA),t.setColorMask(!0,!0,!0,!0),t.setStencilWriteMask(0),t.setStencilTestEnabled(!i)}draw(e,t){if(!(0,s.hasSource)(t)||t.suspended)return;const{renderPass:r}=e;if("raster-bitmap"!==r)return"raster"===r?this._process(e,t):void this._drawBitmap(e,t,!0);this._drawBitmap(e,t)}_process(e,t){const{rasterFunction:r}=e,i="Reproject"===r.name;if(!(i?!t.rasterTexture||!t.projected:!t.processed))return;const{timeline:s,context:o}=e;s.begin(this.name);const l=o.getBoundFramebufferObject(),u=o.getViewport();i||(t.processedTexture=(0,n.disposeMaybe)(t.processedTexture)),o.setStencilFunction(h.CompareFunction.EQUAL,t.stencilRef,255),t.updateTexture(e),this._initQuad(o);const{isStandardRasterTileSize:c,fbo:d}=this._getRasterFBO(o,t.width,t.height);(0,a.process)(e,this._quad,d,t),c||d.dispose(),o.bindFramebuffer(l),o.setViewport(u.x,u.y,u.width,u.height),s.end(this.name)}_drawBitmap(e,t,r=!1){const{timeline:i,context:n}=e;if(i.begin(this.name),n.setStencilFunction(h.CompareFunction.EQUAL,t.stencilRef,255),t.updateTexture(e),r&&!t.processedTexture){if(t.updateProcessedTexture(),!t.processedTexture)return void i.end(this.name);t.processed=!0}this._initBitmapCommonUniforms(t);const s=t.symbolizerParameters.type,a=(0,o.getColorizer)(s),{requestRender:l,allowDelayedRender:c}=e,{defines:d,program:f}=a.createProgram(e,t,r);if(c&&null!=l&&!f.compiled)return void l();n.useProgram(f);const p=this._getUniformInfos(s,n,f,d);this._quad||(this._quad=new(0,u.default)(n,[0,0,1,0,0,1,1,1])),a.bindTextureAndUniforms(e,f,t,p,r),this._quad.draw(),i.end(this.name)}_initBitmapCommonUniforms(e){if(!e.commonUniforms){const t=(0,f.getBasicGridUniforms)(1,[0,0]),{transformGrid:r,width:i,height:n}=e,s=(0,f.getCommonUniforms)(r,[i,n],[e.source.width,e.source.height],1,!1);e.commonUniforms={...t,...s,u_coordScale:e.coordScale}}}_getRasterFBO(e,t,r){const i=t===l.TILE_SIZE||r===l.TILE_SIZE;return i?(this._fbo||(this._fbo=this._createNewFBO(e,t,r)),{isStandardRasterTileSize:i,fbo:this._fbo}):{isStandardRasterTileSize:i,fbo:this._createNewFBO(e,t,r)}}_createNewFBO(e,t,r){const i=(0,a.createTextureDescriptor)(e,t,r);return new(0,d.FramebufferObject)(e,i)}_initQuad(e){this._quad||(this._quad=new(0,u.default)(e,[0,0,1,0,0,1,1,1]))}_getUniformInfos(e,t,r,i){const n=i.length>0?e+"-"+i.join("-"):e;if(this._rendererUniformInfos.has(n))return this._rendererUniformInfos.get(n);const s=(0,f.getUniformLocationInfos)(t,r);return this._rendererUniformInfos.set(n,s),s}constructor(){super(...arguments),this.name="raster",this._quad=null,this._rendererUniformInfos=new Map,this._fbo=null}}})),t.register("cz22x",(function(r,i){e(r.exports,"RasterBitmap",(function(){return d})),e(r.exports,"hasSource",(function(){return f}));var n=t("7qybv"),s=t("j3x2p"),o=t("eYrMi"),a=t("0P8XU"),l=t("2qlsz"),u=t("8JzMA"),c=t("bv6V3");const h={bandCount:3,outMin:0,outMax:1,minCutOff:[0,0,0],maxCutOff:[255,255,255],factor:[1/255,1/255,1/255],useGamma:!1,gamma:[1,1,1],gammaCorrection:[1,1,1],colormap:null,colormapOffset:null,stretchType:"none",type:"stretch"};class d extends l.DisplayObject{destroy(){this._disposeTextures()}get processedTexture(){return this._processedTexture}set processedTexture(e){this._processedTexture!==e&&(this._disposeTextures(!0),this._processedTexture=e)}get rasterTexture(){return this._rasterTexture}set rasterTexture(e){var t;this._rasterTexture!==e&&(null===(t=this._rasterTexture)||void 0===t||t.dispose(),this._rasterTexture=e)}get processed(){return this._processed}set processed(e){this._processed=e,e||((0,n.disposeMaybe)(this.processedTexture),this.invalidateTexture())}get symbolizerParameters(){return this._symbolizerParameters||h}set symbolizerParameters(e){this._symbolizerParameters!==e&&(this._symbolizerParameters=e,this._colormapTextureInvalidated=!0,this.commonUniforms=null)}get source(){return this._source}set source(e){this._source!==e&&(this._source=e,this._rasterTexture&&(this._rasterTexture.dispose(),this._rasterTexture=null,this._rasterTextureBandIds=null),this.projected=!1,this.invalidateTexture())}get suspended(){return this._suspended}set suspended(e){this._suspended&&!e&&this.stage&&(this.ready(),this.requestRender()),this._suspended=e}get bandIds(){return this._bandIds}set bandIds(e){this._bandIds=e,this._isBandIdschanged(e)&&(this.projected=!1,this.invalidateTexture())}get interpolation(){return this._interpolation||"nearest"}set interpolation(e){this._interpolation=e,this._rasterTexture&&this._rasterTexture.setSamplingMode("bilinear"===this._getTextureSamplingMethod(e||"nearest")?u.TextureSamplingMode.LINEAR:u.TextureSamplingMode.NEAREST)}get transformGrid(){return this._transformGrid}set transformGrid(e){this._transformGrid=e,this._transformGridTexture=(0,n.disposeMaybe)(this._transformGridTexture)}invalidateTexture(){this._textureInvalidated||(this._textureInvalidated=!0,this.requestRender())}_createTransforms(){return{dvs:(0,o.c)()}}setTransform(e){const t=(0,s.g)(this.transforms.dvs),[r,i]=e.toScreenNoRotation([0,0],[this.x,this.y]),n=this.resolution/this.pixelRatio/e.resolution,o=n*this.width,l=n*this.height,u=Math.PI*this.rotation/180;(0,s.h)(t,t,(0,a.f)(r,i)),(0,s.h)(t,t,(0,a.f)(o/2,l/2)),(0,s.r)(t,t,-u),(0,s.h)(t,t,(0,a.f)(-o/2,-l/2)),(0,s.l)(t,t,(0,a.f)(o,l)),(0,s.m)(this.transforms.dvs,e.displayViewMat3,t)}getTextures({forProcessing:e=!1,useProcessedTexture:t=!1}={}){var r;const i=t&&null!==(r=this._processedTexture)&&void 0!==r?r:this._rasterTexture,n=[],s=[];return i?t?(s.push(i),n.push("u_image"),this._colormapTexture&&(s.push(this._colormapTexture),n.push("u_colormap")),{names:n,textures:s}):(this._transformGridTexture&&(s.push(this._transformGridTexture),n.push("u_transformGrid")),s.push(i),n.push("u_image"),this._colormapTexture&&!e&&(s.push(this._colormapTexture),n.push("u_colormap")),{names:n,textures:s}):{names:n,textures:s}}onAttach(){this.invalidateTexture()}onDetach(){this.invalidateTexture()}updateTexture({context:e}){if(!this.stage)return void this._disposeTextures();const t=this._isValidSource(this.source);t&&this._colormapTextureInvalidated&&(this._colormapTextureInvalidated=!1,this._updateColormapTexture(e)),this._textureInvalidated&&(this._textureInvalidated=!1,this._createOrDestroyRasterTexture(e),this._rasterTexture&&(t?this.transformGrid&&!this._transformGridTexture&&(this._transformGridTexture=(0,c.createTransformTexture)(e,this.transformGrid)):this._rasterTexture.setData(null)),this.suspended||(this.ready(),this.requestRender()))}updateProcessedTexture(){const{functionTextures:e}=this;0!==e.length&&(this.processedTexture=e.shift(),e.forEach((e=>null==e?void 0:e.dispose())),e.length=0)}_createOrDestroyRasterTexture(e){var t,r,i;const n=null===(t=this.source)||void 0===t?void 0:t.extractBands(this.bandIds);if(!this._isValidSource(n))return void(this._rasterTexture&&(this._rasterTexture.dispose(),this._rasterTextureBandIds=null,this._rasterTexture=null));const s=!this._isBandIdschanged(this.bandIds);if(this._rasterTexture){if(s)return;this._rasterTexture.dispose(),this._rasterTextureBandIds=null,this._rasterTexture=null}this._supportsBilinearTexture=!!(null===(r=e.capabilities.textureFloat)||void 0===r?void 0:r.textureFloatLinear);const o=this._getTextureSamplingMethod(this.interpolation),a=this.isRendereredSource||!(null===(i=e.capabilities.textureFloat)||void 0===i?void 0:i.textureFloat);this._rasterTexture=(0,c.createRasterTexture)(e,n,o,a),this.projected=!1,this._processed=!1,this._rasterTextureBandIds=this.bandIds?[...this.bandIds]:null}_isBandIdschanged(e){const t=this._rasterTextureBandIds;return!(null==t&&null==e||t&&e&&t.join("")===e.join(""))}_isValidSource(e){var t;return null!=e&&(null===(t=e.pixels)||void 0===t?void 0:t.length)>0}_getTextureSamplingMethod(e){const{type:t,colormap:r}=this.symbolizerParameters,i="lut"===t||"stretch"===t&&null!=r;return!this._supportsBilinearTexture||i||"bilinear"!==e&&"cubic"!==e?"nearest":"bilinear"}_updateColormapTexture(e){const t=this._colormap,r=this.symbolizerParameters.colormap;return r?t?r.length!==t.length||r.some(((e,r)=>e!==t[r]))?(this._colormapTexture&&(this._colormapTexture.dispose(),this._colormapTexture=null),this._colormapTexture=(0,c.createColormapTexture)(e,r),void(this._colormap=r)):void 0:(this._colormapTexture=(0,c.createColormapTexture)(e,r),void(this._colormap=r)):(this._colormapTexture&&(this._colormapTexture.dispose(),this._colormapTexture=null),void(this._colormap=null))}_disposeTextures(e=!1){this._transformGridTexture&&(this._transformGridTexture.dispose(),this._transformGridTexture=null),!e&&this._colormapTexture&&(this._colormapTexture.dispose(),this._colormapTexture=null,this._colormap=null,this._colormapTextureInvalidated=!0),!e&&this._rasterTexture&&(this._rasterTexture.dispose(),this._rasterTexture=null,this._rasterTextureBandIds=null),this._processedTexture&&(this._processedTexture.dispose(),this._processedTexture=null)}constructor(e=null,t=null,r=null){super(),this._textureInvalidated=!0,this._colormapTextureInvalidated=!0,this._rasterTexture=null,this._rasterTextureBandIds=null,this._transformGridTexture=null,this._colormapTexture=null,this._colormap=null,this._supportsBilinearTexture=!0,this._processedTexture=null,this.functionTextures=[],this.projected=!1,this.stencilRef=0,this.coordScale=[1,1],this._processed=!1,this._symbolizerParameters=null,this.height=null,this.isRendereredSource=!1,this.pixelRatio=1,this.resolution=0,this.rotation=0,this._source=null,this.rawPixelData=null,this._suspended=!1,this._bandIds=null,this._interpolation=null,this._transformGrid=null,this.width=null,this.x=0,this.y=0,this.source=e,this.transformGrid=t,this.interpolation=r}}function f(e){return null!=e.source}})),t.register("2qlsz",(function(r,i){e(r.exports,"DisplayObject",(function(){return l}));var n=t("amfHf"),s=t("2VlWd"),o=t("10vEZ");const a=1/(0,s.default)("mapview-transitions-duration");class l extends n.default{get clips(){return this._clips}set clips(e){this._clips=e,this.requestRender()}get isReady(){return this._isReady}get opacity(){return this._opacity}set opacity(e){this._opacity!==e&&(this._opacity=Math.min(1,Math.max(e,0)),this.requestRender())}get stage(){return this._stage}set stage(e){var t;if(this._stage===e)return;const r=this._stage;this._stage=e,e?(null===(t=this._stage)||void 0===t?void 0:t.untrashDisplayObject(this))||(this.onAttach(),this.emit("attach")):null==r||r.trashDisplayObject(this)}get transforms(){return this._getTransforms()}_getTransforms(){return null==this._transforms&&(this._transforms=this._createTransforms()),this._transforms}get visible(){return this._visible}set visible(e){this._visible!==e&&(this._visible=e,this.requestRender())}fadeIn(){return this._fadeInResolver||(this._fadeOutResolver&&(this._fadeOutResolver(),this._fadeOutResolver=null),this.opacity=1,this.computedOpacity=0,this.fadeTransitionEnabled=!0,this._fadeInResolver=(0,o.createResolver)(),this.requestRender()),this._fadeInResolver.promise}fadeOut(){return this._fadeOutResolver||(this.opacity=0,this._fadeInResolver&&(this._fadeInResolver(),this._fadeInResolver=null),this.fadeTransitionEnabled=!0,this._fadeOutResolver=(0,o.createResolver)(),this.requestRender()),this._fadeOutResolver.promise}endTransitions(){var e,t;null===(e=this._fadeInResolver)||void 0===e||e.call(this),this._fadeInResolver=null,null===(t=this._fadeOutResolver)||void 0===t||t.call(this),this._fadeOutResolver=null,this.computedOpacity=this.visible?this.opacity:0,this.requestRender()}beforeRender(e){this.updateTransitionProperties(e.deltaTime,e.state.scale)}afterRender(e){this._fadeInResolver&&this.computedOpacity===this.opacity?(this._fadeInResolver(),this._fadeInResolver=null):this._fadeOutResolver&&0===this.computedOpacity&&(this._fadeOutResolver(),this._fadeOutResolver=null)}remove(){var e;null===(e=this.parent)||void 0===e||e.removeChild(this)}setTransform(e){}processRender(e){this.stage&&this.computedVisible&&this.doRender(e)}requestRender(){this.stage&&this.stage.requestRender()}processDetach(){this._fadeInResolver&&(this._fadeInResolver(),this._fadeInResolver=null),this._fadeOutResolver&&(this._fadeOutResolver(),this._fadeOutResolver=null),this.onDetach(),this.emit("detach")}updateTransitionProperties(e,t){if(this.fadeTransitionEnabled){const t=this._fadeOutResolver||!this.visible?0:this.opacity,r=this.computedOpacity;if(r===t)this.computedVisible=this.visible;else{const i=e*a;this.computedOpacity=r>t?Math.max(t,r-i):Math.min(t,r+i),this.computedVisible=this.computedOpacity>0;const n=t===this.computedOpacity;this.inFadeTransition=!n,n||this.requestRender()}}else this.computedOpacity=this.opacity,this.computedVisible=this.visible}onAttach(){}onDetach(){}doRender(e){}ready(){this._isReady||(this._isReady=!0,this.emit("isReady"),this.requestRender())}constructor(){super(...arguments),this._fadeOutResolver=null,this._fadeInResolver=null,this._clips=null,this.computedVisible=!0,this.computedOpacity=1,this.fadeTransitionEnabled=!1,this.inFadeTransition=!1,this._isReady=!1,this._opacity=1,this.parent=null,this._stage=null,this._visible=!0}}})),t.register("bv6V3",(function(r,i){e(r.exports,"createRasterTexture",(function(){return u})),e(r.exports,"createTransformTexture",(function(){return c})),e(r.exports,"createColormapTexture",(function(){return h})),e(r.exports,"getCommonUniforms",(function(){return d})),e(r.exports,"getColormapUniforms",(function(){return f})),e(r.exports,"getBasicGridUniforms",(function(){return p})),e(r.exports,"getStretchUniforms",(function(){return m})),e(r.exports,"getShadedReliefUniforms",(function(){return g})),e(r.exports,"getUniformLocationInfos",(function(){return v})),e(r.exports,"setUniforms",(function(){return y})),e(r.exports,"setTextures",(function(){return x}));var n=t("iE3Nt"),s=t("7O1P4"),o=t("8JzMA"),a=t("8aBT4"),l=t("dDu9k");function u(e,t,r="nearest",i=!1){var n;const u=!(i&&"u8"===t.pixelType),c=u?o.PixelType.FLOAT:o.PixelType.UNSIGNED_BYTE,h=null==t.pixels||0===t.pixels.length?null:u?t.getAsRGBAFloat():t.getAsRGBA(),d=null===(n=e.capabilities.textureFloat)||void 0===n?void 0:n.textureFloatLinear,f=new(0,l.TextureDescriptor);return f.width=t.width,f.height=t.height,f.internalFormat=e.type===s.ContextType.WEBGL2&&u?o.SizedPixelFormat.RGBA32F:o.PixelFormat.RGBA,f.samplingMode=!d||"bilinear"!==r&&"cubic"!==r?o.TextureSamplingMode.NEAREST:o.TextureSamplingMode.LINEAR,f.dataType=c,f.wrapMode=o.TextureWrapMode.CLAMP_TO_EDGE,new(0,a.Texture)(e,f,h)}function c(e,t){const{spacing:r,offsets:i,coefficients:n,size:[u,c]}=t,h=r[0]>1,d=new(0,l.TextureDescriptor);d.width=h?4*u:u,d.height=c,d.internalFormat=e.type===s.ContextType.WEBGL2?o.SizedPixelFormat.RGBA32F:o.PixelFormat.RGBA,d.dataType=o.PixelType.FLOAT,d.samplingMode=o.TextureSamplingMode.NEAREST,d.wrapMode=o.TextureWrapMode.CLAMP_TO_EDGE;const f=new Float32Array(h?u*c*16:2*i.length);if(h&&null!=n)for(let e=0,t=0;e<n.length;e++)f[t++]=n[e],e%3==2&&(f[t++]=1);else for(let e=0;e<c;e++)for(let t=0;t<u;t++){const r=4*(e*u+t),n=2*(t*c+e);f[r]=i[n],f[r+1]=i[n+1],f[r+3]=-1===i[n]?0:1}return new(0,a.Texture)(e,d,f)}function h(e,t){const r=new(0,l.TextureDescriptor);return r.internalFormat=o.PixelFormat.RGBA,r.width=t.length/4,r.height=1,r.samplingMode=o.TextureSamplingMode.NEAREST,r.wrapMode=o.TextureWrapMode.CLAMP_TO_EDGE,new(0,a.Texture)(e,r,t)}function d(e,t,r,i=1,s=!0){return{u_flipY:s,u_applyTransform:!!e,u_opacity:i,u_transformSpacing:e?e.spacing:n.Z,u_transformGridSize:e?e.size:n.Z,u_targetImageSize:t,u_srcImageSize:r}}function f(e,t){return{u_colormapOffset:t||0,u_colormapMaxIndex:e?e.length/4-1:0}}function p(e,t){return{u_scale:e,u_offset:t}}function m(e){return{u_bandCount:e.bandCount,u_minOutput:e.outMin,u_maxOutput:e.outMax,u_minCutOff:e.minCutOff,u_maxCutOff:e.maxCutOff,u_factor:e.factor,u_useGamma:e.useGamma,u_gamma:e.gamma,u_gammaCorrection:e.gammaCorrection}}function g(e){return{u_hillshadeType:e.hillshadeType,u_sinZcosAs:e.sinZcosAs,u_sinZsinAs:e.sinZsinAs,u_cosZs:e.cosZs,u_weights:e.weights,u_factor:e.factor,u_minValue:e.minValue,u_maxValue:e.maxValue}}function v(e,t){const r=e.gl,i=t.glName,n=new Map;if(null==i)return n;const s=r.getProgramParameter(i,r.ACTIVE_UNIFORMS);let o;for(let e=0;e<s;e++)o=r.getActiveUniform(i,e),o&&n.set(o.name,{location:r.getUniformLocation(i,o.name),info:o});return n}function y(e,t,r){Object.keys(r).forEach((i=>{const n=t.get(i)||t.get(i+"[0]");n&&function(e,t,r,i){if(null===i||null==r)return!1;const{info:n}=i;switch(n.type){case o.UniformType.FLOAT:n.size>1?e.setUniform1fv(t,r):e.setUniform1f(t,r);break;case o.UniformType.FLOAT_VEC2:e.setUniform2fv(t,r);break;case o.UniformType.FLOAT_VEC3:e.setUniform3fv(t,r);break;case o.UniformType.FLOAT_VEC4:e.setUniform4fv(t,r);break;case o.UniformType.FLOAT_MAT3:e.setUniformMatrix3fv(t,r);break;case o.UniformType.FLOAT_MAT4:e.setUniformMatrix4fv(t,r);break;case o.UniformType.INT:n.size>1?e.setUniform1iv(t,r):e.setUniform1i(t,r);break;case o.UniformType.BOOL:e.setUniform1i(t,r?1:0);break;case o.UniformType.INT_VEC2:case o.UniformType.BOOL_VEC2:e.setUniform2iv(t,r);break;case o.UniformType.INT_VEC3:case o.UniformType.BOOL_VEC3:e.setUniform3iv(t,r);break;case o.UniformType.INT_VEC4:case o.UniformType.BOOL_VEC4:e.setUniform4iv(t,r);break;default:return!1}}(e,i,r[i],n)}))}function x(e,t,r,i){r.length===i.length&&(i.some((e=>null==e))||r.some((e=>null==e))||r.forEach(((r,n)=>{t.setUniform1i(r,n),e.bindTexture(i[n],n)})))}})),t.register("grNni",(function(r,i){e(r.exports,"getColorizer",(function(){return l}));var n=t("cgnu9"),s=t("jaRaz"),o=t("01W55");const a=new Map;function l(e){return a.get(e)}a.set("lut",n.default),a.set("hillshade",s.default),a.set("stretch",o.default)})),t.register("cgnu9",(function(r,i){e(r.exports,"default",(function(){return a}));var n=t("2sPxZ"),s=t("bv6V3");const o={vsPath:"raster/common",fsPath:"raster/lut",attributes:new Map([["a_position",0],["a_texcoord",1]])};const a={createProgram:function(e,t,r){const i=r?[]:(0,n.getProjectionDefines)(t.transformGrid);return{defines:i,program:e.painter.materialManager.getProgram(o,i)}},bindTextureAndUniforms:function(e,t,r,i,n=!1){const{names:o,textures:a}=r.getTextures({useProcessedTexture:n});(0,s.setTextures)(e.context,t,o,a),(0,s.setUniforms)(t,i,r.commonUniforms),t.setUniformMatrix3fv("u_dvsMat3",r.transforms.dvs);const{colormap:l,colormapOffset:u}=r.symbolizerParameters,c=(0,s.getColormapUniforms)(l,u);(0,s.setUniforms)(t,i,c)}}})),t.register("2sPxZ",(function(t,r){function i(e){const t=[];return e&&(t.push("applyProjection"),1===e.spacing[0]&&t.push("lookupProjection")),t}function n(e,t,r){var i;const n=!(null===(i=r.capabilities.textureFloat)||void 0===i?void 0:i.textureFloatLinear),s=[];return"cubic"===e?s.push("bicubic"):"bilinear"===e&&(t?(s.push("bilinear"),s.push("nnedge")):n&&s.push("bilinear")),s}e(t.exports,"getProjectionDefines",(function(){return i})),e(t.exports,"getInterpolationDefines",(function(){return n}))})),t.register("jaRaz",(function(r,i){e(r.exports,"default",(function(){return a}));var n=t("2sPxZ"),s=t("bv6V3");const o={vsPath:"raster/common",fsPath:"raster/hillshade",attributes:new Map([["a_position",0],["a_texcoord",1]])};const a={createProgram:function(e,t,r){const{colormap:i}=t.symbolizerParameters,s=[...r?[]:(0,n.getProjectionDefines)(t.transformGrid),...(0,n.getInterpolationDefines)(t.interpolation,null!=i,e.context)];return null!=i&&s.push("applyColormap"),{defines:s,program:e.painter.materialManager.getProgram(o,s)}},bindTextureAndUniforms:function(e,t,r,i,n=!1){const{names:o,textures:a}=r.getTextures({useProcessedTexture:n});(0,s.setTextures)(e.context,t,o,a),(0,s.setUniforms)(t,i,r.commonUniforms),t.setUniformMatrix3fv("u_dvsMat3",r.transforms.dvs);const l=r.symbolizerParameters,{colormap:u,colormapOffset:c}=l;if(null!=u){const e=(0,s.getColormapUniforms)(u,c);(0,s.setUniforms)(t,i,e)}const h=(0,s.getShadedReliefUniforms)(l);(0,s.setUniforms)(t,i,h)}}})),t.register("01W55",(function(r,i){e(r.exports,"default",(function(){return a}));var n=t("2sPxZ"),s=t("bv6V3");const o={vsPath:"raster/common",fsPath:"raster/stretch",attributes:new Map([["a_position",0],["a_texcoord",1]])};const a={createProgram:function(e,t,r){const{colormap:i}=t.symbolizerParameters,s=[...r?[]:(0,n.getProjectionDefines)(t.transformGrid),...(0,n.getInterpolationDefines)(t.interpolation,null!=i,e.context)];return t.isRendereredSource&&!r?s.push("noop"):null!=i&&s.push("applyColormap"),{defines:s,program:e.painter.materialManager.getProgram(o,s)}},bindTextureAndUniforms:function(e,t,r,i,n=!1){const{names:o,textures:a}=r.getTextures({useProcessedTexture:n});(0,s.setTextures)(e.context,t,o,a),(0,s.setUniforms)(t,i,r.commonUniforms),t.setUniformMatrix3fv("u_dvsMat3",r.transforms.dvs);const l=r.symbolizerParameters,{colormap:u,colormapOffset:c}=l;if(null!=u){const e=(0,s.getColormapUniforms)(u,c);(0,s.setUniforms)(t,i,e)}const h=(0,s.getStretchUniforms)(l);(0,s.setUniforms)(t,i,h)}}})),t.register("49aaT",(function(r,i){e(r.exports,"createTextureDescriptor",(function(){return b})),e(r.exports,"process",(function(){return S}));var n=t("hkpOs"),s=t("iZrjo"),o=t("gFf8E"),a=t("8qfjZ"),l=t("dpkW1"),u=t("jDABC"),c=t("6VWDX"),h=t("f1JQm"),d=t("cNPLz"),f=t("hbWhx"),p=t("ii5Xe"),m=t("1uskR"),g=t("dZUfU"),v=t("7O1P4"),y=t("8JzMA"),x=t("8aBT4"),_=t("dDu9k");const T=new Map;function b(e,t,r){const i=new(0,_.TextureDescriptor);return i.width=t,i.height=r,i.internalFormat=e.type===v.ContextType.WEBGL2?y.SizedPixelFormat.RGBA32F:y.PixelFormat.RGBA,i.samplingMode=y.TextureSamplingMode.NEAREST,i.dataType=y.PixelType.FLOAT,i.isImmutable=e.type===v.ContextType.WEBGL2,i.wrapMode=y.TextureWrapMode.CLAMP_TO_EDGE,i}function S(e,t,r,i){const n=e.rasterFunction.name.toLowerCase(),s="reproject"===n?p.default:function(e){return T.get(e.toLowerCase())}(n);if(null==s)return;const o=function(e,t,r,i){const{context:n,requestRender:s,allowDelayedRender:o}=e,a=i.createProgram(e,r);if(o&&null!=s&&!a.compiled)return s(),null;const{width:l,height:u}=r;return n.bindFramebuffer(t),n.setViewport(0,0,l,u),n.useProgram(a),a}(e,r,i,s);if(!o)return;s.bindTextureAndUniforms(e,o,i),t.draw();const{width:a,height:l}=i,u=b(e.context,a,l),c=new(0,x.Texture)(e.context,u);if(r.copyToTexture(0,0,a,l,0,0,c),"reproject"===n)i.rasterTexture=c,i.projected=!0;else{const t=e.hasBranches?e.rasterFunction.id:0;i.functionTextures[t]=c}}T.set("aspect",n.default),T.set("bandarithmetic",s.default),T.set("compositeband",o.default),T.set("convolution",a.default),T.set("curvature",l.default),T.set("extractband",u.default),T.set("local",c.default),T.set("mask",h.default),T.set("ndvi",d.default),T.set("remap",f.default),T.set("slope",m.default),T.set("stretch",g.default)})),t.register("hkpOs",(function(r,i){e(r.exports,"default",(function(){return o}));var n=t("KbRV0");const s={vsPath:"raster/rfx/vs",fsPath:"raster/rfx/aspect",attributes:new Map([["a_position",0],["a_texcoord",1]])};const o={createProgram:function(e,t){return e.painter.materialManager.getProgram(s,[])},bindTextureAndUniforms:function(e,t,r){(0,n.setSingleImageTextures)(e,t,r),(0,n.setCoordsAndTransforms)(t);const{width:i,height:s,resolution:o}=r;t.setUniform2fv("u_srcImageSize",[i,s]),t.setUniform2fv("u_cellSize",[o,o])}}})),t.register("KbRV0",(function(r,i){e(r.exports,"setSingleImageTextures",(function(){return a})),e(r.exports,"setMultipleImageTextures",(function(){return l})),e(r.exports,"setCoordsAndTransforms",(function(){return u}));var n=t("bv6V3");const s=[1,1],o=[2,0,0,0,2,0,-1,-1,0];function a(e,t,r){var i,s;const{context:o,rasterFunction:a,hasBranches:l}=e,{raster:u}=a.parameters,c=l?null!==(i=null==u?void 0:u.id)&&void 0!==i?i:-1:0,h=null!==(s=r.functionTextures[c])&&void 0!==s?s:r.rasterTexture;(0,n.setTextures)(o,t,["u_image"],[h])}function l(e,t,r){const{rasters:i}=e.rasterFunction.parameters;if(!i)return;if(i.length<2)return a(e,t,r);const s=i.filter((e=>"Constant"!==e.name)).map((e=>null!=e.id&&"Identity"!==e.name?r.functionTextures[e.id]:r.rasterTexture));if((0,n.setTextures)(e.context,t,["u_image","u_image1","u_image2"].slice(0,s.length),s),s.length!==i.length)if(2===i.length){const e=i.findIndex((e=>"Constant"===e.name)),r=0===e?[0,1,0,1,0,0,0,0,0]:[1,0,0,0,1,0,0,0,0],{value:n}=i[e].parameters;t.setUniform1f("u_image1Const",n),t.setUniformMatrix3fv("u_imageSwap",r)}else if(3===i.length){const e=[];if(i.forEach(((t,r)=>"Constant"===t.name&&e.push(r))),1===e.length){const{value:r}=i[e[0]].parameters;t.setUniform1f("u_image1Const",r);const n=0===e[0]?[0,1,0,0,0,1,1,0,0]:1===e[0]?[1,0,0,0,0,1,0,1,0]:[1,0,0,0,1,0,0,0,1];t.setUniformMatrix3fv("u_imageSwap",n)}else if(2===e.length){const{value:r}=i[e[0]].parameters;t.setUniform1f("u_image1Const",r);const{value:n}=i[e[1]].parameters;t.setUniform1f("u_image2Const",n);const s=i.findIndex((e=>"Constant"!==e.name)),o=0===s?[1,0,0,0,1,0,0,0,1]:1===s?[0,1,0,1,0,0,0,0,1]:[0,0,1,1,0,0,0,1,0];t.setUniformMatrix3fv("u_imageSwap",o)}}}function u(e){e.setUniform2fv("u_coordScale",s),e.setUniformMatrix3fv("u_dvsMat3",o)}})),t.register("iZrjo",(function(r,i){e(r.exports,"default",(function(){return o}));var n=t("KbRV0");const s={vsPath:"raster/rfx/vs",fsPath:"raster/rfx/bandarithmetic",attributes:new Map([["a_position",0],["a_texcoord",1]])};const o={createProgram:function(e,t){const{painter:r,rasterFunction:i}=e,{indexType:n}=i.parameters;return r.materialManager.getProgram(s,[n])},bindTextureAndUniforms:function(e,t,r){(0,n.setSingleImageTextures)(e,t,r),(0,n.setCoordsAndTransforms)(t);const{bandIndexMat3:i}=e.rasterFunction.parameters;t.setUniformMatrix3fv("u_bandIndexMat3",i)}}})),t.register("gFf8E",(function(r,i){e(r.exports,"default",(function(){return o}));var n=t("KbRV0");const s={vsPath:"raster/rfx/vs",fsPath:"raster/rfx/compositeband",attributes:new Map([["a_position",0],["a_texcoord",1]])};const o={createProgram:function(e,t){return e.painter.materialManager.getProgram(s,[])},bindTextureAndUniforms:function(e,t,r){(0,n.setMultipleImageTextures)(e,t,r),(0,n.setCoordsAndTransforms)(t)}}})),t.register("8qfjZ",(function(r,i){e(r.exports,"default",(function(){return o}));var n=t("KbRV0");const s={vsPath:"raster/rfx/vs",fsPath:"raster/rfx/convolution",attributes:new Map([["a_position",0],["a_texcoord",1]])};const o={createProgram:function(e,t){const{painter:r,rasterFunction:i}=e,{kernelRows:n,kernelCols:o}=i.parameters,a=[{name:"rows",value:n},{name:"cols",value:o}];return r.materialManager.getProgram(s,a)},bindTextureAndUniforms:function(e,t,r){(0,n.setSingleImageTextures)(e,t,r),(0,n.setCoordsAndTransforms)(t),t.setUniform2fv("u_srcImageSize",[r.width,r.height]);const{kernel:i,clampRange:s}=e.rasterFunction.parameters;t.setUniform1fv("u_kernel",i),t.setUniform2fv("u_clampRange",s)}}})),t.register("dpkW1",(function(r,i){e(r.exports,"default",(function(){return o}));var n=t("KbRV0");const s={vsPath:"raster/rfx/vs",fsPath:"raster/rfx/curvature",attributes:new Map([["a_position",0],["a_texcoord",1]])};const o={createProgram:function(e,t){const{painter:r,rasterFunction:i}=e,{curvatureType:n}=i.parameters,o=[n];return r.materialManager.getProgram(s,o)},bindTextureAndUniforms:function(e,t,r){(0,n.setSingleImageTextures)(e,t,r),(0,n.setCoordsAndTransforms)(t);const{width:i,height:s,resolution:o}=r,{zFactor:a}=e.rasterFunction.parameters;t.setUniform2fv("u_srcImageSize",[i,s]),t.setUniform1f("u_zlFactor",200*a/o/o)}}})),t.register("jDABC",(function(r,i){e(r.exports,"default",(function(){return o}));var n=t("KbRV0");const s={vsPath:"raster/rfx/vs",fsPath:"raster/rfx/extractband",attributes:new Map([["a_position",0],["a_texcoord",1]])};const o={createProgram:function(e,t){return e.painter.materialManager.getProgram(s,[])},bindTextureAndUniforms:function(e,t,r){(0,n.setSingleImageTextures)(e,t,r),(0,n.setCoordsAndTransforms)(t);const{bandIndexMat3:i}=e.rasterFunction.parameters;t.setUniformMatrix3fv("u_bandIndexMat3",i)}}})),t.register("6VWDX",(function(r,i){e(r.exports,"default",(function(){return l}));var n=t("KbRV0"),s=t("7O1P4");const o={vsPath:"raster/rfx/vs",fsPath:"raster/rfx/local",attributes:new Map([["a_position",0],["a_texcoord",1]])},a=new Set(["sinh","cosh","tanh","asinh","acosh","atanh"]);const l={createProgram:function(e){const{painter:t,rasterFunction:r}=e,{imageCount:i,operationName:n,rasters:l,isOutputRounded:u}=r.parameters;let c=n.toLowerCase();e.context.type===s.ContextType.WEBGL1&&a.has(c)&&(c=`polyfill${c}`);const h=[c];2===i&&h.push("twoImages");const d=l.filter((e=>"Constant"===e.name));return d.length&&(h.push("oneConstant"),2===d.length&&h.push("twoConstant")),u&&h.push("roundOutput"),t.materialManager.getProgram(o,h)},bindTextureAndUniforms:function(e,t,r){(0,n.setMultipleImageTextures)(e,t,r),(0,n.setCoordsAndTransforms)(t);const{domainRange:i}=e.rasterFunction.parameters;t.setUniform2fv("u_domainRange",i)}}})),t.register("f1JQm",(function(r,i){e(r.exports,"default",(function(){return o}));var n=t("KbRV0");const s={vsPath:"raster/rfx/vs",fsPath:"raster/rfx/mask",attributes:new Map([["a_position",0],["a_texcoord",1]])};const o={createProgram:function(e,t){const{painter:r,rasterFunction:i}=e,n=i.parameters.bandCount>1?["multiBand"]:[];return r.materialManager.getProgram(s,n)},bindTextureAndUniforms:function(e,t,r){(0,n.setSingleImageTextures)(e,t,r),(0,n.setCoordsAndTransforms)(t);const{includedRanges:i,noDataValues:s}=e.rasterFunction.parameters;t.setUniform1fv("u_includedRanges",i),t.setUniform1fv("u_noDataValues",s)}}})),t.register("cNPLz",(function(r,i){e(r.exports,"default",(function(){return o}));var n=t("KbRV0");const s={vsPath:"raster/rfx/vs",fsPath:"raster/rfx/ndvi",attributes:new Map([["a_position",0],["a_texcoord",1]])};const o={createProgram:function(e,t){const{painter:r,rasterFunction:i}=e,n=i.parameters.scaled?["scaled"]:[];return r.materialManager.getProgram(s,n)},bindTextureAndUniforms:function(e,t,r){(0,n.setSingleImageTextures)(e,t,r),(0,n.setCoordsAndTransforms)(t);const{bandIndexMat3:i}=e.rasterFunction.parameters;t.setUniformMatrix3fv("u_bandIndexMat3",i)}}})),t.register("hbWhx",(function(r,i){e(r.exports,"default",(function(){return o}));var n=t("KbRV0");const s={vsPath:"raster/rfx/vs",fsPath:"raster/rfx/remap",attributes:new Map([["a_position",0],["a_texcoord",1]])};const o={createProgram:function(e,t){return e.painter.materialManager.getProgram(s,[])},bindTextureAndUniforms:function(e,t,r){(0,n.setSingleImageTextures)(e,t,r),(0,n.setCoordsAndTransforms)(t);const{noDataRanges:i,rangeMaps:s,allowUnmatched:o,clampRange:a}=e.rasterFunction.parameters;t.setUniform1fv("u_noDataRanges",i),t.setUniform1fv("u_rangeMaps",s),t.setUniform1f("u_unmatchMask",o?1:0),t.setUniform2fv("u_clampRange",a)}}})),t.register("ii5Xe",(function(r,i){e(r.exports,"default",(function(){return a}));var n=t("iE3Nt"),s=t("bv6V3");const o={vsPath:"raster/common",fsPath:"raster/reproject",attributes:new Map([["a_position",0],["a_texcoord",1]])};const a={createProgram:function(e,t){var r,i,n;const{painter:s}=e,a=[],{interpolation:l,transformGrid:u}=t,c=!!(null===(r=e.rasterFunction)||void 0===r||null===(i=r.parameters)||void 0===i?void 0:i.requireBilinear),h="bilinear"===l?!(null===(n=e.context.capabilities.textureFloat)||void 0===n?void 0:n.textureFloatLinear):c;return"cubic"===l?a.push("bicubic"):h&&a.push("bilinear"),u&&(a.push("applyProjection"),1===u.spacing[0]&&a.push("lookupProjection")),s.materialManager.getProgram(o,a)},bindTextureAndUniforms:function(e,t,r){const{names:i,textures:o}=r.getTextures({forProcessing:!0});(0,s.setTextures)(e.context,t,i,o),t.setUniform1f("u_scale",1),t.setUniform2fv("u_offset",[0,0]),t.setUniform2fv("u_coordScale",[1,1]),t.setUniformMatrix3fv("u_dvsMat3",[2,0,0,0,2,0,-1,-1,0]),t.setUniform1i("u_flipY",0),t.setUniform1f("u_opacity",1);const{width:a,height:l,source:u,transformGrid:c}=r;t.setUniform2fv("u_srcImageSize",[u.width,u.height]),t.setUniform2fv("u_targetImageSize",[a,l]),t.setUniform2fv("u_transformSpacing",c?c.spacing:n.Z),t.setUniform2fv("u_transformGridSize",c?c.size:n.Z)}}})),t.register("1uskR",(function(r,i){e(r.exports,"default",(function(){return o}));var n=t("KbRV0");const s={vsPath:"raster/rfx/vs",fsPath:"raster/rfx/slope",attributes:new Map([["a_position",0],["a_texcoord",1]])};const o={createProgram:function(e,t){const{painter:r,rasterFunction:i}=e,{slopeType:n}=i.parameters,o="percent-rise"===n?["percentRise"]:[];return r.materialManager.getProgram(s,o)},bindTextureAndUniforms:function(e,t,r){(0,n.setSingleImageTextures)(e,t,r),(0,n.setCoordsAndTransforms)(t);const{width:i,height:s,resolution:o}=r,{zFactor:a,slopeType:l,pixelSizePower:u,pixelSizeFactor:c}=e.rasterFunction.parameters;t.setUniform2fv("u_srcImageSize",[i,s]),t.setUniform2fv("u_cellSize",[o,o]),t.setUniform1f("u_zFactor",a),t.setUniform1f("u_pixelSizePower","adjusted"===l?u:0),t.setUniform1f("u_pixelSizeFactor","adjusted"===l?c:0)}}})),t.register("dZUfU",(function(r,i){e(r.exports,"default",(function(){return o}));var n=t("KbRV0");const s={vsPath:"raster/rfx/vs",fsPath:"raster/rfx/stretch",attributes:new Map([["a_position",0],["a_texcoord",1]])};const o={createProgram:function(e,t){const{useGamma:r,bandCount:i,isOutputRounded:n}=e.rasterFunction.parameters,o=[];return r&&o.push("useGamma"),i>1&&o.push("multiBand"),n&&o.push("roundOutput"),e.painter.materialManager.getProgram(s,o)},bindTextureAndUniforms:function(e,t,r){(0,n.setSingleImageTextures)(e,t,r),(0,n.setCoordsAndTransforms)(t);const{width:i,height:s}=r,o=e.rasterFunction.parameters;t.setUniform2fv("u_srcImageSize",[i,s]),t.setUniform1f("u_minOutput",o.outMin),t.setUniform1f("u_maxOutput",o.outMax),t.setUniform1fv("u_factor",o.factor),t.setUniform1fv("u_minCutOff",o.minCutOff),t.setUniform1fv("u_maxCutOff",o.maxCutOff),t.setUniform1fv("u_gamma",o.gamma),t.setUniform1fv("u_gammaCorrection",o.gammaCorrection)}}})),t.register("9Qv38",(function(r,i){e(r.exports,"RasterTile",(function(){return a}));var n=t("eYrMi"),s=t("cz22x"),o=t("8eM7H");class a extends o.TiledDisplayObject{destroy(){super.destroy(),this.bitmap.destroy(),this.bitmap=null,this.stage=null}set stencilRef(e){this.bitmap.stencilRef=e}get stencilRef(){return this.bitmap.stencilRef}setTransform(e){super.setTransform(e),this.bitmap.transforms.dvs=this.transforms.dvs}_createTransforms(){return{dvs:(0,n.c)(),tileMat3:(0,n.c)()}}onAttach(){this.bitmap.stage=this.stage}onDetach(){this.bitmap.stage=null}constructor(e,t,r,i,n,o,a=null){super(e,t,r,i,n,o),this.bitmap=null,this.bitmap=new(0,s.RasterBitmap)(a,null,null),this.bitmap.coordScale=[n,o],this.bitmap.once("isReady",(()=>this.ready()))}}})),t.register("8eM7H",(function(r,i){e(r.exports,"TiledDisplayObject",(function(){return a}));var n=t("j3x2p"),s=t("2qlsz"),o=t("i90gL");class a extends s.DisplayObject{destroy(){this.texture&&(this.texture.dispose(),this.texture=null)}setTransform(e){const t=this.resolution/(e.resolution*e.pixelRatio),r=this.transforms.tileMat3,[i,s]=e.toScreenNoRotation([0,0],[this.x,this.y]),o=this.width/this.rangeX*t,a=this.height/this.rangeY*t;(0,n.s)(r,o,0,0,0,a,0,i,s,1),(0,n.m)(this.transforms.dvs,e.displayViewMat3,r)}constructor(e,t,r,i,n,s,a=n,l=s){super(),this.triangleCountReportedInDebug=0,this.triangleCount=0,this.texture=null,this.key=new(0,o.default)(e),this.resolution=t,this.x=r,this.y=i,this.width=n,this.height=s,this.rangeX=a,this.rangeY=l}}})),t.register("66IJZ",(function(t,r){var i,n,s,o,a,l,u,c;e(t.exports,"WGLGeometryType",(function(){return i})),e(t.exports,"WGLDrawPhase",(function(){return n})),e(t.exports,"VVType",(function(){return s})),e(t.exports,"WGLVVFlag",(function(){return o})),e(t.exports,"WGLVVTarget",(function(){return a})),e(t.exports,"MosaicType",(function(){return l})),e(t.exports,"WGLSymbologyType",(function(){return u})),(c=i||(i={}))[c.FILL=0]="FILL",c[c.LINE=1]="LINE",c[c.MARKER=2]="MARKER",c[c.TEXT=3]="TEXT",c[c.LABEL=4]="LABEL",function(e){e[e.NONE=0]="NONE",e[e.MAP=1]="MAP",e[e.LABEL=2]="LABEL",e[e.LABEL_ALPHA=4]="LABEL_ALPHA",e[e.HITTEST=8]="HITTEST",e[e.HIGHLIGHT=16]="HIGHLIGHT",e[e.CLIP=32]="CLIP",e[e.DEBUG=64]="DEBUG",e[e.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"}(n||(n={})),function(e){e[e.SIZE=0]="SIZE",e[e.COLOR=1]="COLOR",e[e.OPACITY=2]="OPACITY",e[e.ROTATION=3]="ROTATION"}(s||(s={})),function(e){e[e.NONE=0]="NONE",e[e.OPACITY=1]="OPACITY",e[e.COLOR=2]="COLOR",e[e.ROTATION=4]="ROTATION",e[e.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE",e[e.SIZE_SCALE_STOPS=16]="SIZE_SCALE_STOPS",e[e.SIZE_FIELD_STOPS=32]="SIZE_FIELD_STOPS",e[e.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"}(o||(o={})),function(e){e[e.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE",e[e.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE",e[e.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE",e[e.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"}(a||(a={})),function(e){e[e.SPRITE=0]="SPRITE",e[e.GLYPH=1]="GLYPH"}(l||(l={})),function(e){e[e.DEFAULT=0]="DEFAULT",e[e.SIMPLE=1]="SIMPLE",e[e.DOT_DENSITY=2]="DOT_DENSITY",e[e.OUTLINE_FILL=3]="OUTLINE_FILL",e[e.OUTLINE_FILL_SIMPLE=4]="OUTLINE_FILL_SIMPLE",e[e.HEATMAP=5]="HEATMAP",e[e.PIE_CHART=6]="PIE_CHART"}(u||(u={}))})),t.register("3v0eQ",(function(r,i){e(r.exports,"default",(function(){return c}));var n=t("2VlWd"),s=t("66IJZ"),o=t("3FBIK"),a=t("cq8Fg"),l=t("ht01f");const u=(e,t)=>e.key.level-t.key.level!=0?e.key.level-t.key.level:e.key.row-t.key.row!=0?e.key.row-t.key.row:e.key.col-t.key.col;class c extends o.default{get requiresDedicatedFBO(){return!1}renderChildren(e){this.sortChildren(u),this.setStencilReference(e),super.renderChildren(e)}createRenderParams(e){const{state:t}=e,r=super.createRenderParams(e);return r.requiredLevel=this._tileInfoView.getClosestInfoForScale(t.scale).level,r.displayLevel=this._tileInfoView.tileInfo.scaleToZoom(t.scale),r}prepareRenderPasses(e){const t=super.prepareRenderPasses(e);return t.push(e.registerRenderPass({name:"stencil",brushes:[l.default],drawPhase:s.WGLDrawPhase.DEBUG|s.WGLDrawPhase.MAP|s.WGLDrawPhase.HIGHLIGHT,target:()=>this.getStencilTarget()})),(0,n.default)("esri-tiles-debug")&&t.push(e.registerRenderPass({name:"tileInfo",brushes:[a.default],drawPhase:s.WGLDrawPhase.DEBUG,target:()=>this.children})),t}getStencilTarget(){return this.children}setStencilReference(e){let t=1;for(const e of this.children)e.stencilRef=t++}constructor(e){super(),this._tileInfoView=e}}})),t.register("5QZs5",(function(r,i){e(r.exports,"BaseImageryTileSubView2D",(function(){return S}));var n=t("7eJjO");t("2ILM8");var s=t("6dXDO"),o=t("jHOLN"),a=t("10vEZ"),l=t("iho5X");t("iJAIC"),t("lNwWH"),t("2VlWd");var u=t("fcwIv"),c=t("d1Fqh"),h=t("idX6c"),d=t("xQ42o"),f=t("4IP7o"),p=t("jxAFe"),m=t("fegDl");t("3yhCg");var g=t("cqGfY");t("i90gL");var v=t("eX6AZ"),y=t("gZ2KV"),x=t("4WoSm"),_=t("3NAox"),T=t("gINRd");const b=[0,0];let S=class extends s.HandleOwner{get useWebGLForProcessing(){var e;return null===(e=this._get("useWebGLForProcessing"))||void 0===e||e}set useWebGLForProcessing(e){this._set("useWebGLForProcessing",e)}get useProgressiveUpdate(){var e;return null===(e=this._get("useProgressiveUpdate"))||void 0===e||e}set useProgressiveUpdate(e){if(this._tileStrategy&&this.useProgressiveUpdate!==e){this._tileStrategy.destroy(),this.container.removeAllChildren();const t=this._getCacheSize(e);this._tileStrategy=new(0,y.default)({cachePolicy:"purge",acquireTile:e=>this.acquireTile(e),releaseTile:e=>this.releaseTile(e),cacheSize:t,tileInfoView:this._tileInfoView}),this._set("useProgressiveUpdate",e),this.layerView.requestUpdate()}}update(e){this._fetchQueue.pause(),this._fetchQueue.state=e.state,this._tileStrategy.update(e),this._fetchQueue.resume();const{extent:t,resolution:r,scale:i}=e.state,n=this._tileInfoView.getClosestInfoForScale(i);if(this.layer.raster){var s;if(!this.useProgressiveUpdate||this._needBlockCacheUpdate){const e=this._srcResolutions[n.level],i=t.toJSON?t:T.default.fromJSON(t);(0,f.update)(this._blockCacheRegistryUrl,this._blockCacheRegistryId,i,r,e,this.layer.raster.ioConfig.sampling)}this._needBlockCacheUpdate=!1,(null===(s=this.previousLOD)||void 0===s?void 0:s.level)!==n.level&&(this.previousLOD=n,null==this._symbolizerParams||this.layerView.hasTilingEffects||this._updateSymbolizerParams(),this._tileStrategy.updateCacheSize(0))}}moveEnd(){!this.layerView.hasTilingEffects&&this.useProgressiveUpdate||(this._abortController&&this._abortController.abort(),this._abortController=new AbortController,0===this._fetchQueue.length&&this._redrawImage(this._abortController.signal).then((()=>{this._globalUpdateRequested=!1,this.layerView.requestUpdate()})));const e=this._getCacheSize(this.useProgressiveUpdate);this._tileStrategy.updateCacheSize(e),this.layerView.requestUpdate()}get updating(){var e;return(null===(e=this._fetchQueue)||void 0===e?void 0:e.updating)||this._globalUpdateRequested||!(!this.updatingHandles||!this.updatingHandles.updating)}attach(){const e=(0,_.getWebGLCapabilities)("2d");this._maxIndexedColormapSize=4*(e.maxTextureSize||4096),e.supportsTextureFloat||(this.useWebGLForProcessing=!1),this._initializeTileInfo(),this._tileInfoView=new(0,g.default)(this.layerView.tileInfo,this.layerView.fullExtent);const t=this._computeFetchConcurrency();this._fetchQueue=new(0,v.default)({tileInfoView:this._tileInfoView,concurrency:t,process:(e,t)=>this._fetchTile1(e,t)});const r=this._getCacheSize(this.useProgressiveUpdate);this._tileStrategy=new(0,y.default)({cachePolicy:"purge",acquireTile:e=>this.acquireTile(e),releaseTile:e=>this.releaseTile(e),cacheSize:r,tileInfoView:this._tileInfoView}),this._updateBlockCacheRegistry()}detach(){this._tileStrategy.destroy(),this._fetchQueue.clear(),this.container.removeAllChildren(),this._fetchQueue=this._tileStrategy=this._tileInfoView=null,(0,f.unregister)(this._blockCacheRegistryUrl,this._blockCacheRegistryId),this._blockCacheRegistryUrl=this._blockCacheRegistryId=null}acquireTile(e){const t=this.container.createTile(e);return this._enqueueTileFetch(t),this.layerView.requestUpdate(),this._needBlockCacheUpdate=!0,this._globalUpdateRequested=this.layerView.hasTilingEffects||!this.useProgressiveUpdate,t}releaseTile(e){this._fetchQueue.abort(e.key.id),this.container.removeChild(e),e.once("detach",(()=>{e.destroy(),this.layerView.requestUpdate()})),this.layerView.requestUpdate()}createEmptyTilePixelBlock(e=null){const t=null==e||e.join(",")===this._tileInfoView.tileInfo.size.join(",");if(t&&null!=this._emptyTilePixelBlock)return this._emptyTilePixelBlock;e=e||this._tileInfoView.tileInfo.size;const[r,i]=e,n=new(0,h.default)({width:r,height:i,pixels:[new Uint8Array(r*i)],mask:new Uint8Array(r*i),pixelType:"u8"});return t&&(this._emptyTilePixelBlock=n),n}_getBandIds(){if(!("rasterFunctionChain"in this.container)||!this.container.rasterFunctionChain)return this.layer.bandIds;const{bandIds:e,raster:t}=this.layer,r="rasterFunction"in t?t.rasterFunction.rawInputBandIds:null;return(null==e?void 0:e.length)&&(null==r?void 0:r.length)&&1!==t.rasterInfo.bandCount?e.map((e=>r[Math.min(e,r.length-1)])):e||r}updateRasterFunctionParameters(){}_fetchTile1(e,t){const r=null!=t?t.signal:null,i=this.canUseWebGLForProcessing(),{layerView:n}=this,{tileInfo:s}=n,o=!s.isWrappable&&null!=(0,p.getWorldWidth)(n.view.spatialReference),a=i&&this.layer.raster.hasUniqueSourceStorageInfo,l={allowPartialFill:!0,datumTransformation:n.datumTransformation,interpolation:i?"nearest":this.layer.interpolation,registryId:this._blockCacheRegistryId,requestRawData:a,skipRasterFunction:"raster"===this.type&&null!=this.container.rasterFunctionChain,signal:r,srcResolution:this._srcResolutions[e.level],timeExtent:n.timeExtent,tileInfo:s,disableWrapAround:o};return this.fetchTile(e,l)}_getCacheSize(e){return e?40:0}_initializeTileInfo(){const{layerView:e}=this,t=e.view.spatialReference;if(this._canUseLayerLODs()){const{origin:r,lods:i}=this.layer.tileInfo,n=i.map((({scale:e})=>e)),s=d.default.create({spatialReference:t,size:x.TILE_SIZE,scales:n,origin:r});return e.set("tileInfo",s),void(this._srcResolutions=i.map((({resolution:e})=>({x:e,y:e}))))}const r=(0,m.isShadedReliefRendererSupported)(this.layer.rasterInfo),{scales:i,srcResolutions:n,isCustomTilingScheme:s}=(0,p.computeProjectedScales)(this.layer.rasterInfo,t,{tileSize:x.TILE_SIZE,alignGlobalDatasetWithAGOL:!0,limitToSrcResolution:r}),o=d.default.create({spatialReference:t,size:x.TILE_SIZE,scales:i}),a=new(0,c.default)({x:e.fullExtent.xmin,y:e.fullExtent.ymax,spatialReference:t});(0===o.origin.x||o.origin.x>a.x)&&(o.origin=a),this._isCustomTilingScheme=s,e.set("tileInfo",o),this._srcResolutions=null!=n?n:[]}_canUseLayerLODs(){var e;const{layer:t,layerView:r}=this;if("Map"!==t.raster.tileType)return!1;const{lods:i}=t.tileInfo,n=null===(e=r.view.constraints)||void 0===e?void 0:e.effectiveLODs;return(null==n?void 0:n.length)===i.length&&n.every((({scale:e},t)=>Math.abs(e-i[t].scale)<.001))}_computeFetchConcurrency(){const{blockBoundary:e}=this.layer.rasterInfo.storageInfo,t=e[e.length-1];return(t.maxCol-t.minCol+1)*(t.maxRow-t.minRow+1)>64?2:10}async _enqueueTileFetch(e,t){this.updatingHandles.addPromise(this._enqueueTileFetch1(e,t))}async _enqueueTileFetch1(e,t){if(!this._fetchQueue.has(e.key.id)){try{const t=await this._fetchQueue.push(e.key),i=this._getBandIds();let n=!this.useProgressiveUpdate||this.layerView.hasTilingEffects&&!this._globalSymbolizerParams;if(this._globalUpdateRequested&&!this.layerView.moving&&0===this._fetchQueue.length){n=!1;try{var r;await this._redrawImage(null===(r=this._abortController)||void 0===r?void 0:r.signal)}catch(e){(0,a.isAbortError)(e)&&o.default.getLogger(this).error(e)}this._globalUpdateRequested=!1}!this.canUseWebGLForProcessing()&&"rasterVF"!==this.type||this.layerView.hasTilingEffects||null!=this._symbolizerParams||this._updateSymbolizerParams();const s=this._tileInfoView.getTileCoords(b,e.key),l=this._tileInfoView.getTileResolution(e.key);await this.updateTileSource(e,{source:t,symbolizerParams:this._symbolizerParams,globalSymbolizerParams:this._globalSymbolizerParams,suspended:n,bandIds:i,coords:s,resolution:l}),e.once("attach",(()=>this.layerView.requestUpdate())),this.container.addChild(e)}catch(e){(0,a.isAbortError)(e)||o.default.getLogger(this).error(e)}this.layerView.requestUpdate()}}async _redrawImage(e){if(0===this.container.children.length)return;await this.layer.updateRenderer(),this.layerView.hasTilingEffects?await this._updateGlobalSymbolizerParams(e):(this._updateSymbolizerParams(),this._globalSymbolizerParams=null);const t=this.container.children.map((async e=>this.updateTileSymbolizerParameters(e,{local:this._symbolizerParams,global:this._globalSymbolizerParams})));await(0,a.eachAlways)(t),this.container.requestRender()}async _updateGlobalSymbolizerParams(e){const t={srcResolution:this._srcResolutions[this.previousLOD.level],registryId:this._blockCacheRegistryId,signal:e},r=await this.layer.fetchPixels(this.layerView.view.extent,this.layerView.view.width,this.layerView.view.height,t);if(!r||!r.pixelBlock)return;const{resolution:i}=this.previousLOD,n=this._getBandIds(),s=this.layer.symbolizer.generateWebGLParameters({pixelBlock:r.pixelBlock.extractBands(n),isGCS:this.layerView.view.spatialReference.isGeographic,resolution:{x:i,y:i},bandIds:n});!this.canUseWebGLForProcessing()&&s&&"stretch"===s.type&&this.layer.renderer&&"raster-stretch"===this.layer.renderer.type&&(s.factor=s.factor.map((e=>255*e)),s.outMin=Math.round(255*s.outMin),s.outMax=Math.round(255*s.outMax)),this._globalSymbolizerParams=s}_updateSymbolizerParams(){const{resolution:e}=this.previousLOD,t=this._getBandIds();this._symbolizerParams=this.layer.symbolizer.generateWebGLParameters({pixelBlock:null,isGCS:this.layerView.view.spatialReference.isGeographic,resolution:{x:e,y:e},bandIds:t})}_updateBlockCacheRegistry(e=!1){const{layer:t,layerView:r}=this,{url:i,raster:n}=t,{multidimensionalDefinition:s}=t.normalizeRasterFetchOptions({multidimensionalDefinition:t.multidimensionalDefinition,timeExtent:r.timeExtent}),o=n.rasterInfo.multidimensionalInfo?n.getSliceIndex(s):null,a=(0,f.getRasterId)(i,o);if(a!==this._blockCacheRegistryUrl){if(null!=this._blockCacheRegistryUrl&&(0,f.unregister)(this._blockCacheRegistryUrl,this._blockCacheRegistryId),this._blockCacheRegistryId=(0,f.register)(a,n.rasterInfo),e){const{view:e}=r,t=this._tileInfoView.getClosestInfoForScale(e.scale),i=this._srcResolutions[t.level];(0,f.update)(a,this._blockCacheRegistryId,e.extent,e.resolution,i,n.ioConfig.sampling)}this._blockCacheRegistryUrl=a}}async doRefresh(){if(!this.attached)return;await this.layer.updateRenderer(),this.layerView.hasTilingEffects||this._updateSymbolizerParams(),this._updateBlockCacheRegistry(!0),this._fetchQueue.reset();const e=[];this._globalUpdateRequested=this.layerView.hasTilingEffects||!this.useProgressiveUpdate,this._tileStrategy.refresh((t=>e.push(this._enqueueTileFetch(t)))),await(0,a.eachAlways)(e)}constructor(){super(...arguments),this._emptyTilePixelBlock=null,this._tileStrategy=null,this._tileInfoView=null,this._fetchQueue=null,this._blockCacheRegistryUrl=null,this._blockCacheRegistryId=null,this._srcResolutions=[],this.previousLOD=null,this._needBlockCacheUpdate=!1,this._globalSymbolizerParams=null,this._symbolizerParams=null,this._abortController=null,this._isCustomTilingScheme=!1,this._maxIndexedColormapSize=0,this._rasterFunctionState="na",this._globalUpdateRequested=!1,this.attached=!1,this.timeExtent=null,this.redrawOrRefetch=(0,a.debounce)((async(e={})=>{if(!this.previousLOD||this.layerView.suspended)return;const t=this._rasterFunctionState;e.reprocess&&(await this.updatingHandles.addPromise(this.layer.updateRasterFunction()),this.updateRasterFunctionParameters());const r=this._rasterFunctionState,{type:i}=this;return e.refetch||"raster"!==i&&e.reprocess||"cpu"===r||"cpu"===t?this.updatingHandles.addPromise(this.doRefresh()):this.updatingHandles.addPromise(this._redrawImage(e.signal))}))}};(0,n._)([(0,l.property)()],S.prototype,"_fetchQueue",void 0),(0,n._)([(0,l.property)()],S.prototype,"_globalUpdateRequested",void 0),(0,n._)([(0,l.property)()],S.prototype,"attached",void 0),(0,n._)([(0,l.property)()],S.prototype,"container",void 0),(0,n._)([(0,l.property)()],S.prototype,"layer",void 0),(0,n._)([(0,l.property)()],S.prototype,"layerView",void 0),(0,n._)([(0,l.property)()],S.prototype,"type",void 0),(0,n._)([(0,l.property)()],S.prototype,"useWebGLForProcessing",null),(0,n._)([(0,l.property)()],S.prototype,"useProgressiveUpdate",null),(0,n._)([(0,l.property)()],S.prototype,"timeExtent",void 0),(0,n._)([(0,l.property)()],S.prototype,"updating",null),S=(0,n._)([(0,u.subclass)("esri.views.2d.layers.imagery.BaseImageryTileSubView2D")],S)})),t.register("4IP7o",(function(r,i){e(r.exports,"getRasterId",(function(){return u})),e(r.exports,"register",(function(){return c})),e(r.exports,"unregister",(function(){return h})),e(r.exports,"decreaseRefCount",(function(){return d})),e(r.exports,"getBlock",(function(){return f})),e(r.exports,"putBlock",(function(){return p})),e(r.exports,"deleteBlock",(function(){return m})),e(r.exports,"update",(function(){return g})),t("2ILM8");var n=t("kynKe"),s=t("jxAFe"),o=t("d1Fqh");const a=new Map,l=new(0,n.default);function u(e,t){return null==t?e:`${e}?sliceId=${t}`}function c(e,t){const r={extent:null,rasterInfo:t,cache:new Map},i=a.get(e);return i?(i.push(r),i.length-1):(a.set(e,[r]),0)}function h(e,t){const r=a.get(e);r&&(r[t]=null,r.some((e=>null!=e))||a.delete(e))}function d(e,t,r){var i;const n=a.get(e);if(!n)return null==t?l.decreaseRefCount(e,r):0;if(null==t||null==n[t])return l.decreaseRefCount(e,r);const s=null===(i=n[t])||void 0===i?void 0:i.cache,o=null==s?void 0:s.get(r);if(s&&o){if(o.refCount--,0===o.refCount){var u;s.delete(r);for(let e=0;e<n.length;e++)null===(u=n[e])||void 0===u||u.cache.delete(r);o.controller&&o.controller.abort()}return o.refCount}return 0}function f(e,t,r){var i;const n=a.get(e);if(!n)return null==t?l.getBlock(e,r):null;if(null==t||null==n[t]){for(let e=0;e<n.length;e++){var s;const t=null===(s=n[e])||void 0===s?void 0:s.cache.get(r);if(t)return t.refCount++,t.block}return l.getBlock(e,r)}const o=null===(i=n[t])||void 0===i?void 0:i.cache.get(r);if(o)return o.refCount++,o.block;for(let e=0;e<n.length;e++){var u;if(e===t||!n[e])continue;const i=null===(u=n[e])||void 0===u?void 0:u.cache,s=null==i?void 0:i.get(r);if(i&&s)return s.refCount++,i.set(r,s),s.block}return null}function p(e,t,r,i,n=null){var s;const o=a.get(e);if(!o)return void(null==t&&l.putBlock(e,r,i,n));if(null==t||null==o[t])return void l.putBlock(e,r,i,n);const u={refCount:1,block:i,isResolved:!1,isRejected:!1,controller:n};i.then((()=>u.isResolved=!0)).catch((()=>u.isRejected=!0)),null===(s=o[t])||void 0===s||s.cache.set(r,u)}function m(e,t,r){var i;const n=a.get(e);n?null!=t&&null!=n[t]?null===(i=n[t])||void 0===i||i.cache.delete(r):l.deleteBlock(e,r):null==t&&l.deleteBlock(e,r)}function g(e,t,r,i,n,l,u=null){const c=function(e,t){const r=a.get(e);var i;return r&&null!==(i=r[t])&&void 0!==i?i:null}(e,t);if(!c)return;const h=c.extent,{cache:d,rasterInfo:f}=c;if(h&&h.xmin===r.xmin&&h.xmax===r.xmax&&h.ymin===r.ymin&&h.ymax===r.ymax)return;i=null!=i?i:0;const p=r.clone().normalize(),{spatialReference:m,transform:g}=f,v=new Set;for(let e=0;e<p.length;e++){const t=p[e];if(t.xmax-t.xmin<=i||t.ymax-t.ymin<=i)continue;let r=(0,s.projectExtent)(t,m,u);null!=g&&(r=g.inverseTransform(r));const a=new(0,o.default)({x:i,y:i,spatialReference:t.spatialReference});if(null==n&&!(n=(0,s.projectResolution)(a,m,t,u)))return;const{pyramidLevel:c,pyramidResolution:h,excessiveReading:d}=(0,s.snapPyramid)(n,f,l||"closest");if(d)return;const{storageInfo:y}=f,{origin:x}=y,_={x:Math.max(0,Math.floor((r.xmin-x.x)/h.x)),y:Math.max(0,Math.floor((x.y-r.ymax)/h.y))},T=Math.ceil((r.xmax-r.xmin)/h.x-.1),b=Math.ceil((r.ymax-r.ymin)/h.y-.1),S=c>0?y.pyramidBlockWidth:y.blockWidth,w=c>0?y.pyramidBlockHeight:y.blockHeight,I=1,R=Math.max(0,Math.floor(_.x/S)-I),P=Math.max(0,Math.floor(_.y/w)-I),L=Math.floor((_.x+T-1)/S)+I,C=Math.floor((_.y+b-1)/w)+I;for(let e=P;e<=C;e++)for(let t=R;t<=L;t++)v.add(`${c}/${e}/${t}`)}d.forEach(((e,t)=>{if(!v.has(t)){const e=d.get(t);(null==e||e.isResolved||e.isRejected)&&d.delete(t)}})),c.extent={xmin:r.xmin,ymin:r.ymin,xmax:r.xmax,ymax:r.ymax}}})),t.register("kynKe",(function(t,r){e(t.exports,"default",(function(){return i}));class i{decreaseRefCount(e,t){const r=e+"/"+t,i=this._cachedBlocks;if(i.has(r)){const e=i.get(r);return e.refCount--,e.refCount<=0&&(i.delete(r),e.controller&&e.controller.abort()),e.refCount}return 0}getBlock(e,t){const r=e+"/"+t,i=this._cachedBlocks;if(i.has(r)){const e=i.get(r);return e.ts=Date.now(),e.refCount++,i.delete(r),i.set(r,e),e.block}return null}putBlock(e,t,r,i){const n=this._cachedBlocks,s=e+"/"+t;if(n.has(s)){const e=n.get(s);e.ts=Date.now(),e.refCount++}else n.set(s,{block:r,ts:Date.now(),refCount:1,controller:i});this._trim(),this._updateTimer()}deleteBlock(e,t){const r=this._cachedBlocks,i=e+"/"+t;r.has(i)&&r.delete(i)}updateMaxSize(e){this._size=e,this._trim()}empty(){this._cachedBlocks.clear(),this._clearTimer()}getCurrentSize(){return this._cachedBlocks.size}_updateTimer(){if(null!=this._timer)return;const e=this._cachedBlocks;this._timer=setInterval((()=>{const t=Array.from(e),r=Date.now();for(let i=0;i<t.length&&t[i][1].ts<=r-this._duration;i++)e.delete(t[i][0]);0===e.size&&this._clearTimer()}),this._interval)}_trim(){const e=this._cachedBlocks;if(-1===this._size||this._size>=e.size)return;const t=Array.from(e);for(let r=0;r<t.length-this._size;r++)e.delete(t[r][0])}_clearTimer(){null!=this._timer&&(clearInterval(this._timer),this._timer=null)}constructor(e=15e3,t=5e3){this._timer=null,this._cachedBlocks=new Map,this._size=-1,this._duration=e,this._interval=Math.min(e,t)}}})),t.register("fegDl",(function(t,r){function i(e,t){const{attributeTable:r,bandCount:i}=e;return!(null!=r||(n=e,!["u8","s8"].includes(n.pixelType)||null==(null===(s=n.statistics)||void 0===s||null===(o=s[0])||void 0===o?void 0:o.min)||null==(null===(a=n.statistics[0])||void 0===a?void 0:a.max)||1!==n.bandCount))||!(null==r||i>1)&&(!t||null!=r.fields.find((e=>e.name.toLowerCase()===t.toLowerCase())));var n,s,o,a}function n(e){const{bandCount:t,dataType:r,pixelType:i}=e;return"elevation"===r||"generic"===r&&1===t&&("s16"===i||"s32"===i||"f32"===i||"f64"===i)}function s(e,t=!1){const{bandCount:r,colormap:i,pixelType:n}=e;return 1===r&&(!!(null==i?void 0:i.length)||!t&&"u8"===n)}function o(e,t=!1){const{attributeTable:r,bandCount:i}=e;return 1===i&&(!t||null!=r||null!=e.histograms)}function a(e){const{dataType:t}=e;return"vector-uv"===t||"vector-magdir"===t}function l(e){const{dataType:t}=e;return"vector-uv"===t||"vector-magdir"===t}e(t.exports,"isUVRendererSupported",(function(){return i})),e(t.exports,"isShadedReliefRendererSupported",(function(){return n})),e(t.exports,"isColormapRendererSupported",(function(){return s})),e(t.exports,"isClassBreaksSupported",(function(){return o})),e(t.exports,"isVectorFieldRendererSupported",(function(){return a})),e(t.exports,"isFlowRendererSupported",(function(){return l}))})),t.register("9M3e1",(function(r,i){e(r.exports,"toJSONGeometryType",(function(){return s})),e(r.exports,"canUseMajorityInterpolationOnDataSource",(function(){return o}));const n=new(0,t("79ASa").JSONMap)({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});function s(e){return n.toJSON(e)}function o(e){const{bandCount:t,attributeTable:r,colormap:i,pixelType:n}=e.raster.rasterInfo;return 1===t&&(null!=r||null!=i||"u8"===n||"s8"===n)}})),t.register("cvwLd",(function(r,i){e(r.exports,"default",(function(){return d}));var n=t("7eJjO"),s=t("lKPaD"),o=t("iho5X");t("iJAIC"),t("lNwWH"),t("2VlWd");var a=t("fcwIv"),l=t("2hwKJ"),u=t("92Lzu"),c=t("5QZs5");let h=class extends c.BaseImageryTileSubView2D{canUseWebGLForProcessing(){return!1}async fetchTile(e,t){t={...t,interpolation:"nearest",requestProjectedLocalDirections:!0};const r=await this.layer.fetchTile(e.level,e.row,e.col,t);return"vector-magdir"===this.layer.rasterInfo.dataType&&(null==r?void 0:r.pixelBlock)&&(r.pixelBlock=await this.layer.convertVectorFieldData(r.pixelBlock,t)),r}updateTileSource(e,t){const r=t.symbolizerParams,{tileData:i}=e;i.key=e.key,i.width=this._tileInfoView.tileInfo.size[0],i.height=this._tileInfoView.tileInfo.size[1];const{symbolTileSize:n}=r,{source:s}=t;if(i.offset=this._getTileSymbolOffset(i.key,n),null!=s&&null!=s.pixelBlock){const e={extent:s.extent,pixelBlock:s.pixelBlock};i.rawPixelData=e,i.symbolizerParameters=r,i.source=this._sampleVectorFieldData(s.pixelBlock,r,i.offset)}else{const e=[Math.round((this._tileInfoView.tileInfo.size[0]-i.offset[0])/n),Math.round((this._tileInfoView.tileInfo.size[1]-i.offset[1])/n)],t=this.createEmptyTilePixelBlock(e);i.source=t,i.symbolizerParameters=r}return i.invalidateVAO(),Promise.resolve()}updateTileSymbolizerParameters(e,t){var r;const i=t.local,{symbolTileSize:n}=i,{tileData:s}=e;s.offset=this._getTileSymbolOffset(s.key,n);const o=s.symbolizerParameters.symbolTileSize;s.symbolizerParameters=i;const a=null===(r=s.rawPixelData)||void 0===r?void 0:r.pixelBlock;return null!=a&&o!==n&&(s.source=this._sampleVectorFieldData(a,s.symbolizerParameters,s.offset)),Promise.resolve()}attach(){super.attach(),this.container=new(0,u.RasterVFTileContainer)(this._tileInfoView),this.container.isCustomTilingScheme=this._isCustomTilingScheme,this._updateSymbolType(this.layer.renderer),this._handle=(0,s.watch)((()=>this.layer.renderer),(e=>this._updateSymbolType(e)))}detach(){var e;super.detach(),this.container.removeAllChildren(),null===(e=this._handle)||void 0===e||e.remove(),this._handle=null,this.container=null}_getTileSymbolOffset(e,t){const r=e.col*this._tileInfoView.tileInfo.size[0]%t,i=e.row*this._tileInfoView.tileInfo.size[1]%t;return[r>t/2?t-r:-r,i>t/2?t-i:-i]}_sampleVectorFieldData(e,t,r){const{symbolTileSize:i}=t;return(0,l.sampleVectorField)(e,"vector-uv",i,r)}_updateSymbolType(e){"vector-field"===e.type&&(this.container.symbolTypes="wind-barb"===e.style?["scalar","triangle"]:"simple-scalar"===e.style?["scalar"]:["triangle"])}constructor(){super(...arguments),this._handle=null,this.type="rasterVF"}};(0,n._)([(0,o.property)()],h.prototype,"container",void 0),(0,n._)([(0,o.property)()],h.prototype,"layer",void 0),(0,n._)([(0,o.property)()],h.prototype,"type",void 0),h=(0,n._)([(0,a.subclass)("esri.views.2d.layers.imagery.VectorFieldTileView2D")],h);const d=h})),t.register("92Lzu",(function(r,i){e(r.exports,"RasterVFTileContainer",(function(){return u}));var n=t("8TwEW"),s=t("lysbb"),o=t("4KFRm"),a=t("66IJZ"),l=t("3v0eQ");class u extends l.default{createTile(e){const t=this._tileInfoView.getTileBounds((0,n.create)(),e),[r,i]=this._tileInfoView.tileInfo.size,s=this._tileInfoView.getTileResolution(e.level);return new(0,o.RasterVFTile)(e,s,t[0],t[3],r,i)}prepareRenderPasses(e){const t=e.registerRenderPass({name:"imagery (vf tile)",brushes:[s.default],target:()=>this.children.map((e=>e.tileData)),drawPhase:a.WGLDrawPhase.MAP});return[...super.prepareRenderPasses(e),t]}doRender(e){this.visible&&e.drawPhase===a.WGLDrawPhase.MAP&&this.symbolTypes.forEach((t=>{e.renderPass=t,super.doRender(e)}))}constructor(){super(...arguments),this.isCustomTilingScheme=!1,this.symbolTypes=["triangle"]}}})),t.register("4KFRm",(function(r,i){e(r.exports,"RasterVFTile",(function(){return l}));var n=t("j3x2p"),s=t("eYrMi"),o=t("9q7kD"),a=t("8eM7H");class l extends a.TiledDisplayObject{destroy(){super.destroy(),this.tileData.destroy(),this.tileData=null,this.stage=null}set stencilRef(e){this.tileData.stencilRef=e}get stencilRef(){return this.tileData.stencilRef}_createTransforms(){return{dvs:(0,s.c)(),tileMat3:(0,s.c)()}}setTransform(e){super.setTransform(e);const t=this.resolution/(e.resolution*e.pixelRatio),r=this.transforms.tileMat3,[i,s]=this.tileData.offset,o=[this.x+i*this.resolution,this.y-s*this.resolution],[a,l]=e.toScreenNoRotation([0,0],o),{symbolTileSize:u}=this.tileData.symbolizerParameters,c=Math.round((this.width-this.tileData.offset[0])/u)*u,h=Math.round((this.height-this.tileData.offset[1])/u)*u,d=c/this.rangeX*t,f=h/this.rangeY*t;(0,n.s)(r,d,0,0,0,f,0,a,l,1),(0,n.m)(this.transforms.dvs,e.displayViewMat3,r),this.tileData.transforms.dvs=this.transforms.dvs}onAttach(){this.tileData.stage=this.stage}onDetach(){this.tileData.stage=null}constructor(e,t,r,i,n,s,a=null){super(e,t,r,i,n,s),this.tileData=new(0,o.RasterVFDisplayObject)(a),this.tileData.coordScale=[n,s],this.tileData.once("isReady",(()=>this.ready()))}}})),t.register("afdWM",(function(r,i){e(r.exports,"default",(function(){return d}));var n=t("7eJjO"),s=t("bsvXr"),o=t("kyj08"),a=t("iho5X");t("iJAIC"),t("lNwWH"),t("2VlWd");var l=t("fcwIv"),u=t("gRgX5"),c=t("jxAFe"),h=t("dB39e");const d=e=>{let t=class extends e{get fullExtent(){return this._getfullExtent()}_getfullExtent(){return this.projectFullExtent(this.view.spatialReference)}get hasTilingEffects(){return!!(this.layer.renderer&&"dynamicRangeAdjustment"in this.layer.renderer&&this.layer.renderer.dynamicRangeAdjustment)}get datumTransformation(){return(0,c.getDefaultDatumTransformationForDataset)(this.layer.fullExtent,this.view.spatialReference,!0)}supportsSpatialReference(e){return!!this.projectFullExtent(e)}projectFullExtent(e){const t=this.layer.fullExtent,r=(0,c.getDefaultDatumTransformationForDataset)(t,e,!1);return(0,c.projectExtent)(t,e,r)}async fetchPopupFeatures(e,t){const{layer:r}=this;if(!e)throw new(0,o.default)("imageryTileLayerView:fetchPopupFeatures","Nothing to fetch without area",{layer:r});const{popupEnabled:i}=r,n=(0,h.getFetchPopupTemplate)(r,t);if(!i||null==n)throw new(0,o.default)("imageryTileLayerView:fetchPopupFeatures","Missing required popupTemplate or popupEnabled",{popupEnabled:i,popupTemplate:n});const a=[],{value:l,magdirValue:u,processedValue:c}=await r.identify(e,{timeExtent:this.timeExtent});let d="";if(l&&l.length){d="imagery-tile"===r.type&&r.hasStandardTime()&&null!=l[0]?l.map((e=>r.getStandardTimeValue(e))).join(", "):l.join(", ");const e={ObjectId:0},t="Raster.ServicePixelValue";var f;e[t]=null!==(f=null==c?void 0:c.join(", "))&&void 0!==f?f:d,e[t+".Raw"]=d;const i=r.rasterInfo.attributeTable;if(null!=i){const{fields:t,features:r}=i,n=t.find((({name:e})=>"value"===e.toLowerCase())),s=n?r.find((e=>String(e.attributes[n.name])===d)):null;if(s)for(const t in s.attributes)s.attributes.hasOwnProperty(t)&&(e[this._rasterFieldPrefix+t]=s.attributes[t])}const n=r.rasterInfo.dataType;"vector-magdir"!==n&&"vector-uv"!==n||(e["Raster.Magnitude"]=null==u?void 0:u[0],e["Raster.Direction"]=null==u?void 0:u[1]);const o=new(0,s.default)(this.fullExtent.clone(),null,e);o.layer=r,o.sourceLayer=o.layer,a.push(o)}return a}constructor(){super(...arguments),this._rasterFieldPrefix="Raster.",this.layer=null,this.view=null,this.tileInfo=null}};return(0,n._)([(0,a.property)()],t.prototype,"layer",void 0),(0,n._)([(0,a.property)(u.combinedViewLayerTimeExtentProperty)],t.prototype,"timeExtent",void 0),(0,n._)([(0,a.property)()],t.prototype,"view",void 0),(0,n._)([(0,a.property)()],t.prototype,"fullExtent",null),(0,n._)([(0,a.property)()],t.prototype,"tileInfo",void 0),(0,n._)([(0,a.property)({readOnly:!0})],t.prototype,"hasTilingEffects",null),(0,n._)([(0,a.property)()],t.prototype,"datumTransformation",null),t=(0,n._)([(0,l.subclass)("esri.views.layers.ImageryTileLayerView")],t),t}})),t.register("dB39e",(function(r,i){e(r.exports,"getRequiredFields",(function(){return s})),e(r.exports,"getFetchPopupTemplate",(function(){return o}));var n=t("7vTUY");async function s(e,t=e.popupTemplate){var r,i;if(null==t)return[];const s=await t.getRequiredFields(e.fieldsIndex),{lastEditInfoEnabled:o}=t,{objectIdField:a,typeIdField:l,globalIdField:u,relationships:c}=e;if(s.includes("*"))return["*"];const h=o?await(0,n.getFeatureEditFields)(e):[],d=(0,n.fixFields)(e.fieldsIndex,[...s,...h]);return l&&d.push(l),d&&a&&(null===(r=e.fieldsIndex)||void 0===r?void 0:r.has(a))&&!d.includes(a)&&d.push(a),d&&u&&(null===(i=e.fieldsIndex)||void 0===i?void 0:i.has(u))&&!d.includes(u)&&d.push(u),c&&c.forEach((t=>{var r;const{keyField:i}=t;d&&i&&(null===(r=e.fieldsIndex)||void 0===r?void 0:r.has(i))&&!d.includes(i)&&d.push(i)})),d}function o(e,t){return e.popupTemplate?e.popupTemplate:null!=t&&t.defaultPopupTemplateEnabled&&null!=e.defaultPopupTemplate?e.defaultPopupTemplate:null}})),t.register("hfthk",(function(r,i){e(r.exports,"default",(function(){return c}));var n=t("7eJjO"),s=t("jHOLN"),o=t("10vEZ"),a=t("lKPaD"),l=t("iho5X");t("iJAIC"),t("lNwWH"),t("2VlWd");var u=t("fcwIv");const c=e=>{let t=class extends e{initialize(){this.handles.add((0,a.on)((()=>this.layer),"refresh",(e=>{this.doRefresh(e.dataChanged).catch((e=>{(0,o.isAbortError)(e)||s.default.getLogger(this).error(e)}))})),"RefreshableLayerView")}};return(0,n._)([(0,l.property)()],t.prototype,"layer",void 0),t=(0,n._)([(0,u.subclass)("esri.layers.mixins.RefreshableLayerView")],t),t}})),t.register("5WctK",(function(r,i){e(r.exports,"getStrides",(function(){return L})),e(r.exports,"strideToPackingFactor",(function(){return G})),e(r.exports,"allocateTypedArrayBuffer",(function(){return F})),e(r.exports,"allocateTypedArrayBufferwithData",(function(){return O})),e(r.exports,"isDefined",(function(){return D})),e(r.exports,"isNumber",(function(){return z})),e(r.exports,"getCapType",(function(){return B})),e(r.exports,"getJoinType",(function(){return N})),e(r.exports,"getVVType",(function(){return W})),e(r.exports,"copyMeshData",(function(){return k})),e(r.exports,"C_VBO_INFO",(function(){return H})),e(r.exports,"createGeometryData",(function(){return j})),e(r.exports,"getPixelBytes",(function(){return q})),e(r.exports,"getPixelArrayCtor",(function(){return X})),e(r.exports,"createProgramDescriptor",(function(){return Q})),e(r.exports,"forEachGeometryType",(function(){return $})),e(r.exports,"isSVGResource",(function(){return ee})),e(r.exports,"isImageResource",(function(){return te})),e(r.exports,"getUrl",(function(){return re})),e(r.exports,"isGIF",(function(){return ne})),e(r.exports,"isPNG",(function(){return oe})),e(r.exports,"is3D",(function(){return ae})),e(r.exports,"isSimple",(function(){return le})),e(r.exports,"isSVGImage",(function(){return ue})),e(r.exports,"shouldRepeat",(function(){return ce})),e(r.exports,"isMarkerPlacementInsidePolygon",(function(){return pe})),e(r.exports,"getPMSResourceSize",(function(){return he})),e(r.exports,"charCodes",(function(){return de}));var n=t("kyj08"),s=t("jHOLN"),o=t("6LoaD"),a=t("66IJZ"),l=t("8JzMA"),u=t("LW1Aq");const c=s.default.getLogger("esri.views.2d.engine.webgl.Utils"),h="geometry",d=[{name:h,strideInBytes:12}],f=[{name:h,strideInBytes:36}],p=[{name:h,strideInBytes:24}],m=[{name:h,strideInBytes:12}],g=[{name:h,strideInBytes:40}],v=[{name:h,strideInBytes:36}],y=[{name:h,strideInBytes:36}];function x(e){const t={};for(const r of e)t[r.name]=r.strideInBytes;return t}const _=x([{name:h,strideInBytes:36}]),T=x(d),b=x(f),S=x(p),w=x(m),I=x(g),R=x(v),P=x(y);function L(e,t){switch(e){case a.WGLGeometryType.MARKER:return t===a.WGLSymbologyType.HEATMAP?T:_;case a.WGLGeometryType.FILL:switch(t){case a.WGLSymbologyType.DOT_DENSITY:return w;case a.WGLSymbologyType.SIMPLE:case a.WGLSymbologyType.OUTLINE_FILL_SIMPLE:return S;default:return b}case a.WGLGeometryType.LINE:return I;case a.WGLGeometryType.TEXT:return R;case a.WGLGeometryType.LABEL:return P}}const C=[h],E=[h],M=[h],U=[h],V=[h];function A(e){switch(e){case a.WGLGeometryType.MARKER:return C;case a.WGLGeometryType.FILL:return E;case a.WGLGeometryType.LINE:return M;case a.WGLGeometryType.TEXT:return U;case a.WGLGeometryType.LABEL:return V}}function G(e){switch(e%4){case 0:case 2:return 4;case 1:case 3:return 1}}function F(e,t){switch(t%4){case 0:case 2:return new Uint32Array(Math.floor(e*t/4));case 1:case 3:return new Uint8Array(e*t)}}function O(e,t){switch(t%4){case 0:case 2:return new Uint32Array(e);case 1:case 3:return new Uint8Array(e)}}function D(e){return null!=e}function z(e){return"number"==typeof e}function B(e){switch(e){case"butt":return o.CapType.BUTT;case"round":return o.CapType.ROUND;case"square":return o.CapType.SQUARE;default:return c.error(new(0,n.default)("mapview-invalid-type",`Cap type ${e} is not a valid option. Defaulting to round`)),o.CapType.ROUND}}function N(e){switch(e){case"miter":return o.JoinType.MITER;case"bevel":return o.JoinType.BEVEL;case"round":return o.JoinType.ROUND;default:return c.error(new(0,n.default)("mapview-invalid-type",`Join type ${e} is not a valid option. Defaulting to round`)),o.JoinType.ROUND}}function W(e){switch(e){case"opacity":return a.VVType.OPACITY;case"color":return a.VVType.COLOR;case"rotation":return a.VVType.ROTATION;case"size":return a.VVType.SIZE;default:return c.error(`Cannot interpret unknown vv: ${e}`),null}}function k(e,t,r,i,n,s,o){for(const t in s){const i=s[t].stride,o=G(i),a=s[t].data,l=r[t].data;if(null==a||null==l)continue;const u=i*n.vertexCount/o,c=i*e/o,h=i*n.vertexFrom/o;for(let e=0;e<u;++e)l[e+c]=a[e+h]}if(null!=o&&null!=i){const r=n.indexCount;for(let s=0;s<r;++s)i[s+t]=o[s+n.indexFrom]-n.vertexFrom+e}}const H={[h]:l.Usage.STATIC_DRAW};function j(e,t){const r=[];for(let i=0;i<5;++i){const n=A(i),s={};for(const e of n)s[e]={data:t(i,e)};r.push({data:e(i),buffers:s})}return r}function Z(e){switch(e){case l.DataType.BYTE:case l.DataType.UNSIGNED_BYTE:return 1;case l.DataType.SHORT:case l.DataType.UNSIGNED_SHORT:return 2;case l.DataType.FLOAT:case l.DataType.INT:case l.DataType.UNSIGNED_INT:return 4}}function q(e){switch(e){case l.PixelType.UNSIGNED_BYTE:return 1;case l.PixelType.UNSIGNED_SHORT_4_4_4_4:return 2;case l.PixelType.FLOAT:return 4;default:return void c.error(new(0,n.default)("webgl-utils",`Unable to handle type ${e}`))}}function X(e){switch(e){case l.PixelType.UNSIGNED_BYTE:return Uint8Array;case l.PixelType.UNSIGNED_SHORT_4_4_4_4:return Uint16Array;case l.PixelType.FLOAT:return Float32Array;default:return void c.error(new(0,n.default)("webgl-utils",`Unable to handle type ${e}`))}}const J=e=>{const t=new Map;for(const r in e)for(const i of e[r])t.set(i.name,i.location);return t},Y=e=>{const t={};for(const r in e){const i=e[r];t[r]=(null==i?void 0:i.length)?i[0].stride:0}return t},K=new Map,Q=(e,t)=>{if(!K.has(e)){const r=function(e){const t={};for(const i in e){var r;const n=e[i];let s=0;t[i]=n.map((e=>{const t=new(0,u.VertexElementDescriptor)(e.name,e.count,e.type,s,0,e.normalized||!1);return s+=e.count*Z(e.type),t})),null===(r=t[i])||void 0===r||r.forEach((e=>e.stride=s))}return t}(t),i={strides:Y(r),bufferLayouts:r,attributes:J(t)};K.set(e,i)}return K.get(e)};function $(e){e(a.WGLGeometryType.FILL),e(a.WGLGeometryType.LINE),e(a.WGLGeometryType.MARKER),e(a.WGLGeometryType.TEXT),e(a.WGLGeometryType.LABEL)}const ee=e=>"path"in e&&fe(e.path),te=e=>"url"in e&&e.url||"imageData"in e&&e.imageData,re=e=>"imageData"in e&&e.imageData&&"contentType"in e&&e.contentType?`data:${e.contentType};base64,${e.imageData}`:"url"in e?e.url:null,ie=e=>null!=e&&e.startsWith("data:image/gif"),ne=e=>"url"in e&&e.url&&(e.url.includes(".gif")||ie(e.url))||"contentType"in e&&"image/gif"===e.contentType||"imageData"in e&&ie(e.imageData),se=e=>null!=e&&e.startsWith("data:image/png"),oe=e=>"url"in e&&e.url&&(e.url.includes(".png")||se(e.url))||"contentType"in e&&"image/png"===e.contentType||"imageData"in e&&se(e.imageData),ae=e=>e.type&&e.type.toLowerCase().includes("3d");function le(e){switch(e.type){case"line":{const t=e;return"CIMSolidStroke"===t.cim.type&&!t.dashTemplate}case"fill":return"CIMSolidFill"===e.cim.type;case"esriSFS":return"esriSFSSolid"===e.style||"esriSFSNull"===e.style;case"esriSLS":return"esriSLSSolid"===e.style||"esriSLSNull"===e.style;default:return!1}}const ue=e=>e.includes("data:image/svg+xml");function ce(e){switch("cim"in e?e.cim.type:e.type){case"esriSMS":case"esriPMS":case"CIMPointSymbol":return!1;case"CIMVectorMarker":case"CIMCharacterMarker":case"CIMPictureMarker":return pe(e);default:return!0}}function he(e){const t="maxVVSize"in e&&e.maxVVSize,r="width"in e&&e.width||"size"in e&&e.size||0;return t||r}function de(e){const t=[];for(let r=0;r<e.length;r++)t.push(e.charCodeAt(r));return t}const fe=e=>!!e&&(e=e.trim(),!!(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(e)&&/[\dz]$/i.test(e)&&e.length>4)),pe=e=>{var t,r;return"fill"===e.type&&"CIMMarkerPlacementInsidePolygon"===(null==e||null===(t=e.cim)||void 0===t||null===(r=t.markerPlacement)||void 0===r?void 0:r.type)}})),t.register("hUDEJ",(function(r,i){e(r.exports,"premultiplyAlpha",(function(){return s})),e(r.exports,"premultiplyAlphaRGBA",(function(){return o})),e(r.exports,"premultiplyAlphaRGBAArray",(function(){return a})),e(r.exports,"writeColor",(function(){return l}));var n=t("8lbQw");function s(e,t=0,r=!1){const i=e[t+3];return e[t]*=i,e[t+1]*=i,e[t+2]*=i,r||(e[t+3]*=255),e}function o(e){if(!e)return 0;const{r:t,g:r,b:i,a:s}=e;return(0,n.i8888to32)(t*s,r*s,i*s,255*s)}function a(e){if(!e)return 0;const[t,r,i,s]=e;return(0,n.i8888to32)(t*(s/255),r*(s/255),i*(s/255),s)}function l(e,t,r=0){if(null==t)return e[r]=0,e[r+1]=0,e[r+2]=0,void(e[r+3]=0);const{r:i,g:n,b:s,a:o}=t;e[r]=i*o/255,e[r+1]=n*o/255,e[r+2]=s*o/255,e[r+3]=o}})),t.register("8lbQw",(function(t,r){e(t.exports,"u32to4Xu8",(function(){return n})),e(t.exports,"i1616to32",(function(){return s})),e(t.exports,"i8888to32",(function(){return o}));const i=new Float32Array(1);new Uint32Array(i.buffer);function n(e){return[255&e,(65280&e)>>>8,(16711680&e)>>>16,(4278190080&e)>>>24]}function s(e,t){return 65535&e|t<<16}function o(e,t,r,i){return 255&e|(255&t)<<8|(255&r)<<16|i<<24}})),t.register("6S0qa",(function(t,r){var i,n,s;function o(e){switch(e){case"left":return i.Left;case"right":return i.Right;case"center":return i.Center}}function a(e){switch(e){case"top":return n.Top;case"middle":return n.Center;case"baseline":return n.Baseline;case"bottom":return n.Bottom}}function l(e){switch(e){case"above-left":case"esriServerPointLabelPlacementAboveLeft":return[i.Right,n.Bottom];case"above-center":case"above-along":case"esriServerPointLabelPlacementAboveCenter":case"esriServerLinePlacementAboveAlong":return[i.Center,n.Bottom];case"above-right":case"esriServerPointLabelPlacementAboveRight":return[i.Left,n.Bottom];case"center-left":case"esriServerPointLabelPlacementCenterLeft":return[i.Right,n.Center];case"center-center":case"center-along":case"esriServerPointLabelPlacementCenterCenter":case"esriServerLinePlacementCenterAlong":case"always-horizontal":case"esriServerPolygonPlacementAlwaysHorizontal":return[i.Center,n.Center];case"center-right":case"esriServerPointLabelPlacementCenterRight":return[i.Left,n.Center];case"below-left":case"esriServerPointLabelPlacementBelowLeft":return[i.Right,n.Top];case"below-center":case"below-along":case"esriServerPointLabelPlacementBelowCenter":case"esriServerLinePlacementBelowAlong":return[i.Center,n.Top];case"below-right":case"esriServerPointLabelPlacementBelowRight":return[i.Left,n.Top];default:return console.debug(`Found invalid placement type ${e}`),[i.Center,n.Center]}}function u(e){switch(e){case i.Right:return-1;case i.Center:return 0;case i.Left:return 1;default:return console.debug(`Found invalid horizontal alignment ${e}`),0}}function c(e){switch(e){case n.Top:return 1;case n.Center:return 0;case n.Bottom:case n.Baseline:return-1;default:return console.debug(`Found invalid vertical alignment ${e}`),0}}function h(e){switch(e){case"left":return i.Left;case"right":return i.Right;case"center":return i.Center}}function d(e){switch(e){case"above-along":case"below-along":case"center-along":case"esriServerLinePlacementAboveAlong":case"esriServerLinePlacementBelowAlong":case"esriServerLinePlacementCenterAlong":return!0;default:return!1}}e(t.exports,"HAlign",(function(){return i})),e(t.exports,"VAlign",(function(){return n})),e(t.exports,"getXAnchorDirection",(function(){return o})),e(t.exports,"getYAnchorDirection",(function(){return a})),e(t.exports,"getAlignmentFromPlacement",(function(){return l})),e(t.exports,"getXDirection",(function(){return u})),e(t.exports,"getYDirection",(function(){return c})),e(t.exports,"getJustification",(function(){return h})),e(t.exports,"isMapAligned",(function(){return d})),(s=i||(i={}))[s.Left=-1]="Left",s[s.Center=0]="Center",s[s.Right=1]="Right",function(e){e[e.Top=1]="Top",e[e.Center=0]="Center",e[e.Bottom=-1]="Bottom",e[e.Baseline=2]="Baseline"}(n||(n={}))})),t.register("ktHf8",(function(r,i){e(r.exports,"isOutlineFillSymbology",(function(){return l})),e(r.exports,"hasSimpleSymbology",(function(){return u})),e(r.exports,"hasOutlineFillSymbology",(function(){return c})),e(r.exports,"createMaterialKey",(function(){return h})),e(r.exports,"FillMaterialKey",(function(){return y})),e(r.exports,"LineMaterialKey",(function(){return _})),e(r.exports,"MarkerMaterialKey",(function(){return x})),e(r.exports,"TextMaterialKey",(function(){return T})),e(r.exports,"LabelMaterialKey",(function(){return b})),e(r.exports,"hydrateMaterialKey",(function(){return d})),e(r.exports,"MaterialKeyBase",(function(){return f}));var n=t("kyj08"),s=t("6S0qa"),o=t("66IJZ");const a=Object.keys(o.WGLSymbologyType).filter((e=>"number"==typeof o.WGLSymbologyType[e])).reduce(((e,t)=>({...e,[t]:o.WGLSymbologyType[t]})),{});function l(e){return e===o.WGLSymbologyType.OUTLINE_FILL||e===o.WGLSymbologyType.OUTLINE_FILL_SIMPLE}function u(e){return function(e){return e===o.WGLSymbologyType.SIMPLE||e===o.WGLSymbologyType.OUTLINE_FILL_SIMPLE}(e.symbologyType)}function c(e){return l(e.symbologyType)}function h(e,t){switch(e){case o.WGLGeometryType.FILL:return y.from(t);case o.WGLGeometryType.LINE:return _.from(t);case o.WGLGeometryType.MARKER:return x.from(t);case o.WGLGeometryType.TEXT:return T.from(t);case o.WGLGeometryType.LABEL:return b.from(t);default:throw new Error(`Unable to createMaterialKey for unknown geometryType ${e}`)}}function d(e){switch(f.load(e).geometryType){case o.WGLGeometryType.MARKER:return new x(e);case o.WGLGeometryType.FILL:return new y(e);case o.WGLGeometryType.LINE:return new _(e);case o.WGLGeometryType.TEXT:return new T(e);case o.WGLGeometryType.LABEL:return new b(e)}}class f{static load(e){const t=this.shared;return t.data=e,t}set data(e){this._data=null!=e?e:0}get data(){return this._data}get geometryType(){return this.bits(8,11)}set geometryType(e){this.setBits(e,8,11)}get mapAligned(){return!!this.bit(20)}set mapAligned(e){this.setBit(20,e)}get sdf(){return!!this.bit(11)}set sdf(e){this.setBit(11,null!=e&&e)}get pattern(){return!!this.bit(12)}set pattern(e){this.setBit(12,e)}get textureBinding(){return this.bits(0,8)}set textureBinding(e){this.setBits(e,0,8)}get symbologyType(){return this.bits(21,26)}set symbologyType(e){this.setBits(e,21,26)}get geometryTypeString(){switch(this.geometryType){case o.WGLGeometryType.FILL:return"fill";case o.WGLGeometryType.MARKER:return"marker";case o.WGLGeometryType.LINE:return"line";case o.WGLGeometryType.TEXT:return"text";case o.WGLGeometryType.LABEL:return"label";default:throw new(0,n.default)(`Unable to handle unknown geometryType: ${this.geometryType}`)}}setBit(e,t){const r=1<<e;t?this._data|=r:this._data&=~r}bit(e){return(this._data&1<<e)>>e}setBits(e,t,r){for(let i=t,n=0;i<r;i++,n++)this.setBit(i,0!=(e&1<<n))}bits(e,t){let r=0;for(let i=e,n=0;i<t;i++,n++)r|=this.bit(i)<<n;return r}hasVV(){return!1}setVV(e,t){}getVariation(){return{mapAligned:this.mapAligned,pattern:this.pattern,sdf:this.sdf,symbologyType:{value:o.WGLSymbologyType[this.symbologyType],options:a,namespace:"SYMBOLOGY_TYPE"}}}getVariationHash(){return this._data&~(7&this.textureBinding)}constructor(e){this._data=0,this._data=e}}f.shared=new f(0);const p=e=>class extends e{get vvSizeMinMaxValue(){return 0!==this.bit(16)}set vvSizeMinMaxValue(e){this.setBit(16,e)}get vvSizeScaleStops(){return 0!==this.bit(17)}set vvSizeScaleStops(e){this.setBit(17,e)}get vvSizeFieldStops(){return 0!==this.bit(18)}set vvSizeFieldStops(e){this.setBit(18,e)}get vvSizeUnitValue(){return 0!==this.bit(19)}set vvSizeUnitValue(e){this.setBit(19,e)}hasSizeVV(){return this.vvSizeMinMaxValue||this.vvSizeScaleStops||this.vvSizeFieldStops||this.vvSizeUnitValue}hasVV(){return super.hasVV()||this.hasSizeVV()}setVV(e,t){super.setVV(e,t);const r=function(e,t,r){const i=o.WGLVVFlag.SIZE_FIELD_STOPS|o.WGLVVFlag.SIZE_MINMAX_VALUE|o.WGLVVFlag.SIZE_SCALE_STOPS|o.WGLVVFlag.SIZE_UNIT_VALUE,n=(t&(o.WGLVVTarget.FIELD_TARGETS_OUTLINE|o.WGLVVTarget.MINMAX_TARGETS_OUTLINE|o.WGLVVTarget.SCALE_TARGETS_OUTLINE|o.WGLVVTarget.UNIT_TARGETS_OUTLINE))>>>4;return e===o.WGLGeometryType.LINE&&r.isOutline||e===o.WGLGeometryType.FILL&&l(r.symbologyType)?i&n:i&~n}(this.geometryType,e,t)&e;this.vvSizeMinMaxValue=!!(r&o.WGLVVFlag.SIZE_MINMAX_VALUE),this.vvSizeFieldStops=!!(r&o.WGLVVFlag.SIZE_FIELD_STOPS),this.vvSizeUnitValue=!!(r&o.WGLVVFlag.SIZE_UNIT_VALUE),this.vvSizeScaleStops=!!(r&o.WGLVVFlag.SIZE_SCALE_STOPS)}},m=e=>class extends e{get vvRotation(){return 0!==this.bit(15)}set vvRotation(e){this.setBit(15,e)}hasVV(){return super.hasVV()||this.vvRotation}setVV(e,t){super.setVV(e,t),this.vvRotation=!t.isOutline&&!!(e&o.WGLVVFlag.ROTATION)}},g=e=>class extends e{get vvColor(){return 0!==this.bit(13)}set vvColor(e){this.setBit(13,e)}hasVV(){return super.hasVV()||this.vvColor}setVV(e,t){super.setVV(e,t),this.vvColor=!t.isOutline&&!!(e&o.WGLVVFlag.COLOR)}},v=e=>class extends e{get vvOpacity(){return 0!==this.bit(14)}set vvOpacity(e){this.setBit(14,e)}hasVV(){return super.hasVV()||this.vvOpacity}setVV(e,t){super.setVV(e,t),this.vvOpacity=!t.isOutline&&!!(e&o.WGLVVFlag.OPACITY)}};class y extends(g(v(p(f)))){static load(e){const t=this.shared;return t.data=e,t}static from(e){const{symbologyType:t,vvFlags:r}=e,i=this.load(0);return i.geometryType=o.WGLGeometryType.FILL,i.symbologyType=t,t!==o.WGLSymbologyType.DOT_DENSITY&&i.setVV(r,e),i.data}getVariation(){return{...super.getVariation(),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}}}y.shared=new y(0);class x extends(g(v(m(p(f))))){static load(e){const t=this.shared;return t.data=e,t}static from(e){const{symbologyType:t,vvFlags:r}=e,i=this.load(0);return i.geometryType=o.WGLGeometryType.MARKER,i.symbologyType=t,t!==o.WGLSymbologyType.HEATMAP&&i.setVV(r,e),i.data}getVariation(){return{...super.getVariation(),vvColor:this.vvColor,vvRotation:this.vvRotation,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}}}x.shared=new x(0);class _ extends(g(v(p(f)))){static load(e){const t=this.shared;return t.data=e,t}static from(e){const t=this.load(0);return t.geometryType=o.WGLGeometryType.LINE,t.symbologyType=e.symbologyType,t.setVV(e.vvFlags,e),t.data}getVariation(){return{...super.getVariation(),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}}}_.shared=new _(0);class T extends(g(v(m(p(f))))){static load(e){const t=this.shared;return t.data=e,t}static from(e){const t=this.load(0);return t.geometryType=o.WGLGeometryType.TEXT,t.symbologyType=e.symbologyType,t.setVV(e.vvFlags,e),t.data}getVariation(){return{...super.getVariation(),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvRotation:this.vvRotation,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}}}T.shared=new T(0);class b extends(p(f)){static load(e){const t=this.shared;return t.data=e,t}static from(e){const t=this.load(0);return t.geometryType=o.WGLGeometryType.LABEL,t.symbologyType=e.symbologyType,t.setVV(e.vvFlags,e),t.mapAligned=(0,s.isMapAligned)(e.placement),t.data}getVariation(){return{...super.getVariation(),vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}}}b.shared=new b(0)})),t.register("iTfMY",(function(t,r){e(t.exports,"degToByte",(function(){return s})),e(t.exports,"log2",(function(){return o}));Math.PI;const i=1/Math.LN2;function n(e,t){return(e%=t)>=0?e:e+t}function s(e){return n(.7111111111111111*e,256)}function o(e){return Math.log(e)*i}})),t.register("2ndsO",(function(r,i){e(r.exports,"e",(function(){return l}));var n,s,o=t("LvnzP"),a={exports:{}};n=a,void 0!==(s=function(){function e(e,r,n){n=n||2;var s,o,a,u,c,h,d,f=r&&r.length,p=f?r[0]*n:e.length,m=t(e,0,p,n,!0),g=[];if(!m||m.next===m.prev)return g;if(f&&(m=l(e,r,m,n)),e.length>80*n){s=a=e[0],o=u=e[1];for(var v=n;v<p;v+=n)(c=e[v])<s&&(s=c),(h=e[v+1])<o&&(o=h),c>a&&(a=c),h>u&&(u=h);d=0!==(d=Math.max(a-s,u-o))?1/d:0}return i(m,g,n,s,o,d),g}function t(e,t,r,i,n){var s,o;if(n===L(e,t,r,i)>0)for(s=t;s<r;s+=i)o=I(s,e[s],e[s+1],o);else for(s=r-i;s>=t;s-=i)o=I(s,e[s],e[s+1],o);if(o&&x(o,o.next)){var a=o.next;R(o),o=a}return o}function r(e,t){if(!e)return e;t||(t=e);var r,i=e;do{if(r=!1,i.steiner||!x(i,i.next)&&0!==y(i.prev,i,i.next))i=i.next;else{var n=i.prev;if(R(i),(i=t=n)===i.next)break;r=!0}}while(r||i!==t);return t}function i(e,t,l,u,c,h,d){if(e){!d&&h&&f(e,u,c,h);for(var p,m,g=e;e.prev!==e.next;)if(p=e.prev,m=e.next,h?s(e,u,c,h):n(e))t.push(p.i/l),t.push(e.i/l),t.push(m.i/l),R(e),e=m.next,g=m.next;else if((e=m)===g){d?1===d?i(e=o(r(e),t,l),t,l,u,c,h,2):2===d&&a(e,t,l,u,c,h):i(r(e),t,l,u,c,h,1);break}}}function n(e){var t=e.prev,r=e,i=e.next;if(y(t,r,i)>=0)return!1;for(var n=e.next.next;n!==e.prev;){if(g(t.x,t.y,r.x,r.y,i.x,i.y,n.x,n.y)&&y(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function s(e,t,r,i){var n=e.prev,s=e,o=e.next;if(y(n,s,o)>=0)return!1;for(var a=n.x<s.x?n.x<o.x?n.x:o.x:s.x<o.x?s.x:o.x,l=n.y<s.y?n.y<o.y?n.y:o.y:s.y<o.y?s.y:o.y,u=n.x>s.x?n.x>o.x?n.x:o.x:s.x>o.x?s.x:o.x,c=n.y>s.y?n.y>o.y?n.y:o.y:s.y>o.y?s.y:o.y,h=p(a,l,t,r,i),d=p(u,c,t,r,i),f=e.prevZ,m=e.nextZ;f&&f.z>=h&&m&&m.z<=d;){if(f!==e.prev&&f!==e.next&&g(n.x,n.y,s.x,s.y,o.x,o.y,f.x,f.y)&&y(f.prev,f,f.next)>=0)return!1;if(f=f.prevZ,m!==e.prev&&m!==e.next&&g(n.x,n.y,s.x,s.y,o.x,o.y,m.x,m.y)&&y(m.prev,m,m.next)>=0)return!1;m=m.nextZ}for(;f&&f.z>=h;){if(f!==e.prev&&f!==e.next&&g(n.x,n.y,s.x,s.y,o.x,o.y,f.x,f.y)&&y(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;m&&m.z<=d;){if(m!==e.prev&&m!==e.next&&g(n.x,n.y,s.x,s.y,o.x,o.y,m.x,m.y)&&y(m.prev,m,m.next)>=0)return!1;m=m.nextZ}return!0}function o(e,t,i){var n=e;do{var s=n.prev,o=n.next.next;!x(s,o)&&_(s,n,n.next,o)&&S(s,o)&&S(o,s)&&(t.push(s.i/i),t.push(n.i/i),t.push(o.i/i),R(n),R(n.next),n=e=o),n=n.next}while(n!==e);return r(n)}function a(e,t,n,s,o,a){var l=e;do{for(var u=l.next.next;u!==l.prev;){if(l.i!==u.i&&v(l,u)){var c=w(l,u);return l=r(l,l.next),c=r(c,c.next),i(l,t,n,s,o,a),void i(c,t,n,s,o,a)}u=u.next}l=l.next}while(l!==e)}function l(e,i,n,s){var o,a,l,c=[];for(o=0,a=i.length;o<a;o++)(l=t(e,i[o]*s,o<a-1?i[o+1]*s:e.length,s,!1))===l.next&&(l.steiner=!0),c.push(m(l));for(c.sort(u),o=0;o<c.length;o++)n=r(n=h(c[o],n),n.next);return n}function u(e,t){return e.x-t.x}function c(e){if(e.next.prev===e)return e;let t=e;for(;;){const r=t.next;if(r.prev===t||r===t||r===e)break;t=r}return t}function h(e,t){var i=function(e,t){var r,i=t,n=e.x,s=e.y,o=-1/0;do{if(s<=i.y&&s>=i.next.y&&i.next.y!==i.y){var a=i.x+(s-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=n&&a>o){if(o=a,a===n){if(s===i.y)return i;if(s===i.next.y)return i.next}r=i.x<i.next.x?i:i.next}}i=i.next}while(i!==t);if(!r)return null;if(n===o)return r;var l,u=r,c=r.x,h=r.y,f=1/0;i=r;do{n>=i.x&&i.x>=c&&n!==i.x&&g(s<h?n:o,s,c,h,s<h?o:n,s,i.x,i.y)&&(l=Math.abs(s-i.y)/(n-i.x),S(i,e)&&(l<f||l===f&&(i.x>r.x||i.x===r.x&&d(r,i)))&&(r=i,f=l)),i=i.next}while(i!==u);return r}(e,t);if(!i)return t;var n=w(i,e),s=r(i,i.next);let o=c(n);return r(o,o.next),s=c(s),c(t===i?s:t)}function d(e,t){return y(e.prev,e,t.prev)<0&&y(t.next,e,e.next)<0}function f(e,t,r,i){var n=e;do{null===n.z&&(n.z=p(n.x,n.y,t,r,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==e);n.prevZ.nextZ=null,n.prevZ=null,function(e){var t,r,i,n,s,o,a,l,u=1;do{for(r=e,e=null,s=null,o=0;r;){for(o++,i=r,a=0,t=0;t<u&&(a++,i=i.nextZ);t++);for(l=u;a>0||l>0&&i;)0!==a&&(0===l||!i||r.z<=i.z)?(n=r,r=r.nextZ,a--):(n=i,i=i.nextZ,l--),s?s.nextZ=n:e=n,n.prevZ=s,s=n;r=i}s.nextZ=null,u*=2}while(o>1)}(n)}function p(e,t,r,i,n){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*n)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*n)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function m(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function g(e,t,r,i,n,s,o,a){return(n-o)*(t-a)-(e-o)*(s-a)>=0&&(e-o)*(i-a)-(r-o)*(t-a)>=0&&(r-o)*(s-a)-(n-o)*(i-a)>=0}function v(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&_(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&(S(e,t)&&S(t,e)&&function(e,t){var r=e,i=!1,n=(e.x+t.x)/2,s=(e.y+t.y)/2;do{r.y>s!=r.next.y>s&&r.next.y!==r.y&&n<(r.next.x-r.x)*(s-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next}while(r!==e);return i}(e,t)&&(y(e.prev,e,t.prev)||y(e,t.prev,t))||x(e,t)&&y(e.prev,e,e.next)>0&&y(t.prev,t,t.next)>0)}function y(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function x(e,t){return e.x===t.x&&e.y===t.y}function _(e,t,r,i){var n=b(y(e,t,r)),s=b(y(e,t,i)),o=b(y(r,i,e)),a=b(y(r,i,t));return n!==s&&o!==a||!(0!==n||!T(e,r,t))||!(0!==s||!T(e,i,t))||!(0!==o||!T(r,e,i))||!(0!==a||!T(r,t,i))}function T(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function b(e){return e>0?1:e<0?-1:0}function S(e,t){return y(e.prev,e,e.next)<0?y(e,t,e.next)>=0&&y(e,e.prev,t)>=0:y(e,t,e.prev)<0||y(e,e.next,t)<0}function w(e,t){var r=new P(e.i,e.x,e.y),i=new P(t.i,t.x,t.y),n=e.next,s=t.prev;return e.next=t,t.prev=e,r.next=n,n.prev=r,i.next=r,r.prev=i,s.next=i,i.prev=s,i}function I(e,t,r,i){var n=new P(e,t,r);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function R(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function P(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function L(e,t,r,i){for(var n=0,s=t,o=r-i;s<r;s+=i)n+=(e[o]-e[s])*(e[s+1]+e[o+1]),o=s;return n}return e.deviation=function(e,t,r,i){var n=t&&t.length,s=n?t[0]*r:e.length,o=Math.abs(L(e,0,s,r));if(n)for(var a=0,l=t.length;a<l;a++){var u=t[a]*r,c=a<l-1?t[a+1]*r:e.length;o-=Math.abs(L(e,u,c,r))}var h=0;for(a=0;a<i.length;a+=3){var d=i[a]*r,f=i[a+1]*r,p=i[a+2]*r;h+=Math.abs((e[d]-e[p])*(e[f+1]-e[d+1])-(e[d]-e[f])*(e[p+1]-e[d+1]))}return 0===o&&0===h?0:Math.abs((h-o)/o)},e.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},i=0,n=0;n<e.length;n++){for(var s=0;s<e[n].length;s++)for(var o=0;o<t;o++)r.vertices.push(e[n][s][o]);n>0&&(i+=e[n-1].length,r.holes.push(i))}return r},e}())&&(n.exports=s);const l=(0,o.g)(a.exports)})),t.register("ebEEs",(function(t,r){e(t.exports,"DECLUTTER_TILES",(function(){return i})),e(t.exports,"COLLISION_GRID_CELL_SIZE",(function(){return n})),e(t.exports,"DECLUTTER_BUDGET",(function(){return s})),e(t.exports,"FADE_DURATION",(function(){return o}));const i=!0,n=32,s=1.5,o=200})),t.register("cOrC4",(function(r,i){e(r.exports,"Container",(function(){return l}));var n=t("eYrMi"),s=t("a4nX6"),o=t("2qlsz"),a=t("lkDKi");class l extends o.DisplayObject{get blendMode(){return this._blendMode}set blendMode(e){this._blendMode=e,this.requestRender()}get clips(){return this._clips}set clips(e){this._clips=e,this.children.forEach((t=>t.clips=e))}get computedEffects(){var e,t;return null!==(t=null===(e=this._effectView)||void 0===e?void 0:e.effects)&&void 0!==t?t:null}get effect(){var e,t;return null!==(t=null===(e=this._effectView)||void 0===e?void 0:e.effect)&&void 0!==t?t:""}set effect(e){(this._effectView||e)&&(this._effectView||(this._effectView=new(0,s.EffectView)),this._effectView.effect=e,this.requestRender())}get highlightOptions(){return this._highlightOptions}set highlightOptions(e){if(!e)return this._highlightOptions=null,void(this._highlightGradient&&(this._highlightGradient.destroy(),this._highlightGradient=null,this.requestRender()));this._highlightOptions&&this._highlightOptions.equals(e)||(this._highlightOptions=e,this._highlightGradient||(this._highlightGradient=new(0,a.default)),this._highlightGradient.setHighlightOptions(e),this.requestRender())}updateTransitionProperties(e,t){super.updateTransitionProperties(e,t),this._effectView&&(this._effectView.transitionStep(e,t),this._effectView.transitioning&&this.requestRender())}doRender(e){const t=this.createRenderParams(e);this.renderChildren(t)}addChild(e){return this.addChildAt(e,this.children.length)}addChildAt(e,t=this.children.length){if(!e)return e;if(this.contains(e))return e;this._needsSort=!0;const r=e.parent;return r&&r!==this&&r.removeChild(e),t>=this.children.length?this.children.push(e):this.children.splice(t,0,e),this._childrenSet.add(e),e.parent=this,e.stage=this.stage,this!==this.stage&&(e.clips=this.clips),this.requestRender(),e}contains(e){return this._childrenSet.has(e)}endTransitions(){super.endTransitions(),this._effectView&&(this._effectView.endTransitions(),this.requestRender())}removeAllChildren(){this._childrenSet.clear(),this._needsSort=!0;for(const e of this.children)this!==this.stage&&(e.clips=null),e.stage=null,e.parent=null;this.children.length=0}removeChild(e){return this.contains(e)?this.removeChildAt(this.children.indexOf(e)):e}removeChildAt(e){if(e<0||e>=this.children.length)return null;this._needsSort=!0;const t=this.children.splice(e,1)[0];return this._childrenSet.delete(t),this!==this.stage&&(t.clips=null),t.stage=null,t.parent=null,t}sortChildren(e){this._needsSort&&(this.children.sort(e),this._needsSort=!1)}beforeRender(e){super.beforeRender(e);for(const t of this.children)t.beforeRender(e)}afterRender(e){super.afterRender(e);for(const t of this.children)t.afterRender(e)}_createTransforms(){return{dvs:(0,n.c)()}}onAttach(){super.onAttach();const e=this.stage;for(const t of this.children)t.stage=e}onDetach(){super.onDetach();for(const e of this.children)e.stage=null}renderChildren(e){for(const t of this.children)t.processRender(e)}createRenderParams(e){return{...e,blendMode:this.blendMode,effects:this.computedEffects,globalOpacity:e.globalOpacity*this.computedOpacity,inFadeTransition:this.inFadeTransition,highlightGradient:this._highlightGradient||e.highlightGradient}}constructor(){super(...arguments),this._childrenSet=new Set,this._needsSort=!1,this.children=[],this._effectView=null,this._highlightOptions=null,this._highlightGradient=null}}})),t.register("lkDKi",(function(r,i){e(r.exports,"default",(function(){return d}));var n=t("jHOLN"),s=t("4WoSm"),o=t("fU7bw"),a=t("8JzMA"),l=t("8aBT4"),u=t("dDu9k");const c=n.default.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient");const h=[0,0,0,0];class d{setHighlightOptions(e){const t=this._convertedHighlightOptions;!function(e,t){t.fillColor[0]=e.color.r/255,t.fillColor[1]=e.color.g/255,t.fillColor[2]=e.color.b/255,t.fillColor[3]=e.color.a,e.haloColor?(t.outlineColor[0]=e.haloColor.r/255,t.outlineColor[1]=e.haloColor.g/255,t.outlineColor[2]=e.haloColor.b/255,t.outlineColor[3]=e.haloColor.a):(t.outlineColor[0]=t.fillColor[0],t.outlineColor[1]=t.fillColor[1],t.outlineColor[2]=t.fillColor[2],t.outlineColor[3]=t.fillColor[3]),t.fillColor[3]*=e.fillOpacity,t.outlineColor[3]*=e.haloOpacity,t.fillColor[0]*=t.fillColor[3],t.fillColor[1]*=t.fillColor[3],t.fillColor[2]*=t.fillColor[3],t.outlineColor[0]*=t.outlineColor[3],t.outlineColor[1]*=t.outlineColor[3],t.outlineColor[2]*=t.outlineColor[3],t.outlineWidth=o.HIGHLIGHT_SIZING.outlineWidth,t.outerHaloWidth=o.HIGHLIGHT_SIZING.outerHaloWidth,t.innerHaloWidth=o.HIGHLIGHT_SIZING.innerHaloWidth,t.outlinePosition=o.HIGHLIGHT_SIZING.outlinePosition}(e,t);const r=t.outlinePosition-t.outlineWidth/2-t.outerHaloWidth,i=t.outlinePosition-t.outlineWidth/2,n=t.outlinePosition+t.outlineWidth/2,s=t.outlinePosition+t.outlineWidth/2+t.innerHaloWidth,a=Math.sqrt(Math.PI/2)*o.SIGMA,l=Math.abs(r)>a?Math.round(10*(Math.abs(r)-a))/10:0,u=Math.abs(s)>a?Math.round(10*(Math.abs(s)-a))/10:0;let d;l&&!u?c.error("The outer rim of the highlight is "+l+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!l&&u?c.error("The inner rim of the highlight is "+u+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):l&&u&&c.error("The highlight is "+Math.max(l,u)+"px away from the edge of the feature; consider reducing some width values.");const f=[void 0,void 0,void 0,void 0];function p(e,t,r){f[0]=(1-r)*e[0]+r*t[0],f[1]=(1-r)*e[1]+r*t[1],f[2]=(1-r)*e[2]+r*t[2],f[3]=(1-r)*e[3]+r*t[3]}const{_texelData:m}=this;for(let e=0;e<o.SHADE_TEXTURE_SIZE;++e)d=r+e/(o.SHADE_TEXTURE_SIZE-1)*(s-r),d<r?(f[4*e]=0,f[4*e+1]=0,f[4*e+2]=0,f[4*e+3]=0):d<i?p(h,t.outlineColor,(d-r)/(i-r)):d<n?[f[0],f[1],f[2],f[3]]=t.outlineColor:d<s?p(t.outlineColor,t.fillColor,(d-n)/(s-n)):[f[4*e],f[4*e+1],f[4*e+2],f[4*e+3]]=t.fillColor,m[4*e]=255*f[0],m[4*e+1]=255*f[1],m[4*e+2]=255*f[2],m[4*e+3]=255*f[3];this._minMaxDistance[0]=r,this._minMaxDistance[1]=s,this._shadeTexChanged=!0}applyHighlightOptions(e,t){if(!this._shadeTex){const t=new(0,u.TextureDescriptor);t.wrapMode=a.TextureWrapMode.CLAMP_TO_EDGE,t.width=o.SHADE_TEXTURE_SIZE,t.height=1,this._shadeTex=new(0,l.Texture)(e,t)}this._shadeTexChanged&&(this._shadeTex.updateData(0,0,0,o.SHADE_TEXTURE_SIZE,1,this._texelData),this._shadeTexChanged=!1),e.bindTexture(this._shadeTex,s.TEXTURE_BINDING_HIGHLIGHT_1),t.setUniform2fv("u_minMaxDistance",this._minMaxDistance)}destroy(){var e;null===(e=this._shadeTex)||void 0===e||e.dispose(),this._shadeTex=null}constructor(){this._convertedHighlightOptions={fillColor:[.2*.75,.6*.75,.675,.75],outlineColor:[.2*.9,.54,.81,.9],outlinePosition:o.HIGHLIGHT_SIZING.outlinePosition,outlineWidth:o.HIGHLIGHT_SIZING.outlineWidth,innerHaloWidth:o.HIGHLIGHT_SIZING.innerHaloWidth,outerHaloWidth:o.HIGHLIGHT_SIZING.outerHaloWidth},this._shadeTexChanged=!0,this._texelData=new Uint8Array(4*o.SHADE_TEXTURE_SIZE),this._minMaxDistance=[0,0]}}})),t.register("fU7bw",(function(t,r){e(t.exports,"SIGMA",(function(){return i})),e(t.exports,"ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX",(function(){return n})),e(t.exports,"RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX",(function(){return s})),e(t.exports,"SHADE_TEXTURE_SIZE",(function(){return o})),e(t.exports,"HIGHLIGHT_SIZING",(function(){return a}));const i=1,n=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],s=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],o=256,a={outlineWidth:1.3,outerHaloWidth:.4,innerHaloWidth:.4,outlinePosition:0}}))}();
//# sourceMappingURL=ImageryTileLayerView2D.c1795c0a.js.map
