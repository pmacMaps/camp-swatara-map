!function(){function e(e){return e&&e.__esModule?e.default:e}function t(e,t,r,n){Object.defineProperty(e,t,{get:r,set:n,enumerable:!0,configurable:!0})}var r=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire594f;r.register("gYOhP",(function(n,a){t(n.exports,"WFS_OID_FIELD_NAME",(function(){return F})),t(n.exports,"getCapabilities",(function(){return D})),t(n.exports,"findFeatureType",(function(){return U})),t(n.exports,"getWFSLayerInfo",(function(){return X})),t(n.exports,"prepareWFSLayerFields",(function(){return H})),t(n.exports,"getFeature",(function(){return Z}));var i=r("8TSCy"),o=r("2TvXO");r("2ILM8");var u=r("9pNSx"),s=r("kyj08"),l=r("97KKx"),c=r("7qybv"),p=r("10vEZ"),f=r("kYueh"),d=r("7RvA5"),y=r("eY5Yp"),m=r("7LVgC"),g=r("4shxe"),b=r("3dhED"),v=r("54m8H"),h=r("buMuJ"),w=r("j40xv"),T=r("gINRd"),x="xlink:href",S="2.0.0",F="__esri_wfs_id__",C="wfs-layer:getWFSLayerTypeInfo-error",k="wfs-layer:empty-service",E="wfs-layer:feature-type-not-found",G="wfs-layer:malformed-json",N="wfs-layer:unknown-geometry-type",P="wfs-layer:unknown-field-type",A="wfs-layer:unsupported-spatial-reference",R="wfs-layer:unsupported-wfs-version";function D(e,t){return L.apply(this,arguments)}function L(){return(L=i.asyncToGenerator(e(o).mark((function t(r,n){var a;return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=M,e.next=3,(0,u.default)(r,{responseType:"text",query:i.objectSpread({SERVICE:"WFS",REQUEST:"GetCapabilities",VERSION:S},null==n?void 0:n.customParameters),signal:null==n?void 0:n.signal});case 3:return e.t1=e.sent.data,a=(0,e.t0)(e.t1),e.abrupt("return",(I(r,a),a));case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function M(e){var t=re(e);(function(e){var t=e.firstElementChild.getAttribute("version");if(t&&t!==S)throw new(0,s.default)(R,"Unsupported WFS version ".concat(t,". Supported version: ").concat(S))})(t),ae(t);var r,n=t.firstElementChild,a=(0,l.cache)((r=n,(0,v.iterateXML)(r,{FeatureTypeList:{FeatureType:function(e){var t,r={typeName:"undefined:undefined",name:"",title:"",description:"",extent:null,namespacePrefix:"",namespaceUri:"",supportedSpatialReferences:[]},n=new Set([4326]),a=function(e){var t,r,a=parseInt(null==(t=e.textContent.match(RegExp("(?<wkid>\\d+$)","i")))||null==(r=t.groups)?void 0:r.wkid,10);Number.isNaN(a)||n.add(a)};return(0,v.visitXML)(e,{Name:function(e){var t=ne(e.textContent),n=t.name,a=t.prefix;r.typeName="".concat(a,":").concat(n),r.name=n,r.namespacePrefix=a,r.namespaceUri=e.lookupNamespaceURI(a)},Abstract:function(e){r.description=e.textContent},Title:function(e){r.title=e.textContent},WGS84BoundingBox:function(e){r.extent=function(e){var t,r,n,a,o=!0,u=!1,s=void 0;try{for(var l,c=e.children[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var p=l.value;switch(p.localName){case"LowerCorner":var f;t=(f=i.slicedToArray(p.textContent.split(" ").map((function(e){return Number.parseFloat(e)})),2))[0],r=f[1];break;case"UpperCorner":var d;n=(d=i.slicedToArray(p.textContent.split(" ").map((function(e){return Number.parseFloat(e)})),2))[0],a=d[1]}}}catch(e){u=!0,s=e}finally{try{o||null==c.return||c.return()}finally{if(u)throw s}}return{xmin:t,ymin:r,xmax:n,ymax:a,spatialReference:y.WGS84}}(e)},DefaultSRS:a,DefaultCRS:a,OtherSRS:a,OtherCRS:a}),r.title||(r.title=r.name),(t=r.supportedSpatialReferences).push.apply(t,i.toConsumableArray(n)),r}}})));return{operations:O(n),get featureTypes(){return Array.from(a())},readFeatureTypes:a}}var j=new Set(["json","application/json","geojson","application/json; subtype=geojson"]);function O(e){var t=!1,r={GetCapabilities:{url:""},DescribeFeatureType:{url:""},GetFeature:{url:"",outputFormat:null,supportsPagination:!1}};if((0,v.visitXML)(e,{OperationsMetadata:{Operation:function(e){switch(e.getAttribute("name")){case"GetCapabilities":return{DCP:{HTTP:{Get:function(e){r.GetCapabilities.url=e.getAttribute(x)}}}};case"DescribeFeatureType":return{DCP:{HTTP:{Get:function(e){r.DescribeFeatureType.url=e.getAttribute(x)}}}};case"GetFeature":return{DCP:{HTTP:{Get:function(e){r.GetFeature.url=e.getAttribute(x)}}},Parameter:function(e){if("outputFormat"===e.getAttribute("name"))return{AllowedValues:{Value:function(e){var t=e.textContent;j.has(t.toLowerCase())&&(r.GetFeature.outputFormat=t)}}}}}}},Constraint:function(e){switch(e.getAttribute("name")){case"KVPEncoding":return{DefaultValue:function(e){t="true"===e.textContent.toLowerCase()}};case"ImplementsResultPaging":return{DefaultValue:function(e){r.GetFeature.supportsPagination="true"===e.textContent.toLowerCase()}}}}}}),!t)throw new(0,s.default)("wfs-layer:kvp-encoding-not-supported","WFS service doesn't support key/value pair (KVP) encoding");if((0,c.isNone)(r.GetFeature.outputFormat))throw new(0,s.default)("wfs-layer:geojson-not-supported","WFS service doesn't support GeoJSON output format");return r}function I(e,t){(0,f.isHTTPSProtocol)(e)&&((0,f.hasSameOrigin)(e,t.operations.DescribeFeatureType.url,!0)&&(t.operations.DescribeFeatureType.url=(0,f.toHTTPS)(t.operations.DescribeFeatureType.url)),(0,f.hasSameOrigin)(e,t.operations.GetFeature.url,!0)&&(t.operations.GetFeature.url=(0,f.toHTTPS)(t.operations.GetFeature.url)))}function U(e,t,r){return(0,l.find)(e,(function(e){return r?e.name===t&&e.namespaceUri===r:e.typeName===t||e.name===t}))}function X(e,t,r){return W.apply(this,arguments)}function W(){return W=i.asyncToGenerator(e(o).mark((function t(r,n,a){var i,u,s,l,c,p,f,d,y,m,g,b=arguments;return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=b.length>3&&void 0!==b[3]?b[3]:{},e.next=4,V(r,n,a,i);case 4:return s=e.sent,l=s.featureType,c=s.extent,e.next=9,_(r,l.typeName,i);case 9:return p=e.sent,f=p.fields,d=p.geometryType,y=p.swapXY,m=p.objectIdField,g=p.geometryField,e.abrupt("return",{url:r.operations.GetCapabilities.url,name:l.name,namespaceUri:l.namespaceUri,fields:f,geometryField:g,geometryType:d,objectIdField:m,spatialReference:null!=(u=i.spatialReference)?u:w.default.WGS84,extent:c,swapXY:y,wfsCapabilities:r,customParameters:i.customParameters});case 16:case"end":return e.stop()}}),t)}))),W.apply(this,arguments)}function V(e,t,r){return Y.apply(this,arguments)}function Y(){return Y=i.asyncToGenerator(e(o).mark((function t(r,n,a){var u,l,p,f,m,g,b=arguments;return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=b.length>3&&void 0!==b[3]?b[3]:{},l=u.spatialReference,p=void 0===l?w.default.WGS84:l,f=r.readFeatureTypes(),m=n?U(f,n,a):f.next().value,!(0,c.isNone)(m)){e.next=4;break}throw n?new(0,s.default)(E,"The type '".concat(n,"' could not be found in the service")):new(0,s.default)(k,"The service is empty");case 4:if(g=new(0,T.default)(i.objectSpread({},m.extent,{spatialReference:p})),(0,y.equals)(p,y.WGS84)){e.next=15;break}return e.prev=6,e.next=9,(0,d.initializeProjection)(y.WGS84,p,void 0,u);case 9:g=(0,d.project)(g,y.WGS84),e.next=15;break;case 12:throw e.prev=12,e.t0=e.catch(6),new(0,s.default)(A,"Projection not supported");case 15:return e.abrupt("return",{extent:g,spatialReference:p,featureType:m});case 16:case"end":return e.stop()}}),t,null,[[6,12]])}))),Y.apply(this,arguments)}function _(e,t){return q.apply(this,arguments)}function q(){return q=i.asyncToGenerator(e(o).mark((function t(r,n){var a,u,l,f,d,y,m,g,b,v=arguments;return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=v.length>2&&void 0!==v[2]?v[2]:{},e.t0=i,e.next=4,(0,p.eachAlways)([K(r.operations.DescribeFeatureType.url,n,a),z(r,n,a)]);case 4:if(e.t1=e.sent,u=e.t0.slicedToArray.call(e.t0,e.t1,2),l=u[0],f=u[1],!l.error&&!f.error){e.next=10;break}throw new(0,s.default)(C,"An error occurred while getting info about the feature type '".concat(n,"'"),{error:l.error||f.error});case 10:if(d=l.value,y=d.fields,m=d.errors,g=l.value.geometryType||f.value.geometryType,b=f.value.swapXY,!(0,c.isNone)(g)){e.next=13;break}throw new(0,s.default)(N,"The geometry type could not be determined for type '".concat(n),{typeName:n,geometryType:g,fields:y,errors:m});case 13:return e.abrupt("return",i.objectSpread({},H(y),{geometryType:g,swapXY:b}));case 14:case"end":return e.stop()}}),t)}))),q.apply(this,arguments)}function H(e){var t,r=e.find((function(e){return"geometry"===e.type})),n=e.find((function(e){return"oid"===e.type}));return e=e.filter((function(e){return"geometry"!==e.type})),n||(n=new(0,h.default)({name:F,type:"oid",alias:F}),e.unshift(n)),{geometryField:null!=(t=null==r?void 0:r.name)?t:null,objectIdField:n.name,fields:e}}function z(e,t){return J.apply(this,arguments)}function J(){return J=i.asyncToGenerator(e(o).mark((function t(r,n){var a,s,l,c,p,f,d,y,b,v,h,w,T,x=arguments;return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=x.length>2&&void 0!==x[2]?x[2]:{},c=!1,e.t0=i,e.next=6,Promise.all([Z(r.operations.GetFeature.url,n,r.operations.GetFeature.outputFormat,i.objectSpread({},a,{count:1})),(0,u.default)(r.operations.GetFeature.url,{responseType:"text",query:te(n,void 0,i.objectSpread({},a,{count:1})),signal:null==a?void 0:a.signal})]);case 6:if(e.t1=e.sent,p=e.t0.slicedToArray.call(e.t0,e.t1,2),f=p[0],d=p[1],!(y="FeatureCollection"===f.type&&(null==(s=f.features[0])?void 0:s.geometry))){e.next=25;break}e.t2=(l=m.featureGeometryTypeKebabDictionary.fromJSON((0,g.getGeometryType)(y.type)),y.type),e.next="Point"===e.t2?16:"LineString"===e.t2||"MultiPoint"===e.t2?18:"MultiLineString"===e.t2||"Polygon"===e.t2?20:"MultiPolygon"===e.t2?22:23;break;case 16:return b=y.coordinates,e.abrupt("break",23);case 18:return b=y.coordinates[0],e.abrupt("break",23);case 20:return b=y.coordinates[0][0],e.abrupt("break",23);case 22:b=y.coordinates[0][0][0];case 23:(v=/<[^>]*pos[^>]*> *(-?\d+(?:\.\d+)?) (-?\d+(?:\.\d+)?)/.exec(d.data))&&(h=b[0].toFixed(3),w=b[1].toFixed(3),T=parseFloat(v[1]).toFixed(3),h===parseFloat(v[2]).toFixed(3)&&w===T&&(c=!0));case 25:return e.abrupt("return",{geometryType:l,swapXY:c});case 26:case"end":return e.stop()}}),t)}))),J.apply(this,arguments)}function K(e,t,r){return $.apply(this,arguments)}function $(){return($=i.asyncToGenerator(e(o).mark((function t(r,n,a){return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Q,e.t1=n,e.next=4,(0,u.default)(r,{responseType:"text",query:i.objectSpread({SERVICE:"WFS",REQUEST:"DescribeFeatureType",VERSION:S,TYPENAME:n},null==a?void 0:a.customParameters),signal:null==a?void 0:a.signal});case 4:return e.t2=e.sent.data,e.abrupt("return",(0,e.t0)(e.t1,e.t2));case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Q(e,t){var r=ne(e).name,n=re(t);ae(n);var a=(0,l.find)((0,v.iterateXML)(n.firstElementChild,{element:function(e){return{name:e.getAttribute("name"),typeName:ne(e.getAttribute("type")).name}}}),(function(e){return e.name===r}));if((0,c.isSome)(a)){var i=(0,l.find)((0,v.iterateXML)(n.firstElementChild,{complexType:function(e){return e}}),(function(e){return e.getAttribute("name")===a.typeName}));if((0,c.isSome)(i))return function(e){var t,r,n,a=[],i=[],o=(0,v.iterateXML)(e,{complexContent:{extension:{sequence:{element:function(e){return e}}}}}),u=!0,l=!1,c=void 0;try{for(var p,f=function(o,u){var l=u.value,c=l.getAttribute("name");if(!c)return"continue";var p=void 0,f=void 0;if(l.hasAttribute("type")?p=ne(l.getAttribute("type")).name:(0,v.visitXML)(l,{simpleType:{restriction:function(e){return p=ne(e.getAttribute("base")).name,{maxLength:function(e){f=+e.getAttribute("value")}}}}}),!p)return"continue";var d="true"===l.getAttribute("nillable"),y=!1;switch(p.toLowerCase()){case"integer":case"nonpositiveinteger":case"negativeinteger":case"long":case"int":case"short":case"byte":case"nonnegativeinteger":case"unsignedlong":case"unsignedint":case"unsignedshort":case"unsignedbyte":case"positiveinteger":i.push(new(0,h.default)({name:c,alias:c,type:"integer",nullable:d}));break;case"float":case"double":case"decimal":i.push(new(0,h.default)({name:c,alias:c,type:"double",nullable:d}));break;case"boolean":case"string":case"gyearmonth":case"gyear":case"gmonthday":case"gday":case"gmonth":case"anyuri":case"qname":case"notation":case"normalizedstring":case"token":case"language":case"idrefs":case"entities":case"nmtoken":case"nmtokens":case"name":case"ncname":case"id":case"idref":case"entity":case"duration":case"time":i.push(new(0,h.default)({name:c,alias:c,type:"string",nullable:d,length:null!=(t=f)?t:255}));break;case"datetime":case"date":i.push(new(0,h.default)({name:c,alias:c,type:"date",nullable:d,length:null!=(r=f)?r:36}));break;case"pointpropertytype":n="point",y=!0;break;case"multipointpropertytype":n="multipoint",y=!0;break;case"curvepropertytype":case"multicurvepropertytype":case"multilinestringpropertytype":n="polyline",y=!0;break;case"surfacepropertytype":case"multisurfacepropertytype":case"multipolygonpropertytype":n="polygon",y=!0;break;case"geometrypropertytype":case"multigeometrypropertytype":y=!0,a.push(new(0,s.default)(N,"geometry type '".concat(p,"' is not supported"),{type:(new XMLSerializer).serializeToString(e)}));break;default:a.push(new(0,s.default)(P,"Unknown field type '".concat(p,"'"),{type:(new XMLSerializer).serializeToString(e)}))}y&&i.push(new(0,h.default)({name:c,alias:c,type:"geometry",nullable:d}))},d=o[Symbol.iterator]();!(u=(p=d.next()).done);u=!0)f(d,p)}catch(e){l=!0,c=e}finally{try{u||null==d.return||d.return()}finally{if(l)throw c}}var y=!0,m=!1,g=void 0;try{for(var b,w=i[Symbol.iterator]();!(y=(b=w.next()).done);y=!0){var T=b.value;if("integer"===T.type&&!T.nullable&&B.has(T.name.toLowerCase())){T.type="oid";break}}}catch(e){m=!0,g=e}finally{try{y||null==w.return||w.return()}finally{if(m)throw g}}return{geometryType:n,fields:i,errors:a}}(i)}throw new(0,s.default)(E,"Type '".concat(e,"' not found in document"),{document:(new XMLSerializer).serializeToString(n)})}var B=new Set(["objectid","fid"]);function Z(e,t,r,n){return ee.apply(this,arguments)}function ee(){return(ee=i.asyncToGenerator(e(o).mark((function t(r,n,a,i){var l,c,p,f;return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,u.default)(r,{responseType:"text",query:te(n,a,i),signal:null==i?void 0:i.signal});case 2:if(l=e.sent,c=(c=l.data).replace(/": +(-?\d+),(\d+)(,)?/g,'": $1.$2$3'),e.prev=5,null==i||null==(p=i.dateFields)||!p.length){e.next=10;break}return f=new Set(i.dateFields),e.abrupt("return",JSON.parse(c,(function(e,t){return f.has(e)?(0,b.parseDate)(t):t})));case 10:return e.abrupt("return",JSON.parse(c));case 13:throw e.prev=13,e.t0=e.catch(5),new(0,s.default)(G,"Error while parsing the response",{response:c,error:e.t0});case 16:case"end":return e.stop()}}),t,null,[[5,13]])})))).apply(this,arguments)}function te(e,t,r){return i.objectSpread({SERVICE:"WFS",REQUEST:"GetFeature",VERSION:S,TYPENAMES:e,OUTPUTFORMAT:t,SRSNAME:"EPSG:4326",STARTINDEX:null==r?void 0:r.startIndex,COUNT:null==r?void 0:r.count},null==r?void 0:r.customParameters)}function re(e){return(new DOMParser).parseFromString(e.trim(),"text/xml")}function ne(e){var t=i.slicedToArray(e.split(":"),2),r=t[0],n=t[1];return{prefix:n?r:"",name:null!=n?n:r}}function ae(e){var t,r;if((0,v.visitXML)(e.firstElementChild,{Exception:function(e){return t=e.getAttribute("exceptionCode"),{ExceptionText:function(e){r=e.textContent}}}}),t)throw new(0,s.default)("wfs-layer:".concat(t),r)}})),r.register("3dhED",(function(e,r){function n(e){var t,r;return null!=(t=function(e){var t,r,n,i,o=a.exec(e);if(!o)return null;var u=o.groups,s=+u.year,l=+u.month-1,c=+u.day,p=+(null!=(t=u.hours)?t:"0"),f=+(null!=(r=u.minutes)?r:"0"),d=+(null!=(n=u.seconds)?n:"0");if(p>23)return null;if(f>59)return null;if(d>59)return null;var y,m=null!=(i=u.ms)?i:"0",g=m?+m.padEnd(3,"0").substring(0,3):0;if(u.isUTC)y=Date.UTC(s,l,c,p,f,d,g);else if(u.offsetSign){var b=+u.offsetHours,v=+u.offsetMinutes;y=6e4*("+"===u.offsetSign?-1:1)*(60*b+v)+Date.UTC(s,l,c,p,f,d,g)}else y=new Date(s,l,c,p,f,d,g).getTime();return Number.isNaN(y)?null:y}(e))?t:(r=new Date(e).getTime(),Number.isNaN(r)?null:r)}t(e.exports,"parseDate",(function(){return n}));var a=RegExp("^(?:(?<year>-?\\d{4,})-(?<month>\\d{2})-(?<day>\\d{2}))(?:T(?<hours>\\d{2}):(?<minutes>\\d{2}):(?<seconds>\\d{2})(?:\\.(?<ms>\\d+))?)?(?:(?<isUTC>Z)|(?:(?<offsetSign>\\+|-)(?<offsetHours>\\d{2}):(?<offsetMinutes>\\d{2})))?$")}))}();
//# sourceMappingURL=WFSLayer.1292c178.js.map
