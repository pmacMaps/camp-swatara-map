function t(t,e,r,n){Object.defineProperty(t,e,{get:r,set:n,enumerable:!0,configurable:!0})}var e=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire594f;e.register("9uNK0",(function(r,n){var o;o=r.exports,Object.defineProperty(o,"__esModule",{value:!0,configurable:!0}),t(r.exports,"default",(function(){return O}));var u=e("aX9sh"),a=e("2DP3b"),i=e("gDeEN"),l=e("8Fpda"),s=e("8lcnQ"),c=e("bQCak"),f=e("5cP7j"),d=e("jaaCV"),b=e("kusBK");class p{transform(t){const e=this._transform(t),r=[e.points.buffer,e.rgb.buffer];null!=e.pointIdFilterMap&&r.push(e.pointIdFilterMap.buffer);for(const t of e.attributes)"buffer"in t.values&&(0,a.isArrayBuffer)(t.values.buffer)&&t.values.buffer!==e.rgb.buffer&&r.push(t.values.buffer);return Promise.resolve({result:e,transferList:r})}_transform(t){const e=(0,b.readGeometry)(t.schema,t.geometryBuffer);let r=e.length/3,n=null;const o=new Array,a=(0,b.getAttributeValues)(t.primaryAttributeData,e,r);null!=t.primaryAttributeData&&a&&o.push({attributeInfo:t.primaryAttributeData.attributeInfo,values:a});const i=(0,b.getAttributeValues)(t.modulationAttributeData,e,r);null!=t.modulationAttributeData&&i&&o.push({attributeInfo:t.modulationAttributeData.attributeInfo,values:i});let l=(0,b.evaluateRenderer)(t.rendererInfo,a,i,r);if(t.filterInfo&&t.filterInfo.length>0&&null!=t.filterAttributesData){const a=t.filterAttributesData.filter(u.isSome).map((t=>{const n=(0,b.getAttributeValues)(t,e,r),u={attributeInfo:t.attributeInfo,values:n};return o.push(u),u}));n=new Uint32Array(r),r=(0,b.filterInPlace)(e,l,n,t.filterInfo,a)}for(const n of t.userAttributesData){const t=(0,b.getAttributeValues)(n,e,r);o.push({attributeInfo:n.attributeInfo,values:t})}3*r<l.length&&(l=new Uint8Array(l.buffer.slice(0,3*r))),this._applyElevationOffsetInPlace(e,r,t.elevationOffset);const s=this._transformCoordinates(e,r,t.obb,d.default.fromJSON(t.inSR),d.default.fromJSON(t.outSR));return{obb:t.obb,points:s,rgb:l,attributes:o,pointIdFilterMap:n}}_transformCoordinates(t,e,r,n,o){if(!(0,f.projectBuffer)(t,n,0,t,o,0,e))throw new Error("Can't reproject");const u=(0,c.f)(r.center[0],r.center[1],r.center[2]),a=(0,c.c)(),l=(0,c.c)();(0,i.c)(A,r.quaternion);const d=new Float32Array(3*e);for(let n=0;n<e;n++)a[0]=t[3*n]-u[0],a[1]=t[3*n+1]-u[1],a[2]=t[3*n+2]-u[2],(0,s.q)(l,a,A),r.halfSize[0]=Math.max(r.halfSize[0],Math.abs(l[0])),r.halfSize[1]=Math.max(r.halfSize[1],Math.abs(l[1])),r.halfSize[2]=Math.max(r.halfSize[2],Math.abs(l[2])),d[3*n]=a[0],d[3*n+1]=a[1],d[3*n+2]=a[2];return d}_applyElevationOffsetInPlace(t,e,r){if(0!==r)for(let n=0;n<e;n++)t[3*n+2]+=r}}const A=(0,l.c)();function O(){return new p}})),e.register("gDeEN",(function(r,n){t(r.exports,"s",(function(){return c})),t(r.exports,"g",(function(){return f})),t(r.exports,"m",(function(){return d})),t(r.exports,"c",(function(){return p})),t(r.exports,"k",(function(){return O})),t(r.exports,"a",(function(){return h})),t(r.exports,"j",(function(){return x}));var o=e("4vUOo"),u=e("6MY4j"),a=e("iHxaG"),i=e("6LBkm"),l=e("8lcnQ"),s=e("7X4gL");function c(t,e,r){r*=.5;const n=Math.sin(r);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(r),t}function f(t,e){const r=2*Math.acos(e[3]),n=Math.sin(r/2);return n>(0,i.g)()?(t[0]=e[0]/n,t[1]=e[1]/n,t[2]=e[2]/n):(t[0]=1,t[1]=0,t[2]=0),r}function d(t,e,r){const n=e[0],o=e[1],u=e[2],a=e[3],i=r[0],l=r[1],s=r[2],c=r[3];return t[0]=n*c+a*i+o*s-u*l,t[1]=o*c+a*l+u*i-n*s,t[2]=u*c+a*s+n*l-o*i,t[3]=a*c-n*i-o*l-u*s,t}function b(t,e,r,n){const o=e[0],u=e[1],a=e[2],l=e[3];let s,c,f,d,b,p=r[0],A=r[1],O=r[2],h=r[3];return c=o*p+u*A+a*O+l*h,c<0&&(c=-c,p=-p,A=-A,O=-O,h=-h),1-c>(0,i.g)()?(s=Math.acos(c),f=Math.sin(s),d=Math.sin((1-n)*s)/f,b=Math.sin(n*s)/f):(d=1-n,b=n),t[0]=d*o+b*p,t[1]=d*u+b*A,t[2]=d*a+b*O,t[3]=d*l+b*h,t}function p(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function A(t,e){const r=e[0]+e[4]+e[8];let n;if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{let r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);const o=(r+1)%3,u=(r+2)%3;n=Math.sqrt(e[3*r+r]-e[3*o+o]-e[3*u+u]+1),t[r]=.5*n,n=.5/n,t[3]=(e[3*o+u]-e[3*u+o])*n,t[o]=(e[3*o+r]+e[3*r+o])*n,t[u]=(e[3*u+r]+e[3*r+u])*n}return t}function O(t,e,r,n){const o=.5*Math.PI/180;e*=o,r*=o,n*=o;const u=Math.sin(e),a=Math.cos(e),i=Math.sin(r),l=Math.cos(r),s=Math.sin(n),c=Math.cos(n);return t[0]=u*l*c-a*i*s,t[1]=a*i*c+u*l*s,t[2]=a*l*s-u*i*c,t[3]=a*l*c+u*i*s,t}const h=s.c,I=s.s,T=s.a,g=d,M=s.b,E=s.d,m=s.l,R=s.e,S=R,N=s.f,y=N,v=s.n,x=s.g,L=s.h;const C=(0,a.c)(),F=(0,a.f)(1,0,0),U=(0,a.f)(0,1,0);const D=(0,u.a)(),P=(0,u.a)();const V=(0,o.c)();Object.freeze(Object.defineProperty({__proto__:null,add:T,calculateW:function(t,e){const r=e[0],n=e[1],o=e[2];return t[0]=r,t[1]=n,t[2]=o,t[3]=Math.sqrt(Math.abs(1-r*r-n*n-o*o)),t},conjugate:p,copy:h,dot:E,equals:L,exactEquals:x,fromEuler:O,fromMat3:A,getAxisAngle:f,identity:function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},invert:function(t,e){const r=e[0],n=e[1],o=e[2],u=e[3],a=r*r+n*n+o*o+u*u,i=a?1/a:0;return t[0]=-r*i,t[1]=-n*i,t[2]=-o*i,t[3]=u*i,t},len:S,length:R,lerp:m,mul:g,multiply:d,normalize:v,random:function(t){const e=i.R,r=e(),n=e(),o=e(),u=Math.sqrt(1-r),a=Math.sqrt(r);return t[0]=u*Math.sin(2*Math.PI*n),t[1]=u*Math.cos(2*Math.PI*n),t[2]=a*Math.sin(2*Math.PI*o),t[3]=a*Math.cos(2*Math.PI*o),t},rotateX:function(t,e,r){r*=.5;const n=e[0],o=e[1],u=e[2],a=e[3],i=Math.sin(r),l=Math.cos(r);return t[0]=n*l+a*i,t[1]=o*l+u*i,t[2]=u*l-o*i,t[3]=a*l-n*i,t},rotateY:function(t,e,r){r*=.5;const n=e[0],o=e[1],u=e[2],a=e[3],i=Math.sin(r),l=Math.cos(r);return t[0]=n*l-u*i,t[1]=o*l+a*i,t[2]=u*l+n*i,t[3]=a*l-o*i,t},rotateZ:function(t,e,r){r*=.5;const n=e[0],o=e[1],u=e[2],a=e[3],i=Math.sin(r),l=Math.cos(r);return t[0]=n*l+o*i,t[1]=o*l-n*i,t[2]=u*l+a*i,t[3]=a*l-u*i,t},rotationTo:function(t,e,r){const n=(0,l.e)(e,r);return n<-.999999?((0,l.f)(C,F,e),(0,l.u)(C)<1e-6&&(0,l.f)(C,U,e),(0,l.n)(C,C),c(t,C,Math.PI),t):n>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):((0,l.f)(C,e,r),t[0]=C[0],t[1]=C[1],t[2]=C[2],t[3]=1+n,v(t,t))},scale:M,set:I,setAxes:function(t,e,r,n){const o=V;return o[0]=r[0],o[3]=r[1],o[6]=r[2],o[1]=n[0],o[4]=n[1],o[7]=n[2],o[2]=-e[0],o[5]=-e[1],o[8]=-e[2],v(t,A(t,o))},setAxisAngle:c,slerp:b,sqlerp:function(t,e,r,n,o,u){return b(D,e,o,u),b(P,r,n,u),b(t,D,P,2*u*(1-u)),t},sqrLen:y,squaredLength:N,str:function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}},Symbol.toStringTag,{value:"Module"}))})),e.register("4vUOo",(function(e,r){function n(){return[1,0,0,0,1,0,0,0,1]}function o(t,e,r,n,o,u,a,i,l){return[t,e,r,n,o,u,a,i,l]}function u(t,e){return new Float64Array(t,e,9)}t(e.exports,"c",(function(){return n})),t(e.exports,"f",(function(){return o})),t(e.exports,"a",(function(){return u}));Object.freeze(Object.defineProperty({__proto__:null,clone:function(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]]},create:n,createView:u,fromValues:o},Symbol.toStringTag,{value:"Module"}))})),e.register("6MY4j",(function(e,r){function n(){return[0,0,0,1]}function o(t){return[t[0],t[1],t[2],t[3]]}function u(t,e){return new Float64Array(t,e,4)}t(e.exports,"a",(function(){return n})),t(e.exports,"b",(function(){return o})),t(e.exports,"c",(function(){return u})),t(e.exports,"I",(function(){return a}));const a=[0,0,0,1];Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:a,clone:o,create:n,createView:u,fromValues:function(t,e,r,n){return[t,e,r,n]}},Symbol.toStringTag,{value:"Module"}))})),e.register("bQCak",(function(e,r){function n(){return new Float32Array(3)}function o(t){const e=new Float32Array(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function u(t,e,r){const n=new Float32Array(3);return n[0]=t,n[1]=e,n[2]=r,n}function a(t,e){return new Float32Array(t,e,3)}function i(){return n()}function l(){return u(1,1,1)}function s(){return u(1,0,0)}function c(){return u(0,1,0)}function f(){return u(0,0,1)}t(e.exports,"c",(function(){return n})),t(e.exports,"b",(function(){return o})),t(e.exports,"f",(function(){return u})),t(e.exports,"a",(function(){return a}));const d=i(),b=l(),p=s(),A=c(),O=f();Object.freeze(Object.defineProperty({__proto__:null,ONES:b,UNIT_X:p,UNIT_Y:A,UNIT_Z:O,ZEROS:d,clone:o,create:n,createView:a,fromValues:u,ones:l,unitX:s,unitY:c,unitZ:f,zeros:i},Symbol.toStringTag,{value:"Module"}))})),e.register("kusBK",(function(r,n){t(r.exports,"evaluateRenderer",(function(){return s})),t(r.exports,"readGeometry",(function(){return c})),t(r.exports,"getAttributeValues",(function(){return f})),t(r.exports,"filterInPlace",(function(){return d})),e("5HTPH");var o=e("5fhhG"),u=e("61J2m"),a=e("cA3NT"),i=e("1hJFm"),l=e("grZKR");function s(t,e,r,n){const{rendererJSON:i,isRGBRenderer:l}=t;let s=null,c=null;if(e&&l)s=e;else if(e&&"pointCloudUniqueValueRenderer"===i?.type){c=a.default.fromJSON(i);const t=c.colorUniqueValueInfos;s=new Uint8Array(3*n);const r=b(c.fieldTransformType);for(let o=0;o<n;o++){const n=(r?r(e[o]):e[o])+"";for(let e=0;e<t.length;e++)if(t[e].values.includes(n)){s[3*o]=t[e].color.r,s[3*o+1]=t[e].color.g,s[3*o+2]=t[e].color.b;break}}}else if(e&&"pointCloudStretchRenderer"===i?.type){c=u.default.fromJSON(i);const t=c.stops;s=new Uint8Array(3*n);const r=b(c.fieldTransformType);for(let o=0;o<n;o++){const n=r?r(e[o]):e[o],u=t.length-1;if(n<t[0].value)s[3*o]=t[0].color.r,s[3*o+1]=t[0].color.g,s[3*o+2]=t[0].color.b;else if(n>=t[u].value)s[3*o]=t[u].color.r,s[3*o+1]=t[u].color.g,s[3*o+2]=t[u].color.b;else for(let e=1;e<t.length;e++)if(n<t[e].value){const r=(n-t[e-1].value)/(t[e].value-t[e-1].value);s[3*o]=t[e].color.r*r+t[e-1].color.r*(1-r),s[3*o+1]=t[e].color.g*r+t[e-1].color.g*(1-r),s[3*o+2]=t[e].color.b*r+t[e-1].color.b*(1-r);break}}}else if(e&&"pointCloudClassBreaksRenderer"===i?.type){c=o.default.fromJSON(i);const t=c.colorClassBreakInfos;s=new Uint8Array(3*n);const r=b(c.fieldTransformType);for(let o=0;o<n;o++){const n=r?r(e[o]):e[o];for(let e=0;e<t.length;e++)if(n>=t[e].minValue&&n<=t[e].maxValue){s[3*o]=t[e].color.r,s[3*o+1]=t[e].color.g,s[3*o+2]=t[e].color.b;break}}}else s=new Uint8Array(3*n).fill(255);if(r&&c&&c.colorModulation){const t=c.colorModulation.minValue,e=c.colorModulation.maxValue,o=.3;for(let u=0;u<n;u++){const n=r[u],a=n>=e?1:n<=t?o:o+(1-o)*(n-t)/(e-t);s[3*u]=a*s[3*u],s[3*u+1]=a*s[3*u+1],s[3*u+2]=a*s[3*u+2]}}return s}function c(t,e){if(null==t.encoding||""===t.encoding){const r=(0,i.createGeometryIndexFromSchema)(e,t);if(null==r.vertexAttributes.position)return;const n=(0,i.createTypedView)(e,r.vertexAttributes.position),o=r.header.fields,u=[o.offsetX,o.offsetY,o.offsetZ],a=[o.scaleX,o.scaleY,o.scaleZ],l=n.length/3,s=new Float64Array(3*l);for(let t=0;t<l;t++)s[3*t]=n[3*t]*a[0]+u[0],s[3*t+1]=n[3*t+1]*a[1]+u[1],s[3*t+2]=n[3*t+2]*a[2]+u[2];return s}if("lepcc-xyz"===t.encoding)return(0,l.decodeXYZ)(e).result}function f(t,e,r){return null!=t&&t.attributeInfo.useElevation?e?function(t,e){const r=new Float64Array(e);for(let n=0;n<e;n++)r[n]=t[3*n+2];return r}(e,r):null:null!=t&&t.attributeInfo.storageInfo?(0,i.readBinaryAttribute)(t.attributeInfo.storageInfo,t.buffer,r):null}function d(t,e,r,n,o){const u=t.length/3;let a=0;for(let i=0;i<u;i++){let u=!0;for(let t=0;t<n.length&&u;t++){const{filterJSON:e}=n[t],r=o[t].values[i];switch(e.type){case"pointCloudValueFilter":{const t="exclude"===e.mode;e.values.includes(r)===t&&(u=!1);break}case"pointCloudBitfieldFilter":{const t=p(e.requiredSetBits),n=p(e.requiredClearBits);(r&t)===t&&0==(r&n)||(u=!1);break}case"pointCloudReturnFilter":{const t=15&r,n=r>>>4&15,o=n>1,a=1===t,i=t===n;let l=!1;for(const t of e.includedReturns)if("last"===t&&i||"firstOfMany"===t&&a&&o||"lastOfMany"===t&&i&&o||"single"===t&&!o){l=!0;break}l||(u=!1);break}}}u&&(r[a]=i,t[3*a]=t[3*i],t[3*a+1]=t[3*i+1],t[3*a+2]=t[3*i+2],e[3*a]=e[3*i],e[3*a+1]=e[3*i+1],e[3*a+2]=e[3*i+2],a++)}return a}function b(t){switch(t){default:case null:case"none":return t=>t;case"low-four-bit":return t=>15&t;case"high-four-bit":return t=>(240&t)>>4;case"absolute-value":return t=>Math.abs(t);case"modulo-ten":return t=>t%10}}function p(t){let e=0;for(const r of t||[])e|=1<<r;return e}})),e.register("44Q9I",(function(e,r){var n,o;t(e.exports,"VertexAttribute",(function(){return n})),(o=n||(n={})).POSITION="position",o.NORMAL="normal",o.NORMALCOMPRESSED="normalCompressed",o.UV0="uv0",o.AUXPOS1="auxpos1",o.AUXPOS2="auxpos2",o.COLOR="color",o.SYMBOLCOLOR="symbolColor",o.SIZE="size",o.TANGENT="tangent",o.OFFSET="offset",o.SUBDIVISIONFACTOR="subdivisionFactor",o.COLORFEATUREATTRIBUTE="colorFeatureAttribute",o.SIZEFEATUREATTRIBUTE="sizeFeatureAttribute",o.OPACITYFEATUREATTRIBUTE="opacityFeatureAttribute",o.DISTANCETOSTART="distanceToStart",o.UVMAPSPACE="uvMapSpace",o.BOUNDINGRECT="boundingRect",o.UVREGION="uvRegion",o.PROFILERIGHT="profileRight",o.PROFILEUP="profileUp",o.PROFILEVERTEXANDNORMAL="profileVertexAndNormal",o.FEATUREVALUE="featureValue",o.MODELORIGINHI="modelOriginHi",o.MODELORIGINLO="modelOriginLo",o.MODEL="model",o.MODELNORMAL="modelNormal",o.INSTANCECOLOR="instanceColor",o.INSTANCEFEATUREATTRIBUTE="instanceFeatureAttribute",o.LOCALTRANSFORM="localTransform",o.GLOBALTRANSFORM="globalTransform",o.BOUNDINGSPHERE="boundingSphere",o.MODELORIGIN="modelOrigin",o.MODELSCALEFACTORS="modelScaleFactors",o.FEATUREATTRIBUTE="featureAttribute",o.STATE="state",o.LODLEVEL="lodLevel",o.POSITION0="position0",o.POSITION1="position1",o.NORMALA="normalA",o.NORMALB="normalB",o.COMPONENTINDEX="componentIndex",o.VARIANTOFFSET="variantOffset",o.VARIANTSTROKE="variantStroke",o.VARIANTEXTENSION="variantExtension",o.U8PADDING="u8padding",o.U16PADDING="u16padding",o.SIDENESS="sideness",o.START="start",o.END="end",o.UP="up",o.EXTRUDE="extrude",o.OBJECTANDLAYERIDCOLOR="objectAndLayerIdColor",o.INSTANCEOBJECTANDLAYERIDCOLOR="instanceObjectAndLayerIdColor"}));
//# sourceMappingURL=PointCloudWorker.3c874456.js.map
