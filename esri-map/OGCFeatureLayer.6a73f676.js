!function(){function e(e){return e&&e.__esModule?e.default:e}function t(e,t,r,n){Object.defineProperty(e,t,{get:r,set:n,enumerable:!0,configurable:!0})}var r=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire594f;r.register("eyh26",(function(n,o){var i;i=n.exports,Object.defineProperty(i,"__esModule",{value:!0,configurable:!0}),t(n.exports,"default",(function(){return A}));var a=r("8TSCy"),s=r("2TvXO"),p=r("7eJjO");r("2ILM8");var l=r("3MVX3");r("35mRC"),r("fqK5H"),r("hHJvn"),r("aOUND"),r("7Kl6r"),r("fPYaT"),r("aRUMT"),r("lubf9");var u=r("9ulmN"),c=r("8NioF"),d=r("iho5X");r("lNwWH"),r("2VlWd"),r("iJAIC");var y=r("fcwIv"),f=r("7LVgC"),v=r("4LDxK"),g=r("f0EIx"),m=r("jy0BF"),h=r("gIXJ2"),S=r("cv2jJ"),b=r("6bOVn"),x=r("5N5S1"),_=r("gkEnw"),R=r("9bAYR"),w=r("13Qxf"),I=r("3GzOb"),O=r("2t08e"),k=r("gRgX5"),T=r("bkDoB"),C=r("hRnYX"),F=r("buMuJ"),D=r("ko0sb"),P=r("7vTUY"),j=r("aYrEX"),E=r("gtLRH"),L=r("cRlei"),q=r("37qRo"),G=r("gINRd"),M=r("j40xv"),J=(0,D.defineFieldProperties)(),N=function(t){"use strict";a.inherits(n,t);var r=a.createSuper(n);function n(e){var t;return a.classCallCheck(this,n),(t=r.call(this,e)).collectionId=null,t.copyright=null,t.definitionExpression=null,t.description=null,t.displayField=null,t.elevationInfo=null,t.featureReduction=null,t.fields=null,t.fieldsIndex=null,t.fullExtent=null,t.geometryType=null,t.hasZ=void 0,t.labelingInfo=null,t.labelsVisible=!0,t.legendEnabled=!0,t.objectIdField=null,t.operationalLayerType="OGCFeatureLayer",t.popupEnabled=!0,t.popupTemplate=null,t.screenSizePerspectiveEnabled=!0,t.source=new(0,g.default)({layer:a.assertThisInitialized(t)}),t.spatialReference=null,t.title=null,t.type="ogc-feature",t.typeIdField=null,t.types=null,t.url=null,a.possibleConstructorReturn(t)}return a.createClass(n,[{key:"destroy",value:function(){var e;null==(e=this.source)||e.destroy()}},{key:"load",value:function(e){var t=this;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["OGCFeatureServer"]},e).then((function(){return t._fetchService(e)}))),this.when()}},{key:"defaultPopupTemplate",get:function(){return this.createPopupTemplate()}},{key:"isTable",get:function(){return this.loaded&&null==this.geometryType}},{key:"renderer",set:function(e){(0,P.fixRendererFields)(e,this.fieldsIndex),this._set("renderer",e)}},{key:"on",value:function(e,t){return a.get(a.getPrototypeOf(n.prototype),"on",this).call(this,e,t)}},{key:"createPopupTemplate",value:function(e){return(0,q.createPopupTemplate)(this,e)}},{key:"createQuery",value:function(){return new(0,L.default)}},{key:"getField",value:function(e){return this.fieldsIndex.get(e)}},{key:"getFieldDomain",value:function(e,t){var r,n,o=this,i=!1,a=null==t||null==(r=t.feature)?void 0:r.attributes,s=this.typeIdField&&(null==a?void 0:a[this.typeIdField]);return null!=s&&this.types&&(i=this.types.some((function(t){var r,i;return t.id==s&&("inherited"===(null==(i=n=null==(r=t.domains)?void 0:r[e])?void 0:i.type)&&(n=o._getLayerDomain(e)),!0)}))),i||n||(n=this._getLayerDomain(e)),n}},{key:"queryFeatures",value:function(e,t){var r=this;return this.load().then((function(){return r.source.queryFeatures(L.default.from(e)||r.createQuery(),t)})).then((function(e){var t,n=r;return null==e||null==(t=e.features)||t.forEach((function(e){e.layer=e.sourceLayer=n})),e}))}},{key:"serviceSupportsSpatialReference",value:function(e){var t,r;return null!=(t=null==(r=this.source)?void 0:r.serviceSupportsSpatialReference(e))&&t}},{key:"_fetchService",value:function(t){var r=this;return a.asyncToGenerator(e(s).mark((function n(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.source.load(t);case 2:r.read(r.source.featureDefinition,{origin:"service"}),(0,P.fixRendererFields)(r.renderer,r.fieldsIndex),(0,P.fixTimeInfoFields)(r.timeInfo,r.fieldsIndex);case 5:case"end":return e.stop()}}),n)})))()}},{key:"_getLayerDomain",value:function(e){if(!this.fields)return null;var t=!0,r=!1,n=void 0;try{for(var o,i=this.fields[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;if(a.name===e&&a.domain)return a.domain}}catch(e){r=!0,n=e}finally{try{t||null==i.return||i.return()}finally{if(r)throw n}}return null}}]),n}((0,m.APIKeyMixin)((0,S.CustomParametersMixin)((0,b.FeatureEffectLayer)((0,h.BlendLayer)((0,_.OrderedLayer)((0,O.TemporalLayer)((0,I.ScaleRangeLayer)((0,x.OperationalLayer)((0,R.PortalLayer)((0,w.RefreshableLayer)((0,c.MultiOriginJSONMixin)(v.default))))))))))));(0,p._)([(0,d.property)({readOnly:!0,json:{origins:{service:{read:!0}}}})],N.prototype,"capabilities",void 0),(0,p._)([(0,d.property)({type:String,json:{write:!0}})],N.prototype,"collectionId",void 0),(0,p._)([(0,d.property)({type:String})],N.prototype,"copyright",void 0),(0,p._)([(0,d.property)({readOnly:!0})],N.prototype,"defaultPopupTemplate",null),(0,p._)([(0,d.property)({type:String})],N.prototype,"definitionExpression",void 0),(0,p._)([(0,d.property)({readOnly:!0,type:String,json:{origins:{service:{name:"collection.description"}}}})],N.prototype,"description",void 0),(0,p._)([(0,d.property)({type:String})],N.prototype,"displayField",void 0),(0,p._)([(0,d.property)(k.elevationInfo)],N.prototype,"elevationInfo",void 0),(0,p._)([(0,d.property)(T.featureReductionProperty)],N.prototype,"featureReduction",void 0),(0,p._)([(0,d.property)({type:[F.default],json:{origins:{service:{name:"layerDefinition.fields"}}}})],N.prototype,"fields",void 0),(0,p._)([(0,d.property)(J.fieldsIndex)],N.prototype,"fieldsIndex",void 0),(0,p._)([(0,d.property)({readOnly:!0,type:G.default,json:{origins:{service:{name:"layerDefinition.extent"}}}})],N.prototype,"fullExtent",void 0),(0,p._)([(0,d.property)({type:f.featureGeometryTypeKebabDictionary.apiValues,json:{origins:{service:{name:"layerDefinition.geometryType",read:{reader:f.featureGeometryTypeKebabDictionary.read}}}}})],N.prototype,"geometryType",void 0),(0,p._)([(0,d.property)({type:Boolean,json:{origins:{service:{name:"layerDefinition.hasZ"}}}})],N.prototype,"hasZ",void 0),(0,p._)([(0,d.property)({type:Boolean,readOnly:!0})],N.prototype,"isTable",null),(0,p._)([(0,d.property)({type:[j.default],json:{origins:{"web-document":{name:"layerDefinition.drawingInfo.labelingInfo",read:{reader:E.reader},write:!0}}}})],N.prototype,"labelingInfo",void 0),(0,p._)([(0,d.property)(k.labelsVisible)],N.prototype,"labelsVisible",void 0),(0,p._)([(0,d.property)(k.legendEnabled)],N.prototype,"legendEnabled",void 0),(0,p._)([(0,d.property)({type:String,json:{origins:{service:{name:"layerDefinition.objectIdField"}}}})],N.prototype,"objectIdField",void 0),(0,p._)([(0,d.property)({type:["OGCFeatureLayer"]})],N.prototype,"operationalLayerType",void 0),(0,p._)([(0,d.property)(k.popupEnabled)],N.prototype,"popupEnabled",void 0),(0,p._)([(0,d.property)({type:l.default,json:{name:"popupInfo",write:!0}})],N.prototype,"popupTemplate",void 0),(0,p._)([(0,d.property)({types:u.rendererTypes,json:{origins:{service:{name:"layerDefinition.drawingInfo.renderer",write:!1},"web-scene":{types:u.webSceneRendererTypes,name:"layerDefinition.drawingInfo.renderer",write:!0}},name:"layerDefinition.drawingInfo.renderer",write:!0}})],N.prototype,"renderer",null),(0,p._)([(0,d.property)(k.screenSizePerspectiveEnabled)],N.prototype,"screenSizePerspectiveEnabled",void 0),(0,p._)([(0,d.property)({readOnly:!0})],N.prototype,"source",void 0),(0,p._)([(0,d.property)({readOnly:!0,type:M.default,json:{origins:{service:{read:!0}}}})],N.prototype,"spatialReference",void 0),(0,p._)([(0,d.property)({type:String,json:{write:{enabled:!0,ignoreOrigin:!0,isRequired:!0},origins:{service:{name:"collection.title"}}}})],N.prototype,"title",void 0),(0,p._)([(0,d.property)({readOnly:!0,json:{read:!1}})],N.prototype,"type",void 0),(0,p._)([(0,d.property)({type:String,readOnly:!0})],N.prototype,"typeIdField",void 0),(0,p._)([(0,d.property)({type:[C.default]})],N.prototype,"types",void 0),(0,p._)([(0,d.property)(k.url)],N.prototype,"url",void 0);var A=N=(0,p._)([(0,y.subclass)("esri.layers.OGCFeatureLayer")],N)})),r.register("f0EIx",(function(n,o){t(n.exports,"default",(function(){return h}));var i=r("8TSCy"),a=r("2TvXO"),s=r("7eJjO");r("2ILM8");var p=r("kyj08"),l=r("bQCqB"),u=r("7qybv"),c=r("iho5X");r("lNwWH"),r("2VlWd"),r("iJAIC");var d=r("fcwIv"),y=r("1xeva"),f=r("f4h86"),v=r("j40xv"),g=r("7LVgC"),m=function(t){"use strict";i.inherits(n,t);var r=i.createSuper(n);function n(){var e;return i.classCallCheck(this,n),(e=r.call.apply(r,[this].concat(Array.prototype.slice.call(arguments)))).featureDefinition=null,e.type="ogc-feature",i.possibleConstructorReturn(e)}return i.createClass(n,[{key:"load",value:function(e){return this.addResolvingPromise(this._loadOGCServices(this.layer,e)),this.when()}},{key:"getFeatureDefinition",value:function(){var e=this.featureDefinition,t=e.collection,r=e.layerDefinition,n=e.spatialReference,o=e.supportedCrs,i=this.layer,a=i.apiKey;return{capabilities:i.capabilities,collection:t,layerDefinition:r,queryParameters:{apiKey:a,customParameters:i.customParameters},spatialReference:n,supportedCrs:o}}},{key:"queryExtent",value:function(e){return null}},{key:"queryFeatureCount",value:function(e){return null}},{key:"queryFeatures",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.queryFeaturesJSON(e,t).then((function(e){return f.default.fromJSON(e)}))}},{key:"queryFeaturesJSON",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.getFeatureDefinition();return this.load(t).then((function(){return(0,y.queryFeatureSetJSON)(r,e,t)}))}},{key:"queryObjectIds",value:function(e){return null}},{key:"serviceSupportsSpatialReference",value:function(e){return!(!e.isWGS84&&!e.isWebMercator&&!this.featureDefinition.supportedCrs[e.wkid])}},{key:"_conformsToType",value:function(e,t){var r,n=new RegExp("^".concat(t,"$"),"i");return null!=(r=e.conformsTo.some((function(e){return n.test(e)})))&&r}},{key:"_getCapabilities",value:function(e,t){var r,n,o,i,a,s,p,l=(0,u.isSome)(t)?null==(r=t.components)?void 0:r.parameters:null;return{attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:e},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:!1,supportsDelete:!1,supportsEditing:!1,supportsChangeTracking:!1,supportsQuery:!1,supportsQueryAttachments:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:!1,supportsExceedsLimitStatistics:!1},query:{maxRecordCount:null!=(n=null!=(o=null==l||null==(i=l.limit)||null==(a=i.schema)?void 0:a.maximum)?o:null==l||null==(s=l.limitFeatures)||null==(p=s.schema)?void 0:p.maximum)?n:5e3,maxRecordCountFactor:void 0,standardMaxRecordCount:void 0,supportsCacheHint:!1,supportsCentroid:!1,supportsDisjointSpatialRelationship:!1,supportsDistance:!1,supportsDistinct:!1,supportsExtent:!1,supportsFormatPBF:!1,supportsGeometryProperties:!1,supportsHavingClause:!1,supportsHistoricMoment:!1,supportsMaxRecordCountFactor:!1,supportsOrderBy:!1,supportsPagination:!1,supportsPercentileStatistics:!1,supportsQuantization:!1,supportsQuantizationEditMode:!1,supportsQueryByOthers:!1,supportsQueryGeometry:!1,supportsResultType:!1,supportsStandardizedQueriesOnly:!1,supportsTopFeaturesQuery:!1,supportsStatistics:!1,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsDefaultSpatialReference:!1,supportsCompactGeometry:!1,supportsSqlExpression:!1,tileMaxRecordCount:void 0},queryRelated:{supportsCount:!1,supportsOrderBy:!1,supportsPagination:!1},editing:{supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsGeometryUpdate:!1,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsUploadWithItemId:!1,supportsUpdateWithoutM:!1}}}},{key:"_getExtent",value:function(e){var t,r=null==(t=e.extent)?void 0:t.spatial;if(!r)return null;var n=r.bbox[0],o=4===n.length,i=n[0],a=n[1],s=o?void 0:n[2];return{xmin:i,ymin:a,xmax:o?n[2]:n[3],ymax:o?n[3]:n[4],zmin:s,zmax:o?void 0:n[5],spatialReference:v.default.WGS84.toJSON()}}},{key:"_getStorageSpatialReference",value:function(e){var t,r=null!=(t=e.storageCrs)?t:y.crsDefault,n=(0,y.getSpatialReferenceWkid)(r);return(0,u.isNone)(n)?v.default.WGS84:new(0,v.default)({wkid:n})}},{key:"_getSupportedSpatialReferences",value:function(e,t){var r,n="#/crs",o=null!=(r=e.crs)?r:[y.crsDefault],i=o.includes(n)?o.filter((function(e){return e!==n})).concat(t.crs):o,a=/^http:\/\/www\.opengis.net\/def\/crs\/epsg\/.*\/3785$/i;return i.filter((function(e){return!a.test(e)}))}},{key:"_loadOGCServices",value:function(t,r){var n=this;return i.asyncToGenerator(e(a).mark((function o(){var s,l,c,d,f,v,m,h,S,b,x,_,R,w,I,O,k,T,C,F,D,P,j,E,L,q,G,M,J,N,A,B;return e(a).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=(0,u.isSome)(r)?r.signal:null,l=t.apiKey,c=t.collectionId,d=t.customParameters,f=t.fields,v=t.geometryType,m=t.hasZ,h=t.objectIdField,S=t.timeInfo,b=t.url,x={fields:null==f?void 0:f.map((function(e){return e.toJSON()})),geometryType:g.typeKebabDictionary.toJSON(v),hasZ:m,objectIdField:h,timeInfo:null==S?void 0:S.toJSON()},_={apiKey:l,customParameters:d,signal:s},e.next=14,(0,y.getServerLandingPage)(b,_);case 14:return R=e.sent,e.t0=i,e.next=18,Promise.all([(0,y.getServerConformance)(R,_),(0,y.getServerCollections)(R,_)]);case 18:if(e.t1=e.sent,w=e.t0.slicedToArray.call(e.t0,e.t1,2),I=w[0],O=w[1],n._conformsToType(I,"http://www.opengis.net/spec/ogcapi-features-1/1.0/conf/geojson")){e.next=24;break}throw new(0,p.default)("ogc-feature-layer:no-geojson-support","Server does not support geojson");case 24:if(k=O.collections.find((function(e){return e.id===c}))){e.next=27;break}throw new(0,p.default)("ogc-feature-layer:collection-not-found","Server does not contain the named collection");case 27:if(!n._conformsToType(I,"http://www.opengis.net/spec/ogcapi-features-1/1.0/conf/oas30")){e.next=33;break}return e.next=30,(0,y.getServerOpenApi)(R,_);case 30:e.t2=e.sent,e.next=34;break;case 33:e.t2=null;case 34:return T=e.t2,e.next=37,(0,y.getCollectionDefinition)(k,x,_);case 37:for(C=e.sent,F=n._getCapabilities(C.hasZ,T),D=n._getExtent(k),P=n._getStorageSpatialReference(k).toJSON(),j=n._getSupportedSpatialReferences(k,O),E=new RegExp("^".concat(y.crsPrefix),"i"),L={},q=!0,G=!1,M=void 0,e.prev=45,J=j[Symbol.iterator]();!(q=(N=J.next()).done);q=!0)A=N.value,B=(0,y.getSpatialReferenceWkid)(A),(0,u.isSome)(B)&&(L[B]||(L[B]=A.replace(E,"")));e.next=53;break;case 49:e.prev=49,e.t3=e.catch(45),G=!0,M=e.t3;case 53:e.prev=53,e.prev=54,q||null==J.return||J.return();case 56:if(e.prev=56,!G){e.next=59;break}throw M;case 59:return e.finish(56);case 60:return e.finish(53);case 61:C.extent=D,n.featureDefinition={capabilities:F,collection:k,layerDefinition:C,queryParameters:{},spatialReference:P,supportedCrs:L};case 62:case"end":return e.stop()}}),o,null,[[45,49,53,61],[54,,56,60]])})))()}}]),n}(l.default);(0,s._)([(0,c.property)()],m.prototype,"featureDefinition",void 0),(0,s._)([(0,c.property)({constructOnly:!0})],m.prototype,"layer",void 0),(0,s._)([(0,c.property)()],m.prototype,"type",void 0);var h=m=(0,s._)([(0,d.subclass)("esri.layers.graphics.sources.OGCFeatureSource")],m)}))}();
//# sourceMappingURL=OGCFeatureLayer.6a73f676.js.map
