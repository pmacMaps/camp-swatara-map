function e(e,t,n,a){Object.defineProperty(e,t,{get:n,set:a,enumerable:!0,configurable:!0})}var t=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire594f;t.register("cup7R",(function(n,a){e(n.exports,"summaryStatistics",(function(){return r})),e(n.exports,"uniqueValues",(function(){return o})),e(n.exports,"classBreaks",(function(){return s})),e(n.exports,"histogram",(function(){return u}));var l=t("g1TFa"),i=t("i3NJS");async function r(e){const{attribute:t,features:n}=e,{normalizationType:a,normalizationField:r,minValue:o,maxValue:s,fieldType:u}=t,c=await(0,l.getDataValues)({field:t.field,valueExpression:t.valueExpression,normalizationType:a,normalizationField:r,normalizationTotal:t.normalizationTotal,viewInfoParams:t.viewInfoParams},n),f=(0,i.isNullCountSupported)({normalizationType:a,normalizationField:r,minValue:o,maxValue:s}),d={value:.5,fieldType:u},m="esriFieldTypeString"===u?(0,i.calculateStringStatistics)({values:c,supportsNullCount:f,percentileParams:d}):(0,i.calculateStatistics)({values:c,minValue:o,maxValue:s,useSampleStdDev:!a,supportsNullCount:f,percentileParams:d});return(0,i.processSummaryStatisticsResult)(m,"esriFieldTypeDate"===u)}async function o(e){const{attribute:t,features:n}=e,a=await(0,l.getDataValues)({field:t.field,valueExpression:t.valueExpression,viewInfoParams:t.viewInfoParams},n),r=(0,i.calculateUniqueValuesCount)(a);return(0,i.createUVResult)(r,t.domain,t.returnAllCodedValues)}async function s(e){const{attribute:t,features:n}=e,{field:a,normalizationType:r,normalizationField:o,normalizationTotal:s,classificationMethod:u}=t,c=await(0,l.getDataValues)({field:a,valueExpression:t.valueExpression,normalizationType:r,normalizationField:o,normalizationTotal:s,viewInfoParams:t.viewInfoParams},n),f=(0,i.calculateClassBreaks)(c,{field:a,normalizationType:r,normalizationField:o,normalizationTotal:s,classificationMethod:u,standardDeviationInterval:t.standardDeviationInterval,numClasses:t.numClasses,minValue:t.minValue,maxValue:t.maxValue});return(0,i.resolveCBResult)(f,u)}async function u(e){const{attribute:t,features:n}=e,{field:a,normalizationType:r,normalizationField:o,normalizationTotal:s,classificationMethod:u}=t,c=await(0,l.getDataValues)({field:a,valueExpression:t.valueExpression,normalizationType:r,normalizationField:o,normalizationTotal:s,viewInfoParams:t.viewInfoParams},n);return(0,i.calculateHistogram)(c,{field:a,normalizationType:r,normalizationField:o,normalizationTotal:s,classificationMethod:u,standardDeviationInterval:t.standardDeviationInterval,numBins:t.numBins,minValue:t.minValue,maxValue:t.maxValue})}})),t.register("g1TFa",(function(n,a){e(n.exports,"getDataValues",(function(){return s}));t("bPmsI"),t("1CpCt");var l=t("jaaCV"),i=(t("15IfA"),t("i3NJS")),r=t("QiKdE");let o=null;async function s(e,t){if(!t)return[];const n=e.field,a=e.valueExpression,s=e.normalizationType,u=e.normalizationField,c=e.normalizationTotal,f=[],d=e.viewInfoParams;let m=null,p=null;if(a){if(!o){const{arcadeUtils:e}=await(0,r.loadArcade)();o=e}m=o.createFunction(a),p=d&&o.getViewInfo({viewingMode:d.viewingMode,scale:d.scale,spatialReference:new(0,l.default)(d.spatialReference)})}return t.forEach((e=>{const t=e.attributes;let l;if(a){const t=o.createExecContext(e,p);l=o.executeFunction(m,t)}else t&&(l=t[n]);if(s&&isFinite(l)){const e=t&&parseFloat(t[u]);l=(0,i.getNormalizedValue)(l,s,e,c)}f.push(l)})),f}})),t.register("i3NJS",(function(n,a){e(n.exports,"isNullCountSupported",(function(){return c})),e(n.exports,"calculateStringStatistics",(function(){return f})),e(n.exports,"calculatePercentile",(function(){return m})),e(n.exports,"calculateStatistics",(function(){return d})),e(n.exports,"getAttributeComparator",(function(){return p})),e(n.exports,"processSummaryStatisticsResult",(function(){return y})),e(n.exports,"calculateUniqueValuesCount",(function(){return b})),e(n.exports,"createUVResult",(function(){return V})),e(n.exports,"getNormalizedValue",(function(){return g})),e(n.exports,"calculateClassBreaks",(function(){return x})),e(n.exports,"resolveCBResult",(function(){return T})),e(n.exports,"calculateHistogram",(function(){return z}));var l=t("kTdXv"),i=t("3iKpt");const r="equal-interval",o=/\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi,s=new Set(["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]),u=["min","max","avg","stddev","count","sum","variance","nullcount","median"];function c(e){const t=null!=e.normalizationField||null!=e.normalizationType,n=null!=e.minValue||null!=e.maxValue,a=!!e.sqlExpression&&e.supportsSQLExpression;return!t&&!n&&!a}function f(e){const t=e.returnDistinct?[...new Set(e.values)]:e.values,n=t.filter((e=>null!=e)).length,a={count:n};return e.supportsNullCount&&(a.nullcount=t.length-n),e.percentileParams&&(a.median=m(t,e.percentileParams)),a}function d(e){const{values:t,useSampleStdDev:n,supportsNullCount:a}=e;let l=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,r=null,o=null,s=null,u=null,c=0;const f=null==e.minValue?-1/0:e.minValue,d=null==e.maxValue?1/0:e.maxValue;for(const e of t)Number.isFinite(e)?e>=f&&e<=d&&(r+=e,l=Math.min(l,e),i=Math.max(i,e),c++):"string"==typeof e&&c++;if(c&&null!=r){o=r/c;let e=0;for(const n of t)Number.isFinite(n)&&n>=f&&n<=d&&(e+=(n-o)**2);u=n?c>1?e/(c-1):0:c>0?e/c:0,s=Math.sqrt(u)}else l=null,i=null;const p={avg:o,count:c,max:i,min:l,stddev:s,sum:r,variance:u};return a&&(p.nullcount=t.length-c),e.percentileParams&&(p.median=m(t,e.percentileParams)),p}function m(e,t){const{fieldType:n,value:a,orderBy:l,isDiscrete:i}=t,r=p(n,"desc"===l);if(0===(e=[...e].filter((e=>null!=e)).sort(((e,t)=>r(e,t)))).length)return null;if(a<=0)return e[0];if(a>=1)return e[e.length-1];const o=(e.length-1)*a,s=Math.floor(o),u=s+1,c=o%1,f=e[s],d=e[u];return u>=e.length||i||"string"==typeof f||"string"==typeof d?f:f*(1-c)+d*c}function p(e,t){const n=t?1:-1,a=t?(e,t)=>t-e:(e,t)=>e-t,l=v(t);if(!e||!["esriFieldTypeDate","esriFieldTypeString","esriFieldTypeGUID","esriFieldTypeGlobalID",...s].includes(e))return(e,t)=>"number"==typeof e&&"number"==typeof t?a(e,t):"string"==typeof e&&"string"==typeof t?l(e,t):n;if("esriFieldTypeDate"===e)return(e,t)=>{const l=new Date(e).getTime(),i=new Date(t).getTime();return isNaN(l)||isNaN(i)?n:a(l,i)};if(s.has(e))return(e,t)=>a(e,t);if("esriFieldTypeString"===e)return(e,t)=>l(e,t);if("esriFieldTypeGUID"===e||"esriFieldTypeGlobalID"===e){const e=v(t);return(t,n)=>e(h(t),h(n))}return t?(e,t)=>1:(e,t)=>-1}function v(e){return e?(e,t)=>{var n,a;return(e=null==(n=e)?void 0:n.toUpperCase())>(t=null==(a=t)?void 0:a.toUpperCase())?-1:e<t?1:0}:(e,t)=>{var n,a;return(e=null==(n=e)?void 0:n.toUpperCase())<(t=null==(a=t)?void 0:a.toUpperCase())?-1:e>t?1:0}}function h(e){return e.substr(24,12)+e.substr(19,4)+e.substr(16,2)+e.substr(14,2)+e.substr(11,2)+e.substr(9,2)+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)+e.substr(0,2)}function y(e,t){let n;for(n in e)u.indexOf(n)>-1&&(Number.isFinite(e[n])||(e[n]=null));return t?(["avg","stddev","variance"].forEach((t=>{null!=e[t]&&(e[t]=Math.ceil(e[t]))})),e):e}function b(e){const t={};for(let n of e)(null==n||"string"==typeof n&&""===n.trim())&&(n=null),null==t[n]?t[n]={count:1,data:n}:t[n].count++;return{count:t}}function V(e,t,n){const a=e.count,l=[];n&&t&&"coded-value"===t.type&&t.codedValues.forEach((e=>{const t=e.code;a.hasOwnProperty(t)||(a[t]={data:t,count:0})}));for(const e in a){const t=a[e];l.push({value:t.data,count:t.count,label:t.label})}return{uniqueValueInfos:l}}function g(e,t,n,a){let l=null;switch(t){case"log":0!==e&&(l=Math.log(e)*Math.LOG10E);break;case"percent-of-total":Number.isFinite(a)&&0!==a&&(l=e/a*100);break;case"field":Number.isFinite(n)&&0!==n&&(l=e/n);break;case"natural-log":e>0&&(l=Math.log(e));break;case"square-root":e>0&&(l=e**.5)}return l}function x(e,t){const n=function(e){const t=e.field,n=e.classificationMethod||r,a=e.normalizationType,i=e.normalizationField,o=new(0,l.default);return o.classificationField=t,o.breakCount=e.breakCount,o.classificationMethod=n,o.standardDeviationInterval="standard-deviation"===n?e.standardDeviationInterval||1:void 0,o.normalizationType=a,o.normalizationField="field"===a?i:void 0,o}({field:t.field,normalizationType:t.normalizationType,normalizationField:t.normalizationField,classificationMethod:t.classificationMethod,standardDeviationInterval:t.standardDeviationInterval,breakCount:t.numClasses||5});return a=e,o=t.minValue,s=t.maxValue,o=null==o?-1/0:o,s=null==s?1/0:s,e=a.filter((e=>Number.isFinite(e)&&e>=o&&e<=s)),(0,i.createGenerateRendererClassBreaks)({definition:n,values:e,normalizationTotal:t.normalizationTotal});var a,o,s}function T(e,t){let n=e.classBreaks;const a=n.length,l=n[0].minValue,i=n[a-1].maxValue,r="standard-deviation"===t,s=o;return n=n.map((e=>{const t=e.label,n={minValue:e.minValue,maxValue:e.maxValue,label:t};if(r&&t){const e=t.match(s).map((e=>+e.trim()));2===e.length?(n.minStdDev=e[0],n.maxStdDev=e[1],e[0]<0&&e[1]>0&&(n.hasAvg=!0)):1===e.length&&(t.includes("<")?(n.minStdDev=null,n.maxStdDev=e[0]):t.includes(">")&&(n.minStdDev=e[0],n.maxStdDev=null))}return n})),{minValue:l,maxValue:i,classBreakInfos:n,normalizationTotal:e.normalizationTotal}}function z(e,t){const{min:n,max:a,intervals:l}=function(e,t){const{field:n,classificationMethod:a,standardDeviationInterval:l,normalizationType:i,normalizationField:r,normalizationTotal:o,minValue:s,maxValue:u}=t,f=t.numBins||10;let m=null,p=null,v=null;if(a&&"equal-interval"!==a||i){const{classBreaks:t}=x(e,{field:n,normalizationType:i,normalizationField:r,normalizationTotal:o,classificationMethod:a,standardDeviationInterval:l,minValue:s,maxValue:u,numClasses:f});m=t[0].minValue,p=t[t.length-1].maxValue,v=t.map((e=>[e.minValue,e.maxValue]))}else{if(null!=s&&null!=u)m=s,p=u;else{const t=d({values:e,minValue:s,maxValue:u,useSampleStdDev:!i,supportsNullCount:c({normalizationType:i,normalizationField:r,minValue:s,maxValue:u})});m=t.min,p=t.max}v=function(e,t,n){const a=(t-e)/n,l=[];let i,r=e;for(let e=1;e<=n;e++)i=r+a,i=Number(i.toFixed(16)),l.push([r,e===n?t:i]),r=i;return l}(m,p,f)}return{min:m,max:p,intervals:v}}(e,t),i=l.map(((e,t)=>({minValue:l[t][0],maxValue:l[t][1],count:0})));for(const t of e)if(null!=t&&t>=n&&t<=a){const e=F(l,t);e>-1&&i[e].count++}return{bins:i,minValue:n,maxValue:a,normalizationTotal:t.normalizationTotal}}function F(e,t){let n=-1;for(let a=e.length-1;a>=0;a--)if(t>=e[a][0]){n=a;break}return n}})),t.register("kTdXv",(function(n,a){e(n.exports,"default",(function(){return d}));var l=t("j6uz9"),i=t("4jlRt"),r=t("hTI69");t("aX9sh"),t("5HTPH"),t("gHCNy");var o=t("qA6zg"),s=t("i9mpV");const u=new(0,i.JSONMap)({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"}),c=new(0,i.JSONMap)({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});let f=class extends s.default{set standardDeviationInterval(e){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",e)}set definedInterval(e){"defined-interval"===this.classificationMethod&&this._set("definedInterval",e)}constructor(){super(...arguments),this.breakCount=null,this.classificationField=null,this.classificationMethod=null,this.normalizationField=null,this.normalizationType=null,this.type="class-breaks-definition"}};(0,l._)([(0,r.property)({json:{write:!0}})],f.prototype,"breakCount",void 0),(0,l._)([(0,r.property)({json:{write:!0}})],f.prototype,"classificationField",void 0),(0,l._)([(0,r.property)({type:String,json:{read:u.read,write:u.write}})],f.prototype,"classificationMethod",void 0),(0,l._)([(0,r.property)({json:{write:!0}})],f.prototype,"normalizationField",void 0),(0,l._)([(0,r.property)({json:{read:c.read,write:c.write}})],f.prototype,"normalizationType",void 0),(0,l._)([(0,r.property)({value:null,json:{write:!0}})],f.prototype,"standardDeviationInterval",null),(0,l._)([(0,r.property)({value:null,json:{write:!0}})],f.prototype,"definedInterval",null),(0,l._)([(0,r.property)()],f.prototype,"type",void 0),f=(0,l._)([(0,o.subclass)("esri.rest.support.ClassBreaksDefinition")],f);const d=f})),t.register("i9mpV",(function(n,a){e(n.exports,"default",(function(){return m}));var l=t("j6uz9"),i=t("4jlRt"),r=t("hO0an"),o=t("hTI69");t("aX9sh"),t("5HTPH"),t("gHCNy");var s=t("qA6zg"),u=t("iahGk"),c=t("jnD7B");const f=new(0,i.JSONMap)({classBreaksDef:"class-breaks-definition",uniqueValueDef:"unique-value-definition"});let d=class extends r.JSONSupport{constructor(){super(...arguments),this.baseSymbol=null,this.colorRamp=null,this.type=null}};(0,l._)([(0,o.property)({type:c.default,json:{write:!0}})],d.prototype,"baseSymbol",void 0),(0,l._)([(0,o.property)({types:u.types,json:{read:{reader:u.fromJSON},write:!0}})],d.prototype,"colorRamp",void 0),(0,l._)([(0,o.property)({json:{read:f.read,write:f.write}})],d.prototype,"type",void 0),d=(0,l._)([(0,s.subclass)("esri.rest.support.ClassificationDefinition")],d);const m=d})),t.register("3iKpt",(function(t,n){function a(e,t){return Number(e.toFixed(t))}function l(e){const{normalizationTotal:t}=e;return{classBreaks:i(e),normalizationTotal:t}}function i(e){const t=e.definition,{classificationMethod:n,breakCount:l,normalizationType:i,definedInterval:c}=t,f=[];let d=e.values;if(0===d.length)return[];d=d.sort(((e,t)=>e-t));const m=d[0],p=d[d.length-1];if("equal-interval"===n)if(d.length>=l){const e=(p-m)/l;let t=m;for(let n=1;n<l;n++){const l=a(m+n*e,6);f.push({minValue:t,maxValue:l,label:r(t,l,i)}),t=l}f.push({minValue:t,maxValue:p,label:r(t,p,i)})}else d.forEach((e=>{f.push({minValue:e,maxValue:e,label:r(e,e,i)})}));else if("natural-breaks"===n){const t=o(d),n=e.valueFrequency||t.valueFrequency,c=function(e,t,n){const a=e.length,l=[];n>a&&(n=a);for(let e=0;e<n;e++)l.push(Math.round(e*a/n-1));l.push(a-1);let i=s(l,e,t,n);return function(e,t,n,a,l,i){let r=0,o=0,s=0,c=0,f=!0;for(let d=0;d<2&&f;d++){0===d&&(f=!1);for(let d=0;d<i-1;d++)for(;n[d+1]+1!==n[d+2];){n[d+1]=n[d+1]+1;const i=u(d,n,a,l);s=i.sbMean,r=i.sbSdcm;const m=u(d+1,n,a,l);if(c=m.sbMean,o=m.sbSdcm,!(r+o<t[d]+t[d+1])){n[d+1]=n[d+1]-1;break}t[d]=r,t[d+1]=o,e[d]=s,e[d+1]=c,f=!0}for(let d=i-1;d>0;d--)for(;n[d]!==n[d-1]+1;){n[d]=n[d]-1;const i=u(d-1,n,a,l);s=i.sbMean,r=i.sbSdcm;const m=u(d,n,a,l);if(c=m.sbMean,o=m.sbSdcm,!(r+o<t[d-1]+t[d])){n[d]=n[d]+1;break}t[d-1]=r,t[d]=o,e[d-1]=s,e[d]=c,f=!0}}return f}(i.mean,i.sdcm,l,e,t,n)&&(i=s(l,e,t,n)),l}(t.uniqueValues,n,l);let v=m;for(let e=1;e<l;e++)if(t.uniqueValues.length>e){const n=a(t.uniqueValues[c[e]],6);f.push({minValue:v,maxValue:n,label:r(v,n,i)}),v=n}f.push({minValue:v,maxValue:p,label:r(v,p,i)})}else if("quantile"===n)if(d.length>=l&&m!==p){let e=m,t=Math.ceil(d.length/l),n=0;for(let a=1;a<l;a++){let o=t+n-1;o>d.length&&(o=d.length-1),o<0&&(o=0),f.push({minValue:e,maxValue:d[o],label:r(e,d[o],i)}),e=d[o],n+=t,t=Math.ceil((d.length-n)/(l-a))}f.push({minValue:e,maxValue:p,label:r(e,p,i)})}else{let e=-1;for(let t=0;t<d.length;t++){const n=d[t];n!==e&&(e=n,f.push({minValue:e,maxValue:n,label:r(e,n,i)}),e=n)}}else if("standard-deviation"===n){const e=function(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n];return t/=e.length,t}(d),t=function(e,t){let n=0;for(let a=0;a<e.length;a++){const l=e[a];n+=(l-t)*(l-t)}return n/=e.length,Math.sqrt(n)}(d,e);if(0===t)f.push({minValue:d[0],maxValue:d[0],label:r(d[0],d[0],i)});else{const n=function(e,t,n,a,l){let i=Math.max(a-e,t-a)/l/n;return i=i>=1?1:i>=.5?.5:.25,i}(m,p,l,e,t)*t;let o=0,s=m;for(let t=l;t>=1;t--){const l=a(e-(t-.5)*n,6);f.push({minValue:s,maxValue:l,label:r(s,l,i)}),s=l,o++}let u=a(e+.5*n,6);f.push({minValue:s,maxValue:u,label:r(s,u,i)}),s=u,o++;for(let t=1;t<=l;t++)u=o===2*l?p:a(e+(t+.5)*n,6),f.push({minValue:s,maxValue:u,label:r(s,u,i)}),s=u,o++}}else if("defined-interval"===n){if(!c)return f;const e=d[0],t=d[d.length-1],n=Math.ceil((t-e)/c);let l=e;for(let t=1;t<n;t++){const n=a(e+t*c,6);f.push({minValue:l,maxValue:n,label:r(l,n,i)}),l=n}f.push({minValue:l,maxValue:t,label:r(l,t,i)})}return f}function r(e,t,n){let a=null;return a=e===t?n&&"percent-of-total"===n?e+"%":e.toString():n&&"percent-of-total"===n?e+"% - "+t+"%":e+" - "+t,a}function o(e){const t=[],n=[];let a=Number.MIN_VALUE,l=1,i=-1;for(let r=0;r<e.length;r++){const o=e[r];o===a?(l++,n[i]=l):null!==o&&(t.push(o),a=o,l=1,n.push(l),i++)}return{uniqueValues:t,valueFrequency:n}}function s(e,t,n,a){let l=[],i=[],r=[],o=0;const s=[],c=[];for(let l=0;l<a;l++){const a=u(l,e,t,n);s.push(a.sbMean),c.push(a.sbSdcm),o+=c[l]}let f,d=o,m=!0;for(;m||o<d;){m=!1,l=[];for(let t=0;t<a;t++)l.push(e[t]);for(let n=0;n<a;n++)for(let l=e[n]+1;l<=e[n+1];l++)if(f=t[l],n>0&&l!==e[n+1]&&Math.abs(f-s[n])>Math.abs(f-s[n-1]))e[n]=l;else if(n<a-1&&e[n]!==l-1&&Math.abs(f-s[n])>Math.abs(f-s[n+1])){e[n+1]=l-1;break}d=o,o=0,i=[],r=[];for(let l=0;l<a;l++){i.push(s[l]),r.push(c[l]);const a=u(l,e,t,n);s[l]=a.sbMean,c[l]=a.sbSdcm,o+=c[l]}}if(o>d){for(let t=0;t<a;t++)e[t]=l[t],s[t]=i[t],c[t]=r[t];o=d}return{mean:s,sdcm:c}}function u(e,t,n,a){let l=0,i=0;for(let r=t[e]+1;r<=t[e+1];r++){const e=a[r];l+=n[r]*e,i+=e}i<=0&&console.log("Exception in Natural Breaks calculation");const r=l/i;let o=0;for(let l=t[e]+1;l<=t[e+1];l++)o+=a[l]*(n[l]-r)**2;return{sbMean:r,sbSdcm:o}}e(t.exports,"createGenerateRendererClassBreaks",(function(){return l}))}));
//# sourceMappingURL=statsWorker.fd49a5bb.js.map
