!function(){function e(e){return e&&e.__esModule?e.default:e}function t(e,t,r,a){Object.defineProperty(e,t,{get:r,set:a,enumerable:!0,configurable:!0})}var r=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire594f;r.register("6SArv",(function(a,n){var i;i=a.exports,Object.defineProperty(i,"__esModule",{value:!0,configurable:!0}),t(a.exports,"default",(function(){return q}));var o=r("8TSCy"),l=r("2TvXO"),y=r("7eJjO");r("2ILM8");var u=r("bsvXr");r("cM5QQ");var s=r("d2yMj"),p=r("kyj08"),c=r("flPLJ"),f=r("7qybv"),d=r("8NioF"),v=r("8EPEw"),m=r("lfedQ"),b=r("iho5X");r("iJAIC");var h=r("eB8sj"),g=r("fcwIv"),S=r("kced1"),w=r("7RvA5"),O=r("5On35"),x=r("eY5Yp"),N=r("g15Jq"),_=r("3JXcy"),k=r("4LDxK"),C=r("cUpg2"),L=r("gIXJ2"),J=r("5N5S1"),M=r("9bAYR"),T=r("3GzOb"),I=r("buMuJ"),j=r("SVQ32"),R=r("e6bLq"),P=r("ioNzP"),G=r("d2yGf"),E=r("j40xv"),D=r("gINRd");function F(e){return e.layers.some((function(e){return null!=e.layerDefinition.visibilityField}))}var A=new(0,I.default)({name:"OBJECTID",alias:"OBJECTID",type:"oid",nullable:!1,editable:!1}),z=new(0,I.default)({name:"title",alias:"Title",type:"string",nullable:!0,editable:!0}),X=function(e){"use strict";o.inherits(r,e);var t=o.createSuper(r);function r(){var e;return o.classCallCheck(this,r),(e=t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments)))).visibilityMode="inherited",o.possibleConstructorReturn(e)}return o.createClass(r,[{key:"initialize",value:function(){var e=this,t=!0,r=!1,a=void 0;try{for(var n,i=this.graphics[Symbol.iterator]();!(t=(n=i.next()).done);t=!0){n.value.sourceLayer=this.layer}}catch(e){r=!0,a=e}finally{try{t||null==i.return||i.return()}finally{if(r)throw a}}this.graphics.on("after-add",(function(t){t.item.sourceLayer=e.layer})),this.graphics.on("after-remove",(function(e){e.item.sourceLayer=null}))}},{key:"sublayers",get:function(){return this.graphics}}]),r}(_.default);(0,y._)([(0,b.property)({readOnly:!0})],X.prototype,"sublayers",null),(0,y._)([(0,b.property)()],X.prototype,"layer",void 0),(0,y._)([(0,b.property)({readOnly:!0})],X.prototype,"visibilityMode",void 0),X=(0,y._)([(0,g.subclass)("esri.layers.MapNotesLayer.MapNotesSublayer")],X);var W=[{geometryType:"polygon",geometryTypeJSON:"esriGeometryPolygon",layerId:"polygonLayer",title:"Polygons",identifyingSymbol:(new(0,j.default)).toJSON()},{geometryType:"polyline",geometryTypeJSON:"esriGeometryPolyline",layerId:"polylineLayer",title:"Polylines",identifyingSymbol:(new(0,R.default)).toJSON()},{geometryType:"multipoint",geometryTypeJSON:"esriGeometryMultipoint",layerId:"multipointLayer",title:"Multipoints",identifyingSymbol:(new(0,P.default)).toJSON()},{geometryType:"point",geometryTypeJSON:"esriGeometryPoint",layerId:"pointLayer",title:"Points",identifyingSymbol:(new(0,P.default)).toJSON()},{geometryType:"point",geometryTypeJSON:"esriGeometryPoint",layerId:"textLayer",title:"Text",identifyingSymbol:(new(0,G.default)).toJSON()}],B=function(t){"use strict";o.inherits(a,t);var r=o.createSuper(a);function a(e){var t;return o.classCallCheck(this,a),(t=r.call(this,e)).capabilities={operations:{supportsMapNotesEditing:!0}},t.featureCollections=null,t.featureCollectionJSON=null,t.featureCollectionType="notes",t.legendEnabled=!1,t.minScale=0,t.maxScale=0,t.spatialReference=E.default.WGS84,t.sublayers=new(0,s.default)(W.map((function(e){return new X({id:e.layerId,title:e.title,layer:o.assertThisInitialized(t)})}))),t.title="Map Notes",t.type="map-notes",t.visibilityMode="inherited",o.possibleConstructorReturn(t)}return o.createClass(a,[{key:"readCapabilities",value:function(e,t,r){return{operations:{supportsMapNotesEditing:!F(t)&&"portal-item"!==(null==r?void 0:r.origin)}}}},{key:"readFeatureCollections",value:function(e,t,r){if(!F(t))return null;var a=t.layers.map((function(e){var t=new(0,N.default);return t.read(e,r),t}));return new(0,s.default)({items:a})}},{key:"readLegacyfeatureCollectionJSON",value:function(e,t){return F(t)?(0,c.clone)(t.featureCollection):null}},{key:"readFullExtent",value:function(e,t){if(!t.layers.length||t.layers.every((function(e){return!e.layerDefinition.extent})))return new(0,D.default)({xmin:-180,ymin:-90,xmax:180,ymax:90,spatialReference:E.default.WGS84});var r=E.default.fromJSON(t.layers[0].layerDefinition.spatialReference);return t.layers.reduce((function(e,t){var r=t.layerDefinition.extent;return r?D.default.fromJSON(r).union(e):e}),new(0,D.default)({spatialReference:r}))}},{key:"readMinScale",value:function(e,t){var r=!0,a=!1,n=void 0;try{for(var i,o=t.layers[Symbol.iterator]();!(r=(i=o.next()).done);r=!0){var l=i.value;if(null!=l.layerDefinition.minScale)return l.layerDefinition.minScale}}catch(e){a=!0,n=e}finally{try{r||null==o.return||o.return()}finally{if(a)throw n}}return 0}},{key:"readMaxScale",value:function(e,t){var r=!0,a=!1,n=void 0;try{for(var i,o=t.layers[Symbol.iterator]();!(r=(i=o.next()).done);r=!0){var l=i.value;if(null!=l.layerDefinition.maxScale)return l.layerDefinition.maxScale}}catch(e){a=!0,n=e}finally{try{r||null==o.return||o.return()}finally{if(a)throw n}}return 0}},{key:"multipointLayer",get:function(){return this._findSublayer("multipointLayer")}},{key:"pointLayer",get:function(){return this._findSublayer("pointLayer")}},{key:"polygonLayer",get:function(){return this._findSublayer("polygonLayer")}},{key:"polylineLayer",get:function(){return this._findSublayer("polylineLayer")}},{key:"readSpatialReference",value:function(e,t){return t.layers.length?E.default.fromJSON(t.layers[0].layerDefinition.spatialReference):E.default.WGS84}},{key:"readSublayers",value:function(e,t,r){var a=this,n=function(e){var r,n=t.layers[e],o=n.layerDefinition,l=n.featureSet,y=null!=(r=o.geometryType)?r:l.geometryType,s=W.find((function(e){var t,r,a;return y===e.geometryTypeJSON&&(null==(t=o.drawingInfo)||null==(r=t.renderer)||null==(a=r.symbol)?void 0:a.type)===e.identifyingSymbol.type}));if(s){var p=new X({id:s.layerId,title:o.name,layer:a,graphics:l.features.map((function(e){var t=e.geometry,r=e.symbol,a=e.attributes,n=e.popupInfo;return u.default.fromJSON({attributes:a,geometry:t,symbol:r,popupTemplate:n})}))});i.push(p)}};if(F(t))return null;for(var i=[],o=0;o<t.layers.length;o++)n(o);return new(0,s.default)(i)}},{key:"writeSublayers",value:function(e,t,r,a){var n=this.minScale,i=this.maxScale;if(!(0,f.isNone)(e)){var o=e.some((function(e){return e.graphics.length>0}));if(this.capabilities.operations.supportsMapNotesEditing){var l=[],y=this.spatialReference.toJSON(),u=!0,s=!1,c=void 0,d=!0,m=!1,b=void 0;try{e:for(var h,g=e[Symbol.iterator]();!(d=(h=g.next()).done);d=!0){var S=h.value;try{for(var w,O=S.graphics[Symbol.iterator]();!(u=(w=O.next()).done);u=!0){var x=w.value;if((0,f.isSome)(x.geometry)){y=x.geometry.spatialReference.toJSON();break e}}}catch(e){s=!0,c=e}finally{try{u||null==O.return||O.return()}finally{if(s)throw c}}}}catch(e){m=!0,b=e}finally{try{d||null==g.return||g.return()}finally{if(m)throw b}}var N=!0,_=!1,k=void 0;try{for(var C,L=this,J=function(t,r){var o=r.value,u=e.find((function(e){return o.layerId===e.id}));L._writeMapNoteSublayer(l,u,o,n,i,y,a)},M=W[Symbol.iterator]();!(N=(C=M.next()).done);N=!0)J(0,C)}catch(e){_=!0,k=e}finally{try{N||null==M.return||M.return()}finally{if(_)throw k}}(0,v.setDeepValue)("featureCollection.layers",l,t)}else{var T;o&&(null==a||null==(T=a.messages)||T.push(new(0,p.default)("map-notes-layer:editing-not-supported","New map notes cannot be added to this layer")))}}}},{key:"textLayer",get:function(){return this._findSublayer("textLayer")}},{key:"load",value:function(e){return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Feature Collection"]},e)),Promise.resolve(this)}},{key:"read",value:function(e,t){"featureCollection"in e&&(e=(0,c.clone)(e),Object.assign(e,e.featureCollection)),o.get(o.getPrototypeOf(a.prototype),"read",this).call(this,e,t)}},{key:"beforeSave",value:function(){var t=this;return o.asyncToGenerator(e(l).mark((function r(){var a,n,i,o,y,u,s,p,c,d,v,m,b,h,g,S;return e(l).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,f.isNone)(t.sublayers)){e.next=2;break}return e.abrupt("return");case 2:a=null,n=[],i=!0,o=!1,y=void 0,u=!0,s=!1,p=void 0,e.prev=5,c=t.sublayers[Symbol.iterator]();case 7:if(u=(d=c.next()).done){e.next=47;break}v=d.value,e.prev=9,m=v.graphics[Symbol.iterator]();case 11:if(i=(b=m.next()).done){e.next=30;break}if(h=b.value,!(0,f.isSome)(h.geometry)){e.next=27;break}if(g=h.geometry,!a){e.next=25;break}if(e.t0=(0,x.equals)(g.spatialReference,a),e.t0){e.next=23;break}if(e.t1=(0,w.canProjectWithoutEngine)(g.spatialReference,a)||(0,w.isLoaded)(),e.t1){e.next=22;break}return e.next=22,(0,w.load)();case 22:h.geometry=(0,w.project)(g,a);case 23:e.next=26;break;case 25:a=g.spatialReference;case 26:n.push(h);case 27:i=!0,e.next=11;break;case 30:e.next=36;break;case 32:e.prev=32,e.t2=e.catch(9),o=!0,y=e.t2;case 36:e.prev=36,e.prev=37,i||null==m.return||m.return();case 39:if(e.prev=39,!o){e.next=42;break}throw y;case 42:return e.finish(39);case 43:return e.finish(36);case 44:u=!0,e.next=7;break;case 47:e.next=53;break;case 49:e.prev=49,e.t3=e.catch(5),s=!0,p=e.t3;case 53:e.prev=53,e.prev=54,u||null==c.return||c.return();case 56:if(e.prev=56,!s){e.next=59;break}throw p;case 59:return e.finish(56);case 60:return e.finish(53);case 61:return e.next=63,(0,O.normalizeCentralMeridian)(n.map((function(e){return e.geometry})));case 63:S=e.sent,n.forEach((function(e,t){return e.geometry=S[t]}));case 65:case"end":return e.stop()}}),r,null,[[5,49,53,61],[9,32,36,44],[37,,39,43],[54,,56,60]])})))()}},{key:"_findSublayer",value:function(e){var t,r;return(0,f.isNone)(this.sublayers)?null:null!=(t=null==(r=this.sublayers)?void 0:r.find((function(t){return t.id===e})))?t:null}},{key:"_writeMapNoteSublayer",value:function(e,t,r,a,n,i,o){var l=[];if(!(0,f.isNone)(t)){var y=!0,u=!1,s=void 0;try{for(var p,d=t.graphics[Symbol.iterator]();!(y=(p=d.next()).done);y=!0){var v=p.value;this._writeMapNote(l,v,r.geometryType,o)}}catch(e){u=!0,s=e}finally{try{y||null==d.return||d.return()}finally{if(u)throw s}}this._normalizeObjectIds(l,A),e.push({layerDefinition:{name:t.title,drawingInfo:{renderer:{type:"simple",symbol:(0,c.clone)(r.identifyingSymbol)}},geometryType:r.geometryTypeJSON,minScale:a,maxScale:n,objectIdField:"OBJECTID",fields:[A.toJSON(),z.toJSON()],spatialReference:i},featureSet:{features:l,geometryType:r.geometryTypeJSON}})}}},{key:"_writeMapNote",value:function(e,t,r,a){if(!(0,f.isNone)(t)){var n,i,l=t.geometry,y=t.symbol,u=t.popupTemplate;if(!(0,f.isNone)(l))if(l.type===r)if((0,f.isNone)(y))null==a||null==(i=a.messages)||i.push(new(0,m.default)("map-notes-layer:no-symbol","Skipping map notes with no symbol",{graphic:t}));else{var s={attributes:o.objectSpread({},t.attributes),geometry:l.toJSON(),symbol:y.toJSON()};(0,f.isSome)(u)&&(s.popupInfo=u.toJSON()),e.push(s)}else null==a||null==(n=a.messages)||n.push(new(0,m.default)("map-notes-layer:invalid-geometry-type",'Geometry "'.concat(l.type,'" cannot be saved in "').concat(r,'" layer'),{graphic:t}))}}},{key:"_normalizeObjectIds",value:function(e,t){var r=t.name,a=(0,C.findLastObjectIdFromFeatures)(r,e)+1,n=new Set,i=!0,o=!1,l=void 0;try{for(var y,u=e[Symbol.iterator]();!(i=(y=u.next()).done);i=!0){var s=y.value;s.attributes||(s.attributes={});var p=s.attributes;(null==p[r]||n.has(p[r]))&&(p[r]=a++),n.add(p[r])}}catch(e){o=!0,l=e}finally{try{i||null==u.return||u.return()}finally{if(o)throw l}}}}]),a}((0,L.BlendLayer)((0,T.ScaleRangeLayer)((0,J.OperationalLayer)((0,M.PortalLayer)((0,d.MultiOriginJSONMixin)(k.default))))));(0,y._)([(0,b.property)({readOnly:!0})],B.prototype,"capabilities",void 0),(0,y._)([(0,h.reader)(["portal-item","web-map"],"capabilities",["layers"])],B.prototype,"readCapabilities",null),(0,y._)([(0,b.property)({readOnly:!0})],B.prototype,"featureCollections",void 0),(0,y._)([(0,h.reader)(["web-map","portal-item"],"featureCollections",["layers"])],B.prototype,"readFeatureCollections",null),(0,y._)([(0,b.property)({readOnly:!0,json:{origins:{"web-map":{write:{enabled:!0,target:"featureCollection"}}}}})],B.prototype,"featureCollectionJSON",void 0),(0,y._)([(0,h.reader)(["web-map","portal-item"],"featureCollectionJSON",["featureCollection"])],B.prototype,"readLegacyfeatureCollectionJSON",null),(0,y._)([(0,b.property)({readOnly:!0,json:{read:!1,write:{enabled:!0,ignoreOrigin:!0}}})],B.prototype,"featureCollectionType",void 0),(0,y._)([(0,b.property)({json:{write:!1}})],B.prototype,"fullExtent",void 0),(0,y._)([(0,h.reader)(["web-map","portal-item"],"fullExtent",["layers"])],B.prototype,"readFullExtent",null),(0,y._)([(0,b.property)({readOnly:!0,json:{origins:{"web-map":{write:{target:"featureCollection.showLegend",overridePolicy:function(){return{enabled:null!=this.featureCollectionJSON}}}}}}})],B.prototype,"legendEnabled",void 0),(0,y._)([(0,b.property)({type:["show","hide"]})],B.prototype,"listMode",void 0),(0,y._)([(0,b.property)({type:Number,nonNullable:!0,json:{write:!1}})],B.prototype,"minScale",void 0),(0,y._)([(0,h.reader)(["web-map","portal-item"],"minScale",["layers"])],B.prototype,"readMinScale",null),(0,y._)([(0,b.property)({type:Number,nonNullable:!0,json:{write:!1}})],B.prototype,"maxScale",void 0),(0,y._)([(0,h.reader)(["web-map","portal-item"],"maxScale",["layers"])],B.prototype,"readMaxScale",null),(0,y._)([(0,b.property)({readOnly:!0})],B.prototype,"multipointLayer",null),(0,y._)([(0,b.property)({value:"ArcGISFeatureLayer",type:["ArcGISFeatureLayer"]})],B.prototype,"operationalLayerType",void 0),(0,y._)([(0,b.property)({readOnly:!0})],B.prototype,"pointLayer",null),(0,y._)([(0,b.property)({readOnly:!0})],B.prototype,"polygonLayer",null),(0,y._)([(0,b.property)({readOnly:!0})],B.prototype,"polylineLayer",null),(0,y._)([(0,b.property)({type:E.default})],B.prototype,"spatialReference",void 0),(0,y._)([(0,h.reader)(["web-map","portal-item"],"spatialReference",["layers"])],B.prototype,"readSpatialReference",null),(0,y._)([(0,b.property)({readOnly:!0,json:{origins:{"web-map":{write:{ignoreOrigin:!0}}}}})],B.prototype,"sublayers",void 0),(0,y._)([(0,h.reader)("web-map","sublayers",["layers"])],B.prototype,"readSublayers",null),(0,y._)([(0,S.writer)("web-map","sublayers")],B.prototype,"writeSublayers",null),(0,y._)([(0,b.property)({readOnly:!0})],B.prototype,"textLayer",null),(0,y._)([(0,b.property)()],B.prototype,"title",void 0),(0,y._)([(0,b.property)({readOnly:!0,json:{read:!1}})],B.prototype,"type",void 0);var q=B=(0,y._)([(0,g.subclass)("esri.layers.MapNotesLayer")],B)})),r.register("3JXcy",(function(e,a){t(e.exports,"default",(function(){return v}));var n=r("8TSCy"),i=r("7eJjO"),o=r("iho5X");r("lNwWH"),r("2VlWd"),r("iJAIC");var l=r("fcwIv"),y=r("cvNNH"),u=r("4LDxK"),s=r("gIXJ2"),p=r("3GzOb"),c=r("iWNhG"),f=r("h5vCg"),d=function(e){"use strict";n.inherits(r,e);var t=n.createSuper(r);function r(e){var a;return n.classCallCheck(this,r),(a=t.call(this,e)).elevationInfo=null,a.graphics=new(0,c.GraphicsCollection),a.screenSizePerspectiveEnabled=!0,a.type="graphics",a.internal=!1,n.possibleConstructorReturn(a)}return n.createClass(r,[{key:"destroy",value:function(){this.removeAll(),this.graphics.destroy()}},{key:"add",value:function(e){return this.graphics.add(e),this}},{key:"addMany",value:function(e){return this.graphics.addMany(e),this}},{key:"removeAll",value:function(){return this.graphics.removeAll(),this}},{key:"remove",value:function(e){this.graphics.remove(e)}},{key:"removeMany",value:function(e){this.graphics.removeMany(e)}},{key:"on",value:function(e,t){return n.get(n.getPrototypeOf(r.prototype),"on",this).call(this,e,t)}},{key:"graphicChanged",value:function(e){this.emit("graphic-update",e)}}]),r}((0,s.BlendLayer)((0,p.ScaleRangeLayer)(u.default)));(0,i._)([(0,o.property)({type:f.default})],d.prototype,"elevationInfo",void 0),(0,i._)([(0,o.property)((0,y.owningCollectionProperty)(c.GraphicsCollection,"graphics"))],d.prototype,"graphics",void 0),(0,i._)([(0,o.property)({type:["show","hide"]})],d.prototype,"listMode",void 0),(0,i._)([(0,o.property)()],d.prototype,"screenSizePerspectiveEnabled",void 0),(0,i._)([(0,o.property)({readOnly:!0})],d.prototype,"type",void 0),(0,i._)([(0,o.property)({constructOnly:!0})],d.prototype,"internal",void 0);var v=d=(0,i._)([(0,l.subclass)("esri.layers.GraphicsLayer")],d)})),r.register("cUpg2",(function(e,r){t(e.exports,"initialObjectId",(function(){return a})),t(e.exports,"findLastObjectIdFromFeatures",(function(){return n}));var a=1;function n(e,t){var r=0,a=!0,n=!1,i=void 0;try{for(var o,l=t[Symbol.iterator]();!(a=(o=l.next()).done);a=!0){var y,u=null==(y=o.value.attributes)?void 0:y[e];"number"==typeof u&&isFinite(u)&&(r=Math.max(r,u))}}catch(e){n=!0,i=e}finally{try{a||null==l.return||l.return()}finally{if(n)throw i}}return r}}))}();
//# sourceMappingURL=MapNotesLayer.46b106c3.js.map
