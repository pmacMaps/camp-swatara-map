!function(){function e(e){return e&&e.__esModule?e.default:e}function t(e,t,r,n){Object.defineProperty(e,t,{get:r,set:n,enumerable:!0,configurable:!0})}var r=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire594f;r.register("9Mf0w",(function(n,a){var i;i=n.exports,Object.defineProperty(i,"__esModule",{value:!0,configurable:!0}),t(n.exports,"default",(function(){return I}));var o=r("8TSCy"),s=r("2TvXO"),u=r("7eJjO"),l=r("6J0KG");r("kyj08");var c=r("2VlWd"),f=r("jHOLN"),p=r("7qybv"),y=r("10vEZ");r("iJAIC"),r("lNwWH"),r("62edV");var v=r("fcwIv"),h=r("9doMy"),x=r("j40xv"),d=r("ieqnL"),m=r("4rXhP"),g=r("7Vsyp"),b=r("iyMTk"),w=r("aZQjs"),S=r("4gcZA"),k=r("fUO9S"),_=r("3F9Uf");function T(e,t){return(!e.minScale||e.minScale>=t)&&(!e.maxScale||e.maxScale<=t)}function C(e){var t=e.message,r={message:{data:{},tileKey:t.tileKey,tileKeyOrigin:t.tileKeyOrigin},transferList:new Array};for(var n in t.data){var a=t.data[n];if(r.message.data[n]=null,(0,p.isSome)(a)){var i=a.stride,o=a.indices.slice(0),s=a.vertices.slice(0),u=a.records.slice(0),l={stride:i,indices:o,vertices:s,records:u,metrics:(0,p.applySome)(a.metrics,(function(e){return e.slice(0)}))};r.transferList.push(o,s,u),r.message.data[n]=l}}return r}f.default.getLogger("esri.views.2d.layers.features.processors.SymbolProcessor");var M=function(t){"use strict";o.inherits(n,t);var r=o.createSuper(n);function n(){var e;return o.classCallCheck(this,n),(e=r.call.apply(r,[this].concat(Array.prototype.slice.call(arguments)))).type="symbol",e._matchers={feature:null,aggregate:null},e._bufferData=new Map,e._bufferIds=new Map,o.possibleConstructorReturn(e)}return o.createClass(n,[{key:"initialize",value:function(){this.handles.add([this.tileStore.on("update",this.onTileUpdate.bind(this))]),this._resourceManagerProxy=new(0,_.default)(this.remoteClient)}},{key:"destroy",value:function(){this._resourceManagerProxy.destroy()}},{key:"supportsTileUpdates",get:function(){return!0}},{key:"forEachBufferId",value:function(e){this._bufferIds.forEach((function(t){t.forEach(e)}))}},{key:"update",value:function(t,r){var n=this;return o.asyncToGenerator(e(s).mark((function a(){var i,o;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("symbol"===(i=r.schema.processors[0]).type){e.next=3;break}return e.abrupt("return");case 3:o=(0,h.diff)(n._schema,i),(0,h.hasDiff)(o,"mesh")&&((0,c.default)("esri-2d-update-debug")&&console.debug("Applying Update - Processor:",o),t.mesh=!0,t.why.mesh.push("Symbology changed"),n._schema=i,n._factory=n._createFactory(i),n._factory.update(i,n.tileStore.tileScheme.tileInfo));case 5:case"end":return e.stop()}}),a)})))()}},{key:"onTileMessage",value:function(e,t,r,n){return(0,y.throwIfAborted)(n),this._onTileData(e,t,r,n)}},{key:"onTileClear",value:function(e){return this._bufferData.delete(e.key.id),this._bufferIds.delete(e.key.id),this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:e.id,data:{clear:!0}})}},{key:"onTileError",value:function(e,t,r){var n=r.signal,a={tileKey:e.id,error:t};return this.remoteClient.invoke("tileRenderer.onTileError",a,{signal:n})}},{key:"onTileUpdate",value:function(e){var t=this,r=!0,n=!1,a=void 0;try{for(var i,o=e.removed[Symbol.iterator]();!(r=(i=o.next()).done);r=!0){var s=i.value;this._bufferData.has(s.key.id)&&this._bufferData.delete(s.key.id),this._bufferIds.has(s.key.id)&&this._bufferIds.delete(s.key.id)}}catch(e){n=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(n)throw a}}var u=!0,l=!1,c=void 0;try{for(var f,p=this,y=function(e,r){var n=r.value;p._bufferData.forEach((function(e){var r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;u.message.tileKey===n.id&&t._updateTileMesh("append",n,C(u),[],!1,!1,null)}}catch(e){a=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}}))},v=e.added[Symbol.iterator]();!(u=(f=v.next()).done);u=!0)y(0,f)}catch(e){l=!0,c=e}finally{try{u||null==v.return||v.return()}finally{if(l)throw c}}}},{key:"_addBufferData",value:function(e,t){this._bufferData.has(e)||this._bufferData.set(e,[]),this._bufferData.get(e).push(C(t))}},{key:"_createFactory",value:function(e){var t=this,r=this.service,n=r.geometryType,a=r.objectIdField,i={geometryType:n,fields:r.fields,spatialReference:x.default.fromJSON(this.spatialReference)},o=new(0,b.WGLTemplateStore)((function(e,r){return t.remoteClient.invoke("tileRenderer.getMaterialItems",e,r)}),this.tileStore.tileScheme.tileInfo),s=e.mesh,u=s.matcher,l=s.aggregateMatcher;return this._store=o,this._matchers.feature=(0,w.createMatcher)(u,o,i,this._resourceManagerProxy),this._matchers.aggregate=(0,p.applySome)(l,(function(e){return(0,w.createMatcher)(e,o,i,t._resourceManagerProxy)})),new(0,g.WGLMeshFactory)(n,a,o)}},{key:"_onTileData",value:function(t,r,n,a){var i=this;return o.asyncToGenerator(e(s).mark((function o(){var u,l,c,f,v,h,x,d,m,g,b,w,S,k,_,T,C,M,I,L,P,A,R,O,Z,D,F,z;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,y.throwIfAborted)(a),u=r.type,l=r.addOrUpdate,c=r.remove,f=r.end,v=!!i._schema.mesh.sortKey,l){e.next=5;break}return h={type:u,addOrUpdate:null,remove:c,clear:!1,end:f,sort:v},e.abrupt("return",i.remoteClient.invoke("tileRenderer.onTileData",{tileKey:t.id,data:h},a));case 5:return x=i._processFeatures(t,l,n,a),e.prev=6,e.next=9,x;case 9:if(d=e.sent,!(0,p.isNone)(d)){e.next=13;break}return m={type:u,addOrUpdate:null,remove:c,clear:!1,end:f,sort:v},e.abrupt("return",i.remoteClient.invoke("tileRenderer.onTileData",{tileKey:t.id,data:m},a));case 13:g=[],b=!0,w=!1,S=void 0,e.prev=15,k=d[Symbol.iterator]();case 17:if(b=(_=k.next()).done){e.next=58;break}if(T=_.value,C=!1,M=T.message.bufferIds,I=t.key.id,L=T.message.tileKey,I===L||!(0,p.isSome)(M)){e.next=54;break}if(i.tileStore.get(L)){e.next=25;break}return i._addBufferData(I,T),g.push(T),e.abrupt("continue",55);case 25:(P=i._bufferIds.get(L))||(P=new Set,i._bufferIds.set(L,P)),A=Array.from(M),R=!0,O=!1,Z=void 0,e.prev=29,D=A[Symbol.iterator]();case 31:if(R=(F=D.next()).done){e.next=40;break}if(z=F.value,!P.has(z)){e.next=36;break}return C=!0,e.abrupt("break",40);case 36:P.add(z);case 37:R=!0,e.next=31;break;case 40:e.next=46;break;case 42:e.prev=42,e.t0=e.catch(29),O=!0,Z=e.t0;case 46:e.prev=46,e.prev=47,R||null==D.return||D.return();case 49:if(e.prev=49,!O){e.next=52;break}throw Z;case 52:return e.finish(49);case 53:return e.finish(46);case 54:C||(i._addBufferData(I,T),g.push(T));case 55:b=!0,e.next=17;break;case 58:e.next=64;break;case 60:e.prev=60,e.t1=e.catch(15),w=!0,S=e.t1;case 64:e.prev=64,e.prev=65,b||null==k.return||k.return();case 67:if(e.prev=67,!w){e.next=70;break}throw S;case 70:return e.finish(67);case 71:return e.finish(64);case 72:return e.next=74,(0,y.all)(g.map((function(e){var n=t.key.id===e.message.tileKey,o=n?r.remove:[],s=n&&r.end;return i._updateTileMesh(u,t,e,o,s,r.clear,a.signal)})));case 74:e.next=79;break;case 76:e.prev=76,e.t2=e.catch(6),i._handleError(t,e.t2,a);case 79:case"end":return e.stop()}}),o,null,[[6,76],[15,60,64,72],[29,42,46,54],[47,,49,53],[65,,67,71]])})))()}},{key:"_updateTileMesh",value:function(t,r,n,a,i,u,l){var c=this;return o.asyncToGenerator(e(s).mark((function o(){var u,f,v,h,x,d,m;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=t,f=n.message.tileKey,v=!!c._schema.mesh.sortKey,f!==r.key.id&&(i=!1),h=(0,p.applySome)(n,(function(e){return e.message})),x=(0,p.applySome)(n,(function(e){return e.transferList}))||[],d={type:u,addOrUpdate:h,remove:a,clear:!1,end:i,sort:v},m={transferList:(0,p.unwrap)(x)||[],signal:l},e.abrupt("return",((0,y.throwIfAborted)(m),c.remoteClient.invoke("tileRenderer.onTileData",{tileKey:f,data:d},m)));case 4:case"end":return e.stop()}}),o)})))()}},{key:"_processFeatures",value:function(t,r,n,a){var i=this;return o.asyncToGenerator(e(s).mark((function o(){var u,l,c,f,v,h;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,p.isNone)(r)&&r.hasFeatures){e.next=2;break}return e.abrupt("return",null);case 2:return u={transform:t.transform,hasZ:!1,hasM:!1},l=i._factory,c={viewingMode:"",scale:t.scale},e.next=7,i._matchers.feature;case 7:return f=e.sent,e.next=10,i._matchers.aggregate;case 10:return v=e.sent,(0,y.throwIfAborted)(a),h=i._getLabelInfos(t,r),e.next=15,l.analyze(r.getCursor(),i._resourceManagerProxy,f,v,u,c);case 15:return(0,y.throwIfAborted)(a),e.abrupt("return",(e.sent,i._writeFeatureSet(t,r,u,h,l,n)));case 17:case"end":return e.stop()}}),o)})))()}},{key:"_writeFeatureSet",value:function(e,t,r,n,a,i){for(var o=t.getSize(),s=new(0,m.MeshData)(e.key.id,{features:o,records:o,metrics:0},this._schema.mesh.matcher.stride,i,!0),u={viewingMode:"",scale:e.scale},l=t.getCursor();l.next();)try{var c=l.getDisplayId(),f=(0,p.isSome)(n)?n.get(c):null;a.writeCursor(s,l,r,u,e.level,f,this._resourceManagerProxy)}catch(e){}var y=e.tileInfoView.tileInfo.isWrappable;return s.serialize(y)}},{key:"_handleError",value:function(e,t,r){if(!(0,y.isAbortError)(t)){var n={tileKey:e.id,error:t.message};return this.remoteClient.invoke("tileRenderer.onTileError",n,{signal:r.signal})}}},{key:"_getLabelingSchemaForScale",value:function(e){var t=this._schema.mesh.labels;if((0,p.isNone)(t))return null;if("subtype"===t.type){var r={type:"subtype",classes:{}},n=!1;for(var a in t.classes){var i=t.classes[a].filter((function(t){return T(t,e.scale)}));n=n||!!i.length,r.classes[a]=i}return n?r:null}var o=t.classes.filter((function(t){return T(t,e.scale)}));return o.length?{type:"simple",classes:o}:null}},{key:"_getLabels",value:function(e,t){if("subtype"===t.type){var r,n=this.service.subtypeField,a=(0,p.unwrapOrThrow)(n,"Expected to find subtype Field"),i=e.readAttribute(a);return null==i?[]:null!=(r=t.classes[i])?r:[]}return t.classes}},{key:"_getLabelInfos",value:function(e,t){var r=this._getLabelingSchemaForScale(e);if((0,p.isNone)(r))return null;for(var n=new Map,a=t.getCursor();a.next();){var i=a.getDisplayId(),o=[],s=(0,d.isAggregateId)(i),u=s&&1!==a.readAttribute("cluster_count")?"aggregate":"feature",c=this._getLabels(a,r),f=!0,y=!1,v=void 0;try{for(var h,x=this,m=function(e,t){var r=t.value;if(r.target!==u)return"continue";var n=a.getStorage(),c=s&&"feature"===u?n.getComputedStringAtIndex(a.readAttribute("referenceId"),r.fieldIndex):n.getComputedStringAtIndex(i,r.fieldIndex);if(!c)return"continue";var f=(0,l.bidiText)(c.toString()),p=f[0],y=f[1];x._store.getMosaicItem(r.symbol,(0,S.codepoints)(p)).then((function(e){o[r.index]={glyphs:e.glyphMosaicItems,rtl:y,index:r.index}}))},g=c[Symbol.iterator]();!(f=(h=g.next()).done);f=!0)m(0,h)}catch(e){y=!0,v=e}finally{try{f||null==g.return||g.return()}finally{if(y)throw v}}n.set(i,o)}return n}}]),n}(k.default),I=M=(0,u._)([(0,v.subclass)("esri.views.2d.layers.features.processors.SymbolProcessor")],M)})),r.register("fUO9S",(function(e,n){t(e.exports,"default",(function(){return c}));var a=r("8TSCy"),i=r("7eJjO"),o=r("6dXDO"),s=r("iho5X");r("lNwWH"),r("2VlWd"),r("iJAIC");var u=r("fcwIv"),l=function(e){"use strict";a.inherits(r,e);var t=a.createSuper(r);function r(){return a.classCallCheck(this,r),t.apply(this,arguments)}return a.createClass(r,[{key:"initialize",value:function(){}},{key:"destroy",value:function(){}},{key:"supportsTileUpdates",get:function(){return!1}},{key:"spatialReference",get:function(){var e=this.get("tileStore.tileScheme.spatialReference");return e&&e.toJSON()||null}}]),r}(o.HandleOwner);(0,i._)([(0,s.property)({readOnly:!0})],l.prototype,"supportsTileUpdates",null),(0,i._)([(0,s.property)({constructOnly:!0})],l.prototype,"remoteClient",void 0),(0,i._)([(0,s.property)({constructOnly:!0})],l.prototype,"service",void 0),(0,i._)([(0,s.property)()],l.prototype,"spatialReference",null),(0,i._)([(0,s.property)({constructOnly:!0})],l.prototype,"tileInfo",void 0),(0,i._)([(0,s.property)({constructOnly:!0})],l.prototype,"tileStore",void 0);var c=l=(0,i._)([(0,u.subclass)("esri.views.2d.layers.features.processors.BaseProcessor")],l)})),r.register("3F9Uf",(function(n,a){t(n.exports,"default",(function(){return u}));var i=r("8TSCy"),o=r("2TvXO"),s=r("10vEZ"),u=function(){"use strict";function t(e){i.classCallCheck(this,t),this._remoteClient=e,this._resourceMap=new Map,this._inFlightResourceMap=new Map,this.geometryEngine=null}return i.createClass(t,[{key:"destroy",value:function(){}},{key:"fetchResource",value:function(t,r){var n=this;return i.asyncToGenerator(e(o).mark((function a(){var u,l,c;return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=n._resourceMap,!(l=u.get(t))){e.next=3;break}return e.abrupt("return",l);case 3:if(!(c=n._inFlightResourceMap.get(t))){e.next=6;break}return e.abrupt("return",c);case 6:e.prev=6,c=n._remoteClient.invoke("tileRenderer.fetchResource",{url:t},i.objectSpread({},r)),n._inFlightResourceMap.set(t,c),c.then((function(e){return n._inFlightResourceMap.delete(t),u.set(t,e),e})),e.next=13;break;case 10:return e.prev=10,e.t0=e.catch(6),e.abrupt("return",(0,s.isAbortError)(e.t0)?null:{width:0,height:0});case 13:return e.abrupt("return",c);case 14:case"end":return e.stop()}}),a,null,[[6,10]])})))()}},{key:"getResource",value:function(e){var t;return null!=(t=this._resourceMap.get(e))?t:null}}]),t}()})),r.register("6r3ht",(function(e,n){t(e.exports,"getPow2NeighborKey",(function(){return a}));r("2Z8dq");function a(e,t,r,n){var a=e.clone(),i=1<<a.level,o=a.col+t,s=a.row+r;return n&&o<0?(a.col=o+i,a.world-=1):o>=i?(a.col=o-i,a.world+=1):a.col=o,a.row=s,a}})),r.register("6S0qa",(function(e,r){var n,a,i,o;function s(e){switch(e){case"left":return n.Left;case"right":return n.Right;case"center":case"justify":return n.Center}}function u(e){switch(e){case"top":return a.Top;case"middle":return a.Center;case"baseline":return a.Baseline;case"bottom":return a.Bottom}}function l(e){switch(e){case"above-left":case"esriServerPointLabelPlacementAboveLeft":return[n.Right,a.Bottom];case"above-center":case"above-along":case"esriServerPointLabelPlacementAboveCenter":case"esriServerLinePlacementAboveAlong":return[n.Center,a.Bottom];case"above-right":case"esriServerPointLabelPlacementAboveRight":return[n.Left,a.Bottom];case"center-left":case"esriServerPointLabelPlacementCenterLeft":return[n.Right,a.Center];case"center-center":case"center-along":case"esriServerPointLabelPlacementCenterCenter":case"esriServerLinePlacementCenterAlong":case"always-horizontal":case"esriServerPolygonPlacementAlwaysHorizontal":return[n.Center,a.Center];case"center-right":case"esriServerPointLabelPlacementCenterRight":return[n.Left,a.Center];case"below-left":case"esriServerPointLabelPlacementBelowLeft":return[n.Right,a.Top];case"below-center":case"below-along":case"esriServerPointLabelPlacementBelowCenter":case"esriServerLinePlacementBelowAlong":return[n.Center,a.Top];case"below-right":case"esriServerPointLabelPlacementBelowRight":return[n.Left,a.Top];default:return console.debug("Found invalid placement type ".concat(e)),[n.Center,a.Center]}}function c(e){switch(e){case n.Right:return-1;case n.Center:return 0;case n.Left:return 1;default:return console.debug("Found invalid horizontal alignment ".concat(e)),0}}function f(e){switch(e){case a.Top:return 1;case a.Center:return 0;case a.Bottom:case a.Baseline:return-1;default:return console.debug("Found invalid vertical alignment ".concat(e)),0}}function p(e){switch(e){case"left":return n.Left;case"right":return n.Right;case"center":case"justify":return n.Center}}function y(e){switch(e){case"above-along":case"below-along":case"center-along":case"esriServerLinePlacementAboveAlong":case"esriServerLinePlacementBelowAlong":case"esriServerLinePlacementCenterAlong":return!0;default:return!1}}t(e.exports,"HAlign",(function(){return n})),t(e.exports,"VAlign",(function(){return a})),t(e.exports,"getXAnchorDirection",(function(){return s})),t(e.exports,"getYAnchorDirection",(function(){return u})),t(e.exports,"getAlignmentFromPlacement",(function(){return l})),t(e.exports,"getXDirection",(function(){return c})),t(e.exports,"getYDirection",(function(){return f})),t(e.exports,"getJustification",(function(){return p})),t(e.exports,"isMapAligned",(function(){return y})),(o=n||(n={}))[o.Left=-1]="Left",o[o.Center=0]="Center",o[o.Right=1]="Right",(i=a||(a={}))[i.Top=1]="Top",i[i.Center=0]="Center",i[i.Bottom=-1]="Bottom",i[i.Baseline=2]="Baseline"})),r.register("iTfMY",(function(e,r){t(e.exports,"radToByte",(function(){return s})),t(e.exports,"degToByte",(function(){return u})),t(e.exports,"log2",(function(){return l})),t(e.exports,"between",(function(){return c}));Number.POSITIVE_INFINITY;var n=Math.PI,a=128/n,i=1/Math.LN2;function o(e,t){return(e%=t)>=0?e:e+t}function s(e){return o(e*a,256)}function u(e){return o(.7111111111111111*e,256)}function l(e){return Math.log(e)*i}function c(e,t,r){return e>=t&&e<=r||e>=r&&e<=t}})),r.register("2ndsO",(function(e,r){t(e.exports,"e",(function(){return o}));var n,a,i={exports:{}};n=i,void 0!==(a=function(){function e(e,a,i){i=i||2;var o,s,l,f,p,v,h,x=a&&a.length,d=x?a[0]*i:e.length,m=t(e,0,d,i,!0),g=[];if(!m||m.next===m.prev)return g;if(x&&(m=function(e,n,a,i){var o,s,l,f=[];for(o=0,s=n.length;o<s;o++)(l=t(e,n[o]*i,o<s-1?n[o+1]*i:e.length,i,!1))===l.next&&(l.steiner=!0),f.push(y(l));for(f.sort(u),o=0;o<f.length;o++)a=r(a=c(f[o],a),a.next);return a}(e,a,m,i)),e.length>80*i){o=l=e[0],s=f=e[1];for(var b=i;b<d;b+=i)(p=e[b])<o&&(o=p),(v=e[b+1])<s&&(s=v),p>l&&(l=p),v>f&&(f=v);h=0!==(h=Math.max(l-o,f-s))?1/h:0}return n(m,g,i,o,s,h),g}function t(e,t,r,n,a){var i,o;if(a===C(e,t,r,n)>0)for(i=t;i<r;i+=n)o=k(i,e[i],e[i+1],o);else for(i=r-n;i>=t;i-=n)o=k(i,e[i],e[i+1],o);if(o&&d(o,o.next)){var s=o.next;_(o),o=s}return o}function r(e,t){if(!e)return e;t||(t=e);var r,n=e;do{if(r=!1,n.steiner||!d(n,n.next)&&0!==x(n.prev,n,n.next))n=n.next;else{var a=n.prev;if(_(n),(n=t=a)===n.next)break;r=!0}}while(r||n!==t);return t}function n(e,t,u,l,c,f,y){if(e){!y&&f&&function(e,t,r,n){var a=e;do{null===a.z&&(a.z=p(a.x,a.y,t,r,n)),a.prevZ=a.prev,a.nextZ=a.next,a=a.next}while(a!==e);a.prevZ.nextZ=null,a.prevZ=null,function(e){var t,r,n,a,i,o,s,u,l=1;do{for(r=e,e=null,i=null,o=0;r;){for(o++,n=r,s=0,t=0;t<l&&(s++,n=n.nextZ);t++);for(u=l;s>0||u>0&&n;)0!==s&&(0===u||!n||r.z<=n.z)?(a=r,r=r.nextZ,s--):(a=n,n=n.nextZ,u--),i?i.nextZ=a:e=a,a.prevZ=i,i=a;r=n}i.nextZ=null,l*=2}while(o>1)}(a)}(e,l,c,f);for(var v,h,x=e;e.prev!==e.next;)if(v=e.prev,h=e.next,f?i(e,l,c,f):a(e))t.push(v.i/u),t.push(e.i/u),t.push(h.i/u),_(e),e=h.next,x=h.next;else if((e=h)===x){y?1===y?n(e=o(r(e),t,u),t,u,l,c,f,2):2===y&&s(e,t,u,l,c,f):n(r(e),t,u,l,c,f,1);break}}}function a(e){var t=e.prev,r=e,n=e.next;if(x(t,r,n)>=0)return!1;for(var a=e.next.next;a!==e.prev;){if(v(t.x,t.y,r.x,r.y,n.x,n.y,a.x,a.y)&&x(a.prev,a,a.next)>=0)return!1;a=a.next}return!0}function i(e,t,r,n){var a=e.prev,i=e,o=e.next;if(x(a,i,o)>=0)return!1;for(var s=a.x<i.x?a.x<o.x?a.x:o.x:i.x<o.x?i.x:o.x,u=a.y<i.y?a.y<o.y?a.y:o.y:i.y<o.y?i.y:o.y,l=a.x>i.x?a.x>o.x?a.x:o.x:i.x>o.x?i.x:o.x,c=a.y>i.y?a.y>o.y?a.y:o.y:i.y>o.y?i.y:o.y,f=p(s,u,t,r,n),y=p(l,c,t,r,n),h=e.prevZ,d=e.nextZ;h&&h.z>=f&&d&&d.z<=y;){if(h!==e.prev&&h!==e.next&&v(a.x,a.y,i.x,i.y,o.x,o.y,h.x,h.y)&&x(h.prev,h,h.next)>=0)return!1;if(h=h.prevZ,d!==e.prev&&d!==e.next&&v(a.x,a.y,i.x,i.y,o.x,o.y,d.x,d.y)&&x(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;h&&h.z>=f;){if(h!==e.prev&&h!==e.next&&v(a.x,a.y,i.x,i.y,o.x,o.y,h.x,h.y)&&x(h.prev,h,h.next)>=0)return!1;h=h.prevZ}for(;d&&d.z<=y;){if(d!==e.prev&&d!==e.next&&v(a.x,a.y,i.x,i.y,o.x,o.y,d.x,d.y)&&x(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function o(e,t,n){var a=e;do{var i=a.prev,o=a.next.next;!d(i,o)&&m(i,a,a.next,o)&&w(i,o)&&w(o,i)&&(t.push(i.i/n),t.push(a.i/n),t.push(o.i/n),_(a),_(a.next),a=e=o),a=a.next}while(a!==e);return r(a)}function s(e,t,a,i,o,s){var u=e;do{for(var l=u.next.next;l!==u.prev;){if(u.i!==l.i&&h(u,l)){var c=S(u,l);return u=r(u,u.next),c=r(c,c.next),n(u,t,a,i,o,s),void n(c,t,a,i,o,s)}l=l.next}u=u.next}while(u!==e)}function u(e,t){return e.x-t.x}function l(e){if(e.next.prev===e)return e;for(var t=e;;){var r=t.next;if(r.prev===t||r===t||r===e)break;t=r}return t}function c(e,t){var n=function(e,t){var r,n=t,a=e.x,i=e.y,o=-1/0;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var s=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=a&&s>o){if(o=s,s===a){if(i===n.y)return n;if(i===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!r)return null;if(a===o)return r;var u,l=r,c=r.x,p=r.y,y=1/0;n=r;do{a>=n.x&&n.x>=c&&a!==n.x&&v(i<p?a:o,i,c,p,i<p?o:a,i,n.x,n.y)&&(u=Math.abs(i-n.y)/(a-n.x),w(n,e)&&(u<y||u===y&&(n.x>r.x||n.x===r.x&&f(r,n)))&&(r=n,y=u)),n=n.next}while(n!==l);return r}(e,t);if(!n)return t;var a=S(n,e),i=r(n,n.next),o=l(a);return r(o,o.next),i=l(i),l(t===n?i:t)}function f(e,t){return x(e.prev,e,t.prev)<0&&x(t.next,e,e.next)<0}function p(e,t,r,n,a){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*a)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*a)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function y(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function v(e,t,r,n,a,i,o,s){return(a-o)*(t-s)-(e-o)*(i-s)>=0&&(e-o)*(n-s)-(r-o)*(t-s)>=0&&(r-o)*(i-s)-(a-o)*(n-s)>=0}function h(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&m(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&(w(e,t)&&w(t,e)&&function(e,t){var r=e,n=!1,a=(e.x+t.x)/2,i=(e.y+t.y)/2;do{r.y>i!=r.next.y>i&&r.next.y!==r.y&&a<(r.next.x-r.x)*(i-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}(e,t)&&(x(e.prev,e,t.prev)||x(e,t.prev,t))||d(e,t)&&x(e.prev,e,e.next)>0&&x(t.prev,t,t.next)>0)}function x(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function d(e,t){return e.x===t.x&&e.y===t.y}function m(e,t,r,n){var a=b(x(e,t,r)),i=b(x(e,t,n)),o=b(x(r,n,e)),s=b(x(r,n,t));return a!==i&&o!==s||!(0!==a||!g(e,r,t))||!(0!==i||!g(e,n,t))||!(0!==o||!g(r,e,n))||!(0!==s||!g(r,t,n))}function g(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function b(e){return e>0?1:e<0?-1:0}function w(e,t){return x(e.prev,e,e.next)<0?x(e,t,e.next)>=0&&x(e,e.prev,t)>=0:x(e,t,e.prev)<0||x(e,e.next,t)<0}function S(e,t){var r=new T(e.i,e.x,e.y),n=new T(t.i,t.x,t.y),a=e.next,i=t.prev;return e.next=t,t.prev=e,r.next=a,a.prev=r,n.next=r,r.prev=n,i.next=n,n.prev=i,n}function k(e,t,r,n){var a=new T(e,t,r);return n?(a.next=n.next,a.prev=n,n.next.prev=a,n.next=a):(a.prev=a,a.next=a),a}function _(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function T(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function C(e,t,r,n){for(var a=0,i=t,o=r-n;i<r;i+=n)a+=(e[o]-e[i])*(e[i+1]+e[o+1]),o=i;return a}return e.deviation=function(e,t,r,n){var a=t&&t.length,i=a?t[0]*r:e.length,o=Math.abs(C(e,0,i,r));if(a)for(var s=0,u=t.length;s<u;s++){var l=t[s]*r,c=s<u-1?t[s+1]*r:e.length;o-=Math.abs(C(e,l,c,r))}var f=0;for(s=0;s<n.length;s+=3){var p=n[s]*r,y=n[s+1]*r,v=n[s+2]*r;f+=Math.abs((e[p]-e[v])*(e[y+1]-e[p+1])-(e[p]-e[y])*(e[v+1]-e[p+1]))}return 0===o&&0===f?0:Math.abs((f-o)/o)},e.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},n=0,a=0;a<e.length;a++){for(var i=0;i<e[a].length;i++)for(var o=0;o<t;o++)r.vertices.push(e[a][i][o]);a>0&&(n+=e[a-1].length,r.holes.push(n))}return r},e}())&&(n.exports=a);var o=i.exports})),r.register("2rjRQ",(function(n,a){t(n.exports,"expandSymbol",(function(){return p})),t(n.exports,"cimLayerToRasterizationInfo",(function(){return y}));var i,o=r("8TSCy"),s=r("2TvXO"),u=r("aNOUb"),l=r("f7bFM"),c=r("jfLVm"),f=(i=o.asyncToGenerator(e(s).mark((function t(r,n,a,i){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all(r.map((function(e){return p(e,n,a,i)}))));case 1:case"end":return e.stop()}}),t)}))),function(){var t=o.asyncToGenerator(e(s).mark((function t(r,n,a){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=l.ExpandedCIM,e.next=3,(0,u.analyzeCIMSymbol)(r.data,n,a);case 3:return e.t1=e.sent,e.t2=r.data,e.t3=r.rendererKey,e.t4=r.maxVVSize,e.abrupt("return",new e.t0(e.t1,e.t2,e.t3,e.t4));case 8:case"end":return e.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}()),p=function(){var t=o.asyncToGenerator(e(s).mark((function t(r,n,a,i){var o;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return",null);case 2:if("cim"!==r.type){e.next=4;break}return e.abrupt("return",f(r,n,a));case 4:if("web-style"!==r.type){e.next=12;break}return e.next=7,(0,c.fetchCIMSymbolReference)(r,null,i);case 7:return e.t0=e.sent,e.t1=r.rendererKey,e.t2=r.maxVVSize,o={type:"cim",data:e.t0,rendererKey:e.t1,maxVVSize:e.t2},e.abrupt("return",f(o,n,a));case 12:return e.abrupt("return",r);case 13:case"end":return e.stop()}}),t)})));return function(e,r,n,a){return t.apply(this,arguments)}}();function y(e){if(!e)return null;var t=e.type,r=e.cim,n=e.url,a={cim:r,type:t,mosaicHash:e.materialHash,url:n,size:null,dashTemplate:null,path:null,text:null,fontName:null};switch(t){case"marker":a.size=e.size,a.path=e.path;break;case"line":a.dashTemplate=e.dashTemplate;break;case"text":a.text=e.text,a.fontName=e.fontName}return a}})),r.register("f7bFM",(function(e,n){t(e.exports,"ExpandedCIM",(function(){return u}));var a=r("8TSCy"),i=r("66IJZ"),o=r("ktHf8"),s={marker:i.WGLGeometryType.MARKER,fill:i.WGLGeometryType.FILL,line:i.WGLGeometryType.LINE,text:i.WGLGeometryType.TEXT},u=function(){"use strict";function e(t,r,n,i){a.classCallCheck(this,e);var u,l={minScale:null==r?void 0:r.minScale,maxScale:null==r?void 0:r.maxScale},c=(u=l).minScale||u.maxScale?u.minScale+"-"+u.maxScale:"";this.layers=t,this.data=r,this.hash=this._createHash()+c,this.rendererKey=n;var f={isOutline:!1,isOutlinedFill:!1,placement:null,stride:{fill:"default"},vvFlags:n},p=!0,y=!1,v=void 0;try{for(var h,x=t[Symbol.iterator]();!(p=(h=x.next()).done);p=!0){var d=h.value,m=s[d.type];d.materialKey=(0,o.createMaterialKey)(m,f),d.maxVVSize=i,d.scaleInfo=l,d.templateHash+=c}}catch(e){y=!0,v=e}finally{try{p||null==x.return||x.return()}finally{if(y)throw v}}}return a.createClass(e,[{key:"type",get:function(){return"expanded-cim"}},{key:"_createHash",value:function(){var e="",t=!0,r=!1,n=void 0;try{for(var a,i=this.layers[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){e+=a.value.templateHash}}catch(e){r=!0,n=e}finally{try{t||null==i.return||i.return()}finally{if(r)throw n}}return e}}]),e}()})),r.register("jfLVm",(function(n,a){t(n.exports,"fetchCIMSymbolReference",(function(){return v}));var i=r("8TSCy"),o=r("2TvXO"),s=r("3gVHR"),u=r("kyj08"),l=r("10vEZ"),c=r("kYueh"),f=r("ajJOT"),p=r("9ELaA"),y=r("dmPQi");function v(e,t,r){return h.apply(this,arguments)}function h(){return(h=i.asyncToGenerator(e(o).mark((function t(r,n,a){return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.name){e.next=2;break}return e.abrupt("return",Promise.reject(new(0,u.default)("style-symbol-reference-name-missing","Missing name in style symbol reference")));case 2:if(!r.styleName||"Esri2DPointSymbolsStyle"!==r.styleName){e.next=4;break}return e.abrupt("return",x(r,a));case 4:return e.prev=4,e.t0=m,e.next=8,(0,y.fetchStyle)(r,n,a);case 8:return e.t1=e.sent,e.t2=r.name,e.t3=n,e.t4=a,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3,e.t4));case 15:return e.prev=15,e.t5=e.catch(4),e.abrupt("return",((0,l.throwIfAborted)(e.t5),null));case 18:case"end":return e.stop()}}),t,null,[[4,15]])})))).apply(this,arguments)}function x(e,t){return d.apply(this,arguments)}function d(){return(d=i.asyncToGenerator(e(o).mark((function t(r,n){var a,i;return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=y.Style2DUrlTemplate.replace(/\{SymbolName\}/gi,r.name),e.prev=1,e.next=4,(0,y.requestJSON)(a,n);case 4:return i=e.sent,e.abrupt("return",(0,y.makeCIMSymbolRef)(i.data));case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",((0,l.throwIfAborted)(e.t0),null));case 11:case"end":return e.stop()}}),t,null,[[1,8]])})))).apply(this,arguments)}function m(e,t,r,n){return g.apply(this,arguments)}function g(){return(g=i.asyncToGenerator(e(o).mark((function t(r,n,a,i){var v,h,x,d,m;return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v=r.data,h={portal:a&&a.portal||f.default.getDefault(),url:(0,c.urlToObject)(r.baseUrl),origin:"portal-item"},x=v.items.find((function(e){return e.name===n}))){e.next=3;break}throw new(0,u.default)("symbolstyleutils:symbol-name-not-found","The symbol name '".concat(n,"' could not be found"),{symbolName:n});case 3:return d=(0,p.f)((0,y.symbolUrlFromStyleItem)(x,"cimRef"),h),(0,s.isDevEnvironment)()&&(d=(0,s.adjustStaticAGOUrl)(d)),e.prev=5,e.next=8,(0,y.requestJSON)(d,i);case 8:return m=e.sent,e.abrupt("return",(0,y.makeCIMSymbolRef)(m.data));case 12:return e.prev=12,e.t0=e.catch(5),e.abrupt("return",((0,l.throwIfAborted)(e.t0),null));case 15:case"end":return e.stop()}}),t,null,[[5,12]])})))).apply(this,arguments)}}))}();
//# sourceMappingURL=SymbolProcessor.1111cbc2.js.map
