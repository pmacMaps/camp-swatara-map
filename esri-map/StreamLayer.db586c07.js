!function(){function e(e){return e&&e.__esModule?e.default:e}function r(e,r,t,o){Object.defineProperty(e,r,{get:t,set:o,enumerable:!0,configurable:!0})}var t=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire594f;t.register("fnoLH",(function(o,n){var i;i=o.exports,Object.defineProperty(i,"__esModule",{value:!0,configurable:!0}),r(o.exports,"default",(function(){return ee}));var a=t("8TSCy"),l=t("2TvXO"),p=t("7eJjO");t("2ILM8");var s=t("3MVX3");t("35mRC"),t("fqK5H"),t("hHJvn"),t("aOUND"),t("7Kl6r");var d=t("fPYaT"),u=t("aRUMT"),y=t("lubf9"),c=t("9ulmN"),f=t("9pNSx"),v=t("cM5QQ"),m=t("kyj08"),b=t("jHOLN"),g=t("7qybv"),S=t("8NioF"),h=t("10vEZ"),w=t("iho5X");t("lNwWH"),t("2VlWd");var I=t("iJAIC"),_=t("eB8sj"),x=t("fcwIv"),T=t("bVD6V"),R=t("7LVgC"),k=t("4LDxK"),j=t("aLy89"),O=t("gIXJ2"),N=t("cv2jJ"),P=t("6bOVn"),L=t("5N5S1"),C=t("9bAYR"),F=t("13Qxf"),E=t("3GzOb"),D=t("2t08e"),J=t("gRgX5"),A=t("bkDoB"),V=t("ko0sb"),G=t("7vTUY"),M=t("aYrEX"),U=t("gtLRH"),X=t("hETxd"),q=t("2TQQP"),H=t("cRlei"),W=t("37qRo"),Q=t("h5vCg"),z=t("j40xv"),K=t("gINRd"),Y=b.default.getLogger("esri.layers.StreamLayer"),B=(0,V.defineFieldProperties)(),Z=function(r){"use strict";a.inherits(o,r);var t=a.createSuper(o);function o(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var i;return a.classCallCheck(this,o),(i=t.call.apply(t,[this].concat(a.toConsumableArray(r)))).copyright=null,i.definitionExpression=null,i.displayField=null,i.elevationInfo=null,i.featureReduction=null,i.fields=null,i.fieldsIndex=null,i.geometryDefinition=null,i.geometryType=null,i.labelsVisible=!0,i.labelingInfo=null,i.legendEnabled=!0,i.maxReconnectionAttempts=0,i.maxReconnectionInterval=20,i.maxScale=0,i.minScale=0,i.objectIdField=null,i.operationalLayerType="ArcGISStreamLayer",i.popupEnabled=!0,i.popupTemplate=null,i.purgeOptions=new(0,X.default),i.screenSizePerspectiveEnabled=!0,i.sourceJSON=null,i.spatialReference=z.default.WGS84,i.type="stream",i.url=null,i.updateInterval=300,i.webSocketUrl=null,a.possibleConstructorReturn(i)}return a.createClass(o,[{key:"normalizeCtorArgs",value:function(e,r){return"string"==typeof e?a.objectSpread({url:e},r):e}},{key:"load",value:function(e){var r=this;if(!("WebSocket"in globalThis))return this.addResolvingPromise(Promise.reject(new(0,m.default)("stream-layer:websocket-unsupported","WebSocket is not supported in this browser. StreamLayer will not have real-time connection with the stream service."))),Promise.resolve(this);var t=(0,g.isSome)(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Stream Service","Feed"]},e).catch(h.throwIfAbortError).then((function(){return r._fetchService(t)}))),Promise.resolve(this)}},{key:"defaultPopupTemplate",get:function(){return this.createPopupTemplate()}},{key:"renderer",set:function(e){(0,G.fixRendererFields)(e,this.fieldsIndex),this._set("renderer",e)}},{key:"readRenderer",value:function(e,r,t){var o=(r=r.layerDefinition||r).drawingInfo&&r.drawingInfo.renderer||void 0;if(o){var n=(0,y.read)(o,r,t)||void 0;return n||Y.error("Failed to create renderer",{rendererDefinition:r.drawingInfo.renderer,layer:this,context:t}),n}if(r.defaultSymbol)return r.types&&r.types.length?new(0,u.default)({defaultSymbol:$(r.defaultSymbol,r,t),field:r.typeIdField,uniqueValueInfos:r.types.map((function(e){return{id:e.id,symbol:$(e.symbol,e,t)}}))}):new(0,d.default)({symbol:$(r.defaultSymbol,r,t)})}},{key:"createPopupTemplate",value:function(e){return(0,W.createPopupTemplate)(this,e)}},{key:"createQuery",value:function(){var e=new(0,H.default);return e.returnGeometry=!0,e.outFields=["*"],e.where=this.definitionExpression||"1=1",e}},{key:"getFieldDomain",value:function(e,r){if(!this.fields)return null;var t=null;return this.fields.some((function(r){return r.name===e&&(t=r.domain),!!t})),t}},{key:"getField",value:function(e){return this.fieldsIndex.get(e)}},{key:"serviceSupportsSpatialReference",value:function(e){return!0}},{key:"_fetchService",value:function(r){var t=this;return a.asyncToGenerator(e(l).mark((function o(){var n,i,p,s;return e(l).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.webSocketUrl){e.next=14;break}if(null!=(i=t.timeInfo)&&i.trackIdField){e.next=5;break}throw new(0,m.default)("stream-layer:missing-metadata","The stream layer trackIdField must be specified.");case 5:if(t.objectIdField){e.next=7;break}throw new(0,m.default)("stream-layer:missing-metadata","The stream layer objectIdField must be specified.");case 7:if(t.fields){e.next=9;break}throw new(0,m.default)("stream-layer:missing-metadata","The stream layer fields must be specified.");case 9:if(t.geometryType){e.next=11;break}throw new(0,m.default)("stream-layer:missing-metadata","The stream layer geometryType must be specified.");case 11:t.url=t.webSocketUrl,e.next=20;break;case 14:if(t.sourceJSON){e.next=20;break}return e.next=17,(0,f.default)(t.parsedUrl.path,{query:a.objectSpread({f:"json"},t.customParameters,t.parsedUrl.query),responseType:"json",signal:r});case 17:p=e.sent,s=p.data,t.sourceJSON=s;case 20:return e.abrupt("return",(t.sourceJSON=a.objectSpread({},null!=(n=t.sourceJSON)?n:{},{objectIdField:"__esri_stream_id__"}),t.read(t.sourceJSON,{origin:"service",url:t.parsedUrl}),(0,G.fixRendererFields)(t.renderer,t.fieldsIndex),(0,G.fixTimeInfoFields)(t.timeInfo,t.fieldsIndex),(0,q.loadStyleRenderer)(t,{origin:"service"})));case 21:case"end":return e.stop()}}),o)})))()}}]),o}((0,P.FeatureEffectLayer)((0,O.BlendLayer)((0,D.TemporalLayer)((0,E.ScaleRangeLayer)((0,F.RefreshableLayer)((0,j.ArcGISService)((0,L.OperationalLayer)((0,C.PortalLayer)((0,S.MultiOriginJSONMixin)((0,N.CustomParametersMixin)(k.default)))))))))));(0,p._)([(0,w.property)({type:String})],Z.prototype,"copyright",void 0),(0,p._)([(0,w.property)({readOnly:!0})],Z.prototype,"defaultPopupTemplate",null),(0,p._)([(0,w.property)({type:String,json:{name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],Z.prototype,"definitionExpression",void 0),(0,p._)([(0,w.property)({type:String})],Z.prototype,"displayField",void 0),(0,p._)([(0,w.property)({type:Q.default})],Z.prototype,"elevationInfo",void 0),(0,p._)([(0,w.property)(A.featureReductionProperty)],Z.prototype,"featureReduction",void 0),(0,p._)([(0,w.property)(B.fields)],Z.prototype,"fields",void 0),(0,p._)([(0,w.property)(B.fieldsIndex)],Z.prototype,"fieldsIndex",void 0),(0,p._)([(0,w.property)({type:K.default})],Z.prototype,"geometryDefinition",void 0),(0,p._)([(0,w.property)({type:R.featureGeometryTypeKebabDictionary.apiValues,json:{read:{reader:R.featureGeometryTypeKebabDictionary.read}}})],Z.prototype,"geometryType",void 0),(0,p._)([(0,w.property)(J.labelsVisible)],Z.prototype,"labelsVisible",void 0),(0,p._)([(0,w.property)({type:[M.default],json:{read:{source:"layerDefinition.drawingInfo.labelingInfo",reader:U.reader},write:{target:"layerDefinition.drawingInfo.labelingInfo"}}})],Z.prototype,"labelingInfo",void 0),(0,p._)([(0,w.property)(J.legendEnabled)],Z.prototype,"legendEnabled",void 0),(0,p._)([(0,w.property)({type:["show","hide"]})],Z.prototype,"listMode",void 0),(0,p._)([(0,w.property)({type:I.Integer})],Z.prototype,"maxReconnectionAttempts",void 0),(0,p._)([(0,w.property)({type:I.Integer})],Z.prototype,"maxReconnectionInterval",void 0),(0,p._)([(0,w.property)(J.maxScale)],Z.prototype,"maxScale",void 0),(0,p._)([(0,w.property)(J.minScale)],Z.prototype,"minScale",void 0),(0,p._)([(0,w.property)({type:String})],Z.prototype,"objectIdField",void 0),(0,p._)([(0,w.property)({value:"ArcGISStreamLayer",type:["ArcGISStreamLayer"]})],Z.prototype,"operationalLayerType",void 0),(0,p._)([(0,w.property)(J.popupEnabled)],Z.prototype,"popupEnabled",void 0),(0,p._)([(0,w.property)({type:s.default,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],Z.prototype,"popupTemplate",void 0),(0,p._)([(0,w.property)({type:X.default})],Z.prototype,"purgeOptions",void 0),(0,p._)([(0,w.property)({types:c.rendererTypes,json:{origins:{service:{write:{target:"drawingInfo.renderer",enabled:!1}},"web-scene":{name:"layerDefinition.drawingInfo.renderer",types:c.webSceneRendererTypes,write:!0}},write:{target:"layerDefinition.drawingInfo.renderer"}}})],Z.prototype,"renderer",null),(0,p._)([(0,_.reader)("service","renderer",["drawingInfo.renderer","defaultSymbol"]),(0,_.reader)("renderer",["layerDefinition.drawingInfo.renderer","layerDefinition.defaultSymbol"])],Z.prototype,"readRenderer",null),(0,p._)([(0,w.property)(J.screenSizePerspectiveEnabled)],Z.prototype,"screenSizePerspectiveEnabled",void 0),(0,p._)([(0,w.property)()],Z.prototype,"sourceJSON",void 0),(0,p._)([(0,w.property)({type:z.default,json:{origins:{service:{read:{source:"spatialReference"}}}}})],Z.prototype,"spatialReference",void 0),(0,p._)([(0,w.property)({json:{read:!1}})],Z.prototype,"type",void 0),(0,p._)([(0,w.property)(J.url)],Z.prototype,"url",void 0),(0,p._)([(0,w.property)({type:Number})],Z.prototype,"updateInterval",void 0),(0,p._)([(0,w.property)({type:String})],Z.prototype,"webSocketUrl",void 0),Z=(0,p._)([(0,x.subclass)("esri.layers.StreamLayer")],Z);var $=(0,T.createTypeReader)({types:v.symbolTypesRenderer}),ee=Z})),t.register("hETxd",(function(e,o){r(e.exports,"default",(function(){return u}));var n=t("8TSCy"),i=t("7eJjO"),a=t("1XAcN"),l=t("iho5X");t("lNwWH"),t("2VlWd"),t("iJAIC");var p,s=t("fcwIv"),d=p=function(e){"use strict";n.inherits(t,e);var r=n.createSuper(t);function t(){var e;return n.classCallCheck(this,t),(e=r.call.apply(r,[this].concat(Array.prototype.slice.call(arguments)))).age=null,e.ageReceived=null,e.displayCount=null,e.maxObservations=1,n.possibleConstructorReturn(e)}return n.createClass(t,[{key:"clone",value:function(){return new p({age:this.age,ageReceived:this.ageReceived,displayCount:this.displayCount,maxObservations:this.maxObservations})}}]),t}(a.JSONSupport);(0,i._)([(0,l.property)({type:Number,json:{write:!0}})],d.prototype,"age",void 0),(0,i._)([(0,l.property)({type:Number,json:{write:!0}})],d.prototype,"ageReceived",void 0),(0,i._)([(0,l.property)({type:Number,json:{write:!0}})],d.prototype,"displayCount",void 0),(0,i._)([(0,l.property)({type:Number,json:{write:!0}})],d.prototype,"maxObservations",void 0);var u=d=p=(0,i._)([(0,s.subclass)("esri.layers.support.PurgeOptions")],d)}))}();
//# sourceMappingURL=StreamLayer.db586c07.js.map
