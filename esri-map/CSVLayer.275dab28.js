!function(){function e(e){return e&&e.__esModule?e.default:e}function t(e,t,r,n){Object.defineProperty(e,t,{get:r,set:n,enumerable:!0,configurable:!0})}var r=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire594f;r.register("b00fd",(function(n,o){var a;a=n.exports,Object.defineProperty(a,"__esModule",{value:!0,configurable:!0}),t(n.exports,"default",(function(){return _}));var i=r("8TSCy"),u=r("2TvXO"),s=r("7eJjO");r("2ILM8");var l=r("kyj08"),c=r("7qybv"),p=r("kYueh"),d=r("iho5X");r("lNwWH"),r("2VlWd"),r("iJAIC");var y=r("eB8sj"),f=r("fcwIv"),v=r("g15Jq"),h=r("7jt1r"),m=r("dxhdj"),g=r("cRlei"),b=r("9ELaA"),w=r("j40xv"),k=function(t){"use strict";i.inherits(n,t);var r=i.createSuper(n);function n(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];var a;return i.classCallCheck(this,n),(a=r.call.apply(r,[this].concat(i.toConsumableArray(t)))).capabilities=(0,m.createCapabilities)(!1,!1),a.delimiter=null,a.editingEnabled=!1,a.fields=null,a.latitudeField=null,a.locationType="coordinates",a.longitudeField=null,a.operationalLayerType="CSV",a.outFields=["*"],a.path=null,a.portalItem=null,a.spatialReference=w.default.WGS84,a.source=null,a.type="csv",i.possibleConstructorReturn(a)}return i.createClass(n,[{key:"normalizeCtorArgs",value:function(e,t){return"string"==typeof e?i.objectSpread({url:e},t):e}},{key:"isTable",get:function(){return this.loaded&&null==this.geometryType}},{key:"readWebMapLabelsVisible",value:function(e,t){return null!=t.showLabels?t.showLabels:!!(t.layerDefinition&&t.layerDefinition.drawingInfo&&t.layerDefinition.drawingInfo.labelingInfo)}},{key:"url",set:function(e){if(e){var t=(0,p.urlToObject)(e);this._set("url",t.path),t.query&&(this.customParameters=i.objectSpread({},this.customParameters,t.query))}else this._set("url",e)}},{key:"createGraphicsSource",value:function(t){var r=this;return i.asyncToGenerator(e(u).mark((function n(){var o;return e(u).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=new(0,h.default)({loadOptions:{delimiter:r.delimiter,fields:r.fields,latitudeField:r.latitudeField,longitudeField:r.longitudeField,spatialReference:r.spatialReference,timeInfo:r.timeInfo,url:r.url},customParameters:r.customParameters}),r._set("source",o),e.next=4,o.load({signal:t});case 4:return r.read({locationInfo:o.locationInfo,columnDelimiter:o.delimiter},{origin:"service",url:r.parsedUrl}),e.abrupt("return",(e.sent,o));case 6:case"end":return e.stop()}}),n)})))()}},{key:"queryFeatures",value:function(e,t){var r=this;return this.load().then((function(){return r.source.queryFeatures(g.default.from(e)||r.createQuery())})).then((function(e){var t=!0,n=!1,o=void 0;if(null!=e&&e.features)try{for(var a,i=e.features[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var u=a.value;u.layer=u.sourceLayer=r}}catch(e){n=!0,o=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw o}}return e}))}},{key:"queryObjectIds",value:function(e,t){var r=this;return this.load().then((function(){return r.source.queryObjectIds(g.default.from(e)||r.createQuery())}))}},{key:"queryFeatureCount",value:function(e,t){var r=this;return this.load().then((function(){return r.source.queryFeatureCount(g.default.from(e)||r.createQuery())}))}},{key:"queryExtent",value:function(e,t){var r=this;return this.load().then((function(){return r.source.queryExtent(g.default.from(e)||r.createQuery())}))}},{key:"write",value:function(e,t){return i.get(i.getPrototypeOf(n.prototype),"write",this).call(this,e,i.objectSpread({},t,{writeLayerSchema:!0}))}},{key:"clone",value:function(){throw new(0,l.default)("CSVLayer","CSVLayer (title: ".concat(this.title,", id: ").concat(this.id,") cannot be cloned"))}},{key:"hasDataChanged",value:function(){var t=this;return i.asyncToGenerator(e(u).mark((function r(){var n,o,a;return e(u).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.source.refresh(t.customParameters);case 3:return n=e.sent,o=n.dataChanged,a=n.updates,e.abrupt("return",((0,c.isSome)(a)&&t.read(a,{origin:"service",url:t.parsedUrl,ignoreDefaults:!0}),o));case 9:e.prev=9,e.t0=e.catch(0);case 11:return e.abrupt("return",!1);case 12:case"end":return e.stop()}}),r,null,[[0,9]])})))()}},{key:"_verifyFields",value:function(){}},{key:"_verifySource",value:function(){}},{key:"_hasMemorySource",value:function(){return!1}}]),n}(v.default);(0,s._)([(0,d.property)({readOnly:!0,json:{read:!1,write:!1}})],k.prototype,"capabilities",void 0),(0,s._)([(0,d.property)({type:[","," ",";","|","\t"],json:{read:{source:"columnDelimiter"},write:{target:"columnDelimiter",ignoreOrigin:!0}}})],k.prototype,"delimiter",void 0),(0,s._)([(0,d.property)({readOnly:!0,type:Boolean,json:{origins:{"web-scene":{read:!1,write:!1}}}})],k.prototype,"editingEnabled",void 0),(0,s._)([(0,d.property)({json:{read:{source:"layerDefinition.fields"},write:{target:"layerDefinition.fields"}}})],k.prototype,"fields",void 0),(0,s._)([(0,d.property)({type:Boolean,readOnly:!0})],k.prototype,"isTable",null),(0,s._)([(0,y.reader)("web-map","labelsVisible",["layerDefinition.drawingInfo.labelingInfo","showLabels"])],k.prototype,"readWebMapLabelsVisible",null),(0,s._)([(0,d.property)({type:String,json:{read:{source:"locationInfo.latitudeFieldName"},write:{target:"locationInfo.latitudeFieldName",ignoreOrigin:!0}}})],k.prototype,"latitudeField",void 0),(0,s._)([(0,d.property)({type:["show","hide"]})],k.prototype,"listMode",void 0),(0,s._)([(0,d.property)({type:["coordinates"],json:{read:{source:"locationInfo.locationType"},write:{target:"locationInfo.locationType",ignoreOrigin:!0,isRequired:!0}}})],k.prototype,"locationType",void 0),(0,s._)([(0,d.property)({type:String,json:{read:{source:"locationInfo.longitudeFieldName"},write:{target:"locationInfo.longitudeFieldName",ignoreOrigin:!0}}})],k.prototype,"longitudeField",void 0),(0,s._)([(0,d.property)({type:["CSV"]})],k.prototype,"operationalLayerType",void 0),(0,s._)([(0,d.property)()],k.prototype,"outFields",void 0),(0,s._)([(0,d.property)({type:String,json:{origins:{"web-scene":{read:!1,write:!1}},read:!1,write:!1}})],k.prototype,"path",void 0),(0,s._)([(0,d.property)({json:{read:!1,write:!1,origins:{"web-document":{read:!1,write:!1}}}})],k.prototype,"portalItem",void 0),(0,s._)([(0,d.property)({json:{read:!1},cast:null,type:h.default,readOnly:!0})],k.prototype,"source",void 0),(0,s._)([(0,d.property)({json:{read:!1},value:"csv",readOnly:!0})],k.prototype,"type",void 0),(0,s._)([(0,d.property)({json:{read:b.r,write:{isRequired:!0,ignoreOrigin:!0,writer:b.w}}})],k.prototype,"url",null);var _=k=(0,s._)([(0,f.subclass)("esri.layers.CSVLayer")],k)})),r.register("7jt1r",(function(n,o){t(n.exports,"default",(function(){return g}));var a=r("8TSCy"),i=r("2TvXO"),u=r("7eJjO");r("2ILM8");var s=r("2VlWd"),l=r("bQCqB"),c=r("7qybv"),p=r("10vEZ"),d=r("gdXB3"),y=r("iho5X");r("lNwWH"),r("iJAIC");var f=r("fcwIv"),v=r("f4h86"),h=r("gINRd"),m=function(t){"use strict";a.inherits(n,t);var r=a.createSuper(n);function n(t){var o;a.classCallCheck(this,n);var u,s=a.assertThisInitialized(o);return(o=r.call(this,t)).type="csv",o.refresh=(0,p.debounce)((u=a.asyncToGenerator(e(i).mark((function t(r){var n,o,a;return e(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.load();case 2:return e.next=4,s._connection.invoke("refresh",r);case 4:return n=e.sent,o=n.extent,a=n.timeExtent,e.abrupt("return",(s.sourceJSON.extent=o,a&&(s.sourceJSON.timeInfo.timeExtent=[a.start,a.end]),{dataChanged:!0,updates:{extent:s.sourceJSON.extent,timeInfo:s.sourceJSON.timeInfo}}));case 8:case"end":return e.stop()}}),t)}))),function(e){return u.apply(this,arguments)})),a.possibleConstructorReturn(o)}return a.createClass(n,[{key:"load",value:function(e){var t=(0,c.isSome)(e)?e.signal:null;return this.addResolvingPromise(this._startWorker(t)),Promise.resolve(this)}},{key:"destroy",value:function(){var e;null==(e=this._connection)||e.close(),this._connection=null}},{key:"openPorts",value:function(){var t=this;return a.asyncToGenerator(e(i).mark((function r(){return e(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.load();case 2:return e.abrupt("return",(e.sent,t._connection.openPorts()));case 3:case"end":return e.stop()}}),r)})))()}},{key:"queryFeatures",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this;return a.asyncToGenerator(e(i).mark((function o(){var a;return e(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.load(r);case 2:return e.next=4,n._connection.invoke("queryFeatures",t?t.toJSON():null,r);case 4:return a=e.sent,e.abrupt("return",v.default.fromJSON(a));case 6:case"end":return e.stop()}}),o)})))()}},{key:"queryFeaturesJSON",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this;return a.asyncToGenerator(e(i).mark((function o(){return e(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.load(r);case 2:return e.abrupt("return",(e.sent,n._connection.invoke("queryFeatures",t?t.toJSON():null,r)));case 3:case"end":return e.stop()}}),o)})))()}},{key:"queryFeatureCount",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this;return a.asyncToGenerator(e(i).mark((function o(){return e(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.load(r);case 2:return e.abrupt("return",(e.sent,n._connection.invoke("queryFeatureCount",t?t.toJSON():null,r)));case 3:case"end":return e.stop()}}),o)})))()}},{key:"queryObjectIds",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this;return a.asyncToGenerator(e(i).mark((function o(){return e(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.load(r);case 2:return e.abrupt("return",(e.sent,n._connection.invoke("queryObjectIds",t?t.toJSON():null,r)));case 3:case"end":return e.stop()}}),o)})))()}},{key:"queryExtent",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this;return a.asyncToGenerator(e(i).mark((function o(){var a;return e(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.load(r);case 2:return e.next=4,n._connection.invoke("queryExtent",t?t.toJSON():null,r);case 4:return a=e.sent,e.abrupt("return",{count:a.count,extent:h.default.fromJSON(a.extent)});case 6:case"end":return e.stop()}}),o)})))()}},{key:"querySnapping",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this;return a.asyncToGenerator(e(i).mark((function o(){return e(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.load(r);case 2:return e.abrupt("return",(e.sent,n._connection.invoke("querySnapping",t,r)));case 3:case"end":return e.stop()}}),o)})))()}},{key:"_startWorker",value:function(t){var r=this;return a.asyncToGenerator(e(i).mark((function n(){var o,a,u,l,c,p,y,f,v;return e(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.open)("CSVSourceWorker",{strategy:(0,s.default)("feature-layers-workers")?"dedicated":"local",signal:t});case 2:return r._connection=e.sent,o=r.loadOptions,a=o.url,u=o.delimiter,l=o.fields,c=o.latitudeField,p=o.longitudeField,y=o.spatialReference,f=o.timeInfo,e.next=13,r._connection.invoke("load",{url:a,customParameters:r.customParameters,parsingOptions:{delimiter:u,fields:null==l?void 0:l.map((function(e){return e.toJSON()})),latitudeField:c,longitudeField:p,spatialReference:null==y?void 0:y.toJSON(),timeInfo:null==f?void 0:f.toJSON()}},{signal:t});case 13:v=e.sent,r.locationInfo=v.locationInfo,r.sourceJSON=v.layerDefinition,r.delimiter=v.delimiter;case 15:case"end":return e.stop()}}),n)})))()}}]),n}(l.default);(0,u._)([(0,y.property)()],m.prototype,"type",void 0),(0,u._)([(0,y.property)()],m.prototype,"loadOptions",void 0),(0,u._)([(0,y.property)()],m.prototype,"customParameters",void 0),(0,u._)([(0,y.property)()],m.prototype,"locationInfo",void 0),(0,u._)([(0,y.property)()],m.prototype,"sourceJSON",void 0),(0,u._)([(0,y.property)()],m.prototype,"delimiter",void 0);var g=m=(0,u._)([(0,f.subclass)("esri.layers.graphics.sources.CSVSource")],m)}))}();
//# sourceMappingURL=CSVLayer.275dab28.js.map
