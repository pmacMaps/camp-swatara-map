!function(){function e(e){return e&&e.__esModule?e.default:e}function t(e,t,n,r){Object.defineProperty(e,t,{get:n,set:r,enumerable:!0,configurable:!0})}var n=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire594f;n.register("1xeva",(function(r,a){t(r.exports,"crsPrefix",(function(){return x})),t(r.exports,"crsDefault",(function(){return k})),t(r.exports,"getCollectionDefinition",(function(){return F})),t(r.exports,"getServerCollections",(function(){return S})),t(r.exports,"getServerConformance",(function(){return I})),t(r.exports,"getServerLandingPage",(function(){return O})),t(r.exports,"getServerOpenApi",(function(){return q})),t(r.exports,"getSpatialReferenceWkid",(function(){return C})),t(r.exports,"queryFeatureSetJSON",(function(){return D})),t(r.exports,"queryOptimizedFeatureSet",(function(){return R}));var i=n("8TSCy"),o=n("2TvXO");n("2ILM8");var s=n("9pNSx"),u=n("kyj08"),l=n("jHOLN"),c=n("7qybv"),d=n("eY5Yp"),p=n("eF88h"),f=n("akQYU"),m=n("awJRz"),g=n("4shxe"),y=n("dxhdj"),b=n("4nMX7"),h=n("82Efb"),w=n("j40xv"),v=l.default.getLogger("esri.layers.graphics.sources.ogcfeature"),x="http://www.opengis.net/def/crs/",k="".concat(x,"OGC/1.3/CRS84");function F(e,t){return j.apply(this,arguments)}function j(){return j=i.asyncToGenerator(e(o).mark((function t(n,r){var a,l,d,p,f,m,w,x,k,F,j,S,T,I,N,O,G,q,M,C,D,P,R,W,L=arguments;return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=L.length>2&&void 0!==L[2]?L[2]:{},l=L.length>3&&void 0!==L[3]?L[3]:5,d=n.links,p=E(d,"items","application/geo+json")||E(d,"http://www.opengis.net/def/rel/ogc/1.0/items","application/geo+json"),!(0,c.isNone)(p)){e.next=4;break}throw new(0,u.default)("ogc-feature-layer:missing-items-page","Missing items url");case 4:return e.next=6,(0,s.default)(p.href,{signal:a.signal,query:i.objectSpread({limit:l},a.customParameters,{token:a.apiKey}),headers:{accept:"application/geo+json"}});case 6:return f=e.sent,m=f.data,e.next=10,(0,g.validateGeoJSON)(m);case 10:if(w=(0,g.inferLayerProperties)(m,{geometryType:r.geometryType}),x=r.fields||w.fields||[],k=null!=r.hasZ?r.hasZ:w.hasZ,F=w.geometryType,j=r.objectIdField||w.objectIdFieldName||"OBJECTID",S=r.timeInfo,T=x.find((function(e){return e.name===j}))){e.next=19;break}if(w.objectIdFieldType){e.next=16;break}throw new(0,u.default)("ogc-feature-layer:missing-feature-id","Collection geojson require a feature id as a unique identifier");case 16:x.unshift({name:j,alias:j,type:"esriFieldTypeOID",editable:!1,nullable:!1}),e.next=20;break;case 19:T.type="esriFieldTypeOID",T.editable=!1,T.nullable=!1;case 20:j!==w.objectIdFieldName&&(I=x.find((function(e){return e.name===w.objectIdFieldName})))&&(I.type="esriFieldTypeInteger"),x===w.fields&&w.unknownFields.length>0&&v.warn({name:"ogc-feature-layer:unknown-field-types",message:"Some fields types couldn't be inferred from the features and were dropped",details:{unknownFields:w.unknownFields}}),N=!0,O=!1,G=void 0,e.prev=23,q=x[Symbol.iterator]();case 25:if(N=(M=q.next()).done){e.next=34;break}if(null==(C=M.value).name&&(C.name=C.alias),null==C.alias&&(C.alias=C.name),"esriFieldTypeOID"!==C.type&&"esriFieldTypeGlobalID"!==C.type&&(C.editable=null==C.editable||!!C.editable,C.nullable=null==C.nullable||!!C.nullable),C.name){e.next=29;break}throw new(0,u.default)("ogc-feature-layer:invalid-field-name","field name is missing",{field:C});case 29:if(-1!==h.kebabDict.jsonValues.indexOf(C.type)){e.next=31;break}throw new(0,u.default)("ogc-feature-layer:invalid-field-type",'invalid type for field "'.concat(C.name,'"'),{field:C});case 31:N=!0,e.next=25;break;case 34:e.next=40;break;case 36:e.prev=36,e.t0=e.catch(23),O=!0,G=e.t0;case 40:e.prev=40,e.prev=41,N||null==q.return||q.return();case 43:if(e.prev=43,!O){e.next=46;break}throw G;case 46:return e.finish(43);case 47:return e.finish(40);case 48:return S&&(D=new(0,b.default)(x),S.startTimeField&&((P=D.get(S.startTimeField))?(S.startTimeField=P.name,P.type="esriFieldTypeDate"):S.startTimeField=null),S.endTimeField&&((R=D.get(S.endTimeField))?(S.endTimeField=R.name,R.type="esriFieldTypeDate"):S.endTimeField=null),S.trackIdField&&((W=D.get(S.trackIdField))?S.trackIdField=W.name:(S.trackIdField=null,v.warn({name:"ogc-feature-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:S}}))),S.startTimeField||S.endTimeField||(v.warn({name:"ogc-feature-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing",details:{timeInfo:S}}),S=null)),e.abrupt("return",{drawingInfo:F?(0,y.createDrawingInfo)(F):null,geometryType:F,fields:x,hasZ:!!k,objectIdField:j,timeInfo:S});case 50:case"end":return e.stop()}}),t,null,[[23,36,40,48],[41,,43,47]])}))),j.apply(this,arguments)}function S(e){return T.apply(this,arguments)}function T(){return T=i.asyncToGenerator(e(o).mark((function t(n){var r,a,l,d,p,f,m,g,y=arguments;return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=y.length>1&&void 0!==y[1]?y[1]:{},a=n.links,l=E(a,"data","application/json")||E(a,"http://www.opengis.net/def/rel/ogc/1.0/data","application/json"),!(0,c.isNone)(l)){e.next=4;break}throw new(0,u.default)("ogc-feature-layer:missing-collections-page","Missing collections url");case 4:return d=r.apiKey,p=r.customParameters,f=r.signal,e.next=9,(0,s.default)(l.href,{signal:f,headers:{accept:"application/json"},query:i.objectSpread({},p,{token:d})});case 9:return m=e.sent,g=m.data,e.abrupt("return",g);case 12:case"end":return e.stop()}}),t)}))),T.apply(this,arguments)}function I(e){return N.apply(this,arguments)}function N(){return N=i.asyncToGenerator(e(o).mark((function t(n){var r,a,l,d,p,f,m,g,y=arguments;return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=y.length>1&&void 0!==y[1]?y[1]:{},a=n.links,l=E(a,"conformance","application/json")||E(a,"http://www.opengis.net/def/rel/ogc/1.0/conformance","application/json"),!(0,c.isNone)(l)){e.next=4;break}throw new(0,u.default)("ogc-feature-layer:missing-conformance-page","Missing conformance url");case 4:return d=r.apiKey,p=r.customParameters,f=r.signal,e.next=9,(0,s.default)(l.href,{signal:f,headers:{accept:"application/json"},query:i.objectSpread({},p,{token:d})});case 9:return m=e.sent,g=m.data,e.abrupt("return",g);case 12:case"end":return e.stop()}}),t)}))),N.apply(this,arguments)}function O(e){return G.apply(this,arguments)}function G(){return G=i.asyncToGenerator(e(o).mark((function t(n){var r,a,u,l,c,d,p=arguments;return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=p.length>1&&void 0!==p[1]?p[1]:{},a=r.apiKey,u=r.customParameters,l=r.signal,e.next=6,(0,s.default)(n,{signal:l,headers:{accept:"application/json"},query:i.objectSpread({},u,{token:a})});case 6:return c=e.sent,d=c.data,e.abrupt("return",d);case 9:case"end":return e.stop()}}),t)}))),G.apply(this,arguments)}function q(e){return M.apply(this,arguments)}function M(){return M=i.asyncToGenerator(e(o).mark((function t(n){var r,a,u,l,d,p,f,m,g=arguments;return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=g.length>1&&void 0!==g[1]?g[1]:{},a="application/vnd.oai.openapi+json;version=3.0",u=E(n.links,"service-desc",a),!(0,c.isNone)(u)){e.next=4;break}return e.abrupt("return",(v.warn("ogc-feature-layer:missing-openapi-page","The OGC API-Features server does not have an OpenAPI page."),null));case 4:return l=r.apiKey,d=r.customParameters,p=r.signal,e.next=9,(0,s.default)(u.href,{signal:p,headers:{accept:a},query:i.objectSpread({},d,{token:l})});case 9:return f=e.sent,m=f.data,e.abrupt("return",m);case 12:case"end":return e.stop()}}),t)}))),M.apply(this,arguments)}function C(e){var t=RegExp("^http:\\/\\/www\\.opengis.net\\/def\\/crs\\/(?<authority>.*)\\/(?<version>.*)\\/(?<code>.*)$","i").exec(e),n=null==t?void 0:t.groups;if(!n)return null;var r=n.authority,a=n.code;switch(r.toLowerCase()){case"ogc":switch(a.toLowerCase()){case"crs27":return w.default.GCS_NAD_1927.wkid;case"crs83":return 4269;case"crs84":case"crs84h":return w.default.WGS84.wkid;default:return null}case"esri":case"epsg":var i=Number.parseInt(a,10);return Number.isNaN(i)?null:i;default:return null}}function D(e,t,n){return P.apply(this,arguments)}function P(){return(P=i.asyncToGenerator(e(o).mark((function t(n,r,a){var i;return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R(n,r,a);case 2:return i=e.sent,e.abrupt("return",(0,f.convertToFeatureSet)(i));case 4:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function R(e,t,n){return W.apply(this,arguments)}function W(){return(W=i.asyncToGenerator(e(o).mark((function t(n,r,a){var l,y,b,h,v,x,k,F,j,S,T,I,N,O,G,q,M,C,D,P,R,W,Z,_,z,Y,Q,X,B,H,U,V,$,ee,te,ne,re,ae,ie,oe,se,ue,le,ce,de,pe,fe,me,ge,ye;return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=n.capabilities,y=l.query,b=y.maxRecordCount,h=n.collection,v=n.layerDefinition,x=n.queryParameters,k=x.apiKey,F=x.customParameters,j=n.spatialReference,S=n.supportedCrs,T=h.links,I=E(T,"items","application/geo+json")||E(T,"http://www.opengis.net/def/rel/ogc/1.0/items","application/geo+json"),!(0,c.isNone)(I)){e.next=3;break}throw new(0,u.default)("ogc-feature-layer:missing-items-page","Missing items url");case 3:if(N=r.geometry,O=r.num,G=r.start,q=r.timeExtent,M=r.where,!r.objectIds){e.next=6;break}throw new(0,u.default)("ogc-feature-layer:query-by-objectids-not-supported","Queries with objectids are not supported");case 6:return C=w.default.fromJSON(j),D=(0,c.unwrapOr)(r.outSpatialReference,C),P=D.isWGS84?null:L(D,S),R=A(N,S),W=J(q),Z=K(M),_=null!=O?O:null!=G&&void 0!==G?10:b,e.next=15,(0,s.default)(I.href,i.objectSpread({},a,{query:i.objectSpread({},F,R,{crs:P,datetime:W,query:Z,limit:_,startindex:G,token:k}),headers:{accept:"application/geo+json"}}));case 15:if(z=e.sent,Y=z.data,Q=!1,Y.links&&(X=Y.links.find((function(e){return"next"===e.rel})),Q=!!X),!Q&&Number.isInteger(Y.numberMatched)&&Number.isInteger(Y.numberReturned)&&(Q=Y.numberReturned<Y.numberMatched),B=v.fields,H=v.globalIdField,U=v.hasM,V=v.hasZ,$=v.objectIdField,ee=v.geometryType,te=(0,g.createOptimizedFeatures)(Y,{geometryType:ee,hasZ:V,objectIdField:$}),P||!D.isWebMercator){e.next=39;break}for(ne=!0,re=!1,ae=void 0,e.prev=23,ie=te[Symbol.iterator]();!(ne=(oe=ie.next()).done);ne=!0)se=oe.value,(0,c.isSome)(se.geometry)&&((ue=(0,f.convertToGeometry)(se.geometry,ee,V,!1)).spatialReference=w.default.WGS84,se.geometry=(0,f.convertFromGeometry)((0,p.project)(ue,D)));e.next=31;break;case 27:e.prev=27,e.t0=e.catch(23),re=!0,ae=e.t0;case 31:e.prev=31,e.prev=32,ne||null==ie.return||ie.return();case 34:if(e.prev=34,!re){e.next=37;break}throw ae;case 37:return e.finish(34);case 38:return e.finish(31);case 39:for(le=!0,ce=!1,de=void 0,e.prev=40,pe=te[Symbol.iterator]();!(le=(fe=pe.next()).done);le=!0)(me=fe.value).objectId=me.attributes[$];e.next=48;break;case 44:e.prev=44,e.t1=e.catch(40),ce=!0,de=e.t1;case 48:e.prev=48,e.prev=49,le||null==pe.return||pe.return();case 51:if(e.prev=51,!ce){e.next=54;break}throw de;case 54:return e.finish(51);case 55:return e.finish(48);case 56:return ge=P||!P&&D.isWebMercator?D.toJSON():d.WGS84,ye=new(0,m.default),e.abrupt("return",(ye.exceededTransferLimit=Q,ye.features=te,ye.fields=B,ye.geometryType=ee,ye.globalIdFieldName=H,ye.hasM=U,ye.hasZ=V,ye.objectIdFieldName=$,ye.spatialReference=ge,ye));case 58:case"end":return e.stop()}}),t,null,[[23,27,31,39],[32,,34,38],[40,44,48,56],[49,,51,55]])})))).apply(this,arguments)}function L(e,t){var n,r,a,i=e.isWebMercator;if(!e.wkid)return null;var o=i?null!=(n=null!=(r=null!=(a=t[3857])?a:t[102100])?r:t[102113])?n:t[900913]:t[e.wkid];return o?"".concat(x).concat(o):null}function Z(e){if((0,c.isNone)(e))return"";var t=e.xmin,n=e.ymin,r=e.xmax,a=e.ymax;return"".concat(t,",").concat(n,",").concat(r,",").concat(a)}function J(e){if((0,c.isNone)(e))return null;var t=e.start,n=e.end;return"".concat((0,c.isSome)(t)?t.toISOString():"..","/").concat((0,c.isSome)(n)?n.toISOString():"..")}function K(e){return(0,c.isNone)(e)||!e||"1=1"===e?null:e}function A(e,t){if(n=e,!(0,c.isSome)(n)||"extent"!==n.type)return null;var n,r=e.spatialReference;if(!r||r.isWGS84)return{bbox:Z(e)};var a=L(r,t);return(0,c.isSome)(a)?{bbox:Z(e),"bbox-crs":a}:r.isWebMercator?{bbox:Z((0,p.project)(e,w.default.WGS84))}:null}function E(e,t,n){return e.find((function(e){return e.rel===t&&e.type===n}))||e.find((function(e){return e.rel===t&&!e.type}))}}))}();
//# sourceMappingURL=Pipeline.e1218031.js.map
