function e(e,t,n,r){Object.defineProperty(e,t,{get:n,set:r,enumerable:!0,configurable:!0})}var t=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire594f;t.register("cF7II",(function(n,r){e(n.exports,"loadGLTFMesh",(function(){return L}));var o=t("hJt7u"),u=t("bYA0c"),s=t("035lZ"),a=t("8TN87"),i=t("52822"),c=t("4vUOo"),l=t("iHxaG"),f=t("64ROT"),d=t("lnPqT"),p=t("9CdsJ"),m=t("44zDp"),x=t("2lq8N"),g=t("7uKdD"),T=t("k4Lc2"),O=t("3Bcds"),y=t("7vBMy"),B=t("6Jhbg"),b=t("cjn8Z"),h=t("5cRuQ"),w=t("iXVKm"),C=t("jQTCa"),E=t("5NoUL"),v=t("amFar"),N=t("l3QXd"),M=t("5gcCk"),A=t("7JiCL"),D=t("lLtQf");async function L(e,t,n){const r={...n,useTransform:n?.useTransform??!0},i=new(0,h.DefaultLoadingContext)(function(e){const t=e?.resolveFile;return t?{busy:!1,request:async(e,n,r)=>{const o=t(e),s="image"===n?"image":"binary"===n?"array-buffer":"json";return(await(0,u.default)(o,{responseType:s,signal:null!=r?r.signal:null})).data}}:null}(r)),c=(await(0,w.loadGLTF)(i,t,r,!0)).model,d=c.lods.shift(),O=new Map,y=new Map;c.textures.forEach(((e,t)=>O.set(t,function(e){return new(0,m.default)({data:((0,E.isEncodedMeshTexture)(e.data),e.data),wrap:U(e.parameters.wrap)})}(e)))),c.materials.forEach(((e,t)=>y.set(t,function(e,t){const n=new(0,o.default)(function(e,t){return(0,f.f)(F(e[0]),F(e[1]),F(e[2]),t)}(e.color,e.opacity)),r=e.emissiveFactor?new(0,o.default)(function(e){return(0,l.f)(F(e[0]),F(e[1]),F(e[2]))}(e.emissiveFactor)):null,u=e=>e?new(0,x.default)({scale:e.scale?[e.scale[0],e.scale[1]]:[1,1],rotation:(0,a.rad2deg)(e.rotation??0),offset:e.offset?[e.offset[0],e.offset[1]]:[0,0]}):null;return new(0,p.default)({color:n,colorTexture:t.get(e.textureColor),normalTexture:t.get(e.textureNormal),emissiveColor:r,emissiveTexture:t.get(e.textureEmissive),occlusionTexture:t.get(e.textureOcclusion),alphaMode:I(e.alphaMode),alphaCutoff:e.alphaCutoff,doubleSided:e.doubleSided,metallic:e.metallicFactor,roughness:e.roughnessFactor,metallicRoughnessTexture:t.get(e.textureMetallicRoughness),colorTextureTransform:u(e.colorTextureTransform),normalTextureTransform:u(e.normalTextureTransform),occlusionTextureTransform:u(e.occlusionTextureTransform),emissiveTextureTransform:u(e.emissiveTextureTransform),metallicRoughnessTextureTransform:u(e.metallicRoughnessTextureTransform)})}(e,O))));const C=function(e){let t=0;const n={color:!1,tangent:!1,normal:!1,texCoord0:!1},r=new Map,o=new Map,u=[];for(const a of e.parts){const{attributes:{position:e,normal:i,color:c,tangent:l,texCoord0:f}}=a,d=`\n      ${V(e,r)}/\n      ${V(i,r)}/\n      ${V(c,r)}/\n      ${V(l,r)}/\n      ${V(f,r)}/\n      ${S(a.transform)}\n    `;let p=!1;const m=(0,s.getOrCreateMapValue)(o,d,(()=>(p=!0,{start:t,length:e.count})));p&&(t+=e.count),i&&(n.normal=!0),c&&(n.color=!0),l&&(n.tangent=!0),f&&(n.texCoord0=!0),u.push({gltf:a,writeVertices:p,region:m})}return{vertexAttributes:{position:(0,B.createBuffer)(T.BufferViewVec3f64,t),normal:n.normal?(0,B.createBuffer)(T.BufferViewVec3f,t):null,tangent:n.tangent?(0,B.createBuffer)(T.BufferViewVec4f,t):null,color:n.color?(0,B.createBuffer)(T.BufferViewVec4u8,t):null,texCoord0:n.texCoord0?(0,B.createBuffer)(T.BufferViewVec2f,t):null},parts:u,components:[]}}(d);for(const e of C.parts)R(C,e,y);const{position:v,normal:N,tangent:M,color:A,texCoord0:D}=C.vertexAttributes,L={position:v.typedBuffer,normal:null!=N?N.typedBuffer:null,tangent:null!=M?M.typedBuffer:null,uv:null!=D?D.typedBuffer:null,color:null!=A?A.typedBuffer:null},k=(0,b.georeferenceByTransform)(L,e,r);return{transform:k.transform,vertexSpace:k.vertexSpace,components:C.components,spatialReference:e.spatialReference,vertexAttributes:new(0,g.MeshVertexAttributes)({position:k.vertexAttributes.position,normal:k.vertexAttributes.normal,tangent:k.vertexAttributes.tangent,color:L.color,uv:L.uv})}}function V(e,t){if(null==e)return"-";const n=e.typedBuffer;return`${(0,s.getOrCreateMapValue)(t,n.buffer,(()=>t.size))}/${n.byteOffset}/${n.byteLength}`}function S(e){return null!=e?e.toString():"-"}function R(e,t,n){t.writeVertices&&function(e,t){const{position:n,normal:r,tangent:o,color:u,texCoord0:s}=e.vertexAttributes,l=t.region.start,{attributes:f,transform:d}=t.gltf,p=f.position.count;if((0,O.c)(n.slice(l,p),f.position,d),null!=f.normal&&null!=r){const e=(0,i.b)((0,c.c)(),d),t=r.slice(l,p);(0,O.b)(t,f.normal,e),(0,a.hasScaling)(e)&&(0,O.d)(t,t)}else null!=r&&(0,M.f)(r,0,0,1,{dstIndex:l,count:p});if(null!=f.tangent&&null!=o){const e=(0,i.b)((0,c.c)(),d),t=o.slice(l,p);(0,y.a)(t,f.tangent,e),(0,a.hasScaling)(e)&&(0,y.n)(t,t)}else null!=o&&(0,A.f)(o,0,0,1,1,{dstIndex:l,count:p});if(null!=f.texCoord0&&null!=s?(0,D.a)(s.slice(l,p),f.texCoord0):null!=s&&(0,D.f)(s,0,0,{dstIndex:l,count:p}),null!=f.color&&null!=u){const e=f.color,t=u.slice(l,p);if(4===e.elementCount)e instanceof T.BufferViewVec4f?(0,y.b)(t,e,255):e instanceof T.BufferViewVec4u8?(0,A.a)(t,e):e instanceof T.BufferViewVec4u16&&(0,y.b)(t,e,1/256);else{(0,A.f)(t,255,255,255,255);const n=T.BufferViewVec3u8.fromTypedArray(t.typedBuffer,t.typedBufferStride);e instanceof T.BufferViewVec3f?(0,O.e)(n,e,255):e instanceof T.BufferViewVec3u8?(0,M.a)(n,e):e instanceof T.BufferViewVec3u16&&(0,O.e)(n,e,1/256)}}else null!=u&&(0,A.f)(u.slice(l,p),255,255,255,255)}(e,t);const{indices:r,attributes:o,primitiveType:u,material:s}=t.gltf;let l=(0,C.convertPrimitiveToTriangles)(r||o.position.count,u);const f=t.region.start;if(f){const e=new Uint32Array(l);for(let t=0;t<l.length;t++)e[t]+=f;l=e}e.components.push(new(0,d.default)({faces:l,material:n.get(s),shading:o.normal?"source":"flat",trustSourceNormals:!0}))}function I(e){switch(e){case"OPAQUE":return"opaque";case"MASK":return"mask";case"BLEND":return"blend"}}function U(e){return{horizontal:k(e.s),vertical:k(e.t)}}function k(e){switch(e){case N.TextureWrapMode.CLAMP_TO_EDGE:return"clamp";case N.TextureWrapMode.MIRRORED_REPEAT:return"mirror";case N.TextureWrapMode.REPEAT:return"repeat"}}function F(e){return e**(1/v.COLOR_GAMMA)*255}})),t.register("6Jhbg",(function(n,r){e(n.exports,"createBuffer",(function(){return u}));var o=t("2bApG");t("3Ef82"),t("cKTOq"),t("7bWbh"),t("lLtQf"),t("5gcCk"),t("7JiCL");function u(e,t){return new e(new ArrayBuffer(t*e.ElementCount*(0,o.elementTypeSize)(e.ElementType)))}})),t.register("2bApG",(function(t,n){function r(e){switch(e){case"u8":case"i8":return 1;case"u16":case"i16":return 2;case"u32":case"i32":case"f32":return 4;case"f64":return 8}}e(t.exports,"elementTypeSize",(function(){return r}))})),t.register("3Ef82",(function(e,t){Object.freeze(Object.defineProperty({__proto__:null,copy:function(e,t,n){const r=e.typedBuffer,o=e.typedBufferStride,u=t.typedBuffer,s=t.typedBufferStride,a=n?n.count:t.count;let i=(n&&n.dstIndex?n.dstIndex:0)*o,c=(n&&n.srcIndex?n.srcIndex:0)*s;for(let e=0;e<a;++e){for(let e=0;e<9;++e)r[i+e]=u[c+e];i+=o,c+=s}}},Symbol.toStringTag,{value:"Module"}))})),t.register("cKTOq",(function(e,t){Object.freeze(Object.defineProperty({__proto__:null,copy:function(e,t,n){const r=e.typedBuffer,o=e.typedBufferStride,u=t.typedBuffer,s=t.typedBufferStride,a=n?n.count:t.count;let i=(n&&n.dstIndex?n.dstIndex:0)*o,c=(n&&n.srcIndex?n.srcIndex:0)*s;for(let e=0;e<a;++e){for(let e=0;e<16;++e)r[i+e]=u[c+e];i+=o,c+=s}}},Symbol.toStringTag,{value:"Module"}))})),t.register("5NoUL",(function(n,r){e(n.exports,"EncodedMeshTexture",(function(){return u})),e(n.exports,"isEncodedMeshTexture",(function(){return s})),e(n.exports,"jsonFromBinaryData",(function(){return a})),e(n.exports,"imageFromBinaryData",(function(){return i}));var o=t("kp9RZ");class u{constructor(e){this.data=e,this.type="encoded-mesh-texture",this.encoding=o.TextureEncodingMimeType.KTX2_ENCODING}}function s(e){return"encoded-mesh-texture"===e?.type}async function a(e){return new Promise(((t,n)=>{const r=new Blob([e]),o=new FileReader;o.onload=()=>{const e=o.result;t(JSON.parse(e))},o.onerror=e=>{n(e)},o.readAsText(r)}))}async function i(e,t){return t===o.TextureEncodingMimeType.KTX2_ENCODING?new u(e):new Promise(((n,r)=>{const o=new Blob([e],{type:t}),u=URL.createObjectURL(o),s=new Image,a=()=>{URL.revokeObjectURL(u),"decode"in s?s.decode().then((()=>n(s)),(()=>n(s))).then(c):(n(s),c())},i=e=>{URL.revokeObjectURL(u),r(e),c()},c=()=>{s.removeEventListener("load",a),s.removeEventListener("error",i)};s.addEventListener("load",a),s.addEventListener("error",i),s.src=u}))}})),t.register("kp9RZ",(function(t,n){var r,o,u,s,a,i,c,l,f,d,p;e(t.exports,"CullFaceOptions",(function(){return r})),e(t.exports,"DepthTestFunction",(function(){return o})),e(t.exports,"ResourceState",(function(){return s})),e(t.exports,"StencilBits",(function(){return a})),e(t.exports,"Object3DState",(function(){return i})),e(t.exports,"ValidationState",(function(){return c})),e(t.exports,"AlphaDiscardMode",(function(){return l})),e(t.exports,"TextureEncodingMimeType",(function(){return d})),(p=r||(r={}))[p.None=0]="None",p[p.Front=1]="Front",p[p.Back=2]="Back",p[p.COUNT=3]="COUNT",function(e){e[e.Less=0]="Less",e[e.Lequal=1]="Lequal",e[e.COUNT=2]="COUNT"}(o||(o={})),function(e){e[e.BACKGROUND=0]="BACKGROUND",e[e.UPDATE=1]="UPDATE"}(u||(u={})),function(e){e[e.NOT_LOADED=0]="NOT_LOADED",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED"}(s||(s={})),function(e){e[e.IntegratedMeshMaskExcluded=1]="IntegratedMeshMaskExcluded",e[e.OutlineVisualElementMask=2]="OutlineVisualElementMask"}(a||(a={})),function(e){e[e.Highlight=0]="Highlight",e[e.MaskOccludee=1]="MaskOccludee",e[e.COUNT=2]="COUNT"}(i||(i={})),function(e){e[e.CHANGED=0]="CHANGED",e[e.UNCHANGED=1]="UNCHANGED"}(c||(c={})),function(e){e[e.Blend=0]="Blend",e[e.Opaque=1]="Opaque",e[e.Mask=2]="Mask",e[e.MaskBlend=3]="MaskBlend",e[e.COUNT=4]="COUNT"}(l||(l={})),function(e){e[e.OFF=0]="OFF",e[e.ON=1]="ON"}(f||(f={})),function(e){e.DDS_ENCODING="image/vnd-ms.dds",e.KTX2_ENCODING="image/ktx2",e.BASIS_ENCODING="image/x.basis"}(d||(d={}))}));
//# sourceMappingURL=loadGLTFMesh.eb5ebe5e.js.map
