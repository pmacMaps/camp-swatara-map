function t(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}var e=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire594f;e.register("cjn8Z",(function(n,r){t(n.exports,"georeference",(function(){return A})),t(n.exports,"georeferenceApplyTransform",(function(){return F})),t(n.exports,"georeferenceByTransform",(function(){return T})),t(n.exports,"ungeoreference",(function(){return w})),t(n.exports,"ungeoreferenceByTransform",(function(){return C})),t(n.exports,"project",(function(){return V}));var o=e("zPXCh"),i=e("4vUOo"),a=e("9gD5C"),c=e("2ouJi"),u=e("8lcnQ"),s=e("iHxaG"),l=e("52822"),f=e("5cP7j"),p=e("nVnNX"),g=e("esjR0"),h=e("9Eiwp"),y=e("krhAj"),P=e("7insl"),m=e("1G15h"),x=e("3Bcds"),M=e("8zb78"),d=e("8huIY");function A(t,e,n){return(0,M.isGeographicMesh)(e.spatialReference,n)?function(t,e,n){const r=e.spatialReference,o=b(e,n,O),i=new Float64Array(t.position.length),a=function(t,e,n,r){(0,x.t)(r,t,e);const o=new Float64Array(t.length);return(0,d.projectFromPCPF)(r,o,n)}(t.position,o,r,i),c=(0,l.b)(E,o);return{position:a,normal:j(a,i,t.normal,c,r),tangent:v(a,i,t.tangent,c,r)}}(t,e,n):function(t,e,n){const r=new Float64Array(t.position.length),o=t.position,i=e.x,a=e.y,c=e.z??0,u=_(n?n.unit:null,e.spatialReference);for(let t=0;t<o.length;t+=3)r[t]=o[t]*u+i,r[t+1]=o[t+1]*u+a,r[t+2]=o[t+2]*u+c;return{position:r,normal:t.normal,tangent:t.tangent}}(t,e,n)}function F(t,e,n,r){const{position:o,normal:i,tangent:a}=t;if(!e.isRelative)return{position:o,normal:i,tangent:a};const u=n?.localMatrix??c.I;return A({position:(0,x.t)(new Float64Array(o.length),o,u),normal:null!=i?(0,d.transformNormal)(i,new Float32Array(i.length),u):null,tangent:null!=a?(0,d.transformTangent)(a,new Float32Array(a.length),u):null},e.getOriginPoint(r),{geographic:!e.isGeoreferenced})}function T(t,e,n){if(n?.useTransform){const{position:r,normal:o,tangent:i}=t,{x:a,y:c,z:u}=e,l=(0,s.f)(a,c,u??0);return{vertexAttributes:{position:r,normal:o,tangent:i},vertexSpace:n.geographic??1?new(0,P.default)({origin:l}):new(0,h.default)({origin:l}),transform:new(0,m.default)}}return{vertexAttributes:A(t,e,n),vertexSpace:new(0,y.default),transform:null}}function w(t,e,n){return(0,M.isGeographicMesh)(e.spatialReference,n)?function(t,e,n){const r=e.spatialReference;b(e,n,O);const o=(0,a.a)(N,O),i=new Float64Array(t.position.length),c=function(t,e,n,r){const o=(0,d.projectToPCPF)(t,e,r),i=new Float64Array(o.length);return(0,x.t)(i,o,n),i}(t.position,r,o,i),u=(0,l.b)(E,o);return{position:c,normal:S(t.normal,t.position,i,r,u),tangent:B(t.tangent,t.position,i,r,u)}}(t,e,n):R(t,e,n)}function C(t,e,n,r,o){if(!e.isRelative)return w(t,r,o);const{spatialReference:i}=r,a=F(t,e,n,i);return r.equals(e.getOriginPoint(i))?R(a,r,o):w(a,r,o)}function V({positions:t,transform:e,vertexSpace:n,inSpatialReference:r,outSpatialReference:o,outPositions:i,local:l}){const h=n.isRelative?n.origin:s.Z,y=n.isRelative?e?.localMatrix??c.I:c.I;if(n.isGeoreferenced){const e=i??(0,g.newDoubleArray)(t.length);if((0,a.j)(y,c.I)?(0,g.copyInto)(e,t):(0,x.t)(e,t,y),!(0,u.k)(h,s.Z)){const[t,n,r]=h;for(let o=0;o<e.length;o+=3)e[o]+=t,e[o+1]+=n,e[o+2]+=r}return(0,f.projectBuffer)(e,r,0,e,o,0,e.length/3),e}const P=(0,p.getSphericalPCPF)(r),m=!l&&(0,f.canProjectWithoutEngine)(r,P)?P:r;(0,f.computeTranslationToOriginAndRotation)(r,h,O,m),(0,a.m)(O,O,y);const M=i??(0,g.newDoubleArray)(t.length);return(0,x.t)(M,t,O),(0,f.projectBuffer)(M,m,0,M,o,0,M.length/3),M}function j(t,e,n,r,o){if(null==n)return null;const i=new Float32Array(n.length);return(0,x.a)(i,n,r),(0,d.projectNormalFromPCPF)(i,t,e,o,i),i}function v(t,e,n,r,o){if(null==n)return null;const i=new Float32Array(n.length);(0,x.a)(i,n,r,4);for(let t=3;t<i.length;t+=4)i[t]=n[t];return(0,d.projectTangentFromPCPF)(i,t,e,o,i),i}function R(t,e,n){const r=new Float64Array(t.position.length),o=t.position,i=e.x,a=e.y,c=e.z??0,u=_(n?n.unit:null,e.spatialReference);for(let t=0;t<o.length;t+=3)r[t]=(o[t]-i)/u,r[t+1]=(o[t+1]-a)/u,r[t+2]=(o[t+2]-c)/u;return{position:r,normal:t.normal,tangent:t.tangent}}function b(t,e,n){(0,f.computeTranslationToOriginAndRotation)(t.spatialReference,[t.x,t.y,t.z??0],n,(0,p.getSphericalPCPF)(t.spatialReference));const r=_(e?e.unit:null,t.spatialReference);return(0,a.k)(n,n,[r,r,r]),n}function S(t,e,n,r,o){if(null==t)return null;const i=(0,d.projectNormalToPCPF)(t,e,n,r,new Float32Array(t.length));return(0,x.a)(i,i,o),i}function B(t,e,n,r,o){if(null==t)return null;const i=(0,d.projectTangentToPCPF)(t,e,n,r,new Float32Array(t.length));return(0,x.a)(i,i,o,4),i}function _(t,e){if(null==t)return 1;const n=(0,o.getMetersPerCartesianUnitForSR)(e);return 1/(0,o.convertUnit)(n,"meters",t)}const O=(0,c.c)(),N=(0,c.c)(),E=(0,i.c)()})),e.register("nVnNX",(function(n,r){t(n.exports,"getSphericalPCPF",(function(){return l}));var o=e("4ij3s"),i=e("jaaCV"),a=e("fau59");const c=new(0,i.default)(o.SphericalECEFSpatialReferenceLike),u=new(0,i.default)(o.SphericalPCPFMarsLike),s=new(0,i.default)(o.SphericalPCPFMoonLike);new(0,i.default)(o.WGS84ECEFSpatialReferenceLike);function l(t){return t&&((0,a.isMars)(t)||(0,a.equals)(t,u))?u:t&&((0,a.isMoon)(t)||(0,a.equals)(t,s))?s:c}})),e.register("1G15h",(function(n,r){t(n.exports,"default",(function(){return x}));var o=e("j6uz9"),i=e("hO0an"),a=e("hTI69");e("gHCNy"),e("aX9sh"),e("5HTPH");var c,u=e("qA6zg"),s=e("9gD5C"),l=e("2ouJi"),f=e("gDeEN"),p=e("6MY4j"),g=e("8lcnQ"),h=e("iHxaG"),y=e("kRASh");let P=c=class extends i.JSONSupport{get rotation(){return(0,y.fromAxisAndAngle)(this.rotationAxis,this.rotationAngle)}set rotation(t){this.rotationAxis=(0,h.a)((0,y.axis)(t)),this.rotationAngle=(0,y.angle)(t)}get localMatrix(){const t=(0,l.c)();return(0,f.s)(m,(0,y.axis)(this.rotation),(0,y.angleRad)(this.rotation)),(0,s.g)(t,m,this.translation,this.scale),t}get localMatrixInverse(){return(0,s.a)((0,l.c)(),this.localMatrix)}applyLocal(t,e){return(0,g.m)(e,t,this.localMatrix)}applyLocalInverse(t,e){return(0,g.m)(e,t,this.localMatrixInverse)}equals(t){return this===t||null!=t&&(0,s.h)(this.localMatrix,t.localMatrix)}clone(){const t={translation:(0,h.a)(this.translation),rotationAxis:(0,h.a)(this.rotationAxis),rotationAngle:this.rotationAngle,scale:(0,h.a)(this.scale)};return new c(t)}constructor(t){super(t),this.translation=(0,h.c)(),this.rotationAxis=(0,h.g)(y.UP),this.rotationAngle=0,this.scale=(0,h.f)(1,1,1)}};(0,o._)([(0,a.property)({type:[Number],nonNullable:!0,json:{write:!0}})],P.prototype,"translation",void 0),(0,o._)([(0,a.property)({type:[Number],nonNullable:!0,json:{write:!0}})],P.prototype,"rotationAxis",void 0),(0,o._)([(0,a.property)({type:Number,nonNullable:!0,json:{write:!0}})],P.prototype,"rotationAngle",void 0),(0,o._)([(0,a.property)({type:[Number],nonNullable:!0,json:{write:!0}})],P.prototype,"scale",void 0),(0,o._)([(0,a.property)()],P.prototype,"rotation",null),(0,o._)([(0,a.property)()],P.prototype,"localMatrix",null),(0,o._)([(0,a.property)()],P.prototype,"localMatrixInverse",null),P=c=(0,o._)([(0,u.subclass)("esri.geometry.support.MeshTransform")],P);const m=(0,p.a)(),x=P})),e.register("gDeEN",(function(n,r){t(n.exports,"s",(function(){return l})),t(n.exports,"g",(function(){return f})),t(n.exports,"m",(function(){return p})),t(n.exports,"c",(function(){return h})),t(n.exports,"k",(function(){return P})),t(n.exports,"a",(function(){return m})),t(n.exports,"j",(function(){return R}));var o=e("4vUOo"),i=e("6MY4j"),a=e("iHxaG"),c=e("6LBkm"),u=e("8lcnQ"),s=e("7X4gL");function l(t,e,n){n*=.5;const r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function f(t,e){const n=2*Math.acos(e[3]),r=Math.sin(n/2);return r>(0,c.g)()?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n}function p(t,e,n){const r=e[0],o=e[1],i=e[2],a=e[3],c=n[0],u=n[1],s=n[2],l=n[3];return t[0]=r*l+a*c+o*s-i*u,t[1]=o*l+a*u+i*c-r*s,t[2]=i*l+a*s+r*u-o*c,t[3]=a*l-r*c-o*u-i*s,t}function g(t,e,n,r){const o=e[0],i=e[1],a=e[2],u=e[3];let s,l,f,p,g,h=n[0],y=n[1],P=n[2],m=n[3];return l=o*h+i*y+a*P+u*m,l<0&&(l=-l,h=-h,y=-y,P=-P,m=-m),1-l>(0,c.g)()?(s=Math.acos(l),f=Math.sin(s),p=Math.sin((1-r)*s)/f,g=Math.sin(r*s)/f):(p=1-r,g=r),t[0]=p*o+g*h,t[1]=p*i+g*y,t[2]=p*a+g*P,t[3]=p*u+g*m,t}function h(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function y(t,e){const n=e[0]+e[4]+e[8];let r;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{let n=0;e[4]>e[0]&&(n=1),e[8]>e[3*n+n]&&(n=2);const o=(n+1)%3,i=(n+2)%3;r=Math.sqrt(e[3*n+n]-e[3*o+o]-e[3*i+i]+1),t[n]=.5*r,r=.5/r,t[3]=(e[3*o+i]-e[3*i+o])*r,t[o]=(e[3*o+n]+e[3*n+o])*r,t[i]=(e[3*i+n]+e[3*n+i])*r}return t}function P(t,e,n,r){const o=.5*Math.PI/180;e*=o,n*=o,r*=o;const i=Math.sin(e),a=Math.cos(e),c=Math.sin(n),u=Math.cos(n),s=Math.sin(r),l=Math.cos(r);return t[0]=i*u*l-a*c*s,t[1]=a*c*l+i*u*s,t[2]=a*u*s-i*c*l,t[3]=a*u*l+i*c*s,t}const m=s.c,x=s.s,M=s.a,d=p,A=s.b,F=s.d,T=s.l,w=s.e,C=w,V=s.f,j=V,v=s.n,R=s.g,b=s.h;const S=(0,a.c)(),B=(0,a.f)(1,0,0),_=(0,a.f)(0,1,0);const O=(0,i.a)(),N=(0,i.a)();const E=(0,o.c)();Object.freeze(Object.defineProperty({__proto__:null,add:M,calculateW:function(t,e){const n=e[0],r=e[1],o=e[2];return t[0]=n,t[1]=r,t[2]=o,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-o*o)),t},conjugate:h,copy:m,dot:F,equals:b,exactEquals:R,fromEuler:P,fromMat3:y,getAxisAngle:f,identity:function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},invert:function(t,e){const n=e[0],r=e[1],o=e[2],i=e[3],a=n*n+r*r+o*o+i*i,c=a?1/a:0;return t[0]=-n*c,t[1]=-r*c,t[2]=-o*c,t[3]=i*c,t},len:C,length:w,lerp:T,mul:d,multiply:p,normalize:v,random:function(t){const e=c.R,n=e(),r=e(),o=e(),i=Math.sqrt(1-n),a=Math.sqrt(n);return t[0]=i*Math.sin(2*Math.PI*r),t[1]=i*Math.cos(2*Math.PI*r),t[2]=a*Math.sin(2*Math.PI*o),t[3]=a*Math.cos(2*Math.PI*o),t},rotateX:function(t,e,n){n*=.5;const r=e[0],o=e[1],i=e[2],a=e[3],c=Math.sin(n),u=Math.cos(n);return t[0]=r*u+a*c,t[1]=o*u+i*c,t[2]=i*u-o*c,t[3]=a*u-r*c,t},rotateY:function(t,e,n){n*=.5;const r=e[0],o=e[1],i=e[2],a=e[3],c=Math.sin(n),u=Math.cos(n);return t[0]=r*u-i*c,t[1]=o*u+a*c,t[2]=i*u+r*c,t[3]=a*u-o*c,t},rotateZ:function(t,e,n){n*=.5;const r=e[0],o=e[1],i=e[2],a=e[3],c=Math.sin(n),u=Math.cos(n);return t[0]=r*u+o*c,t[1]=o*u-r*c,t[2]=i*u+a*c,t[3]=a*u-i*c,t},rotationTo:function(t,e,n){const r=(0,u.e)(e,n);return r<-.999999?((0,u.f)(S,B,e),(0,u.u)(S)<1e-6&&(0,u.f)(S,_,e),(0,u.n)(S,S),l(t,S,Math.PI),t):r>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):((0,u.f)(S,e,n),t[0]=S[0],t[1]=S[1],t[2]=S[2],t[3]=1+r,v(t,t))},scale:A,set:x,setAxes:function(t,e,n,r){const o=E;return o[0]=n[0],o[3]=n[1],o[6]=n[2],o[1]=r[0],o[4]=r[1],o[7]=r[2],o[2]=-e[0],o[5]=-e[1],o[8]=-e[2],v(t,y(t,o))},setAxisAngle:l,slerp:g,sqlerp:function(t,e,n,r,o,i){return g(O,e,o,i),g(N,n,r,i),g(t,O,N,2*i*(1-i)),t},sqrLen:j,squaredLength:V,str:function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}},Symbol.toStringTag,{value:"Module"}))})),e.register("kRASh",(function(n,r){t(n.exports,"create",(function(){return s})),t(n.exports,"UP",(function(){return P})),t(n.exports,"fromAxisAndAngle",(function(){return l})),t(n.exports,"axis",(function(){return g})),t(n.exports,"compose",(function(){return f})),t(n.exports,"angleRad",(function(){return y})),t(n.exports,"composeAxes",(function(){return p})),t(n.exports,"angle",(function(){return h}));var o=e("8TN87"),i=e("gDeEN"),a=e("6MY4j"),c=e("8lcnQ"),u=e("iHxaG");function s(t=P){return[t[0],t[1],t[2],t[3]]}function l(t,e,n=s()){return(0,c.c)(n,t),n[3]=e,n}function f(t,e,n=s()){return(0,i.s)(m,t,y(t)),(0,i.s)(x,e,y(e)),(0,i.m)(m,x,m),function(t,e){return t[3]=e,t}(n,(0,o.rad2deg)((0,i.g)(n,m)))}function p(t,e,n,r=s()){return l(u.d,t,M),l(u.e,e,d),l(u.U,n,A),f(M,d,M),f(M,A,r),r}function g(t){return t}function h(t){return t[3]}function y(t){return(0,o.deg2rad)(t[3])}const P=[0,0,1,0],m=(0,a.a)(),x=(0,a.a)(),M=(s(),s()),d=s(),A=s()})),e.register("8zb78",(function(n,r){t(n.exports,"isGeographicMesh",(function(){return i})),t(n.exports,"validateGeographicFlag",(function(){return a}));var o=e("6TszD");function i(t,e){return t.isGeographic||t.isWebMercator&&(e?.geographic??!0)}function a(t,e,n){const r=!t.isGeoreferenced;null!=n?.geographic&&n.geographic!==r&&o.default.getLogger(e).warnOnce(`Specifying the 'geographic' parameter (${n.geographic}) for a Mesh vertex space of type "${t.type}" is not supported. This parameter will be ignored.`)}})),e.register("8huIY",(function(n,r){t(n.exports,"projectNormalToPCPF",(function(){return m})),t(n.exports,"projectNormalFromPCPF",(function(){return x})),t(n.exports,"projectToPCPF",(function(){return M})),t(n.exports,"projectFromPCPF",(function(){return d})),t(n.exports,"transformNormal",(function(){return A})),t(n.exports,"transformTangent",(function(){return F})),t(n.exports,"projectTangentToPCPF",(function(){return T})),t(n.exports,"projectTangentFromPCPF",(function(){return w}));var o=e("6TszD"),i=e("52822"),a=e("4vUOo"),c=e("2ouJi"),u=e("8lcnQ"),s=e("iHxaG"),l=e("5cP7j"),f=e("nVnNX"),p=e("fau59"),g=e("ZYFMI"),h=e("k4Lc2"),y=e("3Bcds");const P=o.default.getLogger("esri.geometry.support.meshUtils.normalProjection");function m(t,e,n,r,o){return V(r)?(C(v.TO_PCPF,h.BufferViewVec3f.fromTypedArray(t),h.BufferViewVec3f64.fromTypedArray(e),h.BufferViewVec3f64.fromTypedArray(n),r,h.BufferViewVec3f.fromTypedArray(o)),o):(P.error("Cannot convert spatial reference to PCPF"),o)}function x(t,e,n,r,o){return V(r)?(C(v.FROM_PCPF,h.BufferViewVec3f.fromTypedArray(t),h.BufferViewVec3f64.fromTypedArray(e),h.BufferViewVec3f64.fromTypedArray(n),r,h.BufferViewVec3f.fromTypedArray(o)),o):(P.error("Cannot convert to spatial reference from PCPF"),o)}function M(t,e,n){return(0,l.projectBuffer)(t,e,0,n,(0,f.getSphericalPCPF)(e),0,t.length/3),n}function d(t,e,n){return(0,l.projectBuffer)(t,(0,f.getSphericalPCPF)(n),0,e,n,0,t.length/3),e}function A(t,e,n){return(0,i.b)(_,n),(0,y.a)(e,t,_),(0,i.i)(_)||(0,y.n)(e,e),e}function F(t,e,n){if((0,i.b)(_,n),(0,y.a)(e,t,_,4),(0,i.i)(_)||(0,y.n)(e,e,4),t!==e)for(let n=3;n<t.length;n+=4)e[n]=t[n];return e}function T(t,e,n,r,o){if(!V(r))return P.error("Cannot convert spatial reference to PCPF"),o;C(v.TO_PCPF,h.BufferViewVec3f.fromTypedArray(t,4*Float32Array.BYTES_PER_ELEMENT),h.BufferViewVec3f64.fromTypedArray(e),h.BufferViewVec3f64.fromTypedArray(n),r,h.BufferViewVec3f.fromTypedArray(o,4*Float32Array.BYTES_PER_ELEMENT));for(let e=3;e<t.length;e+=4)o[e]=t[e];return o}function w(t,e,n,r,o){if(!V(r))return P.error("Cannot convert to spatial reference from PCPF"),o;C(v.FROM_PCPF,h.BufferViewVec3f.fromTypedArray(t,16),h.BufferViewVec3f64.fromTypedArray(e),h.BufferViewVec3f64.fromTypedArray(n),r,h.BufferViewVec3f.fromTypedArray(o,16));for(let e=3;e<t.length;e+=4)o[e]=t[e];return o}function C(t,e,n,r,o,a){if(!e)return;const c=n.count,s=(0,f.getSphericalPCPF)(o);if(j(o))for(let n=0;n<c;n++)r.getVec(n,b),e.getVec(n,S),(0,l.computeTranslationToOriginAndRotation)(s,b,B,s),(0,i.f)(_,B),t===v.FROM_PCPF&&(0,i.t)(_,_),(0,u.t)(S,S,_),a.setVec(n,S);else for(let o=0;o<c;o++){r.getVec(o,b),e.getVec(o,S),(0,l.computeTranslationToOriginAndRotation)(s,b,B,s),(0,i.f)(_,B);const c=(0,g.y2lat)(n.get(o,1));let f=Math.cos(c);t===v.TO_PCPF&&(f=1/f),_[0]*=f,_[1]*=f,_[2]*=f,_[3]*=f,_[4]*=f,_[5]*=f,t===v.FROM_PCPF&&(0,i.t)(_,_),(0,u.t)(S,S,_),(0,u.n)(S,S),a.setVec(o,S)}return a}function V(t){return j(t)||function(t){return t.isWebMercator}(t)}function j(t){return t.isWGS84||(0,p.isCGCS2000)(t)||(0,p.isMars)(t)||(0,p.isMoon)(t)}var v,R;(R=v||(v={}))[R.TO_PCPF=0]="TO_PCPF",R[R.FROM_PCPF=1]="FROM_PCPF";const b=(0,s.c)(),S=(0,s.c)(),B=(0,c.c)(),_=(0,a.c)()}));
//# sourceMappingURL=georeference.7eede090.js.map
