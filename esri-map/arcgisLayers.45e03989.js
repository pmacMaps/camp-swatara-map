!function(){function e(e){return e&&e.__esModule?e.default:e}var r=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire594f;r.register("1VmFB",(function(t,n){var a,u,s,l;a=t.exports,u="fromUrl",s=function(){return v},Object.defineProperty(a,u,{get:s,set:l,enumerable:!0,configurable:!0});var o=r("8TSCy"),i=r("2TvXO"),c=r("9pNSx"),p=r("kyj08"),y=r("7qybv"),f=r("kYueh"),d=r("lmu5w"),b=r("ge5sz");function v(e){return h.apply(this,arguments)}function h(){return(h=o.asyncToGenerator(e(i).mark((function t(n){var a,u,s,l,c;return e(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=null==(a=n.properties)?void 0:a.customParameters,e.next=4,m(n.url,u);case 4:if(s=e.sent,l=o.objectSpread({},n.properties,{url:n.url}),s.sublayerIds){e.next=8;break}return e.abrupt("return",(null!=s.layerOrTableId&&(l.layerId=s.layerOrTableId,l.sourceJSON=s.sourceJSON),new s.Constructor(l)));case 8:return e.next=10,r("aEtgJ");case 10:return e.t0=e.sent.default,e.t1={title:s.parsedUrl.title},c=new e.t0(e.t1),e.abrupt("return",(I(c,s,l),c));case 14:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function S(e,r){return e?e.find((function(e){return e.id===r})):null}function I(e,r,t){function n(e,n){var a=o.objectSpread({},t,{layerId:e,sublayerTitleMode:"service-name"});return(0,y.isSome)(n)&&(a.sourceJSON=n),new r.Constructor(a)}r.sublayerIds.forEach((function(t){var a=n(t,S(r.sublayerInfos,t));e.add(a)})),r.tableIds.forEach((function(t){var a=n(t,S(r.tableInfos,t));e.tables.add(a)}))}function m(e,r){return x.apply(this,arguments)}function x(){return(x=o.asyncToGenerator(e(i).mark((function r(t,n){var a,u,s,l,o,c,f,b,v,h,S,I;return e(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=(0,d.parse)(t),e.t0=(0,y.isNone)(a),!e.t0){e.next=6;break}return e.next=5,w(t,n);case 5:a=e.sent;case 6:if(e.t0,!(0,y.isNone)(a)){e.next=8;break}throw new(0,p.default)("arcgis-layers:url-mismatch","The url '${url}' is not a valid arcgis resource",{url:t});case 8:u=a.serverType,s=a.sublayer,o={FeatureServer:"FeatureLayer",StreamServer:"StreamLayer",VectorTileServer:"VectorTileLayer"},e.t1=u,e.next="MapServer"===e.t1?14:"ImageServer"===e.t1?16:"SceneServer"===e.t1?18:20;break;case 14:return l=null!=s?"FeatureLayer":F(t,n).then((function(e){return e?"TileLayer":"MapImageLayer"})),e.abrupt("break",21);case 16:return l=G(t,n).then((function(e){var r=e.tileInfo&&e.tileInfo.format;return e.tileInfo?!r||"LERC"!==r.toUpperCase()||e.cacheType&&"elevation"!==e.cacheType.toLowerCase()?"ImageryTileLayer":"ElevationLayer":"ImageryLayer"})),e.abrupt("break",21);case 18:return l=G(a.url.path,n).then((function(e){if(e){if("Voxel"===(null==e?void 0:e.layerType))return"VoxelLayer";if(null!=e&&e.layers&&Array.isArray(e.layers)&&e.layers.length>0){var r,t={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"},n=null==(r=e.layers[0])?void 0:r.layerType;if(null!=t[n])return t[n]}}return"SceneLayer"})),e.abrupt("break",21);case 20:l=o[u];case 21:return c={FeatureLayer:!0,SceneLayer:!0},b={parsedUrl:a,Constructor:null,layerOrTableId:(f="FeatureServer"===u)?s:null,sublayerIds:null,tableIds:null},e.next=26,l;case 26:if(v=e.sent,!c[v]||null!=s){e.next=33;break}return e.next=30,O(t,u,n);case 30:h=e.sent,f&&(b.sublayerInfos=h.layerInfos,b.tableInfos=h.tableInfos),1!==h.layerIds.length+h.tableIds.length?(b.sublayerIds=h.layerIds,b.tableIds=h.tableIds):f&&(b.layerOrTableId=null!=(S=h.layerIds[0])?S:h.tableIds[0],b.sourceJSON=null!=(I=h.layerInfos[0])?I:h.tableInfos[0]);case 33:return e.next=35,C(v);case 35:return b.Constructor=e.sent,e.abrupt("return",b);case 37:case"end":return e.stop()}}),r)})))).apply(this,arguments)}function w(e,r){return T.apply(this,arguments)}function T(){return(T=o.asyncToGenerator(e(i).mark((function r(t,n){var a,u,s,l,o,c;return e(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,G(t,n);case 3:if(u=e.sent,s=null,l=null,"Feature Layer"===(o=u.type)||"Table"===o?(s="FeatureServer",l=u.id):"indexedVector"===o?s="VectorTileServer":u.hasOwnProperty("mapName")?s="MapServer":u.hasOwnProperty("bandCount")&&u.hasOwnProperty("pixelSizeX")?s="ImageServer":u.hasOwnProperty("maxRecordCount")&&u.hasOwnProperty("allowGeometryUpdates")?s="FeatureServer":u.hasOwnProperty("streamUrls")?s="StreamServer":g(u)?(s="SceneServer",l=u.id):u.hasOwnProperty("layers")&&g(null==(a=u.layers)?void 0:a[0])&&(s="SceneServer"),s){e.next=8;break}return e.abrupt("return",null);case 8:return c=null!=l?(0,d.parseNonStandardSublayerUrl)(t):null,e.abrupt("return",{title:(0,y.isSome)(c)&&u.name||(0,f.getFilename)(t),serverType:s,sublayer:l,url:{path:(0,y.isSome)(c)?c.serviceUrl:(0,f.urlToObject)(t).path}});case 10:case"end":return e.stop()}}),r)})))).apply(this,arguments)}function g(e){return(null==e?void 0:e.hasOwnProperty("store"))&&e.hasOwnProperty("id")&&"number"==typeof e.id}function O(e,r,t){return k.apply(this,arguments)}function k(){return(k=o.asyncToGenerator(e(i).mark((function r(t,n,a){var u,s,l,o,c,p,y;return e(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=!1,"FeatureServer"!==n){e.next=9;break}return e.next=5,N(t,a);case 5:c=e.sent,o=!!c.layersJSON,l=c.layersJSON||c.serviceJSON,e.next=12;break;case 9:return e.next=11,G(t,a);case 11:l=e.sent;case 12:return p=null==(u=l)?void 0:u.layers,y=null==(s=l)?void 0:s.tables,e.abrupt("return",{layerIds:(null==p?void 0:p.map((function(e){return e.id})).reverse())||[],tableIds:(null==y?void 0:y.map((function(e){return e.id})).reverse())||[],layerInfos:o?p:[],tableInfos:o?y:[]});case 14:case"end":return e.stop()}}),r)})))).apply(this,arguments)}function L(e){return!e.type||"Feature Layer"===e.type}function N(e,r){return P.apply(this,arguments)}function P(){return(P=o.asyncToGenerator(e(i).mark((function r(t,n){var a,u,s,l,o;return e(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,G(t,n);case 3:if((s=(s=e.sent)||{}).layers=(null==(a=s.layers)?void 0:a.filter(L))||[],l={serviceJSON:s},!(s.currentVersion<10.5)){e.next=8;break}return e.abrupt("return",l);case 8:return e.next=10,G(t+"/layers",n);case 10:return o=e.sent,e.abrupt("return",(l.layersJSON={layers:(null==o||null==(u=o.layers)?void 0:u.filter(L))||[],tables:(null==o?void 0:o.tables)||[]},l));case 12:case"end":return e.stop()}}),r)})))).apply(this,arguments)}function C(e){return J.apply(this,arguments)}function J(){return(J=o.asyncToGenerator(e(i).mark((function r(t){return e(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,b.layerLookupMap[t])());case 1:case"end":return e.stop()}}),r)})))).apply(this,arguments)}function F(e,r){return j.apply(this,arguments)}function j(){return(j=o.asyncToGenerator(e(i).mark((function r(t,n){return e(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G(t,n);case 2:return e.abrupt("return",e.sent.tileInfo);case 3:case"end":return e.stop()}}),r)})))).apply(this,arguments)}function G(e,r){return U.apply(this,arguments)}function U(){return(U=o.asyncToGenerator(e(i).mark((function r(t,n){return e(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,c.default)(t,{responseType:"json",query:o.objectSpread({f:"json"},n)});case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}}),r)})))).apply(this,arguments)}})),r.register("aEtgJ",(function(e,t){e.exports=r("4WKyX")(r("aNJCr").getBundleURL("kcJXD")+r("iE7OH").resolve("3PyzW")).then((function(){return r("eBpzH")}))}))}();
//# sourceMappingURL=arcgisLayers.45e03989.js.map
