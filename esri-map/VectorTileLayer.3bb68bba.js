!function(){function e(e){return e&&e.__esModule?e.default:e}var t=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire594f;t.register("1J8jF",(function(r,o){var n,a,i,l,s;n=r.exports,Object.defineProperty(n,"__esModule",{value:!0,configurable:!0}),a=r.exports,i="default",l=function(){return F},Object.defineProperty(a,i,{get:l,set:s,enumerable:!0,configurable:!0});var u=t("8TSCy"),p=t("2TvXO"),y=t("7eJjO"),c=t("9pNSx"),d=t("kyj08"),f=t("flPLJ"),v=t("8NioF"),h=t("10vEZ"),S=t("kYueh"),g=t("iho5X");t("iJAIC");var m=t("eB8sj"),b=t("fcwIv"),_=t("kced1"),k=t("gINRd"),w=t("j40xv"),x=t("4LDxK"),T=t("jy0BF"),I=t("1a7AW"),P=t("aLy89"),O=t("gIXJ2"),L=t("cv2jJ"),j=t("5N5S1"),R=t("9bAYR"),U=t("3GzOb"),M=t("2Yxel"),C=t("bxPyI"),A=t("xQ42o"),N=t("bNyRh"),V=t("UdTKD"),D=t("aOITd"),G=t("7dqtP"),B=t("3NAox"),E=function(t){"use strict";u.inherits(o,t);var r=u.createSuper(o);function o(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var a;return u.classCallCheck(this,o),(a=r.call.apply(r,[this].concat(u.toConsumableArray(t))))._spriteSourceMap=new Map,a.currentStyleInfo=null,a.style=null,a.isReference=null,a.operationalLayerType="VectorTileLayer",a.type="vector-tile",a.url=null,a.symbolCollisionBoxesVisible=!1,a.path=null,u.possibleConstructorReturn(a)}return u.createClass(o,[{key:"normalizeCtorArgs",value:function(e,t){return"string"==typeof e?u.objectSpread({url:e},t):e}},{key:"destroy",value:function(){var e=!0,t=!1,r=void 0;if(this.sourceNameToSource)try{for(var o,n=Object.values(this.sourceNameToSource)[Symbol.iterator]();!(e=(o=n.next()).done);e=!0){var a=o.value;null==a||a.destroy()}}catch(e){t=!0,r=e}finally{try{e||null==n.return||n.return()}finally{if(t)throw r}}this._spriteSourceMap.clear()}},{key:"prefetchResources",value:function(t){var r=this;return u.asyncToGenerator(e(p).mark((function o(){return e(p).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.loadSpriteSource(globalThis.devicePixelRatio||1,t);case 2:case"end":return e.stop()}}),o)})))()}},{key:"load",value:function(t){var r=this,o=this,n=this.loadFromPortal({supportedTypes:["Vector Tile Service"],supportsData:!1},t).catch(h.throwIfAbortError).then(u.asyncToGenerator(e(p).mark((function r(){var n;return e(p).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o.portalItem&&o.portalItem.id){e.next=2;break}return e.abrupt("return");case 2:return n="".concat(o.portalItem.itemUrl,"/resources/styles/root.json"),e.next=5,(0,c.default)(n,u.objectSpread({},t,{query:u.objectSpread({f:"json"},o.customParameters,{token:o.apiKey})}));case 5:if(e.t0=e.sent.data,!e.t0){e.next=8;break}o.read({url:n},(0,V.createForItem)(o.portalItem));case 8:case"end":return e.stop()}}),r)})))).catch(h.throwIfAbortError).then((function(){return r._loadStyle(t)}));return this.addResolvingPromise(n),Promise.resolve(this)}},{key:"attributionDataUrl",get:function(){var e=this.currentStyleInfo,t=e&&e.serviceUrl&&(0,S.urlToObject)(e.serviceUrl);if(!t)return null;var r=this._getDefaultAttribution(t.path);return r?(0,S.addQueryParameters)(r,u.objectSpread({},this.customParameters,{token:this.apiKey})):null}},{key:"capabilities",get:function(){var e=this.primarySource;return e?e.capabilities:{operations:{supportsExportTiles:!1,supportsTileMap:!1},exportTiles:null}}},{key:"fullExtent",get:function(){var e;return(null==(e=this.primarySource)?void 0:e.fullExtent)||null}},{key:"parsedUrl",get:function(){return this.serviceUrl?(0,S.urlToObject)(this.serviceUrl):null}},{key:"serviceUrl",get:function(){return this.currentStyleInfo&&this.currentStyleInfo.serviceUrl||null}},{key:"spatialReference",get:function(){return this.tileInfo&&this.tileInfo.spatialReference||null}},{key:"styleUrl",get:function(){return this.currentStyleInfo&&this.currentStyleInfo.styleUrl||null}},{key:"writeStyleUrl",value:function(e,t){e&&(0,S.isProtocolRelative)(e)&&(e="https:".concat(e)),t.styleUrl=e}},{key:"tileInfo",get:function(){var e,t=[];for(var r in this.sourceNameToSource)t.push(this.sourceNameToSource[r]);var o=(null==(e=this.primarySource)?void 0:e.tileInfo)||new(0,A.default);if(t.length>1)for(var n=0;n<t.length;n++)(0,D.areSchemasOverlapping)(o,t[n].tileInfo)&&(o=(0,D.unionTileInfos)(o,t[n].tileInfo));return o}},{key:"readVersion",value:function(e,t){return t.version?parseFloat(t.version):parseFloat(t.currentVersion)}},{key:"loadSpriteSource",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1?arguments[1]:void 0,o=this;return u.asyncToGenerator(e(p).mark((function n(){var a,i,l,s;return e(p).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o._spriteSourceMap.has(t)){e.next=6;break}return i=(0,B.getWebGL1Capabilities)().maxTextureSize,l=null!=(a=o.currentStyleInfo)&&a.spriteUrl?(0,S.addQueryParameters)(o.currentStyleInfo.spriteUrl,u.objectSpread({},o.customParameters,{token:o.apiKey})):null,s=new(0,C.default)(l,t,i,o.currentStyleInfo.spriteFormat),e.next=5,s.load(r);case 5:o._spriteSourceMap.set(t,s);case 6:return e.abrupt("return",Promise.resolve(o._spriteSourceMap.get(t)));case 7:case"end":return e.stop()}}),n)})))()}},{key:"setSpriteSource",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"png",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3?arguments[3]:void 0,a=this;return u.asyncToGenerator(e(p).mark((function i(){var l,s,y;return e(p).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=(0,B.getWebGL1Capabilities)().maxTextureSize,s=t?(0,S.addQueryParameters)(t,u.objectSpread({},a.customParameters,{token:a.apiKey})):null){e.next=3;break}return e.abrupt("return",null);case 3:return y=new(0,C.default)(s,o,l,r),e.prev=4,e.next=7,y.load(n);case 7:return a._spriteSourceMap.clear(),a._spriteSourceMap.set(o,y),a.currentStyleInfo.spriteUrl=s,a.emit("spriteSource-change",{spriteSource:y}),e.abrupt("return",(e.sent,y));case 14:e.prev=14,e.t0=e.catch(4),(0,h.throwIfAbortError)(e.t0);case 17:return e.abrupt("return",null);case 18:case"end":return e.stop()}}),i,null,[[4,14]])})))()}},{key:"loadStyle",value:function(t,r){var o=this;return u.asyncToGenerator(e(p).mark((function n(){var a,i;return e(p).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t||o.style||o.url,e.abrupt("return",(o._loadingTask&&"string"==typeof i&&o.url===i||(null==(a=o._loadingTask)||a.abort(),o._loadingTask=(0,h.createTask)((function(e){return o._spriteSourceMap.clear(),o._getSourceAndStyle(i,{signal:e})}),r)),o._loadingTask.promise));case 3:case"end":return e.stop()}}),n)})))()}},{key:"getStyleLayerId",value:function(e){return this.styleRepository.getStyleLayerId(e)}},{key:"getStyleLayerIndex",value:function(e){return this.styleRepository.getStyleLayerIndex(e)}},{key:"getPaintProperties",value:function(e){return(0,f.clone)(this.styleRepository.getPaintProperties(e))}},{key:"setPaintProperties",value:function(e,t){var r=this.styleRepository.isPainterDataDriven(e);this.styleRepository.setPaintProperties(e,t);var o=this.styleRepository.isPainterDataDriven(e);this.emit("paint-change",{layer:e,paint:t,isDataDriven:r||o})}},{key:"getStyleLayer",value:function(e){return(0,f.clone)(this.styleRepository.getStyleLayer(e))}},{key:"setStyleLayer",value:function(e,t){this.styleRepository.setStyleLayer(e,t),this.emit("style-layer-change",{layer:e,index:t})}},{key:"deleteStyleLayer",value:function(e){this.styleRepository.deleteStyleLayer(e),this.emit("delete-style-layer",{layer:e})}},{key:"getLayoutProperties",value:function(e){return(0,f.clone)(this.styleRepository.getLayoutProperties(e))}},{key:"setLayoutProperties",value:function(e,t){this.styleRepository.setLayoutProperties(e,t),this.emit("layout-change",{layer:e,layout:t})}},{key:"setStyleLayerVisibility",value:function(e,t){this.styleRepository.setStyleLayerVisibility(e,t),this.emit("style-layer-visibility-change",{layer:e,visibility:t})}},{key:"getStyleLayerVisibility",value:function(e){return this.styleRepository.getStyleLayerVisibility(e)}},{key:"write",value:function(e,t){return null!=t&&t.origin&&!this.styleUrl?(t.messages&&t.messages.push(new(0,d.default)("vectortilelayer:unsupported","VectorTileLayer (".concat(this.title,", ").concat(this.id,") with style defined by JSON only are not supported"),{layer:this})),null):u.get(u.getPrototypeOf(o.prototype),"write",this).call(this,e,t)}},{key:"getTileUrl",value:function(e,t,r){return null}},{key:"_getSourceAndStyle",value:function(t,r){var o=this;return u.asyncToGenerator(e(p).mark((function n(){var a;return e(p).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new Error("invalid style!");case 2:return e.next=4,(0,N.loadMetadata)(t,u.objectSpread({},r,{query:u.objectSpread({},o.customParameters,{token:o.apiKey})}));case 4:if("webp"!==(a=e.sent).spriteFormat){e.next=11;break}return e.next=8,(0,M.checkWebPSupport)("lossy");case 8:if(e.t0=e.sent,e.t0){e.next=11;break}a.spriteFormat="png";case 11:o._set("currentStyleInfo",u.objectSpread({},a)),"string"==typeof t?(o.url=t,o.style=null):(o.url=null,o.style=t),o._set("sourceNameToSource",a.sourceNameToSource),o._set("primarySource",a.sourceNameToSource[a.primarySourceName]),o._set("styleRepository",new(0,G.default)(a.style)),o.read(a.layerDefinition,{origin:"service"}),o.emit("load-style");case 12:case"end":return e.stop()}}),n)})))()}},{key:"_getDefaultAttribution",value:function(e){var t=e.match(/^https?:\/\/(?:basemaps|basemapsbeta|basemapsdev)(?:-api)?\.arcgis\.com(\/[^\/]+)?\/arcgis\/rest\/services\/([^\/]+(\/[^\/]+)*)\/vectortileserver/i);if(t){var r=t[2]&&t[2].toLowerCase();if(r){var o=t[1]||"",n=!0,a=!1,i=void 0;try{for(var l,s=["OpenStreetMap_v2","OpenStreetMap_Daylight_v2","OpenStreetMap_Export_v2","OpenStreetMap_FTS_v2","OpenStreetMap_GCS_v2","World_Basemap","World_Basemap_v2","World_Basemap_Export_v2","World_Basemap_GCS_v2","World_Basemap_WGS84","World_Contours_v2"][Symbol.iterator]();!(n=(l=s.next()).done);n=!0){var u=l.value;if(u.toLowerCase().includes(r))return(0,S.normalize)("//static.arcgis.com/attribution/Vector".concat(o,"/").concat(u))}}catch(e){a=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw i}}}}}},{key:"_loadStyle",value:function(t){var r=this;return u.asyncToGenerator(e(p).mark((function o(){var n,a;return e(p).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null!=(n=null==(a=r._loadingTask)?void 0:a.promise)?n:r.loadStyle(null,t));case 2:case"end":return e.stop()}}),o)})))()}}]),o}((0,O.BlendLayer)((0,U.ScaleRangeLayer)((0,I.ArcGISCachedService)((0,P.ArcGISService)((0,j.OperationalLayer)((0,R.PortalLayer)((0,L.CustomParametersMixin)((0,T.APIKeyMixin)((0,v.MultiOriginJSONMixin)(x.default))))))))));(0,y._)([(0,g.property)({readOnly:!0})],E.prototype,"attributionDataUrl",null),(0,y._)([(0,g.property)({type:["show","hide"]})],E.prototype,"listMode",void 0),(0,y._)([(0,g.property)({readOnly:!0,json:{read:!1}})],E.prototype,"capabilities",null),(0,y._)([(0,g.property)({readOnly:!0})],E.prototype,"currentStyleInfo",void 0),(0,y._)([(0,g.property)({json:{read:!1},readOnly:!0,type:k.default})],E.prototype,"fullExtent",null),(0,y._)([(0,g.property)()],E.prototype,"style",void 0),(0,y._)([(0,g.property)({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:function(){return{enabled:!1}}}}})],E.prototype,"isReference",void 0),(0,y._)([(0,g.property)({type:["VectorTileLayer"]})],E.prototype,"operationalLayerType",void 0),(0,y._)([(0,g.property)({readOnly:!0})],E.prototype,"parsedUrl",null),(0,y._)([(0,g.property)({readOnly:!0})],E.prototype,"serviceUrl",null),(0,y._)([(0,g.property)({type:w.default,readOnly:!0})],E.prototype,"spatialReference",null),(0,y._)([(0,g.property)({readOnly:!0})],E.prototype,"styleRepository",void 0),(0,y._)([(0,g.property)({readOnly:!0})],E.prototype,"sourceNameToSource",void 0),(0,y._)([(0,g.property)({readOnly:!0})],E.prototype,"primarySource",void 0),(0,y._)([(0,g.property)({type:String,readOnly:!0,json:{write:{ignoreOrigin:!0},origins:{"web-document":{write:{ignoreOrigin:!0,isRequired:!0}}}}})],E.prototype,"styleUrl",null),(0,y._)([(0,_.writer)(["portal-item","web-document"],"styleUrl")],E.prototype,"writeStyleUrl",null),(0,y._)([(0,g.property)({json:{read:!1,origins:{service:{read:!1}}},readOnly:!0,type:A.default})],E.prototype,"tileInfo",null),(0,y._)([(0,g.property)({json:{read:!1},readOnly:!0,value:"vector-tile"})],E.prototype,"type",void 0),(0,y._)([(0,g.property)({json:{origins:{"web-document":{read:{source:"styleUrl"}},"portal-item":{read:{source:"url"}}},write:!1,read:!1}})],E.prototype,"url",void 0),(0,y._)([(0,g.property)({readOnly:!0})],E.prototype,"version",void 0),(0,y._)([(0,m.reader)("version",["version","currentVersion"])],E.prototype,"readVersion",null),(0,y._)([(0,g.property)({type:Boolean})],E.prototype,"symbolCollisionBoxesVisible",void 0),(0,y._)([(0,g.property)({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],E.prototype,"path",void 0);var F=E=(0,y._)([(0,b.subclass)("esri.layers.VectorTileLayer")],E)}))}();
//# sourceMappingURL=VectorTileLayer.3bb68bba.js.map
