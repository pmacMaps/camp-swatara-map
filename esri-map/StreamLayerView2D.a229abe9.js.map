{"mappings":"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","sources":["node_modules/@arcgis/core/views/2d/layers/StreamLayerView2D.js","node_modules/@arcgis/core/views/layers/StreamLayerView.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/Error.js\";import{handlesGroup as r}from\"../../../core/handleUtils.js\";import{watch as s}from\"../../../core/reactiveUtils.js\";import{property as i}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/has.js\";import{subclass as o}from\"../../../core/accessorSupport/decorators/subclass.js\";import n from\"../../../rest/support/FeatureSet.js\";import a from\"./FeatureLayerView2D.js\";import{toJSONGeometryType as l}from\"./support/util.js\";import p from\"../../layers/StreamLayerView.js\";function c(e,t){if(null==e&&null==t)return null;const r={};return null!=t&&(r.geometry=t.toJSON()),null!=e&&(r.where=e),r}let u=class extends(p(a)){constructor(){super(...arguments),this.pipelineConnectionStatus=\"disconnected\",this.pipelineErrorString=null,this._enabledEventTypes=new Set}initialize(){this.addHandles([s((()=>this.layer.customParameters),(e=>this._proxy.updateCustomParameters(e))),this.layer.on(\"send-message-to-socket\",(e=>this._proxy.sendMessageToSocket(e))),this.layer.on(\"send-message-to-client\",(e=>this._proxy.sendMessageToClient(e))),s((()=>this.layer.purgeOptions),(()=>this._update())),s((()=>this.suspended),this._onSuspendedChange.bind(this))],\"constructor\")}get connectionError(){return this.pipelineErrorString?new t(\"stream-controller\",this.pipelineErrorString):null}on(e,t){if(Array.isArray(e))return r(e.map((e=>this.on(e,t))));const s=[\"data-received\",\"message-received\"].includes(e);s&&(this._enabledEventTypes.add(e),this._proxy.enableEvent(e,!0));const i=super.on(e,t),o=this;return{remove(){i.remove(),s&&(o._proxy.closed||o.hasEventListener(e)||o._proxy.enableEvent(e,!1))}}}queryLatestObservations(e,r){if(!(this.layer.timeInfo?.endField||this.layer.timeInfo?.startField||this.layer.timeInfo?.trackIdField))throw new t(\"streamlayer-no-timeField\",\"queryLatestObservation can only be used with services that define a TrackIdField\");return this._proxy.queryLatestObservations(this._cleanUpQuery(e),r).then((e=>{const t=n.fromJSON(e);return t.features.forEach((e=>{e.layer=this.layer,e.sourceLayer=this.layer})),t}))}detach(){super.detach(),this.pipelineConnectionStatus=\"disconnected\"}get _streamConnectionStatus(){return this.pipelineConnectionStatus}_doPause(){this._proxy?.pauseStream()}_doResume(){this._proxy?.resumeStream()}_createClientOptions(){return{...super._createClientOptions(),setProperty:e=>{this.set(e.propertyName,e.value)}}}_createTileRendererHash(e){const t=`${JSON.stringify(this.layer.purgeOptions)}.${JSON.stringify(c(this.layer.definitionExpression,this.layer.geometryDefinition))})`;return super._createTileRendererHash(e)+t}async _createServiceOptions(){const e=this.layer,{objectIdField:t}=e,r=e.fields.map((e=>e.toJSON())),s=l(e.geometryType),i=e.timeInfo&&e.timeInfo.toJSON()||null,o=e.spatialReference?e.spatialReference.toJSON():null;return{type:\"stream\",isPaused:this._isUserPaused,fields:r,geometryType:s,objectIdField:t,timeInfo:i,source:this.layer.parsedUrl,serviceFilter:c(this.layer.definitionExpression,this.layer.geometryDefinition),purgeOptions:this.layer.purgeOptions.toJSON(),enabledEventTypes:Array.from(this._enabledEventTypes.values()),spatialReference:o,maxReconnectionAttempts:this.layer.maxReconnectionAttempts,maxReconnectionInterval:this.layer.maxReconnectionInterval,updateInterval:this.layer.updateInterval,customParameters:e.customParameters}}};e([i()],u.prototype,\"pipelineConnectionStatus\",void 0),e([i()],u.prototype,\"pipelineErrorString\",void 0),e([i({readOnly:!0})],u.prototype,\"connectionError\",null),e([i({readOnly:!0})],u.prototype,\"_streamConnectionStatus\",null),u=e([o(\"esri.views.2d.layers.StreamLayerView2D\")],u);const y=u;export{y as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{_ as s}from\"../../chunks/tslib.es6.js\";import{property as e}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import{subclass as r}from\"../../core/accessorSupport/decorators/subclass.js\";import t from\"../../layers/support/FeatureFilter.js\";const o=o=>{let i=class extends o{resume(){this._isUserPaused=!1,this.suspended||this._doResume()}pause(){this._isUserPaused=!0,this.suspended||this._doPause()}constructor(...s){super(...s),this._isUserPaused=!1,this.filter=null}get connectionStatus(){return this._isUserPaused?\"paused\":this._streamConnectionStatus}_onSuspendedChange(s){s?this._doPause():this._isUserPaused||this._doResume()}};return s([e()],i.prototype,\"_isUserPaused\",void 0),s([e({readOnly:!0})],i.prototype,\"connectionStatus\",null),s([e({type:t})],i.prototype,\"filter\",void 0),i=s([r(\"esri.layers.mixins.StreamLayerView\")],i),i};export{o as default};\n"],"names":["$7eJjO","parcelRequire","$ca5a8d4660fd5694$var$c","e","t","r","geometry","toJSON","where","$ca5a8d4660fd5694$var$u","$lIBVg","default","$9QPTU","initialize","this","addHandles","$lKPaD","watch","layer","customParameters","_proxy","updateCustomParameters","on","sendMessageToSocket","sendMessageToClient","purgeOptions","_update","suspended","_onSuspendedChange","bind","connectionError","pipelineErrorString","$kyj08","Array","isArray","$6ah52","handlesGroup","map","s","includes","_enabledEventTypes","add","enableEvent","i","super","o","remove","closed","hasEventListener","queryLatestObservations","ref","ref1","ref2","timeInfo","endField","startField","trackIdField","_cleanUpQuery","then","$f4h86","fromJSON","features","forEach","sourceLayer","detach","pipelineConnectionStatus","_streamConnectionStatus","_doPause","pauseStream","_doResume","resumeStream","_createClientOptions","setProperty","set","propertyName","value","_createTileRendererHash","JSON","stringify","definitionExpression","geometryDefinition","async","objectIdField","fields","$9M3e1","toJSONGeometryType","geometryType","spatialReference","type","isPaused","_isUserPaused","source","parsedUrl","serviceFilter","enabledEventTypes","from","values","maxReconnectionAttempts","maxReconnectionInterval","updateInterval","constructor","arguments","Set","_","$iho5X","property","prototype","readOnly","$fcwIv","subclass","$ca5a8d4660fd5694$export$2e2bcd8739ae039","$fcfb1fac58b21555$export$2e2bcd8739ae039","resume","pause","connectionStatus","filter","$krMu9"],"version":3,"file":"StreamLayerView2D.a229abe9.js.map"}