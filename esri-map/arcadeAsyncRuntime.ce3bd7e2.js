!function(){function e(e,n,t,r){Object.defineProperty(e,n,{get:t,set:r,enumerable:!0,configurable:!0})}var n=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire594f;n.register("dVCsz",(function(t,r){e(t.exports,"functionHelper",(function(){return ce})),e(t.exports,"extend",(function(){return se})),e(t.exports,"executeScript",(function(){return fe})),e(t.exports,"extractFieldLiterals",(function(){return de})),e(t.exports,"validateScript",(function(){return he})),e(t.exports,"referencesMember",(function(){return ge})),e(t.exports,"referencesFunction",(function(){return ve})),e(t.exports,"findFunctionCalls",(function(){return pe}));var o=n("iwIpP"),a=n("MCT5v"),i=n("3UOnP"),u=n("3TgtC"),l=n("1xq6U"),c=n("afhHk"),s=n("baXxs"),f=n("e8oaX"),d=n("6C3Uw"),h=n("9yzf5"),g=n("3PL6g"),v=n("hyxO7"),p=n("hdg7E"),m=n("5POqf"),E=n("faNR6"),w=n("k5NMq"),y=n("BmtAd"),I=n("10vEZ"),N=n("gINRd"),A=n("Pe3X5"),b=n("eaHvJ"),C=n("d1Fqh"),T=n("fTq43"),R=n("95Tg0"),S=n("j40xv");function F(e){return e&&"function"==typeof e.then}var M=100;function U(e){return e instanceof Error?(0,I.reject)(e):(0,I.reject)(new Error(e))}function x(e){return(0,I.resolve)(e)}function O(e,n){for(var t=[],r=0;r<n.arguments.length;r++)t.push(k(e,n.arguments[r]));return(0,I.all)(t)}function L(e,n,t){return(0,I.create)((function(r,o){if(!0===n.preparsed)return r(t(e,null,n.arguments));O(e,n).then((function(a){try{r(t(e,n,a))}catch(e){o(e)}}),o)}))}function P(e,n,t){try{if(!0===n.preparsed){var r=t(e,null,n.arguments);return F(r)?r:(0,I.resolve)(r)}return O(e,n).then((function(r){try{var o=t(e,n,r);return F(o)?o:(0,I.resolve)(o)}catch(e){return U(e)}}))}catch(e){return U(e)}}function k(e,n,t){try{if(n.breakpoint&&!0!==t)return n.breakpoint().then((function(){return k(e,n,!0)}));switch(n.type){case"VariableDeclarator":return function(e,n){try{var t=null;return t=null===n.init?(0,I.resolve)(null):k(e,n.init),null!==e.localScope?t.then((function(t){return(0,I.create)((function(r){if(t===f.v&&(t=null),"Identifier"!==n.id.type)throw new Error("Can only assign a regular variable");var o=n.id.name.toLowerCase();e.localScope[o]={value:t,valueset:!0,node:n.init},r(f.v)}))})):t.then((function(t){return(0,I.create)((function(r){if("Identifier"!==n.id.type)throw new Error("Can only assign a regular variable");var o=n.id.name.toLowerCase();t===f.v&&(t=null),e.globalScope[o]={value:t,valueset:!0,node:n.init},r(f.v)}))}))}catch(e){return U(e)}}(e,n);case"VariableDeclaration":return z(e,n,0);case"BlockStatement":return function(e,n){try{return B(e,n,0)}catch(e){return U(e)}}(e,n);case"FunctionDeclaration":return function(e,n){try{var t=n.id.name.toLowerCase();return e.globalScope[t]={valueset:!0,node:null,value:new(0,l.default)(n,e)},(0,I.resolve)(f.v)}catch(e){return U(e)}}(e,n);case"ReturnStatement":return w=e,y=n,(0,I.create)((function(e,n){null===y.argument?e(new(0,f.R)(f.v)):k(w,y.argument).then((function(t){try{e(new(0,f.R)(t))}catch(e){n(e)}}),n)}));case"IfStatement":return m=e,E=n,(0,I.create)((function(e,n){"AssignmentExpression"!==E.test.type&&"UpdateExpression"!==E.test.type?k(m,E.test).then((function(t){try{!0===t?k(m,E.consequent).then(e,n):!1===t?null!==E.alternate?k(m,E.alternate).then(e,n):e(f.v):n(new Error((0,d.nodeErrorMessage)(E.test,"RUNTIME","CANNOT_USE_NONBOOLEAN_IN_CONDITION")))}catch(e){n(e)}}),n):n(new Error((0,d.nodeErrorMessage)(E.test,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION")))}));case"ExpressionStatement":return function(e,n){try{return"AssignmentExpression"===n.expression.type?k(e,n.expression):(n.expression.type,k(e,n.expression).then((function(e){return(0,I.create)((function(n){n(e===f.v?f.v:new(0,f.I)(e))}))})))}catch(e){return(0,I.reject)(e)}}(e,n);case"UpdateExpression":return function(e,n){try{var t=n.argument;if("MemberExpression"===t.type){var r={t:null};return k(e,t.object).then((function(n){var o=null;return r.t=n,!0===t.computed?o=k(e,t.property):"Identifier"===t.property.type&&(o=(0,I.resolve)(t.property.name)),o})).then((function(e){return(0,I.create)((function(t){var o,a=r.t;if((0,f.a)(a)){if(!(0,f.j)(e))throw new Error("Invalid Parameter");if(e<0&&(e=a.length+e),e<0||e>=a.length)throw new Error("Assignment outside of array bounds");o=(0,f.t)(a[e]),a[e]="++"===n.operator?o+1:o-1}else if(a instanceof i.default){if(!1===(0,f.f)(e))throw new Error("Dictionary accessor must be a string");if(!0!==a.hasField(e))throw new Error("Invalid Parameter");o=(0,f.t)(a.field(e)),a.setField(e,"++"===n.operator?o+1:o-1)}else{if(!(0,f.k)(a))throw(0,f.b)(a)?new Error("Array is Immutable"):new Error("Invalid Parameter");if(!1===(0,f.f)(e))throw new Error("Feature accessor must be a string");if(!0!==a.hasField(e))throw new Error("Invalid Parameter");o=(0,f.t)(a.field(e)),a.setField(e,"++"===n.operator?o+1:o-1)}!1===n.prefix?t(o):t("++"===n.operator?o+1:o-1)}))}))}return(0,I.create)((function(t,r){var o,a="Identifier"===n.argument.type?n.argument.name.toLowerCase():"";if(!a)throw new Error("Invalid identifier");return null!==e.localScope&&void 0!==e.localScope[a]?(o=(0,f.t)(e.localScope[a].value),e.localScope[a]={value:"++"===n.operator?o+1:o-1,valueset:!0,node:n},void(!1===n.prefix?t(o):t("++"===n.operator?o+1:o-1))):void 0!==e.globalScope[a]?(o=(0,f.t)(e.globalScope[a].value),e.globalScope[a]={value:"++"===n.operator?o+1:o-1,valueset:!0,node:n},void(!1===n.prefix?t(o):t("++"===n.operator?o+1:o-1))):void r(new Error("Variable not recognised"))}))}catch(e){return(0,I.reject)(e)}}(e,n);case"AssignmentExpression":return v=e,p=n,(0,I.create)((function(e,n){var t=p.left;if("MemberExpression"===t.type)k(v,p.right).then((function(r){try{k(v,t.object).then((function(o){try{var a=null;if(!0===t.computed)a=k(v,t.property);else{if("Identifier"!==t.property.type)throw new Error("Expected computed or identifier for assignemnt target");a=(0,I.resolve)(t.property.name)}a.then((function(t){try{if((0,f.a)(o)){if(!(0,f.j)(t))throw new Error("Invalid Parameter");if(t<0&&(t=o.length+t),t<0||t>o.length)throw new Error("Assignment outside of array bounds");if(t===o.length){if("="!==p.operator)throw new Error("Invalid Parameter");o[t]=V(r,p.operator,o[t],p)}else o[t]=V(r,p.operator,o[t],p)}else if(o instanceof i.default){if(!1===(0,f.f)(t))throw new Error("Dictionary accessor must be a string");if(!0===o.hasField(t))o.setField(t,V(r,p.operator,o.field(t),p));else{if("="!==p.operator)throw new Error("Invalid Parameter");o.setField(t,V(r,p.operator,null,p))}}else{if(!(0,f.k)(o))throw(0,f.b)(o)?new Error("Array is Immutable"):new Error("Invalid Parameter");if(!1===(0,f.f)(t))throw new Error("Feature accessor must be a string");if(!0===o.hasField(t))o.setField(t,V(r,p.operator,o.field(t),p));else{if("="!==p.operator)throw new Error("Invalid Parameter");o.setField(t,V(r,p.operator,null,p))}}e(f.v)}catch(e){n(e)}}),n)}catch(e){n(e)}}),n)}catch(e){n(e)}}),n);else{var r=t.name.toLowerCase();if(null!==v.localScope&&void 0!==v.localScope[r])return void k(v,p.right).then((function(t){try{v.localScope[r]={value:V(t,p.operator,v.localScope[r].value,p),valueset:!0,node:p.right},e(f.v)}catch(e){n(e)}}),n);void 0!==v.globalScope[r]?k(v,p.right).then((function(t){try{v.globalScope[r]={value:V(t,p.operator,v.globalScope[r].value,p),valueset:!0,node:p.right},e(f.v)}catch(e){n(e)}}),n):n(new Error("Cannot assign undeclared variable"))}}));case"ForStatement":return function(e,n){try{return null!==n.init?k(e,n.init).then((function(){return(0,I.create)((function(t,r){j(e,n,{testResult:!0,lastAction:f.v},(function(e){t(e)}),(function(e){r(e)}),0)}))})):(0,I.create)((function(t,r){j(e,n,{testResult:!0,lastAction:f.v},(function(e){t(e)}),(function(e){r(e)}),0)}))}catch(e){return(0,I.reject)(e)}}(e,n);case"ForInStatement":return s=e,g=n,(0,I.create)((function(e,n){k(s,g.right).then((function(t){try{("VariableDeclaration"===g.left.type?k(s,g.left):(0,I.resolve)()).then((function(){try{var r="";if("VariableDeclaration"===g.left.type){var o=g.left.declarations[0].id;"Identifier"===o.type&&(r=o.name)}else"Identifier"===g.left.type&&(r=g.left.name);if(!r)throw new Error((0,d.nodeErrorMessage)(g,"RUNTIME","INVALIDVARIABLE"));r=r.toLowerCase();var a=null;if(null!==s.localScope&&void 0!==s.localScope[r]&&(a=s.localScope[r]),null===a&&void 0!==s.globalScope[r]&&(a=s.globalScope[r]),null===a)return void n(new Error((0,d.nodeErrorMessage)(g,"RUNTIME","VARIABLENOTDECLARED")));(0,f.a)(t)||(0,f.f)(t)?q(s,g,t,{reject:n,resolve:e},a):(0,f.b)(t)?function(e,n,t,r,o,a){try{if(void 0===a&&(a="i"),0===t.length)return void r.resolve(f.v);_(e,n,t,o,0,a,(function(e){r.resolve(e)}),(function(e){r.reject(e)}),0)}catch(e){r.reject(e)}}(s,g,t,{reject:n,resolve:e},a):t instanceof i.default||(0,f.k)(t)?function(e,n,t,r,o){try{q(e,n,t.keys(),r,o,"k")}catch(e){r.reject(e)}}(s,g,t,{reject:n,resolve:e},a):(0,f.q)(t)?G(t.iterator(s.abortSignal),s,g,t,a,(function(n){e(n)}),(function(e){n(e)}),0):q(s,g,[],{reject:n,resolve:e},a)}catch(e){n(e)}}),n)}catch(e){n(e)}}),n)}));case"BreakStatement":return(0,I.resolve)(f.m);case"EmptyStatement":return(0,I.resolve)(f.v);case"ContinueStatement":return(0,I.resolve)(f.n);case"TemplateElement":return c=n,(0,I.resolve)(c.value?c.value.cooked:"");case"TemplateLiteral":return a=e,u=n,(0,I.create)((function(e){var n=[];(0,h.reduceArrayWithPromises)(u.expressions,(function(e,t,r,o){return k(a,t).then((function(e){n[r]=(0,f.d)(e)}))})).then((function(){var t="",r=0,o=!0,a=!1,i=void 0;try{for(var l,c=u.quasis[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var s=l.value;t+=s.value?s.value.cooked:"",!1===s.tail&&(t+=n[r]?n[r]:"",r++)}}catch(e){a=!0,i=e}finally{try{o||null==c.return||c.return()}finally{if(a)throw i}}e(t)}))}));case"Identifier":return J(e,n);case"MemberExpression":return function(e,n){try{return k(e,n.object).then((function(t){try{return null===t?(0,I.reject)(new Error((0,d.nodeErrorMessage)(n,"RUNTIME","NOTFOUND"))):!1===n.computed?"Identifier"===n.property.type?t instanceof i.default||(0,f.k)(t)?(0,I.resolve)(t.field(n.property.name)):t instanceof A.default?(0,I.resolve)(Z(t,n.property.name,e,n)):(0,I.reject)(new Error((0,d.nodeErrorMessage)(n,"RUNTIME","INVALIDTYPE"))):(0,I.reject)(new Error((0,d.nodeErrorMessage)(n,"RUNTIME","INVALIDTYPE"))):k(e,n.property).then((function(r){return(0,I.create)((function(o,a){if(t instanceof i.default||(0,f.k)(t))(0,f.f)(r)?o(t.field(r)):a(new Error((0,d.nodeErrorMessage)(n,"RUNTIME","INVALIDTYPE")));else if(t instanceof A.default)(0,f.f)(r)?o(Z(t,r,e,n)):a(new Error((0,d.nodeErrorMessage)(n,"RUNTIME","INVALIDTYPE")));else if((0,f.a)(t))if((0,f.j)(r)&&isFinite(r)&&Math.floor(r)===r){if(r<0&&(r=t.length+r),r>=t.length||r<0)throw new Error((0,d.nodeErrorMessage)(n,"RUNTIME","OUTOFBOUNDS"));o(t[r])}else a(new Error((0,d.nodeErrorMessage)(n,"RUNTIME","INVALIDTYPE")));else if((0,f.b)(t))if((0,f.j)(r)&&isFinite(r)&&Math.floor(r)===r){if(r<0&&(r=t.length()+r),r>=t.length()||r<0)throw new Error((0,d.nodeErrorMessage)(n,"RUNTIME","OUTOFBOUNDS"));o(t.get(r))}else a(new Error((0,d.nodeErrorMessage)(n,"RUNTIME","INVALIDTYPE")));else if((0,f.f)(t))if((0,f.j)(r)&&isFinite(r)&&Math.floor(r)===r){if(r<0&&(r=t.length+r),r>=t.length||r<0)throw new Error((0,d.nodeErrorMessage)(n,"RUNTIME","OUTOFBOUNDS"));o(t[r])}else a(new Error((0,d.nodeErrorMessage)(n,"RUNTIME","INVALIDTYPE")));else a(new Error((0,d.nodeErrorMessage)(n,"RUNTIME","INVALIDTYPE")))}))}))}catch(e){return U(e)}}))}catch(e){return U(e)}}(e,n);case"Literal":return x(n.value);case"CallExpression":return function(e,n){try{if("Identifier"!==n.callee.type)return U((0,d.nodeErrorMessage)(n,"RUNTIME","ONLYNODESSUPPORTED"));if(null!==e.localScope&&void 0!==e.localScope[n.callee.name.toLowerCase()]){var t=e.localScope[n.callee.name.toLowerCase()];return t.value instanceof f.N?t.value.fn(e,n):t.value instanceof l.default?re(e,n,t.value.definition):U((0,d.nodeErrorMessage)(n,"RUNTIME","NOTAFUNCTION"))}if(void 0!==e.globalScope[n.callee.name.toLowerCase()]){var r=e.globalScope[n.callee.name.toLowerCase()];return r.value instanceof f.N?r.value.fn(e,n):r.value instanceof l.default?re(e,n,r.value.definition):U((0,d.nodeErrorMessage)(n,"RUNTIME","NOTAFUNCTION"))}return U((0,d.nodeErrorMessage)(n,"RUNTIME","NOTFOUND"))}catch(e){return U(e)}}(e,n);case"UnaryExpression":return function(e,n){try{return k(e,n.argument).then((function(e){return(0,I.create)((function(t,r){(0,f.i)(e)&&"!"===n.operator?t(!e):"-"===n.operator?t(-1*(0,f.t)(e)):"+"===n.operator?t(1*(0,f.t)(e)):"~"===n.operator?t(~(0,f.t)(e)):r(new Error((0,d.nodeErrorMessage)(n,"RUNTIME","NOTSUPPORTEDUNARYOPERATOR")))}))}))}catch(e){return U(e)}}(e,n);case"BinaryExpression":return function(e,n){try{return(0,I.all)([k(e,n.left),k(e,n.right)]).then((function(e){return(0,I.create)((function(t,r){var o=e[0],a=e[1];switch(n.operator){case"|":case"<<":case">>":case">>>":case"^":case"&":t((0,f.h)((0,f.t)(o),(0,f.t)(a),n.operator));case"==":t((0,f.e)(o,a));break;case"!=":t(!(0,f.e)(o,a));break;case"<":case">":case"<=":case">=":t((0,f.g)(o,a,n.operator));break;case"+":(0,f.f)(o)||(0,f.f)(a)?t((0,f.d)(o)+(0,f.d)(a)):t((0,f.t)(o)+(0,f.t)(a));break;case"-":t((0,f.t)(o)-(0,f.t)(a));break;case"*":t((0,f.t)(o)*(0,f.t)(a));break;case"/":t((0,f.t)(o)/(0,f.t)(a));break;case"%":t((0,f.t)(o)%(0,f.t)(a));break;default:r(new Error((0,d.nodeErrorMessage)(n,"RUNTIME","OPERATORNOTRECOGNISED")))}}))}))}catch(e){return U(e)}}(e,n);case"LogicalExpression":return r=e,o=n,(0,I.create)((function(e,n){"AssignmentExpression"!==o.left.type&&"UpdateExpression"!==o.left.type?"AssignmentExpression"!==o.right.type&&"UpdateExpression"!==o.right.type?k(r,o.left).then((function(t){try{if(!(0,f.i)(t))throw new Error((0,d.nodeErrorMessage)(o,"RUNTIME","ONLYBOOLEAN"));switch(o.operator){case"||":!0===t?e(t):k(r,o.right).then((function(t){try{if(!(0,f.i)(t))throw new Error((0,d.nodeErrorMessage)(o,"RUNTIME","ONLYORORAND"));e(t)}catch(e){n(e)}}),n);break;case"&&":!1===t?e(t):k(r,o.right).then((function(t){try{if(!(0,f.i)(t))throw new Error((0,d.nodeErrorMessage)(o,"RUNTIME","ONLYORORAND"));e(t)}catch(e){n(e)}}),n);break;default:throw new Error((0,d.nodeErrorMessage)(o,"RUNTIME","ONLYORORAND"))}}catch(e){n(e)}}),n):n(new Error((0,d.nodeErrorMessage)(o.right,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"))):n(new Error((0,d.nodeErrorMessage)(o.left,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION")))}));case"ArrayExpression":return function(e,n){try{for(var t=[],r=0;r<n.elements.length;r++)t.push(k(e,n.elements[r]));return(0,I.all)(t).then((function(e){return(0,I.create)((function(t,r){for(var o=0;o<e.length;o++){if((0,f.c)(e[o]))return void r(new Error((0,d.nodeErrorMessage)(n,"RUNTIME","FUNCTIONCONTEXTILLEGAL")));e[o]===f.v&&(e[o]=null)}t(e)}))}))}catch(e){return U(e)}}(e,n);case"ObjectExpression":return function(e,n){try{for(var t=[],r=0;r<n.properties.length;r++)t.push(k(e,n.properties[r]));return(0,I.all)(t).then((function(e){return(0,I.create)((function(n){for(var t={},r=0;r<e.length;r++){var o=e[r];if((0,f.c)(o.value))throw new Error("Illegal Argument");if(!1===(0,f.f)(o.key))throw new Error("Illegal Argument");o.value===f.v?t[o.key.toString()]=null:t[o.key.toString()]=o.value}var a=new(0,i.default)(t);a.immutable=!1,n(a)}))}))}catch(e){return U(e)}}(e,n);case"Property":return function(e,n){try{return k(e,n.value).then((function(t){return(0,I.create)((function(r){"Identifier"===n.key.type?r({key:n.key.name,value:t}):k(e,n.key).then((function(e){r({key:e,value:t})}))}))}))}catch(e){return(0,I.reject)(e)}}(e,n);default:return U((0,d.nodeErrorMessage)(n,"RUNTIME","UNREOGNISED"))}}catch(e){return U(e)}var r,o,a,u,c,s,g,v,p,m,E,w,y}function D(e,n,t){try{return k(e,n.body).then((function(r){try{return t.lastAction=r,t.lastAction===f.m||t.lastAction instanceof f.R?(t.testResult=!1,(0,I.resolve)(t)):null!==n.update?k(e,n.update).then((function(){return(0,I.resolve)(t)})):(0,I.resolve)(t)}catch(e){return(0,I.reject)(e)}}))}catch(e){return(0,I.reject)(e)}}function j(e,n,t,r,o,a){try{(function(e,n,t){try{return null!==n.test?k(e,n.test).then((function(r){try{return!0===e.abortSignal.aborted?(0,I.reject)(new Error("Cancelled")):(t.testResult=r,!1===t.testResult?(0,I.resolve)(t):!0!==t.testResult?(0,I.reject)(new Error((0,d.nodeErrorMessage)(n,"RUNTIME","CANNOT_USE_NONBOOLEAN_IN_CONDITION"))):D(e,n,t))}catch(e){return(0,I.reject)(e)}})):D(e,n,t)}catch(e){return(0,I.reject)(e)}})(e,n,t).then((function(){try{!0===t.testResult?++a>M?(a=0,setTimeout((function(){j(e,n,t,r,o,a)}),0)):j(e,n,t,r,o,a):t.lastAction instanceof f.R?r(t.lastAction):r(f.v)}catch(e){o(e)}}),(function(e){o(e)}))}catch(e){o(e)}}function H(e,n,t,r,o,a,i,u,l,c){try{if(r<=a)return void u(f.v);o.value="k"===i?t[a]:a,k(e,n.body).then((function(s){try{s instanceof f.R?u(s):s===f.m?u(f.v):++c>M?(c=0,setTimeout((function(){H(e,n,t,r,o,a+1,i,u,l,c)}),0)):H(e,n,t,r,o,a+1,i,u,l,c)}catch(e){l(e)}}),(function(e){l(e)}))}catch(e){l(e)}}function _(e,n,t,r,o,a,i,u,l){try{if(t.length()<=o)return void i(f.v);r.value="k"===a?t.get(o):o,k(e,n.body).then((function(c){c instanceof f.R?i(c):c===f.m?i(f.v):++l>M?(l=0,setTimeout((function(){_(e,n,t,r,o+1,a,i,u,l)}),0)):_(e,n,t,r,o+1,a,i,u,l)}),(function(e){u(e)}))}catch(e){u(e)}}function q(e,n,t,r,o,a){try{if(void 0===a&&(a="i"),0===t.length)return void r.resolve(f.v);H(e,n,t,t.length,o,0,a,(function(e){r.resolve(e)}),(function(e){r.reject(e)}),0)}catch(e){r.reject(e)}}function G(e,n,t,r,o,a,i,l){try{e.next().then((function(c){try{if(null===c)a(f.v);else{var s=u.default.createFromGraphicLikeObject(c.geometry,c.attributes,r);s._underlyingGraphic=c,o.value=s,k(n,t.body).then((function(u){try{u===f.m?a(f.v):u instanceof f.R?a(u):++l>M?(l=0,setTimeout((function(){G(e,n,t,r,o,a,i,l)}),0)):G(e,n,t,r,o,a,i,l)}catch(e){i(e)}}),(function(e){i(e)}))}}catch(e){i(e)}}),(function(e){i(e)}))}catch(e){i(e)}}function V(e,n,t,r){switch(n){case"=":return e===f.v?null:e;case"/=":return(0,f.t)(t)/(0,f.t)(e);case"*=":return(0,f.t)(t)*(0,f.t)(e);case"-=":return(0,f.t)(t)-(0,f.t)(e);case"+=":return(0,f.f)(t)||(0,f.f)(e)?(0,f.d)(t)+(0,f.d)(e):(0,f.t)(t)+(0,f.t)(e);case"%=":return(0,f.t)(t)%(0,f.t)(e);default:throw new Error((0,d.nodeErrorMessage)(r,"RUNTIME","OPERATORNOTRECOGNISED"))}}function B(e,n,t){try{return t>=n.body.length?(0,I.resolve)(f.v):(0,I.create)((function(r,o){k(e,n.body[t]).then((function(a){try{a instanceof f.R||a===f.m||a===f.n||t===n.body.length-1?r(a):B(e,n,t+1).then(r,o)}catch(e){o(e)}}),o)}))}catch(e){return U(e)}}function z(e,n,t){return(0,I.create)((function(r,o){t>=n.declarations.length?r(f.v):k(e,n.declarations[t]).then((function(){t===n.declarations.length-1?r(f.v):z(e,n,t+1).then((function(){r(f.v)}),o)}),o)}))}var Y=0;function Z(e,n,t,r){var o;switch(n=n.toLowerCase()){case"hasz":var a=e.hasZ;return void 0!==a&&a;case"hasm":var u=e.hasM;return void 0!==u&&u;case"spatialreference":var l=e.spatialReference._arcadeCacheId;if(void 0===l){var f=!0;Object.freeze&&Object.isFrozen(e.spatialReference)&&(f=!1),f&&(Y++,e.spatialReference._arcadeCacheId=Y,l=Y)}var h=new(0,i.default)({wkt:e.spatialReference.wkt,wkid:e.spatialReference.wkid});return void 0!==l&&(h._arcadeCacheId="SPREF"+l.toString()),h}switch(e.type){case"extent":switch(n){case"xmin":case"xmax":case"ymin":case"ymax":case"zmin":case"zmax":case"mmin":case"mmax":var g=e[n];return void 0!==g?g:null;case"type":return"Extent"}break;case"polygon":switch(n){case"rings":return void 0===(o=e.cache._arcadeCacheId)&&(o=++Y,e.cache._arcadeCacheId=o),new(0,c.default)(e.rings,e.spatialReference,!0===e.hasZ,!0===e.hasM,o);case"type":return"Polygon"}break;case"point":switch(n){case"x":case"y":case"z":case"m":return void 0!==e[n]?e[n]:null;case"type":return"Point"}break;case"polyline":switch(n){case"paths":return void 0===(o=e.cache._arcadeCacheId)&&(o=++Y,e.cache._arcadeCacheId=o),new(0,c.default)(e.paths,e.spatialReference,!0===e.hasZ,!0===e.hasM,o);case"type":return"Polyline"}break;case"multipoint":switch(n){case"points":return void 0===(o=e.cache._arcadeCacheId)&&(o=++Y,e.cache._arcadeCacheId=o),new(0,s.default)(e.points,e.spatialReference,!0===e.hasZ,!0===e.hasM,o,1);case"type":return"Multipoint"}}throw new Error((0,d.nodeErrorMessage)(r,"RUNTIME","PROPERTYNOTFOUND"))}function J(e,n){return(0,I.create)((function(t,r){var o=n.name.toLowerCase();if(null===e.localScope||void 0===e.localScope[o])if(void 0===e.globalScope[o])r(new Error((0,d.nodeErrorMessage)(n,"RUNTIME","VARIABLENOTFOUND")));else{var a=e.globalScope[o];!0===a.valueset?t(a.value):null!==a.d?a.d.then(t,r):(a.d=k(e,a.node),a.d.then((function(e){try{a.value=e,a.valueset=!0,t(e)}catch(e){r(e)}}),r))}else{var i=e.localScope[o];!0===i.valueset?t(i.value):null!==i.d?i.d.then(t,r):(i.d=k(e,i.node),i.d.then((function(e){try{i.value=e,i.valueset=!0,t(e)}catch(e){r(e)}}),r))}}))}var X={};function W(e){return null===e?"":(0,f.a)(e)||(0,f.b)(e)?"Array":(0,f.o)(e)?"Date":(0,f.f)(e)?"String":(0,f.i)(e)?"Boolean":(0,f.j)(e)?"Number":e instanceof a.default?"Attachment":e instanceof o.default?"Portal":e instanceof i.default?"Dictionary":(0,f.k)(e)?"Feature":e instanceof C.default?"Point":e instanceof T.default?"Polygon":e instanceof R.default?"Polyline":e instanceof b.default?"Multipoint":e instanceof N.default?"Extent":(0,f.c)(e)?"Function":(0,f.q)(e)?"FeatureSet":(0,f.r)(e)?"FeatureSetCollection":e===f.v?"":"number"==typeof e&&isNaN(e)?"Number":"Unrecognised Type"}function K(e,n,t,r){return(0,I.create)((function(o,a){k(e,n.arguments[t]).then((function(i){try{if((0,f.e)(i,r))return void k(e,n.arguments[t+1]).then(o,a);var u=n.arguments.length-t;return 1===u?void k(e,n.arguments[t]).then(o,a):(2===u&&o(null),3===u?void k(e,n.arguments[t+2]).then(o,a):void K(e,n,t+2,r).then(o,a))}catch(e){a(e)}}),a)}))}function Q(e,n,t,r){return(0,I.create)((function(o,a){!0===r?k(e,n.arguments[t+1]).then(o,a):3==n.arguments.length-t?k(e,n.arguments[t+2]).then(o,a):k(e,n.arguments[t+2]).then((function(r){try{if(!1===(0,f.i)(r))return void a(new Error("WHEN needs boolean test conditions"));Q(e,n,t+2,r).then(o,a)}catch(e){a(e)}}))}))}function $(e,n){try{var t=e.length,r=Math.floor(t/2);return 0===t?(0,I.resolve)([]):1===t?(0,I.resolve)([e[0]]):(0,I.create)((function(o,a){var i=[$(e.slice(0,r),n),$(e.slice(r,t),n)];(0,I.all)(i).then((function(e){try{ee(e[0],e[1],n,[]).then(o,a)}catch(e){a(e)}}),a)}))}catch(e){return U(e)}}function ee(e,n,t,r){return(0,I.create)((function(o,a){var i=r;e.length>0||n.length>0?e.length>0&&n.length>0?t(e[0],n[0]).then((function(u){try{isNaN(u)&&(u=1),u<=0?(i.push(e[0]),e=e.slice(1)):(i.push(n[0]),n=n.slice(1)),ee(e,n,t,r).then(o,a)}catch(e){a(e)}}),a):e.length>0?(i.push(e[0]),ee(e=e.slice(1),n,t,r).then(o,a)):n.length>0&&(i.push(n[0]),n=n.slice(1),ee(e,n,t,r).then(o,a)):o(r)}))}function ne(e,n){var t=e.length,r=Math.floor(t/2);return n||(n=function(e,n){return e<n?-1:e===n?0:1}),0===t?[]:1===t?[e[0]]:function(e,n,t){for(var r=[];e.length>0||n.length>0;)if(e.length>0&&n.length>0){var o=t(e[0],n[0]);isNaN(o)&&(o=1),o<=0?(r.push(e[0]),e=e.slice(1)):(r.push(n[0]),n=n.slice(1))}else e.length>0?(r.push(e[0]),e=e.slice(1)):n.length>0&&(r.push(n[0]),n=n.slice(1));return r}(ne(e.slice(0,r),n),ne(e.slice(r,t),n),n)}function te(e,n,t){try{var r=e.body;if(t.length!==e.params.length)return U(new Error("Invalid Parameter calls to function."));for(var o=0;o<t.length;o++){var a=e.params[o];"Identifier"===a.type&&(n.localScope[a.name.toLowerCase()]={d:null,value:t[o],valueset:!0,node:null})}return k(n,r).then((function(e){return(0,I.create)((function(n,t){e instanceof f.R?n(e.value):e!==f.m?e!==f.n?n(e instanceof f.I?e.value:e):t(new Error("Cannot Continue from a Function")):t(new Error("Cannot Break from a Function"))}))}))}catch(e){return(0,I.reject)(e)}}function re(e,n,t){return P(e,n,(function(n,r,o){var a={spatialReference:e.spatialReference,services:e.services,console:e.console,lrucache:e.lrucache,interceptor:e.interceptor,localScope:{},abortSignal:e.abortSignal,globalScope:e.globalScope,depthCounter:e.depthCounter+1};if(a.depthCounter>64)throw new Error("Exceeded maximum function depth");return te(t,a,o)}))}function oe(e){return function(){var n={abortSignal:e.context.abortSignal,spatialReference:e.context.spatialReference,console:e.context.console,lrucache:e.context.lrucache,interceptor:e.context.interceptor,services:e.context.services,localScope:{},globalScope:e.context.globalScope,depthCounter:e.context.depthCounter+1};if(n.depthCounter>64)throw new Error("Exceeded maximum function depth");return te(e.definition,n,arguments)}}(0,v.registerFunctions)(X,L),(0,y.registerFunctions)(X,L),(0,E.registerFunctions)(X,L),(0,m.registerFunctions)(X,L),(0,w.registerFunctions)(X,L),(0,p.registerFunctions)({functions:X,compiled:!1,signatures:null,failDefferred:null,evaluateIdentifier:null,arcadeCustomFunctionHandler:null,mode:"async",standardFunction:L,standardFunctionAsync:P}),X.typeof=function(e,n){return L(e,n,(function(e,n,t){(0,f.p)(t,1,1);var r=W(t[0]);if("Unrecognised Type"===r)throw new Error("Unrecognised Type");return r}))},X.iif=function(e,n){return(0,I.create)((function(t,r){(0,f.p)(null===n.arguments?[]:n.arguments,3,3),k(e,n.arguments[0]).then((function(o){try{if(!1===(0,f.i)(o))return void r(new Error("IF Function must have a boolean test condition"));(0,I.all)([k(e,n.arguments[1]),k(e,n.arguments[2])]).then((function(e){t(o?e[0]:e[1])}),r)}catch(e){r(e)}}),r)}))},X.decode=function(e,n){return(0,I.create)((function(t,r){n.arguments.length<2?r(new Error("Missing Parameters")):2!==n.arguments.length?(n.arguments.length-1)%2!=0?k(e,n.arguments[0]).then((function(o){try{K(e,n,1,o).then(t,r)}catch(e){r(e)}}),r):r(new Error("Must have a default value result.")):k(e,n.arguments[1]).then(t,r)}))},X.when=function(e,n){try{return n.arguments.length<3?U("Missing Parameters"):n.arguments.length%2==0?U("Must have a default value result."):k(e,n.arguments[0]).then((function(t){return(0,I.create)((function(r,o){!1!==(0,f.i)(t)?Q(e,n,0,t).then(r,o):o(new Error("WHEN needs boolean test conditions"))}))}))}catch(e){return U(e)}},X.sort=function(e,n){return P(e,n,(function(e,n,t){(0,f.p)(t,1,2);var r=t[0];if((0,f.b)(r)&&(r=r.toArray()),!1===(0,f.a)(r))return U(Error("Illegal Argument"));if(t.length>1)return!1===(0,f.c)(t[1])?U(Error("Illegal Argument")):$(r,oe(t[1]));var o=r;if(0===o.length)return(0,I.resolve)([]);for(var a={},i=0;i<o.length;i++){var u=W(o[i]);""!==u&&(a[u]=!0)}if(!0===a.Array||!0===a.Dictionary||!0===a.Feature||!0===a.Point||!0===a.Polygon||!0===a.Polyline||!0===a.Multipoint||!0===a.Extent||!0===a.Function)return(0,I.resolve)(o.slice(0));var l=0,c="";for(var s in a)l++,c=s;return l>1||"String"===c?o=ne(o,(function(e,n){if(null==e||e===f.v)return null==n||n===f.v?0:1;if(null==n||n===f.v)return-1;var t=(0,f.d)(e),r=(0,f.d)(n);return t<r?-1:t===r?0:1})):"Number"===c?o=ne(o,(function(e,n){return e-n})):"Boolean"===c?o=ne(o,(function(e,n){return e===n?0:n?-1:1})):"Date"===c&&(o=ne(o,(function(e,n){return n-e}))),(0,I.resolve)(o)}))};var ae={failDefferred:U,resolveDeffered:x,fixSpatialReference:f.s,parseArguments:O,standardFunction:L,standardFunctionAsync:P,evaluateIdentifier:J,arcadeCustomFunction:oe};for(var ie in X)X[ie]={value:new(0,f.N)(X[ie]),valueset:!0,node:null};var ue=function(){};function le(e){console.log(e)}(ue.prototype=X).infinity={value:Number.POSITIVE_INFINITY,valueset:!0,node:null},ue.prototype.pi={value:Math.PI,valueset:!0,node:null};var ce=ae;function se(e){for(var n={mode:"async",compiled:!1,functions:{},signatures:[],standardFunction:L,standardFunctionAsync:P,failDefferred:U,evaluateIdentifier:J,arcadeCustomFunctionHandler:oe},t=0;t<e.length;t++)e[t].registerFunctions(n);for(var r in n.functions)X[r]={value:new(0,f.N)(n.functions[r]),valueset:!0,node:null},ue.prototype[r]=X[r];for(var o=0;o<n.signatures.length;o++)(0,d.addFunctionDeclaration)(n.signatures[o],"async")}function fe(e,n){var t=n.spatialReference;null==t&&(t=new(0,S.default)({wkid:102100}));var r=function(e,n){var t=new ue;null==e&&(e={}),null==n&&(n={});var r=new(0,i.default)({newline:"\n",tab:"\t",singlequote:"'",doublequote:'"',forwardslash:"/",backwardslash:"\\"});for(var o in r.immutable=!1,t.textformatting={value:r,valueset:!0,node:null},n)t[o]={value:new(0,f.N)(n[o]),native:!0,valueset:!0,node:null};for(var a in e)e[a]&&"esri.Graphic"===e[a].declaredClass?t[a]={value:u.default.createFromGraphic(e[a]),valueset:!0,node:null}:t[a]={value:e[a],valueset:!0,node:null};return t}(n.vars,n.customfunctions);return k({spatialReference:t,services:n.services,abortSignal:void 0===n.abortSignal||null===n.abortSignal?{aborted:!1}:n.abortSignal,globalScope:r,console:n.console?n.console:le,lrucache:n.lrucache,interceptor:n.interceptor,localScope:null,depthCounter:1},e.body[0].body).then((function(e){return(0,I.create)((function(n,t){e instanceof f.R&&(e=e.value),e instanceof f.I&&(e=e.value),e===f.v&&(e=null),e!==f.m?e!==f.n?e instanceof f.N||e instanceof l.default?t(new Error("Cannot return FUNCTION")):n(e):t(new Error("Cannot return CONTINUE")):t(new Error("Cannot return BREAK"))}))}))}function de(e,n){return(0,d.findFieldLiterals)(e)}function he(e,n){return(0,d.validateScript)(e,n,"full")}function ge(e,n){return(0,d.referencesMember)(e,n)}function ve(e,n){return(0,d.referencesFunction)(e,n)}function pe(e){return(0,d.findFunctionCalls)(e)}se([g.A])})),n.register("hdg7E",(function(t,r){e(t.exports,"registerFunctions",(function(){return I}));var o=n("dLARP"),a=n("dcpcS"),i=n("e8oaX"),u=n("aUA9M"),l=n("10vEZ"),c=n("gINRd"),s=n("Pe3X5"),f=n("absvu"),d=n("eaHvJ"),h=n("d1Fqh"),g=n("fTq43"),v=n("95Tg0"),p=n("79LpT"),m=n("5vzSQ");function E(e){return 0===o.version.indexOf("4.")?g.default.fromExtent(e):new(0,g.default)({spatialReference:e.spatialReference,rings:[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]})}function w(e){if((0,i.p)(e,2,2),e[0]instanceof s.default&&e[1]instanceof s.default);else if(e[0]instanceof s.default&&null===e[1]);else if(e[1]instanceof s.default&&null===e[0]);else if(null!==e[0]||null!==e[1])throw new Error("Illegal Argument")}function y(e,n){if("polygon"!==e.type&&"polyline"!==e.type&&"extent"!==e.type)return(0,l.resolve)(0);var t=1;(e.spatialReference.vcsWkid||e.spatialReference.latestVcsWkid)&&(t=(0,u.getMetersPerVerticalUnitForSR)(e.spatialReference)/(0,m.getMetersPerUnitForSR)(e.spatialReference));var r=0,o=!0,a=!1,c=void 0,s=!0,d=!1,h=void 0;if("polyline"===e.type)try{for(var g,p=e.paths[Symbol.iterator]();!(o=(g=p.next()).done);o=!0)for(var E=g.value,w=1;w<E.length;w++)r+=(0,u.segmentLength3d)(E[w],E[w-1],t)}catch(e){a=!0,c=e}finally{try{o||null==p.return||p.return()}finally{if(a)throw c}}else if("polygon"===e.type)try{for(var y,I=e.rings[Symbol.iterator]();!(s=(y=I.next()).done);s=!0){for(var N=y.value,A=1;A<N.length;A++)r+=(0,u.segmentLength3d)(N[A],N[A-1],t);(N[0][0]!==N[N.length-1][0]||N[0][1]!==N[N.length-1][1]||void 0!==N[0][2]&&N[0][2]!==N[N.length-1][2])&&(r+=(0,u.segmentLength3d)(N[0],N[N.length-1],t))}}catch(e){d=!0,h=e}finally{try{s||null==I.return||I.return()}finally{if(d)throw h}}else"extent"===e.type&&(r+=2*(0,u.segmentLength3d)([e.xmin,e.ymin,0],[e.xmax,e.ymin,0],t),r+=2*(0,u.segmentLength3d)([e.xmin,e.ymin,0],[e.xmin,e.ymax,0],t),r*=2,r+=4*Math.abs((0,i.C)(e.zmax,0)*t-(0,i.C)(e.zmin,0)*t));var b=new(0,v.default)({hasZ:!1,hasM:!1,spatialReference:e.spatialReference,paths:[[0,0],[0,r]]});return(0,f.planarLength)(b,n)}function I(e){"async"===e.mode&&(e.functions.disjoint=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){return w(t=(0,i.H)(t)),null===t[0]||null===t[1]||(0,f.disjoint)(t[0],t[1])}))},e.functions.intersects=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){return w(t=(0,i.H)(t)),null!==t[0]&&null!==t[1]&&(0,f.intersects)(t[0],t[1])}))},e.functions.touches=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){return w(t=(0,i.H)(t)),null!==t[0]&&null!==t[1]&&(0,f.touches)(t[0],t[1])}))},e.functions.crosses=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){return w(t=(0,i.H)(t)),null!==t[0]&&null!==t[1]&&(0,f.crosses)(t[0],t[1])}))},e.functions.within=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){return w(t=(0,i.H)(t)),null!==t[0]&&null!==t[1]&&(0,f.within)(t[0],t[1])}))},e.functions.contains=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){return w(t=(0,i.H)(t)),null!==t[0]&&null!==t[1]&&(0,f.contains)(t[0],t[1])}))},e.functions.overlaps=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){return w(t=(0,i.H)(t)),null!==t[0]&&null!==t[1]&&(0,f.overlaps)(t[0],t[1])}))},e.functions.equals=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){return(0,i.p)(t,2,2),t[0]===t[1]||(t[0]instanceof s.default&&t[1]instanceof s.default?(0,f.equals)(t[0],t[1]):!(!(0,i.o)(t[0])||!(0,i.o)(t[1]))&&t[0].getTime()===t[1].getTime())}))},e.functions.relate=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){if(t=(0,i.H)(t),(0,i.p)(t,3,3),t[0]instanceof s.default&&t[1]instanceof s.default)return(0,f.relate)(t[0],t[1],(0,i.d)(t[2]));if(t[0]instanceof s.default&&null===t[1])return!1;if(t[1]instanceof s.default&&null===t[0])return!1;if(null===t[0]&&null===t[1])return!1;throw new Error("Illegal Argument")}))},e.functions.intersection=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){return w(t=(0,i.H)(t)),null===t[0]||null===t[1]?null:(0,f.intersect)(t[0],t[1])}))},e.functions.union=function(n,t){return e.standardFunctionAsync(n,t,(function(e,t,r){var o=[];if(0===(r=(0,i.H)(r)).length)throw new Error("Function called with wrong number of Parameters");if(1===r.length)if((0,i.a)(r[0])){for(var u=(0,i.H)(r[0]),l=0;l<u.length;l++)if(null!==u[l]){if(!(u[l]instanceof s.default))throw new Error("Illegal Argument");o.push(u[l])}}else{if(!(0,i.b)(r[0])){if(r[0]instanceof s.default)return(0,i.s)((0,a.cloneGeometry)(r[0]),n.spatialReference);if(null===r[0])return null;throw new Error("Illegal Argument")}for(var c=(0,i.H)(r[0].toArray()),d=0;d<c.length;d++)if(null!==c[d]){if(!(c[d]instanceof s.default))throw new Error("Illegal Argument");o.push(c[d])}}else for(var h=0;h<r.length;h++)if(null!==r[h]){if(!(r[h]instanceof s.default))throw new Error("Illegal Argument");o.push(r[h])}return 0===o.length?null:(0,f.union)(o)}))},e.functions.difference=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){return w(t=(0,i.H)(t)),null!==t[0]&&null===t[1]?(0,a.cloneGeometry)(t[0]):null===t[0]?null:(0,f.difference)(t[0],t[1])}))},e.functions.symmetricdifference=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){return w(t=(0,i.H)(t)),null===t[0]&&null===t[1]?null:null===t[0]?(0,a.cloneGeometry)(t[1]):null===t[1]?(0,a.cloneGeometry)(t[0]):(0,f.symmetricDifference)(t[0],t[1])}))},e.functions.clip=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){if(t=(0,i.H)(t),(0,i.p)(t,2,2),!(t[1]instanceof c.default)&&null!==t[1])throw new Error("Illegal Argument");if(null===t[0])return null;if(!(t[0]instanceof s.default))throw new Error("Illegal Argument");return null===t[1]?null:(0,f.clip)(t[0],t[1])}))},e.functions.cut=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){if(t=(0,i.H)(t),(0,i.p)(t,2,2),!(t[1]instanceof v.default)&&null!==t[1])throw new Error("Illegal Argument");if(null===t[0])return[];if(!(t[0]instanceof s.default))throw new Error("Illegal Argument");return null===t[1]?[(0,a.cloneGeometry)(t[0])]:(0,f.cut)(t[0],t[1])}))},e.functions.area=function(n,t){return e.standardFunctionAsync(n,t,(function(e,t,r){if((0,i.p)(r,1,2),null===(r=(0,i.H)(r))[0])return 0;if((0,i.q)(r[0]))return r[0].sumArea((0,a.convertSquareUnitsToCode)((0,i.C)(r[1],-1)),!1,n.abortSignal).then((function(e){if(n.abortSignal.aborted)throw new Error("Operation has been cancelled.");return e}));if((0,i.a)(r[0])||(0,i.b)(r[0])){var o=(0,i.K)(r[0],n.spatialReference);return null===o?0:(0,f.planarArea)(o,(0,a.convertSquareUnitsToCode)((0,i.C)(r[1],-1)))}if(!(r[0]instanceof s.default))throw new Error("Illegal Argument");return(0,f.planarArea)(r[0],(0,a.convertSquareUnitsToCode)((0,i.C)(r[1],-1)))}))},e.functions.areageodetic=function(n,t){return e.standardFunctionAsync(n,t,(function(e,t,r){if((0,i.p)(r,1,2),null===(r=(0,i.H)(r))[0])return 0;if((0,i.q)(r[0]))return r[0].sumArea((0,a.convertSquareUnitsToCode)((0,i.C)(r[1],-1)),!0,n.abortSignal).then((function(e){if(n.abortSignal.aborted)throw new Error("Operation has been cancelled.");return e}));if((0,i.a)(r[0])||(0,i.b)(r[0])){var o=(0,i.K)(r[0],n.spatialReference);return null===o?0:(0,f.geodesicArea)(o,(0,a.convertSquareUnitsToCode)((0,i.C)(r[1],-1)))}if(!(r[0]instanceof s.default))throw new Error("Illegal Argument");return(0,f.geodesicArea)(r[0],(0,a.convertSquareUnitsToCode)((0,i.C)(r[1],-1)))}))},e.functions.length=function(n,t){return e.standardFunctionAsync(n,t,(function(e,t,r){if((0,i.p)(r,1,2),null===(r=(0,i.H)(r))[0])return 0;if((0,i.q)(r[0]))return r[0].sumLength((0,a.convertLinearUnitsToCode)((0,i.C)(r[1],-1)),!1,n.abortSignal).then((function(e){if(n.abortSignal.aborted)throw new Error("Operation has been cancelled.");return e}));if((0,i.a)(r[0])||(0,i.b)(r[0])){var o=(0,i.J)(r[0],n.spatialReference);return null===o?0:(0,f.planarLength)(o,(0,a.convertLinearUnitsToCode)((0,i.C)(r[1],-1)))}if(!(r[0]instanceof s.default))throw new Error("Illegal Argument");return(0,f.planarLength)(r[0],(0,a.convertLinearUnitsToCode)((0,i.C)(r[1],-1)))}))},e.functions.length3d=function(n,t){return e.standardFunctionAsync(n,t,(function(e,t,r){if((0,i.p)(r,1,2),null===(r=(0,i.H)(r))[0])return 0;if((0,i.a)(r[0])||(0,i.b)(r[0])){var o=(0,i.J)(r[0],n.spatialReference);return null===o?0:!0===o.hasZ?y(o,(0,a.convertLinearUnitsToCode)((0,i.C)(r[1],-1))):(0,f.planarLength)(o,(0,a.convertLinearUnitsToCode)((0,i.C)(r[1],-1)))}if(!(r[0]instanceof s.default))throw new Error("Illegal Argument");return!0===r[0].hasZ?y(r[0],(0,a.convertLinearUnitsToCode)((0,i.C)(r[1],-1))):(0,f.planarLength)(r[0],(0,a.convertLinearUnitsToCode)((0,i.C)(r[1],-1)))}))},e.functions.lengthgeodetic=function(n,t){return e.standardFunctionAsync(n,t,(function(e,t,r){if((0,i.p)(r,1,2),null===(r=(0,i.H)(r))[0])return 0;if((0,i.q)(r[0]))return r[0].sumLength((0,a.convertLinearUnitsToCode)((0,i.C)(r[1],-1)),!0,n.abortSignal).then((function(e){if(n.abortSignal.aborted)throw new Error("Operation has been cancelled.");return e}));if((0,i.a)(r[0])||(0,i.b)(r[0])){var o=(0,i.J)(r[0],n.spatialReference);return null===o?0:(0,f.geodesicLength)(o,(0,a.convertLinearUnitsToCode)((0,i.C)(r[1],-1)))}if(!(r[0]instanceof s.default))throw new Error("Illegal Argument");return(0,f.geodesicLength)(r[0],(0,a.convertLinearUnitsToCode)((0,i.C)(r[1],-1)))}))},e.functions.distance=function(n,t){return e.standardFunctionAsync(n,t,(function(e,t,r){r=(0,i.H)(r),(0,i.p)(r,2,3);var o=r[0];((0,i.a)(r[0])||(0,i.b)(r[0]))&&(o=(0,i.L)(r[0],n.spatialReference));var u=r[1];if(((0,i.a)(r[1])||(0,i.b)(r[1]))&&(u=(0,i.L)(r[1],n.spatialReference)),!(o instanceof s.default))throw new Error("Illegal Argument");if(!(u instanceof s.default))throw new Error("Illegal Argument");return(0,f.distance)(o,u,(0,a.convertLinearUnitsToCode)((0,i.C)(r[2],-1)))}))},e.functions.distancegeodetic=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){t=(0,i.H)(t),(0,i.p)(t,2,3);var r=t[0],o=t[1];if(!(r instanceof h.default))throw new Error("Illegal Argument");if(!(o instanceof h.default))throw new Error("Illegal Argument");var u=new(0,v.default)({paths:[],spatialReference:r.spatialReference});return u.addPath([r,o]),(0,f.geodesicLength)(u,(0,a.convertLinearUnitsToCode)((0,i.C)(t[2],-1)))}))},e.functions.densify=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){if(t=(0,i.H)(t),(0,i.p)(t,2,3),null===t[0])return null;if(!(t[0]instanceof s.default))throw new Error("Illegal Argument");var r=(0,i.t)(t[1]);if(isNaN(r))throw new Error("Illegal Argument");if(r<=0)throw new Error("Illegal Argument");return t[0]instanceof g.default||t[0]instanceof v.default?(0,f.densify)(t[0],r,(0,a.convertLinearUnitsToCode)((0,i.C)(t[2],-1))):t[0]instanceof c.default?(0,f.densify)(E(t[0]),r,(0,a.convertLinearUnitsToCode)((0,i.C)(t[2],-1))):t[0]}))},e.functions.densifygeodetic=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){if(t=(0,i.H)(t),(0,i.p)(t,2,3),null===t[0])return null;if(!(t[0]instanceof s.default))throw new Error("Illegal Argument");var r=(0,i.t)(t[1]);if(isNaN(r))throw new Error("Illegal Argument");if(r<=0)throw new Error("Illegal Argument");return t[0]instanceof g.default||t[0]instanceof v.default?(0,f.geodesicDensify)(t[0],r,(0,a.convertLinearUnitsToCode)((0,i.C)(t[2],-1))):t[0]instanceof c.default?(0,f.geodesicDensify)(E(t[0]),r,(0,a.convertLinearUnitsToCode)((0,i.C)(t[2],-1))):t[0]}))},e.functions.generalize=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){if(t=(0,i.H)(t),(0,i.p)(t,2,4),null===t[0])return null;if(!(t[0]instanceof s.default))throw new Error("Illegal Argument");var r=(0,i.t)(t[1]);if(isNaN(r))throw new Error("Illegal Argument");return(0,f.generalize)(t[0],r,(0,i.z)((0,i.C)(t[2],!0)),(0,a.convertLinearUnitsToCode)((0,i.C)(t[3],-1)))}))},e.functions.buffer=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){if(t=(0,i.H)(t),(0,i.p)(t,2,3),null===t[0])return null;if(!(t[0]instanceof s.default))throw new Error("Illegal Argument");var r=(0,i.t)(t[1]);if(isNaN(r))throw new Error("Illegal Argument");return 0===r?(0,a.cloneGeometry)(t[0]):(0,f.buffer)(t[0],r,(0,a.convertLinearUnitsToCode)((0,i.C)(t[2],-1)))}))},e.functions.buffergeodetic=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){if(t=(0,i.H)(t),(0,i.p)(t,2,3),null===t[0])return null;if(!(t[0]instanceof s.default))throw new Error("Illegal Argument");var r=(0,i.t)(t[1]);if(isNaN(r))throw new Error("Illegal Argument");return 0===r?(0,a.cloneGeometry)(t[0]):(0,f.geodesicBuffer)(t[0],r,(0,a.convertLinearUnitsToCode)((0,i.C)(t[2],-1)))}))},e.functions.offset=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){if(t=(0,i.H)(t),(0,i.p)(t,2,6),null===t[0])return null;if(!(t[0]instanceof g.default||t[0]instanceof v.default))throw new Error("Illegal Argument");var r=(0,i.t)(t[1]);if(isNaN(r))throw new Error("Illegal Argument");var o=(0,i.t)((0,i.C)(t[4],10));if(isNaN(o))throw new Error("Illegal Argument");var u=(0,i.t)((0,i.C)(t[5],0));if(isNaN(u))throw new Error("Illegal Argument");return(0,f.offset)(t[0],r,(0,a.convertLinearUnitsToCode)((0,i.C)(t[2],-1)),(0,i.d)((0,i.C)(t[3],"round")).toLowerCase(),o,u)}))},e.functions.rotate=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){t=(0,i.H)(t),(0,i.p)(t,2,3);var r=t[0];if(null===r)return null;if(!(r instanceof s.default))throw new Error("Illegal Argument");r instanceof c.default&&(r=g.default.fromExtent(r));var o=(0,i.t)(t[1]);if(isNaN(o))throw new Error("Illegal Argument");var a=(0,i.C)(t[2],null);if(null===a)return(0,f.rotate)(r,o);if(a instanceof h.default)return(0,f.rotate)(r,o,a);throw new Error("Illegal Argument")}))},e.functions.centroid=function(n,t){return e.standardFunctionAsync(n,t,(function(e,t,r){if(r=(0,i.H)(r),(0,i.p)(r,1,1),null===r[0])return null;var o=r[0];if(((0,i.a)(r[0])||(0,i.b)(r[0]))&&(o=(0,i.L)(r[0],n.spatialReference)),null===o)return null;if(!(o instanceof s.default))throw new Error("Illegal Argument");return o instanceof h.default?(0,i.s)((0,a.cloneGeometry)(r[0]),n.spatialReference):o instanceof g.default?o.centroid:o instanceof v.default?(0,u.centroidPolyline)(o):o instanceof d.default?(0,u.centroidMultiPoint)(o):o instanceof c.default?o.center:null}))},e.functions.multiparttosinglepart=function(n,t){return e.standardFunctionAsync(n,t,(function(e,t,r){r=(0,i.H)(r),(0,i.p)(r,1,1);var o=[];if(null===r[0])return null;if(!(r[0]instanceof s.default))throw new Error("Illegal Argument");return r[0]instanceof h.default||r[0]instanceof c.default?[(0,i.s)((0,a.cloneGeometry)(r[0]),n.spatialReference)]:(0,f.simplify)(r[0]).then((function(e){if(e instanceof g.default){for(var t=[],u=[],l=0;l<e.rings.length;l++)if(e.isClockwise(e.rings[l])){var c=(0,p.fromJSON)({rings:[e.rings[l]],hasZ:!0===e.hasZ,hazM:!0===e.hasM,spatialReference:e.spatialReference.toJSON()});t.push(c)}else u.push({ring:e.rings[l],pt:e.getPoint(l,0)});for(var s=0;s<u.length;s++)for(var f=0;f<t.length;f++)if(t[f].contains(u[s].pt)){t[f].addRing(u[s].ring);break}return t}if(e instanceof v.default){for(var h=[],m=0;m<e.paths.length;m++){var E=(0,p.fromJSON)({paths:[e.paths[m]],hasZ:!0===e.hasZ,hazM:!0===e.hasM,spatialReference:e.spatialReference.toJSON()});h.push(E)}return h}if(r[0]instanceof d.default){for(var w=(0,i.s)((0,a.cloneGeometry)(r[0]),n.spatialReference),y=0;y<w.points.length;y++)o.push(w.getPoint(y));return o}return null}))}))},e.functions.issimple=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){if(t=(0,i.H)(t),(0,i.p)(t,1,1),null===t[0])return!0;if(!(t[0]instanceof s.default))throw new Error("Illegal Argument");return(0,f.isSimple)(t[0])}))},e.functions.simplify=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){if(t=(0,i.H)(t),(0,i.p)(t,1,1),null===t[0])return null;if(!(t[0]instanceof s.default))throw new Error("Illegal Argument");return(0,f.simplify)(t[0])}))})}}))}();
//# sourceMappingURL=arcadeAsyncRuntime.ce3bd7e2.js.map
