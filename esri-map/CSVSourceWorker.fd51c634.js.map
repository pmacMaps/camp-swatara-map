{"mappings":"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","sources":["node_modules/@arcgis/core/layers/graphics/data/QueryEngine.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{PositionHint as e,indexOf as t}from\"../../../core/arrayUtils.js\";import i from\"../../../core/Error.js\";import{clone as s}from\"../../../core/lang.js\";import{removeMaybe as r,destroyMaybe as a,isNone as n,isSome as o}from\"../../../core/maybe.js\";import{MemCacheStorage as u,MemCache as c}from\"../../../core/MemCache.js\";import{getMetersPerUnitForSR as h}from\"../../../core/unitUtils.js\";import{create as l,set as m,NEGATIVE_INFINITY as p,expandWithAABB as f}from\"../../../geometry/support/aaBoundingBox.js\";import{fromValues as d,create as y}from\"../../../geometry/support/aaBoundingRect.js\";import{getBoundsXY as g}from\"../../../geometry/support/boundsUtils.js\";import{fromJSON as x,isExtent as _,isPolygon as w}from\"../../../geometry/support/jsonUtils.js\";import{normalizeCentralMeridian as S}from\"../../../geometry/support/normalizeUtils.js\";import{equals as F,isValid as R}from\"../../../geometry/support/spatialReferenceUtils.js\";import{convertFromGeometry as Q}from\"../featureConversionUtils.js\";import{getWhereClause as I,validateFields as j,validateWhere as E,validateHaving as b,hasInvalidFieldType as A}from\"./attributeSupport.js\";import{project as T,checkProjectionSupport as k,projectMany as C}from\"./projectionSupport.js\";import{queryCapabilities as B}from\"./QueryEngineCapabilities.js\";import{QueryEngineResult as q,SnappingTypes as v}from\"./QueryEngineResult.js\";import{getSpatialQueryOperator as z,canQueryWithRBush as O,checkSpatialQuerySupport as G}from\"./spatialQuerySupport.js\";import{getTimeExtent as M,getTimeOperator as P}from\"./timeSupport.js\";import{cleanFromGeometryEngine as U,QUERY_ENGINE_EMPTY_RESULT as Z,normalizeQuery as N,getGeometry as D}from\"./utils.js\";import H from\"../../support/FieldsIndex.js\";import{loadArcade as L}from\"../../../support/arcadeOnDemand.js\";import{noBudget as J}from\"../../../views/support/Scheduler.js\";function V(e){return e.every((e=>\"exceedslimit\"!==e.statisticType))}const W=\"feature-store:unsupported-query\";class ${constructor(e,t=null,i,s,r){this.attributes=e,this.geometry=i,this.centroid=s,this.filterFlags=r,this.groupId=-1,this.displayId=t}}const K=new u(2e6);let X=0;class Y{constructor(e){this.capabilities={query:B},this.geometryType=e.geometryType,this.hasM=e.hasM,this.hasZ=e.hasZ,this.objectIdField=e.objectIdField,this.spatialReference=e.spatialReference,this.definitionExpression=e.definitionExpression,this.featureStore=e.featureStore,this.aggregateAdapter=e.aggregateAdapter,this._changeHandle=this.featureStore.events.on(\"changed\",(()=>this.clearCache())),this.timeInfo=e.timeInfo,e.cacheSpatialQueries&&(this._geometryQueryCache=new c(X+++\"$$\",K)),this.fieldsIndex=new H(e.fields),e.scheduler&&e.priority&&(this._frameTask=e.scheduler.registerTask(e.priority))}destroy(){this._frameTask=r(this._frameTask),this.clearCache(),a(this._geometryQueryCache),this._changeHandle=r(this._changeHandle),a(this.fieldsIndex)}get featureAdapter(){return this.featureStore.featureAdapter}get fullExtent(){const e=this.featureStore.fullBounds;return n(e)?null:{xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:U(this.spatialReference)}}get timeExtent(){return this.timeInfo?(this._timeExtent||(this._timeExtent=M(this.timeInfo,this.featureStore)),this._timeExtent):null}clearCache(){this._geometryQueryCache?.clear(),this._allItems=null,this._timeExtent=null}async executeQuery(e,t){try{return(await this._executeQuery(e,{},t)).createQueryResponse()}catch(i){if(i!==Z)throw i;return new q([],e,this).createQueryResponse()}}async executeQueryForCount(e={},t){try{return(await this._executeQuery(e,{returnGeometry:!1,returnCentroid:!1,outSR:null},t)).createQueryResponseForCount()}catch(i){if(i!==Z)throw i;return 0}}async executeQueryForExtent(e,t){const i=e.outSR;try{const s=await this._executeQuery(e,{returnGeometry:!0,returnCentroid:!1,outSR:null},t),r=s.size;if(!r)return{count:0,extent:null};m(te,p),this.featureStore.forEachBounds(s.items,(e=>f(te,e)),ee);const a={xmin:te[0],ymin:te[1],xmax:te[3],ymax:te[4],spatialReference:U(this.spatialReference)};this.hasZ&&isFinite(te[2])&&isFinite(te[5])&&(a.zmin=te[2],a.zmax=te[5]);const n=T(a,s.spatialReference,i);if(n.spatialReference=U(i||this.spatialReference),n.xmax-n.xmin==0){const e=h(n.spatialReference);n.xmin-=e,n.xmax+=e}if(n.ymax-n.ymin==0){const e=h(n.spatialReference);n.ymin-=e,n.ymax+=e}if(this.hasZ&&null!=n.zmin&&null!=n.zmax&&n.zmax-n.zmin==0){const e=h(n.spatialReference);n.zmin-=e,n.zmax+=e}return{count:r,extent:n}}catch(s){if(s===Z)return{count:0,extent:null};throw s}}async executeQueryForIds(e,t){return this.executeQueryForIdSet(e,t).then((e=>Array.from(e)))}async executeQueryForIdSet(e,t){try{const i=await this._executeQuery(e,{returnGeometry:!0,returnCentroid:!1,outSR:null},t),s=i.items,r=new Set;return await this._reschedule((()=>{for(const e of s)r.add(i.featureAdapter.getObjectId(e))}),t),r}catch(i){if(i===Z)return new Set;throw i}}async executeQueryForSnapping(e,t){const{point:i,distance:s,types:r}=e;if(r===v.NONE)return{candidates:[]};const a=await this._reschedule((()=>this._checkQuerySupport(e.query)),t),o=!F(i.spatialReference,this.spatialReference);o&&await k(i.spatialReference,this.spatialReference);const u=\"number\"==typeof s?s:s.x,c=\"number\"==typeof s?s:s.y,h={xmin:i.x-u,xmax:i.x+u,ymin:i.y-c,ymax:i.y+c,spatialReference:i.spatialReference},l=o?T(h,this.spatialReference):h;if(!l)return{candidates:[]};const m=(await S(x(i),null,{signal:t}))[0],p=(await S(x(l),null,{signal:t}))[0];if(n(m)||n(p))return{candidates:[]};const f=new q(this._searchFeatures(this._getQueryBBoxes(p.toJSON())),a,this);await this._reschedule((()=>this._executeObjectIdsQuery(f)),t),await this._reschedule((()=>this._executeTimeQuery(f)),t),await this._reschedule((()=>this._executeAttributesQuery(f)),t);const d=m.toJSON(),y=o?T(d,this.spatialReference):d,g=o?Math.max(l.xmax-l.xmin,l.ymax-l.ymin)/2:s;return f.createSnappingResponse({...e,point:y,distance:g},i.spatialReference)}async executeQueryForLatestObservations(e,t){if(!this.timeInfo||!this.timeInfo.trackIdField)throw new i(W,\"Missing timeInfo or timeInfo.trackIdField\",{query:e,timeInfo:this.timeInfo});try{const i=await this._executeQuery(e,{},t);return await this._reschedule((()=>this._filterLatest(i)),t),i.createQueryResponse()}catch(s){if(s!==Z)throw s;return new q([],e,this).createQueryResponse()}}async executeQueryForSummaryStatistics(e={},t,i){const{field:s,normalizationField:r,valueExpression:a}=t;return(await this._getQueryEngineResultForStats(e,{field:s,normalizationField:r,valueExpression:a},i)).createSummaryStatisticsResponse(t)}async executeQueryForUniqueValues(e={},t,i){const{field:s,valueExpression:r}=t;return(await this._getQueryEngineResultForStats(e,{field:s,valueExpression:r},i)).createUniqueValuesResponse(t)}async executeQueryForClassBreaks(e={},t,i){const{field:s,normalizationField:r,valueExpression:a}=t;return(await this._getQueryEngineResultForStats(e,{field:s,normalizationField:r,valueExpression:a},i)).createClassBreaksResponse(t)}async executeQueryForHistogram(e={},t,i){const{field:s,normalizationField:r,valueExpression:a}=t;return(await this._getQueryEngineResultForStats(e,{field:s,normalizationField:r,valueExpression:a},i)).createHistogramResponse(t)}async _schedule(e,t){return o(this._frameTask)?this._frameTask.schedule(e,t):e(J)}async _reschedule(e,t){return o(this._frameTask)?this._frameTask.reschedule(e,t):e(J)}_getAll(e){return n(this._allItems)&&(this._allItems=this.featureStore.toArray()),new q(this._allItems,e,this)}async _executeQuery(e,t,i){e=s(e),e=await this._schedule((()=>N(e,this.definitionExpression,this.spatialReference)),i),e=await this._reschedule((()=>this._checkQuerySupport(e)),i),e={...e,...t};const r=await this._reschedule((()=>this._executeSceneFilterQuery(e,i)),i),a=await this._reschedule((()=>this._executeGeometryQuery(e,r,i)),i);return await this._reschedule((()=>this._executeAggregateIdsQuery(a)),i),await this._reschedule((()=>this._executeObjectIdsQuery(a)),i),await this._reschedule((()=>this._executeTimeQuery(a)),i),await this._reschedule((()=>this._executeAttributesQuery(a)),i),a}async _executeSceneFilterQuery(e,t){if(n(e.sceneFilter))return null;const{outSR:i,returnGeometry:s,returnCentroid:r}=e,a=this.featureStore.featureSpatialReference,o=e.sceneFilter.geometry,u=n(a)||F(a,o.spatialReference)?o:T(o,a);if(!u)return null;const c=s||r,h=R(i)&&!F(this.spatialReference,i)&&c?async e=>this._project(e,i):e=>e,l=this.featureAdapter,m=this._searchFeatures(this._getQueryBBoxes(u));if(\"disjoint\"===e.sceneFilter.spatialRelationship){if(!m.length)return null;const i=new Set;for(const e of m)i.add(l.getObjectId(e));const s=await this._reschedule((()=>this.featureStore.toArray()),t),r=await this._reschedule((async()=>{const r=await z(\"esriSpatialRelDisjoint\",u,this.geometryType,this.hasZ,this.hasM),a=e=>!i.has(l.getObjectId(e))||r(l.getGeometry(e)),n=await this._runSpatialFilter(s,a,t);return new q(n,e,this)}),t);return h(r)}if(!m.length)return new q([],e,this);if(this._canExecuteSinglePass(u,e))return h(new q(m,e,this));const p=await z(\"esriSpatialRelContains\",u,this.geometryType,this.hasZ,this.hasM),f=await this._runSpatialFilter(m,(e=>p(l.getGeometry(e))),t);return h(new q(f,e,this))}async _executeGeometryQuery(i,s,r){if(o(s)&&0===s.items.length)return s;i=o(s)?s.query:i;const{geometry:a,outSR:u,spatialRel:c,returnGeometry:h,returnCentroid:l}=i,m=this.featureStore.featureSpatialReference,p=!a||n(m)||F(m,a.spatialReference)?a:T(a,m),f=h||l,d=R(u)&&!F(this.spatialReference,u),y=this._geometryQueryCache&&n(s)?d&&f?JSON.stringify({originalFilterGeometry:a,spatialRelationship:c,outSpatialReference:u}):JSON.stringify({originalFilterGeometry:a,spatialRelationship:c}):null,g=y?this._geometryQueryCache.get(y):null;if(o(g))return new q(g,i,this);const x=async e=>(d&&f&&await this._project(e,u),y&&this._geometryQueryCache.put(y,e.items,e.items.length+1),e);if(!p)return x(o(s)?s:this._getAll(i));const _=this.featureAdapter;let w=this._searchFeatures(this._getQueryBBoxes(a));if(\"esriSpatialRelDisjoint\"===c){if(!w.length)return x(o(s)?s:this._getAll(i));const e=new Set;for(const i of w)e.add(_.getObjectId(i));const t=o(s)?s.items:await this._reschedule((()=>this.featureStore.toArray()),r),a=await this._reschedule((async()=>{const s=await z(c,p,this.geometryType,this.hasZ,this.hasM),a=t=>!e.has(_.getObjectId(t))||s(_.getGeometry(t)),n=await this._runSpatialFilter(t,a,r);return new q(n,i,this)}),r);return x(a)}if(o(s)){const i=new e;w=w.filter((e=>t(s.items,e,s.items.length,i)>=0))}if(!w.length){const e=new q([],i,this);return y&&this._geometryQueryCache.put(y,e.items,1),e}if(this._canExecuteSinglePass(p,i))return x(new q(w,i,this));const S=await z(c,p,this.geometryType,this.hasZ,this.hasM),Q=await this._runSpatialFilter(w,(e=>S(_.getGeometry(e))),r);return x(new q(Q,i,this))}_executeAggregateIdsQuery(e){if(0===e.items.length||!e.query.aggregateIds||!e.query.aggregateIds.length||n(this.aggregateAdapter))return;const t=new Set;for(const s of e.query.aggregateIds){this.aggregateAdapter.getFeatureObjectIds(s).forEach((e=>t.add(e)))}const i=this.featureAdapter.getObjectId;e.items=e.items.filter((e=>t.has(i(e))))}_executeObjectIdsQuery(e){if(0===e.items.length||!e.query.objectIds||!e.query.objectIds.length)return;const t=new Set(e.query.objectIds),i=this.featureAdapter.getObjectId;e.items=e.items.filter((e=>t.has(i(e))))}_executeTimeQuery(e){if(0===e.items.length)return;const t=P(this.timeInfo,e.query.timeExtent,this.featureAdapter);n(t)||(e.items=e.items.filter(t))}_executeAttributesQuery(e){if(0===e.items.length)return;const t=I(e.query.where,this.fieldsIndex);if(t){if(!t.isStandardized)throw new TypeError(\"Where clause is not standardized\");e.items=e.items.filter((e=>t.testFeature(e,this.featureAdapter)))}}async _runSpatialFilter(e,t,i){if(!t)return e;if(n(this._frameTask))return e.filter((e=>t(e)));let s=0;const r=new Array,a=async n=>{for(;s<e.length;){const o=e[s++];t(o)&&(r.push(o),n.madeProgress()),n.done&&await this._reschedule((e=>a(e)),i)}};return this._reschedule((e=>a(e)),i).then((()=>r))}_filterLatest(e){const{trackIdField:t,startTimeField:i,endTimeField:s}=this.timeInfo,r=s||i,a=new Map,n=this.featureAdapter.getAttribute;for(const o of e.items){const e=n(o,t),i=n(o,r),s=a.get(e);(!s||i>n(s,r))&&a.set(e,o)}e.items=Array.from(a.values())}_canExecuteSinglePass(e,t){const{spatialRel:i}=t;return O(e)&&(\"esriSpatialRelEnvelopeIntersects\"===i||\"esriGeometryPoint\"===this.geometryType&&(\"esriSpatialRelIntersects\"===i||\"esriSpatialRelContains\"===i||\"esriSpatialRelWithin\"===i))}async _project(e,t){if(!t||F(this.spatialReference,t))return e;const i=this.featureAdapter,s=await C(e.items.map((e=>D(this.geometryType,this.hasZ,this.hasM,i.getGeometry(e)))),this.spatialReference,t);return e.items=s.map(((t,s)=>i.cloneWithGeometry(e.items[s],Q(t,this.hasZ,this.hasM)))),e}_getQueryBBoxes(e){if(O(e)){if(_(e))return[d(e.xmin,e.ymin,e.xmax,e.ymax)];if(w(e))return e.rings.map((e=>d(Math.min(e[0][0],e[2][0]),Math.min(e[0][1],e[2][1]),Math.max(e[0][0],e[2][0]),Math.max(e[0][1],e[2][1]))))}return[g(y(),e)]}_searchFeatures(e){for(const i of e)this.featureStore.forEachInBounds(i,(e=>ie.add(e)));const t=Array.from(ie.values());return ie.clear(),t}async _checkStatisticsSupport(e,t){if(e.distance<0||null!=e.geometryPrecision||e.multipatchOption||e.pixelSize||e.relationParam||e.text||e.outStatistics||e.groupByFieldsForStatistics||e.having||e.orderByFields)throw new i(W,\"Unsupported query options\",{query:e});return this._checkAttributesQuerySupport(e),Promise.all([this._checkStatisticsParamsSupport(t),G(e,this.geometryType,this.spatialReference),k(this.spatialReference,e.outSR)]).then((()=>e))}async _checkStatisticsParamsSupport(e){let t=[];if(e.valueExpression){const{arcadeUtils:i}=await L();t=i.extractFieldNames(e.valueExpression)}if(e.field&&t.push(e.field),e.normalizationField&&t.push(e.normalizationField),!t.length)throw new i(W,\"params should have at least a field or valueExpression\",{params:e});j(this.fieldsIndex,t,\"params contains missing fields\")}async _checkQuerySupport(e){if(e.distance<0||null!=e.geometryPrecision||e.multipatchOption||e.pixelSize||e.relationParam||e.text)throw new i(W,\"Unsupported query options\",{query:e});return this._checkAttributesQuerySupport(e),this._checkStatisticsQuerySupport(e),Promise.all([G(e,this.geometryType,this.spatialReference),k(this.spatialReference,e.outSR)]).then((()=>e))}_checkAttributesQuerySupport(e){const{outFields:t,orderByFields:s,returnDistinctValues:r,outStatistics:a}=e,n=a?a.map((e=>e.outStatisticFieldName&&e.outStatisticFieldName.toLowerCase())).filter(Boolean):[];if(s&&s.length>0){const e=\" asc\",t=\" desc\",i=s.map((i=>{const s=i.toLowerCase();return s.includes(e)?s.split(e)[0]:s.includes(t)?s.split(t)[0]:i})).filter((e=>!n.includes(e)));j(this.fieldsIndex,i,\"orderByFields contains missing fields\")}if(t&&t.length>0)j(this.fieldsIndex,t,\"outFields contains missing fields\");else if(r)throw new i(W,\"outFields should be specified for returnDistinctValues\",{query:e});E(this.fieldsIndex,e.where)}_checkStatisticsQuerySupport(e){const{outStatistics:t,groupByFieldsForStatistics:s,having:r}=e,a=s&&s.length,n=t&&t.length;if(r){if(!a||!n)throw new i(W,\"outStatistics and groupByFieldsForStatistics should be specified with having\",{query:e});b(this.fieldsIndex,r,t)}if(n){if(!V(t))return;const r=t.map((e=>e.onStatisticField)).filter(Boolean);j(this.fieldsIndex,r,\"onStatisticFields contains missing fields\"),a&&j(this.fieldsIndex,s,\"groupByFieldsForStatistics contains missing fields\");for(const s of t){const{onStatisticField:t,statisticType:r}=s;if((\"percentile_disc\"===r||\"percentile_cont\"===r)&&\"statisticParameters\"in s){const{statisticParameters:t}=s;if(!t)throw new i(W,\"statisticParamters should be set for percentile type\",{definition:s,query:e})}else if(\"count\"!==r&&t&&A(t,this.fieldsIndex))throw new i(W,\"outStatistics contains non-numeric fields\",{definition:s,query:e})}}}async _getQueryEngineResultForStats(e,t,i){e=s(e);try{e=await this._schedule((()=>N(e,this.definitionExpression,this.spatialReference)),i),e=await this._reschedule((()=>this._checkStatisticsSupport(e,t)),i);const s=await this._reschedule((()=>this._executeSceneFilterQuery(e,i)),i),r=await this._reschedule((()=>this._executeGeometryQuery(e,s,i)),i);return await this._reschedule((()=>this._executeAggregateIdsQuery(r)),i),await this._reschedule((()=>this._executeObjectIdsQuery(r)),i),await this._reschedule((()=>this._executeTimeQuery(r)),i),await this._reschedule((()=>this._executeAttributesQuery(r)),i),r}catch(r){if(r!==Z)throw r;return new q([],e,this)}}}const ee=l(),te=l(),ie=new Set;export{$ as Feature,Y as QueryEngine};\n"],"names":["$lNwWH","parcelRequire","$af4fbd65d3240965$var$W","$af4fbd65d3240965$var$K","$8BcI6","MemCacheStorage","$af4fbd65d3240965$var$X","$af4fbd65d3240965$export$b9b7dd41af1fba2c","destroy","this","_frameTask","$7qybv","removeMaybe","clearCache","destroyMaybe","_geometryQueryCache","_changeHandle","fieldsIndex","featureAdapter","featureStore","fullExtent","e","fullBounds","isNone","xmin","ymin","xmax","ymax","spatialReference","$emniL","cleanFromGeometryEngine","timeExtent","timeInfo","_timeExtent","$17eId","getTimeExtent","ref","clear","_allItems","async","t","_executeQuery","createQueryResponse","i","QUERY_ENGINE_EMPTY_RESULT","$3lcnv","QueryEngineResult","returnGeometry","returnCentroid","outSR","createQueryResponseForCount","s","r","size","count","extent","$ayLat","set","$af4fbd65d3240965$var$te","NEGATIVE_INFINITY","forEachBounds","items","expandWithAABB","$af4fbd65d3240965$var$ee","a","hasZ","isFinite","zmin","zmax","n","$fP7bp","project","e1","$5vzSQ","getMetersPerUnitForSR","e2","e3","s1","executeQueryForIdSet","then","Array","from","Set","_reschedule","add","getObjectId","i1","point","distance","types","SnappingTypes","NONE","candidates","_checkQuerySupport","query","o","$eY5Yp","equals","checkProjectionSupport","u","x","c","y","h","l","m","$5On35","normalizeCentralMeridian","$79LpT","fromJSON","signal","p","f","_searchFeatures","_getQueryBBoxes","toJSON","_executeObjectIdsQuery","_executeTimeQuery","_executeAttributesQuery","d","g","Math","max","createSnappingResponse","trackIdField","$kyj08","default","_filterLatest","field","normalizationField","valueExpression","_getQueryEngineResultForStats","createSummaryStatisticsResponse","createUniqueValuesResponse","createClassBreaksResponse","createHistogramResponse","isSome","schedule","$5U4nr","noBudget","reschedule","_getAll","toArray","$flPLJ","clone","_schedule","normalizeQuery","definitionExpression","_executeSceneFilterQuery","_executeGeometryQuery","_executeAggregateIdsQuery","sceneFilter","featureSpatialReference","geometry","isValid","_project","spatialRelationship","length","r1","$iNIOS","getSpatialQueryOperator","geometryType","hasM","_runSpatialFilter","has","getGeometry","_canExecuteSinglePass","spatialRel","JSON","stringify","originalFilterGeometry","outSpatialReference","get","put","_","w","t1","a1","i2","PositionHint","filter","indexOf","S","Q","aggregateIds","aggregateAdapter","getFeatureObjectIds","forEach","objectIds","getTimeOperator","$gCbVt","getWhereClause","where","isStandardized","TypeError","testFeature","push","madeProgress","done","startTimeField","endTimeField","Map","getAttribute","values","canQueryWithRBush","projectMany","map","cloneWithGeometry","$akQYU","convertFromGeometry","isExtent","$8TwEW","fromValues","isPolygon","rings","min","$5Hy9K","getBoundsXY","create","forEachInBounds","$af4fbd65d3240965$var$ie","geometryPrecision","multipatchOption","pixelSize","relationParam","text","outStatistics","groupByFieldsForStatistics","having","orderByFields","_checkAttributesQuerySupport","Promise","all","_checkStatisticsParamsSupport","checkSpatialQuerySupport","arcadeUtils","$3nnTb","loadArcade","extractFieldNames","params","validateFields","_checkStatisticsQuerySupport","outFields","returnDistinctValues","outStatisticFieldName","toLowerCase","Boolean","includes","split","validateWhere","validateHaving","every","statisticType","$af4fbd65d3240965$var$V","onStatisticField","r2","hasInvalidFieldType","definition","statisticParameters","t2","_checkStatisticsSupport","constructor","capabilities","$aNMpQ","queryCapabilities","objectIdField","events","on","cacheSpatialQueries","MemCache","$4nMX7","fields","scheduler","priority","registerTask"],"version":3,"file":"CSVSourceWorker.fd51c634.js.map"}