{"mappings":"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","sources":["node_modules/@arcgis/core/layers/graphics/editingSupport.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport e from\"../../Graphic.js\";import t from\"../../core/Collection.js\";import a from\"../../core/Error.js\";import{clone as r}from\"../../core/lang.js\";import s from\"../../core/Logger.js\";import{createResolver as o}from\"../../core/promiseUtils.js\";import{dataComponents as i}from\"../../core/urlUtils.js\";import{normalizeCentralMeridian as n}from\"../../geometry/support/normalizeUtils.js\";import{isEditBusLayer as d,emitApplyEditsEvent as l}from\"../mixins/EditBusLayer.js\";import{getMimeTypeFormatId as u,getFilenameFormatId as p}from\"../support/infoFor3D.js\";import{getEffectiveEditingEnabled as c,getEffectiveLayerCapabilities as h}from\"../support/layerUtils.js\";function m(e){return e&&null!=e.applyEdits}function y(e){return\"object\"==typeof e&&null!=e&&\"objectId\"in e&&!!e.objectId}function f(e){return e.every(y)}function g(e){return\"object\"==typeof e&&null!=e&&\"globalId\"in e&&!!e.globalId}function b(e){return e.every(g)}async function F(e,t,a,s={}){let i;if(d(e)&&e.url)i=l(e.url,e.layerId,\"original-and-current-features\"===s.returnServiceEditsOption);else{i=o(),i.promise.then((t=>{(t.addedFeatures.length||t.updatedFeatures.length||t.deletedFeatures.length||t.addedAttachments.length||t.updatedAttachments.length||t.deletedAttachments.length)&&e.emit(\"edits\",t)}));const t={result:i.promise};e.emit(\"apply-edits\",t)}try{const{results:o,edits:n}=await w(e,t,a,s),d=e=>e.filter((e=>!e.error)).map(r),l={edits:n,addedFeatures:d(o.addFeatureResults),updatedFeatures:d(o.updateFeatureResults),deletedFeatures:d(o.deleteFeatureResults),addedAttachments:d(o.addAttachmentResults),updatedAttachments:d(o.updateAttachmentResults),deletedAttachments:d(o.deleteAttachmentResults),exceededTransferLimit:!1};return o.editedFeatureResults?.length&&(l.editedFeatures=o.editedFeatureResults),i.resolve(l),o}catch(n){throw i.reject(n),n}}async function w(e,t,r,s){if(await e.load(),!m(t))throw new a(`${e.type}-layer:no-editing-support`,\"Layer source does not support applyEdits capability\",{layer:e});if(!c(e))throw new a(`${e.type}-layer:editing-disabled`,\"Editing is disabled for layer\",{layer:e});const{edits:o,options:i}=await A(e,r,s);return o.addFeatures?.length||o.updateFeatures?.length||o.deleteFeatures?.length||o.addAttachments?.length||o.updateAttachments?.length||o.deleteAttachments?.length?{edits:o,results:await t.applyEdits(o,i)}:{edits:o,results:{addFeatureResults:[],updateFeatureResults:[],deleteFeatureResults:[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]}}}async function A(e,r,o){const i=r&&(r.addFeatures||r.updateFeatures||r.deleteFeatures),n=r&&(r.addAttachments||r.updateAttachments||r.deleteAttachments),d=null!=e.infoFor3D;if(!r||!i&&!n)throw new a(`${e.type}-layer:missing-parameters`,\"'addFeatures', 'updateFeatures', 'deleteFeatures', 'addAttachments', 'updateAttachments' or 'deleteAttachments' parameter is required\");const l=h(e);if(!l.data.isVersioned&&o?.gdbVersion)throw new a(`${e.type}-layer:invalid-parameter`,\"'gdbVersion' is applicable only if the layer supports versioned data. See: 'capabilities.data.isVersioned'\");if(!l.editing.supportsRollbackOnFailure&&o?.rollbackOnFailureEnabled)throw new a(`${e.type}-layer:invalid-parameter`,\"This layer does not support 'rollbackOnFailureEnabled' parameter. See: 'capabilities.editing.supportsRollbackOnFailure'\");if(!l.editing.supportsGlobalId&&o?.globalIdUsed)throw new a(`${e.type}-layer:invalid-parameter`,\"This layer does not support 'globalIdUsed' parameter. See: 'capabilities.editing.supportsGlobalId'\");if(!l.editing.supportsGlobalId&&n)throw new a(`${e.type}-layer:invalid-parameter`,\"'addAttachments', 'updateAttachments' and 'deleteAttachments' are applicable only if the layer supports global ids. See: 'capabilities.editing.supportsGlobalId'\");if(!o?.globalIdUsed&&n)throw new a(`${e.type}-layer:invalid-parameter`,\"When 'addAttachments', 'updateAttachments' or 'deleteAttachments' is specified, globalIdUsed should be set to true\");const u={...o};if(null!=u.rollbackOnFailureEnabled||l.editing.supportsRollbackOnFailure||(u.rollbackOnFailureEnabled=!0),u.rollbackOnFailureEnabled||\"original-and-current-features\"!==u.returnServiceEditsOption||(!1===u.rollbackOnFailureEnabled&&s.getLogger(\"esri.layers.graphics.editingSupport\").warn(`${e.type}-layer:invalid-parameter`,\"'original-and-current-features' is valid for 'returnServiceEditsOption' only when 'rollBackOnFailure' is true, but 'rollBackOnFailure' was set to false. 'rollBackOnFailure' has been overwrritten and set to true.\"),u.rollbackOnFailureEnabled=!0),!l.editing.supportsReturnServiceEditsInSourceSpatialReference&&u.returnServiceEditsInSourceSR)throw new a(`${e.type}-layer:invalid-parameter`,\"This layer does not support 'returnServiceEditsInSourceSR' parameter. See: 'capabilities.editing.supportsReturnServiceEditsInSourceSpatialReference'\");if(u.returnServiceEditsInSourceSR&&\"original-and-current-features\"!==u.returnServiceEditsOption)throw new a(`${e.type}-layer:invalid-parameter`,\"'returnServiceEditsInSourceSR' is valid only when 'returnServiceEditsOption' is set to 'original-and-current-features'\");const p={...r};if(p.addFeatures=r&&t.isCollection(r.addFeatures)?r.addFeatures.toArray():p.addFeatures||[],p.updateFeatures=r&&t.isCollection(r.updateFeatures)?r.updateFeatures.toArray():p.updateFeatures||[],p.deleteFeatures=r&&t.isCollection(r.deleteFeatures)?r.deleteFeatures.toArray():p.deleteFeatures||[],p.addFeatures.length&&!l.operations.supportsAdd)throw new a(`${e.type}-layer:unsupported-operation`,\"Layer does not support adding features.\");if(p.updateFeatures.length&&!l.operations.supportsUpdate)throw new a(`${e.type}-layer:unsupported-operation`,\"Layer does not support updating features.\");if(p.deleteFeatures.length&&!l.operations.supportsDelete)throw new a(`${e.type}-layer:unsupported-operation`,\"Layer does not support deleting features.\");p.addAttachments=p.addAttachments||[],p.updateAttachments=p.updateAttachments||[],p.deleteAttachments=p.deleteAttachments||[],p.addFeatures=p.addFeatures.map(j),p.updateFeatures=p.updateFeatures.map(j),p.addAssetFeatures=[];const c=o?.globalIdUsed||d;p.addFeatures.forEach((t=>E(t,e,c))),p.updateFeatures.forEach((t=>$(t,e,c))),p.deleteFeatures.forEach((t=>S(t,e,c))),p.addAttachments.forEach((t=>R(t,e))),p.updateAttachments.forEach((t=>R(t,e))),d&&await U(p,e);return{edits:await O(p),options:u}}function v(e,t,r){if(r){if(\"attributes\"in e&&!e.attributes[t.globalIdField])throw new a(`${t.type}-layer:invalid-parameter`,\"Feature should have 'globalId' when 'globalIdUsed' is true\");if(!(\"attributes\"in e)&&!e.globalId)throw new a(`${t.type}-layer:invalid-parameter`,\"'globalId' of the feature should be passed when 'globalIdUsed' is true\")}if(\"geometry\"in e&&null!=e.geometry){if(e.geometry.hasZ&&!1===t.capabilities?.data.supportsZ)throw new a(`${t.type}-layer:z-unsupported`,\"Layer does not support z values while feature has z values.\");if(e.geometry.hasM&&!1===t.capabilities?.data.supportsM)throw new a(`${t.type}-layer:m-unsupported`,\"Layer does not support m values while feature has m values.\")}}function I(e,t){if(\"geometry\"in e&&\"mesh\"===e.geometry?.type){const{geometry:r}=e;if(r.vertexSpace.isGeoreferenced)throw new a(`${t.type}-layer:georeferenced-mesh-unsupported`,\"Uploading georeferenced meshes to a layer is not supported.\")}}function E(e,t,a){v(e,t,a),I(e,t)}function S(e,t,a){v(e,t,a)}function $(e,t,r){v(e,t,r),I(e,t);const s=h(t);if(\"geometry\"in e&&null!=e.geometry&&!s?.editing.supportsGeometryUpdate)throw new a(`${t.type}-layer:unsupported-operation`,\"Layer does not support geometry updates.\")}function R(e,t){const{feature:r,attachment:s}=e;if(!r||\"attributes\"in r&&!r.attributes[t.globalIdField])throw new a(`${t.type}-layer:invalid-parameter`,\"Attachment should have reference to a feature with 'globalId'\");if(!(\"attributes\"in r)&&!r.globalId)throw new a(`${t.type}-layer:invalid-parameter`,\"Attachment should have reference to 'globalId' of the parent feature\");if(!s.globalId)throw new a(`${t.type}-layer:invalid-parameter`,\"Attachment should have 'globalId'\");if(!s.data&&!s.uploadId)throw new a(`${t.type}-layer:invalid-parameter`,\"Attachment should have 'data' or 'uploadId'\");if(!(s.data instanceof File&&!!s.data.name)&&!s.name)throw new a(`${t.type}-layer:invalid-parameter`,\"'name' is required when attachment is specified as Base64 encoded string using 'data'\");if(!t.capabilities?.editing.supportsUploadWithItemId&&s.uploadId)throw new a(`${t.type}-layer:invalid-parameter`,\"This layer does not support 'uploadId' parameter. See: 'capabilities.editing.supportsUploadWithItemId'\");if(\"string\"==typeof s.data){const e=i(s.data);if(e&&!e.isBase64)throw new a(`${t.type}-layer:invalid-parameter`,\"Attachment 'data' should be a Blob, File or Base64 encoded string\")}}async function O(e){const t=e.addFeatures??[],a=e.updateFeatures??[],r=t.concat(a).map((e=>e.geometry)),s=await n(r),o=t.length,i=a.length;return s.slice(0,o).forEach(((e,a)=>t[a].geometry=e)),s.slice(o,o+i).forEach(((e,t)=>a[t].geometry=e)),e}function j(t){const a=new e;return t.attributes||(t.attributes={}),a.geometry=t.geometry,a.attributes=t.attributes,a}async function U(e,t){if(null==t.infoFor3D)return;const{infoFor3D:r}=t,s=u(\"model/gltf-binary\",r.supportedFormats)??p(\"glb\",r.supportedFormats);if(!(!!s&&r.editFormats.includes(s)))throw new a(`${t.type}-layer:binary-gltf-asset-not-supported`,\"3DObjectFeatureLayer requires binary glTF (.glb) support for updating mesh geometry.\");e.addAssetFeatures??=[];const{addAssetFeatures:o}=e;for(const a of e.addFeatures??[])L(a)&&o.push(a);for(const a of e.updateFeatures??[])L(a)&&o.push(a)}function L(e){return\"mesh\"===e?.geometry?.type}function k(e,t,r,s){if(!m(t))throw new a(`${e.type}-layer:no-editing-support`,\"Layer source does not support applyEdits capability\",{layer:e});if(!t.uploadAssets)throw new a(`${e.type}-layer:no-asset-upload-support`,\"Layer source does not support uploadAssets capability\",{layer:e});return t.uploadAssets(r,s)}export{F as applyEdits,b as isFeatureIdentifierArrayWithGlobalId,f as isFeatureIdentifierArrayWithObjectId,g as isFeatureIdentifierWithGlobalId,y as isFeatureIdentifierWithObjectId,k as uploadAssets};\n"],"names":["$5722edd8ec620a72$var$_e","$bsvXr","parcelRequire","$5722edd8ec620a72$var$m","e","applyEdits","$5722edd8ec620a72$export$8c8a605b93b39bc9","objectId","$5722edd8ec620a72$export$aee89296b65480fb","every","$5722edd8ec620a72$export$9529e019e18a61a8","globalId","$5722edd8ec620a72$export$db39a4bd0d2c8ef8","async","$5722edd8ec620a72$export$e4d6f33e09e1fc33","t","a","s","i","$81IGt","isEditBusLayer","url","emitApplyEditsEvent","layerId","returnServiceEditsOption","$10vEZ","createResolver","promise","then","addedFeatures","length","updatedFeatures","deletedFeatures","addedAttachments","updatedAttachments","deletedAttachments","emit","t1","result","ref","results","o1","edits","n","r","ref1","ref2","ref3","ref4","ref5","load","$kyj08","default","type","layer","$d1ImW","getEffectiveEditingEnabled","o","options","addFeatures","updateFeatures","deleteFeatures","addAttachments","updateAttachments","deleteAttachments","d","infoFor3D","l","getEffectiveLayerCapabilities","data","isVersioned","gdbVersion","editing","supportsRollbackOnFailure","rollbackOnFailureEnabled","supportsGlobalId","globalIdUsed","u","$jHOLN","getLogger","warn","supportsReturnServiceEditsInSourceSpatialReference","returnServiceEditsInSourceSR","p","$d2yMj","isCollection","toArray","operations","supportsAdd","supportsUpdate","supportsDelete","map","$5722edd8ec620a72$var$j","addAssetFeatures","c","forEach","$5722edd8ec620a72$var$v","$5722edd8ec620a72$var$I","$5722edd8ec620a72$var$E","geometry","supportsGeometryUpdate","$5722edd8ec620a72$var$$","$5722edd8ec620a72$var$S","$5722edd8ec620a72$var$R","$g1GYh","getMimeTypeFormatId","supportedFormats","getFilenameFormatId","editFormats","includes","_addAssetFeatures","_addFeatures","_updateFeatures","a1","$5722edd8ec620a72$var$L","push","a2","$5722edd8ec620a72$var$U","$5722edd8ec620a72$var$O","$5722edd8ec620a72$var$A","addFeatureResults","updateFeatureResults","deleteFeatureResults","addAttachmentResults","updateAttachmentResults","deleteAttachmentResults","$5722edd8ec620a72$var$w","d1","filter","error","$flPLJ","clone","l1","exceededTransferLimit","editedFeatureResults","editedFeatures","resolve","n1","reject","attributes","globalIdField","hasZ","capabilities","supportsZ","hasM","supportsM","vertexSpace","isGeoreferenced","feature","attachment","uploadId","File","name","supportsUploadWithItemId","e1","$kYueh","dataComponents","isBase64","concat","$5On35","normalizeCentralMeridian","slice","$5722edd8ec620a72$export$54085e1fef2ee78e","uploadAssets"],"version":3,"file":"editingSupport.ea119b62.js.map"}