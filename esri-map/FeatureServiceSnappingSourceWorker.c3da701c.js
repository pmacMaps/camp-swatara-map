!function(){function e(e){return e&&e.__esModule?e.default:e}function t(e,t,r,n){Object.defineProperty(e,t,{get:r,set:n,enumerable:!0,configurable:!0})}var r=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire594f;r.register("gJ4iC",(function(n,i){var a;a=n.exports,Object.defineProperty(a,"__esModule",{value:!0,configurable:!0}),t(n.exports,"FeatureServiceSnappingSourceWorker",(function(){return k})),t(n.exports,"default",(function(){return I}));var s=r("8TSCy"),o=r("2TvXO"),u=r("7eJjO"),l=r("amfHf"),c=r("qhgF7"),h=r("7qybv"),f=r("10vEZ"),d=r("5qZXj"),v=r("iho5X");r("lNwWH"),r("2VlWd"),r("iJAIC");var p=r("fcwIv"),y=r("j40xv"),m=r("73BcH"),g=r("f3b5K"),_=r("xQ42o"),x=r("a4yk4"),b=r("cRlei"),T=r("lwg8V"),S=r("di4ub"),C=r("1Zzc4"),k=function(t){"use strict";s.inherits(n,t);var r=s.createSuper(n);function n(){var e;return s.classCallCheck(this,n),(e=r.call.apply(r,[this].concat(Array.prototype.slice.call(arguments)))).isInitializing=!0,e.whenSetup=(0,f.createDeferred)(),e.handles=new(0,c.default),e.updatingHandles=new(0,C.WatchUpdatingTracking),e.pendingApplyEdits=new Map,s.possibleConstructorReturn(e)}return s.createClass(n,[{key:"updating",get:function(){return this.featureFetcher.updating||this.isInitializing||this.updatingHandles.updating}},{key:"destroy",value:function(){this.featureFetcher.destroy(),this.queryEngine.destroy(),this.featureStore.clear(),this.handles.destroy()}},{key:"setup",value:function(t){var r=this;return s.asyncToGenerator(e(o).mark((function n(){var i,a,u,l,c;return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.serviceInfo,a=i.geometryType,u=i.objectIdField,l=i.timeInfo,c=i.fields,e.abrupt("return",(r.featureStore=new(0,m.default)(s.objectSpread({},t.serviceInfo,{hasZ:!1,hasM:!1})),r.queryEngine=new(0,g.default)({spatialReference:t.spatialReference,featureStore:r.featureStore,geometryType:a,fields:c,hasZ:!1,hasM:!1,objectIdField:u,timeInfo:l?x.default.fromJSON(l):null}),r.featureFetcher=new(0,T.FeatureServiceTiledFetcher)({store:new(0,S.FeatureServiceTileStore)({featureStore:r.featureStore}),url:t.serviceInfo.url,objectIdField:t.serviceInfo.objectIdField,globalIdField:t.serviceInfo.globalIdField,capabilities:t.serviceInfo.capabilities,spatialReference:y.default.fromJSON(t.spatialReference),sourceSpatialReference:y.default.fromJSON(t.serviceInfo.spatialReference)}),r.handles.add([r.featureFetcher.watch("availability",(function(e){return r.emit("notify-availability",{availability:e})}),!0),r.watch("updating",(function(){return r._notifyUpdating()}))]),r.whenSetup.resolve(),r.isInitializing=!1,r.configure(t.configuration)));case 2:case"end":return e.stop()}}),n)})))()}},{key:"configure",value:function(t){var r=this;return s.asyncToGenerator(e(o).mark((function n(){return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.updatingHandles.addPromise(r.whenSetup.promise);case 2:return r._updateFeatureFetcherConfiguration(t),e.abrupt("return",(e.sent,{result:{}}));case 4:case"end":return e.stop()}}),n)})))()}},{key:"fetchCandidates",value:function(t,r){var n=this;return s.asyncToGenerator(e(o).mark((function i(){return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.whenSetup.promise;case 2:return(0,f.throwIfAborted)(r),e.next=5,n.queryEngine.executeQueryForSnapping({point:t.point,distance:t.distance,types:t.types,query:(0,h.isSome)(t.filter)?t.filter:{where:"1=1"}},(0,h.isSome)(r)?r.signal:null);case 5:return e.t0=e.sent,e.abrupt("return",{result:e.t0});case 7:case"end":return e.stop()}}),i)})))()}},{key:"updateTiles",value:function(t,r){var n=this;return s.asyncToGenerator(e(o).mark((function i(){return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.updatingHandles.addPromise(n.whenSetup.promise);case 2:return(0,f.throwIfAborted)(r),n.featureFetcher.tileSize=t.tileSize,n.featureFetcher.tilesOfInterest=t.tiles,n.featureFetcher.tileInfo=(0,h.isSome)(t.tileInfo)?_.default.fromJSON(t.tileInfo):null,e.abrupt("return",(e.sent,{result:{}}));case 7:case"end":return e.stop()}}),i)})))()}},{key:"refresh",value:function(t,r){var n=this;return s.asyncToGenerator(e(o).mark((function t(){return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.updatingHandles.addPromise(n.whenSetup.promise);case 2:return(0,f.throwIfAborted)(r),n.featureFetcher.refresh(),e.abrupt("return",(e.sent,{result:{}}));case 5:case"end":return e.stop()}}),t)})))()}},{key:"whenNotUpdating",value:function(t,r){var n=this;return s.asyncToGenerator(e(o).mark((function t(){return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.updatingHandles.addPromise(n.whenSetup.promise);case 2:return(0,f.throwIfAborted)(r),e.next=5,(0,f.whenOrAbort)((0,d.whenNotOnce)(n,"updating"),r);case 5:return e.abrupt("return",(e.sent,e.sent,{result:{}}));case 6:case"end":return e.stop()}}),t)})))()}},{key:"getDebugInfo",value:function(t,r){var n=this;return s.asyncToGenerator(e(o).mark((function t(){return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",((0,f.throwIfAborted)(r),{result:n.featureFetcher.debugInfo}));case 1:case"end":return e.stop()}}),t)})))()}},{key:"beginApplyEdits",value:function(t,r){var n=this;return s.asyncToGenerator(e(o).mark((function i(){var a;return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.updatingHandles.addPromise(n.whenSetup.promise),(0,f.throwIfAborted)(r),a=(0,f.createDeferred)(),e.abrupt("return",(n.pendingApplyEdits.set(t.id,a),n.featureFetcher.applyEdits(a.promise),n.updatingHandles.addPromise(a.promise),{result:{}}));case 3:case"end":return e.stop()}}),i)})))()}},{key:"endApplyEdits",value:function(t,r){var n=this;return s.asyncToGenerator(e(o).mark((function i(){var a;return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.pendingApplyEdits.get(t.id),e.abrupt("return",(a&&a.resolve(t.edits),(0,f.throwIfAborted)(r),{result:{}}));case 2:case"end":return e.stop()}}),i)})))()}},{key:"_updateFeatureFetcherConfiguration",value:function(e){this.featureFetcher.filter=(0,h.isSome)(e.filter)?b.default.fromJSON(e.filter):null,this.featureFetcher.customParameters=e.customParameters}},{key:"_notifyUpdating",value:function(){this.emit("notify-updating",{updating:this.updating})}}]),n}(l.default.EventedAccessor);function I(){return new k}(0,u._)([(0,v.property)({readOnly:!0})],k.prototype,"updating",null),(0,u._)([(0,v.property)()],k.prototype,"isInitializing",void 0),k=(0,u._)([(0,p.subclass)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceSnappingSourceWorker")],k)})),r.register("73BcH",(function(e,n){t(e.exports,"default",(function(){return v}));var i=r("8TSCy"),a=r("kyj08"),s=r("amfHf"),o=r("jHOLN"),u=r("7qybv"),l=r("ayLat"),c=r("8TwEW"),h=r("akQYU"),f=r("1ZPLr"),d=r("1zB3R"),v=function(){"use strict";function e(t){i.classCallCheck(this,e),this.geometryInfo=t,this._boundsStore=new(0,f.BoundsStore),this._featuresById=new Map,this._markedIds=new Set,this.events=new(0,s.default),this.featureAdapter=d.optimizedFeatureQueryEngineAdapter}return i.createClass(e,[{key:"geometryType",get:function(){return this.geometryInfo.geometryType}},{key:"hasM",get:function(){return this.geometryInfo.hasM}},{key:"hasZ",get:function(){return this.geometryInfo.hasZ}},{key:"numFeatures",get:function(){return this._featuresById.size}},{key:"fullBounds",get:function(){var e=this;if(!this.numFeatures)return null;var t=(0,c.create)(c.NEGATIVE_INFINITY);return this._featuresById.forEach((function(r){var n=e._boundsStore.get(r.objectId);n&&(t[0]=Math.min(n[0],t[0]),t[1]=Math.min(n[1],t[1]),t[2]=Math.max(n[2],t[2]),t[3]=Math.max(n[3],t[3]))})),t}},{key:"storeStatistics",get:function(){var e=0;return this._featuresById.forEach((function(t){(0,u.isSome)(t.geometry)&&t.geometry.coords&&(e+=t.geometry.coords.length)})),{featureCount:this._featuresById.size,vertexCount:e/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}},{key:"add",value:function(e){this._add(e),this._emitChanged()}},{key:"addMany",value:function(e){var t=!0,r=!1,n=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value;this._add(s)}}catch(e){r=!0,n=e}finally{try{t||null==a.return||a.return()}finally{if(r)throw n}}this._emitChanged()}},{key:"clear",value:function(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged()}},{key:"removeById",value:function(e){var t=this._featuresById.get(e);return t?(this._remove(t),this._emitChanged(),t):null}},{key:"removeManyById",value:function(e){this._boundsStore.invalidateIndex();var t=!0,r=!1,n=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value,o=this._featuresById.get(s);o&&this._remove(o)}}catch(e){r=!0,n=e}finally{try{t||null==a.return||a.return()}finally{if(r)throw n}}this._emitChanged()}},{key:"forEachBounds",value:function(e,t,r){var n=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var u=s.value,c=this._boundsStore.get(u.objectId);c&&t((0,l.fromRect)(r,c))}}catch(e){i=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(i)throw a}}}},{key:"getFeature",value:function(e){return this._featuresById.get(e)}},{key:"has",value:function(e){return this._featuresById.has(e)}},{key:"forEach",value:function(e){this._featuresById.forEach((function(t){return e(t)}))}},{key:"forEachInBounds",value:function(e,t){var r=this;this._boundsStore.forEachInBounds(e,(function(e){t(r._featuresById.get(e))}))}},{key:"startMarkingUsedFeatures",value:function(){this._boundsStore.invalidateIndex(),this._markedIds.clear()}},{key:"sweep",value:function(){var e=this,t=!1;this._featuresById.forEach((function(r,n){e._markedIds.has(n)||(t=!0,e._remove(r))})),this._markedIds.clear(),t&&this._emitChanged()}},{key:"_emitChanged",value:function(){this.events.emit("changed",void 0)}},{key:"_add",value:function(e){if(e){var t=e.objectId;if(null!=t){var r,n=this._featuresById.get(t);if(this._markedIds.add(t),n?(e.displayId=n.displayId,r=this._boundsStore.get(t),this._boundsStore.delete(t)):(0,u.isSome)(this.onFeatureAdd)&&this.onFeatureAdd(e),(0,u.isNone)(e.geometry)||!e.geometry.coords||!e.geometry.coords.length)return this._boundsStore.set(t,null),void this._featuresById.set(t,e);r=(0,h.getBoundsOptimizedGeometry)((0,u.isSome)(r)?r:(0,c.create)(),e.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),(0,u.isSome)(r)&&this._boundsStore.set(t,r),this._featuresById.set(t,e)}else o.default.getLogger("esri.layers.graphics.data.FeatureStore").error(new(0,a.default)("featurestore:invalid-feature","feature id is missing",{feature:e}))}}},{key:"_remove",value:function(e){return(0,u.isSome)(this.onFeatureRemove)&&this.onFeatureRemove(e),this._markedIds.delete(e.objectId),this._boundsStore.delete(e.objectId),this._featuresById.delete(e.objectId),e}}]),e}()})),r.register("1ZPLr",(function(e,n){t(e.exports,"BoundsStore",(function(){return u}));var i=r("8TSCy"),a=r("2VlWd"),s=r("bWAZj"),o={minX:0,minY:0,maxX:0,maxY:0};var u=function(){"use strict";function e(){var t=this;i.classCallCheck(this,e),this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new(0,s.PooledRBush)(9,(0,a.default)("esri-csp-restrictions")?function(e){return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}}:["[0]","[1]","[2]","[3]"]),this._loadIndex=function(){var e=t;if(t._indexInvalid){var r=new Array(t._idByBounds.size),n=0;t._idByBounds.forEach((function(e,t){r[n++]=t})),t._indexInvalid=!1,t._index.clear(),t._index.load(r)}else t._boundsToLoad.length&&(t._index.load(t._boundsToLoad.filter((function(t){return e._idByBounds.has(t)}))),t._boundsToLoad.length=0)}}return i.createClass(e,[{key:"clear",value:function(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}},{key:"delete",value:function(e){var t=this._boundsById.get(e);this._boundsById.delete(e),t&&(this._idByBounds.delete(t),this._indexInvalid||this._index.remove(t))}},{key:"forEachInBounds",value:function(e,t){var r,n,i,a=this;this._loadIndex(),r=this._index,n=e,i=function(e){return t(a._idByBounds.get(e))},o.minX=n[0],o.minY=n[1],o.maxX=n[2],o.maxY=n[3],r.search(o,i)}},{key:"get",value:function(e){return this._boundsById.get(e)}},{key:"has",value:function(e){return this._boundsById.has(e)}},{key:"invalidateIndex",value:function(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}},{key:"set",value:function(e,t){if(!this._indexInvalid){var r=this._boundsById.get(e);r&&(this._index.remove(r),this._idByBounds.delete(r))}this._boundsById.set(e,t),t&&(this._idByBounds.set(t,e),this._indexInvalid||(this._boundsToLoad.push(t),this._boundsToLoad.length>5e4&&this._loadIndex()))}}]),e}()})),r.register("bWAZj",(function(e,n){t(e.exports,"PooledRBush",(function(){return l}));var i=r("8TSCy"),a=r("lNwWH"),s=r("7qybv"),o=r("6v7Z0"),u=r("fcGl2"),l=function(){"use strict";function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:9,r=arguments.length>1?arguments[1]:void 0;i.classCallCheck(this,e),this.compareMinX=d,this.compareMinY=v,this._toBBox=function(e){return e},this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),r&&("function"==typeof r?this._toBBox=r:this._initFormat(r)),this.clear()}return i.createClass(e,[{key:"destroy",value:function(){this.clear(),b.prune(),T.prune(),S.prune(),C.prune()}},{key:"all",value:function(e){this._all(this.data,e)}},{key:"search",value:function(e,t){var r=this.data,n=this._toBBox;if(_(e,r))for(b.clear();r;){for(var i=0,a=r.children.length;i<a;i++){var s=r.children[i],o=r.leaf?n(s):s;_(e,o)&&(r.leaf?t(s):g(e,o)?this._all(s,t):b.push(s))}r=b.pop()}}},{key:"collides",value:function(e){var t=this.data,r=this._toBBox;if(!_(e,t))return!1;for(b.clear();t;){for(var n=0,i=t.children.length;n<i;n++){var a=t.children[n],s=t.leaf?r(a):a;if(_(e,s)){if(t.leaf||g(e,s))return!0;b.push(a)}}t=b.pop()}return!1}},{key:"load",value:function(e){if(!e.length)return this;if(e.length<this._minEntries){for(var t=0,r=e.length;t<r;t++)this.insert(e[t]);return this}var n=this._build(e.slice(0,e.length),0,e.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var i=this.data;this.data=n,n=i}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this}},{key:"insert",value:function(e){return e&&this._insert(e,this.data.height-1),this}},{key:"clear",value:function(){return this.data=new I([]),this}},{key:"remove",value:function(e){if(!e)return this;var t,r=this.data,n=null,i=0,o=!1,u=this._toBBox(e);for(S.clear(),C.clear();r||S.length>0;){var l;if(r||(r=(0,s.assumeNonNull)(S.pop()),n=S.data[S.length-1],i=null!=(l=C.pop())?l:0,o=!0),r.leaf&&-1!==(t=(0,a.indexOf)(r.children,e,r.children.length,r.indexHint)))return r.children.splice(t,1),S.push(r),this._condense(S),this;o||r.leaf||!g(r,u)?n?(i++,r=n.children[i],o=!1):r=null:(S.push(r),C.push(i),i=0,n=r,r=r.children[0])}return this}},{key:"toJSON",value:function(){return this.data}},{key:"fromJSON",value:function(e){return this.data=e,this}},{key:"_all",value:function(e,t){var r=e;for(T.clear();r;){var n,i=!0,a=!1,s=void 0;if(!0===r.leaf)try{for(var o,u=r.children[Symbol.iterator]();!(i=(o=u.next()).done);i=!0){t(o.value)}}catch(e){a=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw s}}else T.pushArray(r.children);r=null!=(n=T.pop())?n:null}}},{key:"_build",value:function(e,t,r,n){var i=r-t+1,a=this._maxEntries;if(i<=a){var s=new I(e.slice(t,r+1));return c(s,this._toBBox),s}n||(n=Math.ceil(Math.log(i)/Math.log(a)),a=Math.ceil(i/Math.pow(a,n-1)));var o=new F([]);o.height=n;var u=Math.ceil(i/a),l=u*Math.ceil(Math.sqrt(a));x(e,t,r,l,this.compareMinX);for(var h=t;h<=r;h+=l){var f=Math.min(h+l-1,r);x(e,h,f,u,this.compareMinY);for(var d=h;d<=f;d+=u){var v=Math.min(d+u-1,f);o.children.push(this._build(e,d,v,n-1))}}return c(o,this._toBBox),o}},{key:"_chooseSubtree",value:function(e,t,r,n){for(;n.push(t),!0!==t.leaf&&n.length-1!==r;){for(var i=void 0,a=1/0,s=1/0,o=0,u=t.children.length;o<u;o++){var l=t.children[o],c=p(l),h=(f=e,d=l,(Math.max(d.maxX,f.maxX)-Math.min(d.minX,f.minX))*(Math.max(d.maxY,f.maxY)-Math.min(d.minY,f.minY))-c);h<s?(s=h,a=c<a?c:a,i=l):h===s&&c<a&&(a=c,i=l)}t=i||t.children[0]}var f,d;return t}},{key:"_insert",value:function(e,t,r){var n=this._toBBox,i=r?e:n(e);S.clear();var a=this._chooseSubtree(i,this.data,t,S);for(a.children.push(e),f(a,i);t>=0&&S.data[t].children.length>this._maxEntries;)this._split(S,t),t--;this._adjustParentBBoxes(i,S,t)}},{key:"_split",value:function(e,t){var r=e.data[t],n=r.children.length,i=this._minEntries;this._chooseSplitAxis(r,i,n);var a=this._chooseSplitIndex(r,i,n);if(a){var s=r.children.splice(a,r.children.length-a),o=r.leaf?new I(s):new F(s);o.height=r.height,c(r,this._toBBox),c(o,this._toBBox),t?e.data[t-1].children.push(o):this._splitRoot(r,o)}else console.log("  Error: assertion failed at PooledRBush._split: no valid split index")}},{key:"_splitRoot",value:function(e,t){this.data=new F([e,t]),this.data.height=e.height+1,c(this.data,this._toBBox)}},{key:"_chooseSplitIndex",value:function(e,t,r){var n,i,a;n=i=1/0;for(var s=t;s<=r-t;s++){var o=h(e,0,s,this._toBBox),u=h(e,s,r,this._toBBox),l=m(o,u),c=p(o)+p(u);l<n?(n=l,a=s,i=c<i?c:i):l===n&&c<i&&(i=c,a=s)}return a}},{key:"_chooseSplitAxis",value:function(e,t,r){var n=e.leaf?this.compareMinX:d,i=e.leaf?this.compareMinY:v;this._allDistMargin(e,t,r,n)<this._allDistMargin(e,t,r,i)&&e.children.sort(n)}},{key:"_allDistMargin",value:function(e,t,r,n){e.children.sort(n);for(var i=this._toBBox,a=h(e,0,t,i),s=h(e,r-t,r,i),o=y(a)+y(s),u=t;u<r-t;u++){var l=e.children[u];f(a,e.leaf?i(l):l),o+=y(a)}for(var c=r-t-1;c>=t;c--){var d=e.children[c];f(s,e.leaf?i(d):d),o+=y(s)}return o}},{key:"_adjustParentBBoxes",value:function(e,t,r){for(var n=r;n>=0;n--)f(t.data[n],e)}},{key:"_condense",value:function(e){for(var t=e.length-1;t>=0;t--){var r=e.data[t];if(0===r.children.length)if(t>0){var n=e.data[t-1],i=n.children;i.splice((0,a.indexOf)(i,r,i.length,n.indexHint),1)}else this.clear();else c(r,this._toBBox)}}},{key:"_initFormat",value:function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0])),this.compareMinY=new Function("a","b",t.join(e[1])),this._toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}}]),e}();function c(e,t){h(e,0,e.children.length,t,e)}function h(e,t,r,n,i){i||(i=new I([])),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var a,s=t;s<r;s++)a=e.children[s],f(i,e.leaf?n(a):a);return i}function f(e,t){e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY)}function d(e,t){return e.minX-t.minX}function v(e,t){return e.minY-t.minY}function p(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function y(e){return e.maxX-e.minX+(e.maxY-e.minY)}function m(e,t){var r=Math.max(e.minX,t.minX),n=Math.max(e.minY,t.minY),i=Math.min(e.maxX,t.maxX),a=Math.min(e.maxY,t.maxY);return Math.max(0,i-r)*Math.max(0,a-n)}function g(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function _(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function x(e,t,r,n,i){for(var a=[t,r];a.length;){var o=(0,s.assumeNonNull)(a.pop()),l=(0,s.assumeNonNull)(a.pop());if(!(o-l<=n)){var c=l+Math.ceil((o-l)/n/2)*n;(0,u.q)(e,c,l,o,i),a.push(l,c,c,o)}}}var b=new(0,o.default),T=new(0,o.default),S=new(0,o.default),C=new(0,o.default)({deallocator:void 0}),k=function(e){"use strict";i.inherits(r,e);var t=i.createSuper(r);function r(){var e;return i.classCallCheck(this,r),(e=t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments)))).height=1,e.indexHint=new(0,a.PositionHint),i.possibleConstructorReturn(e)}return r}((function e(){"use strict";i.classCallCheck(this,e),this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0})),I=function(e){"use strict";i.inherits(r,e);var t=i.createSuper(r);function r(e){var n;return i.classCallCheck(this,r),(n=t.call(this)).children=e,n.leaf=!0,i.possibleConstructorReturn(n)}return r}(k),F=function(e){"use strict";i.inherits(r,e);var t=i.createSuper(r);function r(e){var n;return i.classCallCheck(this,r),(n=t.call(this)).children=e,n.leaf=!1,i.possibleConstructorReturn(n)}return r}(k)})),r.register("1zB3R",(function(e,n){t(e.exports,"optimizedFeatureQueryEngineAdapter",(function(){return u}));var i=r("7qybv"),a=r("8mTF7"),s=r("ft2bT"),o=r("awxBI"),u={getObjectId:function(e){return e.objectId},getAttributes:function(e){return e.attributes},getAttribute:function(e,t){return e.attributes[t]},cloneWithGeometry:function(e,t){return new(0,s.OptimizedFeature)(t,e.attributes,null,e.objectId)},getGeometry:function(e){return e.geometry},getCentroid:function(e,t){return(0,i.isNone)(e.centroid)&&(e.centroid=(0,a.getCentroidOptimizedGeometry)(new(0,o.default),e.geometry,t.hasZ,t.hasM)),e.centroid}}})),r.register("8mTF7",(function(e,n){t(e.exports,"getCentroidOptimizedGeometry",(function(){return s}));var i=r("7qybv");function a(e,t){return e?t?4:3:t?3:2}function s(e,t,r,n,s){if((0,i.isNone)(t)||!t.lengths.length)return null;var f="upperLeft"===(null==s?void 0:s.originPosition)?-1:1;e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0);var d=e.coords,v=[],p=r?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],y=t.lengths,m=t.coords,g=a(r,n),_=0,x=!0,b=!1,T=void 0;try{for(var S,C=y[Symbol.iterator]();!(x=(S=C.next()).done);x=!0){var k=S.value,I=o(p,m,_,k,r,n,f);I&&v.push(I),_+=k*g}}catch(e){b=!0,T=e}finally{try{x||null==C.return||C.return()}finally{if(b)throw T}}if(v.sort((function(e,t){var n=f*e[2]-f*t[2];return 0===n&&r&&(n=e[4]-t[4]),n})),v.length){var F=6*v[0][2];d[0]=v[0][0]/F,d[1]=v[0][1]/F,r&&(F=6*v[0][4],d[2]=0!==F?v[0][3]/F:0),(d[0]<p[0]||d[0]>p[1]||d[1]<p[2]||d[1]>p[3]||r&&(d[2]<p[4]||d[2]>p[5]))&&(d.length=0)}if(!d.length){var w=t.lengths[0]?function(e,t,r,n,i){for(var s=a(n,i),o=t,f=t+s,d=0,v=0,p=0,y=0,m=0,g=r-1;m<g;m++,o+=s,f+=s){var _=e[o],x=e[o+1],b=e[o+2],T=e[f],S=e[f+1],C=e[f+2],k=n?l(_,x,b,T,S,C):u(_,x,T,S);if(k)if(d+=k,n){var I=h(_,x,b,T,S,C);v+=k*I[0],p+=k*I[1],y+=k*I[2]}else{var F=c(_,x,T,S);v+=k*F[0],p+=k*F[1]}}return d>0?n?[v/d,p/d,y/d]:[v/d,p/d]:r>0?n?[e[t],e[t+1],e[t+2]]:[e[t],e[t+1]]:null}(m,0,y[0],r,n):null;if(!w)return null;d[0]=w[0],d[1]=w[1],r&&w.length>2&&(d[2]=w[2])}return e}function o(e,t,r,n,i,s){for(var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,u=a(i,s),l=r,c=r+u,h=0,f=0,d=0,v=0,p=0,y=0,m=n-1;y<m;y++,l+=u,c+=u){var g=t[l],_=t[l+1],x=t[l+2],b=t[c],T=t[c+1],S=t[c+2],C=g*T-b*_;v+=C,h+=(g+b)*C,f+=(_+T)*C,i&&(d+=(x+S)*(C=g*S-b*x),p+=C),g<e[0]&&(e[0]=g),g>e[1]&&(e[1]=g),_<e[2]&&(e[2]=_),_>e[3]&&(e[3]=_),i&&(x<e[4]&&(e[4]=x),x>e[5]&&(e[5]=x))}if(v*o>0&&(v*=-1),p*o>0&&(p*=-1),!v)return null;var k=[h,f,.5*v];return i&&(k[3]=d,k[4]=.5*p),k}function u(e,t,r,n){var i=r-e,a=n-t;return Math.sqrt(i*i+a*a)}function l(e,t,r,n,i,a){var s=n-e,o=i-t,u=a-r;return Math.sqrt(s*s+o*o+u*u)}function c(e,t,r,n){return[e+.5*(r-e),t+.5*(n-t)]}function h(e,t,r,n,i,a){return[e+.5*(n-e),t+.5*(i-t),r+.5*(a-r)]}})),r.register("lwg8V",(function(n,i){t(n.exports,"FeatureServiceTiledFetcher",(function(){return I}));var a=r("8TSCy"),s=r("2TvXO"),o=r("7eJjO"),u=r("lNwWH"),l=r("4AKWB"),c=r("6dXDO"),h=r("6ah52"),f=r("jHOLN"),d=r("7qybv"),v=r("10vEZ"),p=r("lKPaD"),y=r("iho5X");r("2VlWd"),r("iJAIC");var m=r("fcwIv"),g=r("gINRd"),_=r("8TwEW"),x=r("akQYU"),b=r("7zyiu"),T=r("j6c7r"),S=r("cRlei"),C=r("aa0IA"),k=f.default.getLogger("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTiledFetcher"),I=function(t){"use strict";a.inherits(n,t);var r=a.createSuper(n);function n(e){var t;return a.classCallCheck(this,n),(t=r.call(this,e)).tilesOfInterest=[],t.availability=0,t.pendingTiles=new Map,t.pendingEdits=new(0,l.AsyncSequence),t.pendingEditsAbortController=new AbortController,a.possibleConstructorReturn(t)}return a.createClass(n,[{key:"minimumVerticesPerFeature",get:function(){var e;switch(null==(e=this.store)?void 0:e.featureStore.geometryType){case"esriGeometryPoint":case"esriGeometryMultipoint":return 1;case"esriGeometryPolygon":return 4;case"esriGeometryPolyline":return 2}}},{key:"filter",set:function(e){var t=this._get("filter"),r=this._filterProperties(e);JSON.stringify(t)!==JSON.stringify(r)&&this._set("filter",r)}},{key:"customParameters",set:function(e){var t=this._get("customParameters");JSON.stringify(t)!==JSON.stringify(e)&&this._set("customParameters",e)}},{key:"configuration",get:function(){return{filter:this.filter,customParameters:this.customParameters,tileInfo:this.tileInfo,tileSize:this.tileSize}}},{key:"tileInfo",set:function(e){var t=this._get("tileInfo");t!==e&&((0,d.isSome)(e)&&(0,d.isSome)(t)&&JSON.stringify(e)===JSON.stringify(t)||(this._set("tileInfo",e),this.store.tileInfo=e))}},{key:"tileSize",set:function(e){this._get("tileSize")!==e&&this._set("tileSize",e)}},{key:"updating",get:function(){return this.updatingHandles.updating||this.pendingEdits.updating}},{key:"initialize",value:function(){var e=this;this._initializeFetchExtent(),this.updatingHandles.add((function(){return e.configuration}),(function(){return e.refresh()})),this.updatingHandles.add((function(){return e.tilesOfInterest}),(function(t,r){(0,u.equals)(t,r,(function(e,t){return e.id===t.id}))||e._process()}),p.sync)}},{key:"destroy",value:function(){var e=this;this.pendingTiles.forEach((function(t){return e._deletePendingTile(t)})),this.pendingTiles.clear(),this.store.destroy(),this.tilesOfInterest.length=0,this.pendingEditsAbortController.abort(),this.pendingEditsAbortController=null}},{key:"refresh",value:function(){var e=this;this.store.refresh(),this.pendingTiles.forEach((function(t){return e._deletePendingTile(t)})),this._process()}},{key:"applyEdits",value:function(t){var r,n=this;this.pendingEdits.push(t,(r=a.asyncToGenerator(e(s).mark((function t(r){var i,o,u,l,c,h;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==r.addedFeatures.length||0!==r.updatedFeatures.length||0!==r.deletedFeatures.length){e.next=2;break}return e.abrupt("return");case 2:for(i=!0,o=!1,u=void 0,e.prev=3,l=n.pendingTiles[Symbol.iterator]();!(i=(c=l.next()).done);i=!0)a.slicedToArray(c.value,2)[1].reset();e.next=11;break;case 7:e.prev=7,e.t0=e.catch(3),o=!0,u=e.t0;case 11:e.prev=11,e.prev=12,i||null==l.return||l.return();case 14:if(e.prev=14,!o){e.next=17;break}throw u;case 17:return e.finish(14);case 18:return e.finish(11);case 19:return h=a.objectSpread({},r,{deletedFeatures:r.deletedFeatures.map((function(e){var t=e.objectId,r=e.globalId;return t&&-1!==t?t:n._lookupObjectIdByGlobalId(r)}))}),e.next=22,n.updatingHandles.addPromise(n.store.processEdits(h,(function(e,t){return n._queryFeaturesById(e,t)}),n.pendingEditsAbortController.signal));case 22:n._processPendingTiles();case 23:case"end":return e.stop()}}),t,null,[[3,7,11,19],[12,,14,18]])}))),function(e){return r.apply(this,arguments)}))}},{key:"_initializeFetchExtent",value:function(){var t=this;if(this.capabilities.query.supportsExtent){var r,n=this,i=(0,v.createTask)((r=a.asyncToGenerator(e(s).mark((function t(r){var i,a;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=4,(0,T.executeQueryForExtent)(n.url,new(0,S.default)({where:"1=1",outSpatialReference:n.spatialReference,cacheHint:!!n.capabilities.query.supportsCacheHint||void 0}),{query:n.configuration.customParameters,signal:r});case 4:a=e.sent,n.store.extent=g.default.fromJSON(null==(i=a.data)?void 0:i.extent),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),(0,v.throwIfAbortError)(e.t0),k.warn("Failed to fetch data extent",e.t0);case 11:case"end":return e.stop()}}),t,null,[[0,8]])}))),function(e){return r.apply(this,arguments)}));this.updatingHandles.addPromise(i.promise.then((function(){return t._process()}))),this.handles.add((0,h.makeHandle)((function(){return i.abort()})))}}},{key:"debugInfo",get:function(){return{numberOfFeatures:this.store.featureStore.numFeatures,tilesOfInterest:this.tilesOfInterest,pendingTiles:Array.from(this.pendingTiles.values()).map((function(e){return e.debugInfo})),storedTiles:this.store.debugInfo}}},{key:"_process",value:function(){this._markTilesNotAlive(),this._createPendingTiles(),this._deletePendingTiles(),this._processPendingTiles()}},{key:"_markTilesNotAlive",value:function(){var e=!0,t=!1,r=void 0;try{for(var n,i=this.pendingTiles[Symbol.iterator]();!(e=(n=i.next()).done);e=!0){a.slicedToArray(n.value,2)[1].alive=!1}}catch(e){t=!0,r=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw r}}}},{key:"_createPendingTiles",value:function(){var e=this._collectMissingTilesInfo(),t=!0,r=!1,n=void 0;if(this._setAvailability((0,d.isNone)(e)?1:e.coveredArea/e.fullArea),!(0,d.isNone)(e))try{for(var i,a=e.missingTiles[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value,o=s.data,u=s.resolution,l=this.pendingTiles.get(o.id);l?(l.resolution=u,l.alive=!0):this._createPendingTile(o,u)}}catch(e){r=!0,n=e}finally{try{t||null==a.return||a.return()}finally{if(r)throw n}}}},{key:"_collectMissingTilesInfo",value:function(){for(var e=null,t=this.tilesOfInterest.length-1;t>=0;t--){var r=this,n=this.tilesOfInterest[t],i=this.store.process(n,(function(e,t){return r._verifyTileComplexity(e,t)}));(0,d.isNone)(e)?e=i:e.prepend(i)}return e}},{key:"_deletePendingTiles",value:function(){var e=!0,t=!1,r=void 0;try{for(var n,i=this.pendingTiles[Symbol.iterator]();!(e=(n=i.next()).done);e=!0){var s=a.slicedToArray(n.value,2)[1];s.alive||this._deletePendingTile(s)}}catch(e){t=!0,r=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw r}}}},{key:"_processPendingTiles",value:function(){var e=this,t={fetchCount:function(t,r){return e._fetchCount(t,r)},fetchFeatures:function(t,r,n){return e._fetchFeatures(t,r,n)},finish:function(t,r){return e._finishPendingTile(t,r)},resume:function(){return e._processPendingTiles()}},r=!0,n=!1,i=void 0;if(this._ensureFetchAllCounts(t))try{for(var s,o=this.pendingTiles[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=a.slicedToArray(s.value,2)[1];this._verifyTileComplexity(this.store.getFeatureCount(u.data),u.resolution)&&this.updatingHandles.addPromise(u.process(t))}}catch(e){n=!0,i=e}finally{try{r||null==o.return||o.return()}finally{if(n)throw i}}}},{key:"_verifyTileComplexity",value:function(e,t){return this._verifyVertexComplexity(e)&&this._verifyFeatureDensity(e,t)}},{key:"_verifyVertexComplexity",value:function(e){return e*this.minimumVerticesPerFeature<E}},{key:"_verifyFeatureDensity",value:function(e,t){if((0,d.isNone)(this.tileInfo))return!1;var r=this.tileSize*t;return e*(M/(r*r))<N}},{key:"_ensureFetchAllCounts",value:function(e){var t=!0,r=!0,n=!1,i=void 0;try{for(var s,o=this.pendingTiles[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=a.slicedToArray(s.value,2)[1];u.state.type<C.StateType.FETCHED_COUNT&&this.updatingHandles.addPromise(u.process(e)),u.state.type<=C.StateType.FETCH_COUNT&&(t=!1)}}catch(e){n=!0,i=e}finally{try{r||null==o.return||o.return()}finally{if(n)throw i}}return t}},{key:"_finishPendingTile",value:function(e,t){this.store.add(e.data,t),this._deletePendingTile(e),this._updateAvailability()}},{key:"_updateAvailability",value:function(){var e=this._collectMissingTilesInfo();this._setAvailability((0,d.isNone)(e)?1:e.coveredArea/e.fullArea)}},{key:"_setAvailability",value:function(e){this._set("availability",e)}},{key:"_createPendingTile",value:function(e,t){var r=new(0,C.PendingFeatureTile)(e,t);return this.pendingTiles.set(e.id,r),r}},{key:"_deletePendingTile",value:function(e){e.reset(),this.pendingTiles.delete(e.data.id)}},{key:"_fetchCount",value:function(t,r){var n=this;return a.asyncToGenerator(e(s).mark((function i(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.store.fetchCount(t.data,n.url,n._createCountQuery(t),{query:n.customParameters,timeout:w,signal:r}));case 1:case"end":return e.stop()}}),i)})))()}},{key:"_fetchFeatures",value:function(t,r,n){var i=this;return a.asyncToGenerator(e(s).mark((function a(){var o,u,l,c,h,f,v,p,y;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u=0,l=0,c=r;case 1:return h=i._createFeaturesQuery(t),f=i._setPagingParameters(h,u,c),e.next=5,i._queryFeatures(h,n);case 5:if(v=e.sent,p=v.features,y=v.exceededTransferLimit,f&&(u+=(0,d.unwrap)(h.num)),l+=p.length,o=o?o.concat(p):p,c=r-l,f&&y&&!(c<=0)){e.next=10;break}return e.abrupt("return",o);case 10:e.next=1;break;case 12:case"end":return e.stop()}}),a)})))()}},{key:"_filterProperties",value:function(e){return(0,d.isNone)(e)?{where:"1=1",gdbVersion:void 0,timeExtent:void 0}:{where:e.where||"1=1",timeExtent:e.timeExtent,gdbVersion:e.gdbVersion}}},{key:"_lookupObjectIdByGlobalId",value:function(e){var t=this.globalIdField,r=this.objectIdField;if((0,d.isNone)(t))throw new Error("Expected globalIdField to be defined");var n=null;if(this.store.featureStore.forEach((function(i){var a;e===i.attributes[t]&&(n=null!=(a=i.objectId)?a:i.attributes[r])})),(0,d.isNone)(n))throw new Error("Expected to find a feature with globalId ".concat(e));return n}},{key:"_queryFeaturesById",value:function(e,t){var r=this._createFeaturesQuery(null);return r.objectIds=e,this._queryFeatures(r,t)}},{key:"_queryFeatures",value:function(e,t){return this.capabilities.query.supportsFormatPBF?this._queryFeaturesPBF(e,t):this._queryFeaturesJSON(e,t)}},{key:"_queryFeaturesPBF",value:function(t,r){var n=this;return a.asyncToGenerator(e(s).mark((function i(){var a,o,u;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.sourceSpatialReference,e.next=3,(0,T.executeQueryPBF)(n.url,t,new(0,b.OptimizedFeatureSetParserContext)({sourceSpatialReference:a}),{query:n.configuration.customParameters,timeout:w,signal:r});case 3:return o=e.sent,u=o.data,e.abrupt("return",(0,x.unquantizeOptimizedFeatureSet)(u));case 6:case"end":return e.stop()}}),i)})))()}},{key:"_queryFeaturesJSON",value:function(t,r){var n=this;return a.asyncToGenerator(e(s).mark((function i(){var a,o,u;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.sourceSpatialReference,e.next=3,(0,T.executeQuery)(n.url,t,a,{query:n.configuration.customParameters,timeout:w,signal:r});case 3:return o=e.sent,u=o.data,e.abrupt("return",(0,x.convertFromFeatureSet)(u,n.objectIdField));case 6:case"end":return e.stop()}}),i)})))()}},{key:"_createCountQuery",value:function(e){var t=this._createBaseQuery(e);return this.capabilities.query.supportsCacheHint&&(t.cacheHint=!0),t}},{key:"_createFeaturesQuery",value:function(e){var t=this._createBaseQuery(e);return t.outFields=this.globalIdField?[this.globalIdField,this.objectIdField]:[this.objectIdField],t.returnGeometry=!0,(0,d.isSome)(e)&&(this.capabilities.query.supportsResultType?t.resultType="tile":this.capabilities.query.supportsCacheHint&&(t.cacheHint=!0)),t}},{key:"_createBaseQuery",value:function(e){var t=new(0,S.default)({returnZ:!1,returnM:!1,geometry:(0,d.isSome)(this.tileInfo)&&(0,d.isSome)(e)?(0,_.toExtent)(e.data.extent,this.tileInfo.spatialReference):void 0}),r=this.configuration.filter;return(0,d.isSome)(r)&&(t.where=r.where,t.gdbVersion=r.gdbVersion,t.timeExtent=r.timeExtent),t.outSpatialReference=this.spatialReference,t}},{key:"_setPagingParameters",value:function(e,t,r){if(!this.capabilities.query.supportsPagination)return!1;var n=this.capabilities.query,i=n.supportsMaxRecordCountFactor,a=n.supportsCacheHint,s=n.tileMaxRecordCount,o=n.maxRecordCount,u=n.supportsResultType,l=i?S.default.MAX_MAX_RECORD_COUNT_FACTOR:1,c=l*((u||a)&&s?s:o||F);return e.start=t,i?(e.maxRecordCountFactor=Math.min(l,Math.ceil(r/c)),e.num=Math.min(r,e.maxRecordCountFactor*c)):e.num=Math.min(r,c),!0}}]),n}(c.HandleOwner);(0,o._)([(0,y.property)({constructOnly:!0})],I.prototype,"url",void 0),(0,o._)([(0,y.property)({constructOnly:!0})],I.prototype,"objectIdField",void 0),(0,o._)([(0,y.property)({constructOnly:!0})],I.prototype,"globalIdField",void 0),(0,o._)([(0,y.property)({constructOnly:!0})],I.prototype,"capabilities",void 0),(0,o._)([(0,y.property)({constructOnly:!0})],I.prototype,"sourceSpatialReference",void 0),(0,o._)([(0,y.property)({constructOnly:!0})],I.prototype,"spatialReference",void 0),(0,o._)([(0,y.property)({constructOnly:!0})],I.prototype,"store",void 0),(0,o._)([(0,y.property)({readOnly:!0})],I.prototype,"minimumVerticesPerFeature",null),(0,o._)([(0,y.property)()],I.prototype,"filter",null),(0,o._)([(0,y.property)()],I.prototype,"customParameters",null),(0,o._)([(0,y.property)({readOnly:!0})],I.prototype,"configuration",null),(0,o._)([(0,y.property)()],I.prototype,"tileInfo",null),(0,o._)([(0,y.property)()],I.prototype,"tileSize",null),(0,o._)([(0,y.property)()],I.prototype,"tilesOfInterest",void 0),(0,o._)([(0,y.property)({readOnly:!0})],I.prototype,"updating",null),(0,o._)([(0,y.property)({readOnly:!0})],I.prototype,"availability",void 0),I=(0,o._)([(0,m.subclass)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTiledFetcher")],I);var F=2e3,w=6e5,E=1e6,M=25,N=1})),r.register("4AKWB",(function(e,n){t(e.exports,"AsyncSequence",(function(){return l}));var i=r("8TSCy"),a=r("7eJjO"),s=r("jymfC"),o=r("iho5X"),u=r("fcwIv"),l=function(e){"use strict";i.inherits(r,e);var t=i.createSuper(r);function r(){var e;return i.classCallCheck(this,r),(e=t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments)))).updating=!1,e.pending=[],i.possibleConstructorReturn(e)}return i.createClass(r,[{key:"push",value:function(e,t){this.pending.push({promise:e,callback:t}),1===this.pending.length&&this._process()}},{key:"_process",value:function(){var e=this;if(this.pending.length){this.updating=!0;var t=this.pending[0];t.promise.then((function(e){return t.callback(e)})).catch((function(){})).then((function(){e.pending.shift(),e._process()}))}else this.updating=!1}}]),r}(s.default);(0,a._)([(0,o.property)()],l.prototype,"updating",void 0),l=(0,a._)([(0,u.subclass)("esri.core.AsyncSequence")],l)})),r.register("aa0IA",(function(n,i){t(n.exports,"PendingFeatureTile",(function(){return d})),t(n.exports,"StateType",(function(){return a}));var a,s,o=r("8TSCy"),u=r("2TvXO"),l=r("dqkq5"),c=r("7qybv"),h=r("10vEZ"),f=r("8TwEW"),d=function(){"use strict";function t(e,r){o.classCallCheck(this,t),this.data=e,this.resolution=r,this.state={type:a.CREATED},this.alive=!0}return o.createClass(t,[{key:"process",value:function(e){switch(this.state.type){case a.CREATED:return this.state=this._gotoFetchCount(this.state,e),this.state.task.promise.then(e.resume,e.resume);case a.FETCH_COUNT:break;case a.FETCHED_COUNT:return this.state=this._gotoFetchFeatures(this.state,e),this.state.task.promise.then(e.resume,e.resume);case a.FETCH_FEATURES:break;case a.FETCHED_FEATURES:this.state=this._goToDone(this.state,e);case a.DONE:}return null}},{key:"debugInfo",get:function(){return{data:this.data,featureCount:this.featureCount,state:this.stateToString}}},{key:"featureCount",get:function(){switch(this.state.type){case a.CREATED:case a.FETCH_COUNT:return 0;case a.FETCHED_COUNT:return this.state.featureCount;case a.FETCH_FEATURES:return this.state.previous.featureCount;case a.FETCHED_FEATURES:return this.state.features.length;case a.DONE:return this.state.previous.features.length}}},{key:"stateToString",get:function(){switch(this.state.type){case a.CREATED:return"created";case a.FETCH_COUNT:return"fetch-count";case a.FETCHED_COUNT:return"fetched-count";case a.FETCH_FEATURES:return"fetch-features";case a.FETCHED_FEATURES:return"fetched-features";case a.DONE:return"done"}}},{key:"_gotoFetchCount",value:function(t,r){var n,i=this;return{type:a.FETCH_COUNT,previous:t,task:(0,h.createTask)((n=o.asyncToGenerator(e(u).mark((function t(n){var s;return e(u).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.resultOrAbort)(r.fetchCount(i,n));case 2:s=e.sent,i.state.type===a.FETCH_COUNT&&(i.state=i._gotoFetchedCount(i.state,s.ok?s.value:1/0));case 4:case"end":return e.stop()}}),t)}))),function(e){return n.apply(this,arguments)}))}}},{key:"_gotoFetchedCount",value:function(e,t){return{type:a.FETCHED_COUNT,featureCount:t,previous:e}}},{key:"_gotoFetchFeatures",value:function(t,r){var n,i=this;return{type:a.FETCH_FEATURES,previous:t,task:(0,h.createTask)((n=o.asyncToGenerator(e(u).mark((function n(s){var o;return e(u).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.resultOrAbort)(r.fetchFeatures(i,t.featureCount,s));case 2:o=e.sent,i.state.type===a.FETCH_FEATURES&&(i.state=i._gotoFetchedFeatures(i.state,o.ok?o.value:[]));case 4:case"end":return e.stop()}}),n)}))),function(e){return n.apply(this,arguments)}))}}},{key:"_gotoFetchedFeatures",value:function(e,t){return{type:a.FETCHED_FEATURES,previous:e,features:t}}},{key:"_goToDone",value:function(e,t){return t.finish(this,e.features),{type:a.DONE,previous:e}}},{key:"reset",value:function(){var e=this.state;switch(this.state={type:a.CREATED},e.type){case a.CREATED:case a.FETCHED_COUNT:case a.FETCHED_FEATURES:case a.DONE:break;case a.FETCH_COUNT:case a.FETCH_FEATURES:e.task.abort()}}},{key:"intersects",value:function(e){return!(!(0,c.isNone)(e)&&this.data.extent)||((0,f.fromExtent)(e,v),(0,f.intersects)(this.data.extent,v))}}]),t}();(s=a||(a={}))[s.CREATED=0]="CREATED",s[s.FETCH_COUNT=1]="FETCH_COUNT",s[s.FETCHED_COUNT=2]="FETCHED_COUNT",s[s.FETCH_FEATURES=3]="FETCH_FEATURES",s[s.FETCHED_FEATURES=4]="FETCHED_FEATURES",s[s.DONE=5]="DONE";var v=(0,f.create)()})),r.register("di4ub",(function(n,i){t(n.exports,"FeatureServiceTileStore",(function(){return _}));var a=r("8TSCy"),s=r("2TvXO"),o=r("7eJjO"),u=r("jymfC"),l=r("dbxRf"),c=r("7qybv"),h=r("iho5X");r("lNwWH"),r("2VlWd"),r("iJAIC");var f=r("fcwIv"),d=r("8TwEW"),v=r("akQYU"),p=r("1ZPLr"),y=r("xQ42o"),m=r("j6c7r"),g=r("l9YOK"),_=function(t){"use strict";a.inherits(n,t);var r=a.createSuper(n);function n(e){var t;return a.classCallCheck(this,n),(t=r.call(this,e)).tileInfo=null,t.extent=null,t.maximumByteSize=10*l.ByteSizeUnit.MEGABYTES,t.tileBounds=new(0,p.BoundsStore),t.tiles=new(0,g.FeatureServiceTileCache),t.refCounts=new Map,t.tileFeatureCounts=new Map,t.tmpBoundingRect=(0,d.create)(),a.possibleConstructorReturn(t)}return a.createClass(n,[{key:"add",value:function(e,t){var r=this,n=[],i=!0,a=!1,s=void 0;try{for(var o,u=t[Symbol.iterator]();!(i=(o=u.next()).done);i=!0){var h=o.value;this._referenceFeature(h.objectId)===x.ADDED&&n.push(h)}}catch(e){a=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw s}}this._addTileStorage(e,new Set(t.map((function(e){return e.objectId}))),t.reduce((function(e,t){return e+(32+function(e){if((0,c.isNone)(e))return 0;var t=(0,l.estimateFixedArraySize)(e.lengths,4);return 32+(0,l.estimateFixedArraySize)(e.coords,8)+t}((r=t).geometry)+(0,l.estimateAttributesObjectSize)(r.attributes));var r}),0)),this.featureStore.addMany(n),this.tiles.applyByteSizeLimit(this.maximumByteSize,(function(e){return r._removeTileStorage(e)}))}},{key:"destroy",value:function(){this.clear(),this.tileFeatureCounts.clear()}},{key:"clear",value:function(){this.featureStore.clear(),this.tileBounds.clear(),this.tiles.clear(),this.refCounts.clear()}},{key:"refresh",value:function(){this.clear(),this.tileFeatureCounts.clear()}},{key:"processEdits",value:function(e,t,r){return this._processEditsDelete(e.deletedFeatures.concat(e.updatedFeatures)),this._processEditsRefetch(e.addedFeatures.concat(e.updatedFeatures),t,r)}},{key:"_addTileStorage",value:function(e,t,r){this.tiles.set(e.id,new T(e,t,r)),this.tileBounds.set(e.id,e.extent),this.tileFeatureCounts.set(e.id,t.size)}},{key:"_remove",value:function(e){var t=e.id,r=this.tiles.get(t);r&&this._removeTileStorage(r)}},{key:"_removeTileStorage",value:function(e){var t=[],r=!0,n=!1,i=void 0;try{for(var a,s=e.objectIds[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var o=a.value;this._unreferenceFeature(o)===x.REMOVED&&t.push(o)}}catch(e){n=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(n)throw i}}this.featureStore.removeManyById(t);var u=e.data.id;this.tiles.delete(u),this.tileBounds.delete(u)}},{key:"_processEditsDelete",value:function(e){this.featureStore.removeManyById(e);var t=!0,r=!1,n=void 0;try{for(var i,s=this.tiles[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){var o=a.slicedToArray(i.value,2)[1],u=!0,l=!1,c=void 0;try{for(var h,f=e[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var d=h.value;o.objectIds.delete(d)}}catch(e){l=!0,c=e}finally{try{u||null==f.return||f.return()}finally{if(l)throw c}}this.tileFeatureCounts.set(o.data.id,o.objectIds.size)}}catch(e){r=!0,n=e}finally{try{t||null==s.return||s.return()}finally{if(r)throw n}}var v=!0,p=!1,y=void 0;try{for(var m,g=e[Symbol.iterator]();!(v=(m=g.next()).done);v=!0){var _=m.value;this.refCounts.delete(_)}}catch(e){p=!0,y=e}finally{try{v||null==g.return||g.return()}finally{if(p)throw y}}}},{key:"_processEditsRefetch",value:function(t,r,n){var i=this;return a.asyncToGenerator(e(s).mark((function a(){var o,u,l,h,f,d,p,y,m,g,_;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(t,n);case 2:for(o=e.sent.features,u=i.featureStore,l=u.hasZ,h=u.hasM,f=!0,d=!1,p=void 0,e.prev=7,y=o[Symbol.iterator]();!(f=(m=y.next()).done);f=!0)g=m.value,_=(0,v.getBoundsOptimizedGeometry)(i.tmpBoundingRect,g.geometry,l,h),(0,c.isNone)(_)||i.tileBounds.forEachInBounds(_,(function(e){var t=i.tiles.get(e);i.featureStore.add(g),t.objectIds.has(g.objectId)||(t.objectIds.add(g.objectId),i._referenceFeature(g.objectId),i.tileFeatureCounts.set(t.data.id,t.objectIds.size))}));e.next=15;break;case 11:e.prev=11,e.t0=e.catch(7),d=!0,p=e.t0;case 15:e.prev=15,e.prev=16,f||null==y.return||y.return();case 18:if(e.prev=18,!d){e.next=21;break}throw p;case 21:return e.finish(18);case 22:return e.finish(15);case 23:case"end":return e.stop()}}),a,null,[[7,11,15,23],[16,,18,22]])})))()}},{key:"process",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0};if((0,c.isNone)(this.tileInfo)||!e.extent||(0,c.isSome)(this.extent)&&!(0,d.intersects)((0,d.fromExtent)(this.extent,this.tmpBoundingRect),e.extent))return new C(e);if(this.tiles.has(e.id))return new C(e);var r=this._createTileTree(e,this.tileInfo);return this._simplify(r,t,null,0,1),this._collectMissingTiles(e,r,this.tileInfo)}},{key:"debugInfo",get:function(){var e=this;return Array.from(this.tiles.values()).map((function(t){var r=t.data;return{data:r,featureCount:e.tileFeatureCounts.get(r.id)||0}}))}},{key:"getFeatureCount",value:function(e){var t=this.tileFeatureCounts.get(e.id);return null!=t?t:0}},{key:"fetchCount",value:function(t,r,n,i){var o=this;return a.asyncToGenerator(e(s).mark((function a(){var u,l;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==(u=o.tileFeatureCounts.get(t.id))){e.next=3;break}return e.abrupt("return",u);case 3:return e.next=5,(0,m.executeQueryForCount)(r,n,i);case 5:return l=e.sent,e.abrupt("return",(o.tileFeatureCounts.set(t.id,l.data.count),l.data.count));case 7:case"end":return e.stop()}}),a)})))()}},{key:"_createTileTree",value:function(e,t){var r=this,n=new S(e.level,e.row,e.col);return t.updateTileInfo(n,y.default.ExtrapolateOptions.POWER_OF_TWO),this.tileBounds.forEachInBounds(e.extent,(function(i){var a=r.tiles.get(i).data;r._tilesAreRelated(e,a)&&r._populateChildren(n,a,t,r.tileFeatureCounts.get(a.id)||0)})),n}},{key:"_tilesAreRelated",value:function(e,t){if(!e||!t)return!1;if(e.level===t.level)return e.row===t.row&&e.col===t.col;var r=e.level<t.level,n=r?e:t,i=r?t:e,a=1<<i.level-n.level;return Math.floor(i.row/a)===n.row&&Math.floor(i.col/a)===n.col}},{key:"_populateChildren",value:function(e,t,r,n){var i=t.level-e.level-1;if(i<0)e.isLeaf=!0;else{var a=t.row>>i,s=t.col>>i,o=e.row<<1,u=s-(e.col<<1)+(a-o<<1),l=e.children[u];if((0,c.isSome)(l))this._populateChildren(l,t,r,n);else{var h=new S(e.level+1,a,s);r.updateTileInfo(h,y.default.ExtrapolateOptions.POWER_OF_TWO),e.children[u]=h,this._populateChildren(h,t,r,n)}}}},{key:"_simplify",value:function(e,t,r,n,i){var a=i*i;if(e.isLeaf)return t(this.getFeatureCount(e),i)?0:(this._remove(e),(0,c.isSome)(r)&&(r.children[n]=null),a);for(var s=i/2,o=s*s,u=0,l=0;l<e.children.length;l++){var h=e.children[l];u+=(0,c.isSome)(h)?this._simplify(h,t,e,l,s):o}return 0===u?this._mergeChildren(e):1-u/a<I&&(this._purge(e),(0,c.isSome)(r)&&(r.children[n]=null),u=a),u}},{key:"_mergeChildren",value:function(e){var t=this,r=new Set,n=0;this._forEachLeaf(e,(function(e){var i=t.tiles.get(e.id);if(i){n+=i.byteSize;var a=!0,s=!1,o=void 0;try{for(var u,l=i.objectIds[Symbol.iterator]();!(a=(u=l.next()).done);a=!0){var c=u.value;r.has(c)||(r.add(c),t._referenceFeature(c))}}catch(e){s=!0,o=e}finally{try{a||null==l.return||l.return()}finally{if(s)throw o}}t._remove(e)}})),this._addTileStorage(e,r,n),e.isLeaf=!0,e.children[0]=e.children[1]=e.children[2]=e.children[3]=null,this.tileFeatureCounts.set(e.id,r.size)}},{key:"_forEachLeaf",value:function(e,t){var r=!0,n=!1,i=void 0;try{for(var a,s=e.children[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var o=a.value;(0,c.isNone)(o)||(o.isLeaf?t(o):this._forEachLeaf(o,t))}}catch(e){n=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(n)throw i}}}},{key:"_purge",value:function(e){if(!(0,c.isNone)(e))if(e.isLeaf)this._remove(e);else for(var t=0;t<e.children.length;t++){var r=e.children[t];this._purge(r),e.children[t]=null}}},{key:"_collectMissingTiles",value:function(e,t,r){var n=new k(r,e,this.extent);return this._collectMissingTilesRecurse(t,n,1),n.info}},{key:"_collectMissingTilesRecurse",value:function(e,t,r){if(!e.isLeaf)if(e.hasChildren)for(var n=r/2,i=0;i<e.children.length;i++){var a=e.children[i];(0,c.isNone)(a)?t.addMissing(e.level+1,(e.row<<1)+((2&i)>>1),(e.col<<1)+(1&i),n):this._collectMissingTilesRecurse(a,t,n)}else t.addMissing(e.level,e.row,e.col,r)}},{key:"_referenceFeature",value:function(e){var t=(this.refCounts.get(e)||0)+1;return this.refCounts.set(e,t),1===t?x.ADDED:x.UNCHANGED}},{key:"_unreferenceFeature",value:function(e){var t=(this.refCounts.get(e)||0)-1;return 0===t?(this.refCounts.delete(e),x.REMOVED):(t>0&&this.refCounts.set(e,t),x.UNCHANGED)}},{key:"test",get:function(){var e=this;return{tiles:Array.from(this.tiles.values()).map((function(e){return"".concat(e.data.id,":[").concat(Array.from(e.objectIds),"]")})),featureReferences:Array.from(this.refCounts.keys()).map((function(t){return"".concat(t,":").concat(e.refCounts.get(t))}))}}}]),n}(u.default);(0,o._)([(0,h.property)({constructOnly:!0})],_.prototype,"featureStore",void 0),(0,o._)([(0,h.property)()],_.prototype,"tileInfo",void 0),(0,o._)([(0,h.property)()],_.prototype,"extent",void 0),(0,o._)([(0,h.property)()],_.prototype,"maximumByteSize",void 0),_=(0,o._)([(0,f.subclass)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTileStore")],_);var x,b,T=function e(t,r,n){"use strict";a.classCallCheck(this,e),this.data=t,this.objectIds=r,this.byteSize=n},S=function(){"use strict";function e(t,r,n){a.classCallCheck(this,e),this.level=t,this.row=r,this.col=n,this.isLeaf=!1,this.extent=null,this.children=[null,null,null,null]}return a.createClass(e,[{key:"hasChildren",get:function(){return!this.isLeaf&&((0,c.isSome)(this.children[0])||(0,c.isSome)(this.children[1])||(0,c.isSome)(this.children[2])||(0,c.isSome)(this.children[3]))}}]),e}(),C=function(){"use strict";function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];a.classCallCheck(this,e),this.missingTiles=r,this.fullArea=0,this.coveredArea=0,this.fullArea=(0,d.area)(t.extent),this.coveredArea=this.fullArea}return a.createClass(e,[{key:"prepend",value:function(e){this.missingTiles=e.missingTiles.concat(this.missingTiles),this.coveredArea+=e.coveredArea,this.fullArea+=e.fullArea}}]),e}(),k=function(){"use strict";function e(t,r,n){a.classCallCheck(this,e),this.tileInfo=t,this.extent=null,this.info=new C(r),(0,c.isSome)(n)&&(this.extent=(0,d.fromExtent)(n))}return a.createClass(e,[{key:"addMissing",value:function(e,t,r,n){var i={id:null,level:e,row:t,col:r};this.tileInfo.updateTileInfo(i,y.default.ExtrapolateOptions.POWER_OF_TWO),!(0,c.isSome)(i.extent)||(0,c.isSome)(this.extent)&&!(0,d.intersects)(this.extent,i.extent)||(this.info.missingTiles.push({data:i,resolution:n}),this.info.coveredArea-=(0,d.area)(i.extent))}}]),e}(),I=.18751;(b=x||(x={}))[b.ADDED=0]="ADDED",b[b.REMOVED=1]="REMOVED",b[b.UNCHANGED=2]="UNCHANGED"})),r.register("l9YOK",(function(e,n){t(e.exports,"FeatureServiceTileCache",(function(){return s}));var i=r("8TSCy"),a=Symbol.iterator,s=function(){"use strict";function e(){i.classCallCheck(this,e),this._store=new Map,this._byteSize=0}return i.createClass(e,[{key:"set",value:function(e,t){this.delete(e),this._store.set(e,t),this._byteSize+=t.byteSize}},{key:"delete",value:function(e){var t=this._store.get(e);return!!this._store.delete(e)&&(this._byteSize-=t.byteSize,!0)}},{key:"get",value:function(e){return this._used(e),this._store.get(e)}},{key:"has",value:function(e){return this._used(e),this._store.has(e)}},{key:"clear",value:function(){this._store.clear()}},{key:"applyByteSizeLimit",value:function(e,t){var r=!0,n=!1,a=void 0;try{for(var s,o=this._store[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=i.slicedToArray(s.value,2),l=u[0],c=u[1];if(this._byteSize<=e)break;this.delete(l),t(c)}}catch(e){n=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(n)throw a}}}},{key:"values",value:function(){return this._store.values()}},{key:a,value:function(){return this._store[Symbol.iterator]()}},{key:"_used",value:function(e){var t=this._store.get(e);t&&(this._store.delete(e),this._store.set(e,t))}}]),e}()})),r.register("hbg1x",(function(e,n){t(e.exports,"isNullCountSupported",(function(){return h})),t(e.exports,"calculateStringStatistics",(function(){return f})),t(e.exports,"calculatePercentile",(function(){return v})),t(e.exports,"calculateStatistics",(function(){return d})),t(e.exports,"getAttributeComparator",(function(){return p})),t(e.exports,"processSummaryStatisticsResult",(function(){return g})),t(e.exports,"calculateUniqueValuesCount",(function(){return _})),t(e.exports,"createUVResult",(function(){return x})),t(e.exports,"getNormalizedValue",(function(){return b})),t(e.exports,"calculateClassBreaks",(function(){return T})),t(e.exports,"resolveCBResult",(function(){return S})),t(e.exports,"calculateHistogram",(function(){return C}));var i=r("8TSCy"),a=r("59jTx"),s=r("hxmJW"),o="equal-interval",u=/\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi,l=new Set(["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]),c=["min","max","avg","stddev","count","sum","variance","nullcount","median"];function h(e){var t=null!=e.normalizationField||null!=e.normalizationType,r=null!=e.minValue||null!=e.maxValue,n=!!e.sqlExpression&&e.supportsSQLExpression;return!t&&!r&&!n}function f(e){var t=e.returnDistinct?i.toConsumableArray(new Set(e.values)):e.values,r=t.filter((function(e){return null!=e})).length,n={count:r};return e.supportsNullCount&&(n.nullcount=t.length-r),e.percentileParams&&(n.median=v(t,e.percentileParams)),n}function d(e){var t=e.values,r=e.useSampleStdDev,n=e.supportsNullCount,i=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,s=null,o=null,u=null,l=null,c=0,h=null==e.minValue?-1/0:e.minValue,f=null==e.maxValue?1/0:e.maxValue,d=!0,p=!1,y=void 0;try{for(var m,g=t[Symbol.iterator]();!(d=(m=g.next()).done);d=!0){var _=m.value;Number.isFinite(_)?_>=h&&_<=f&&(s+=_,i=Math.min(i,_),a=Math.max(a,_),c++):"string"==typeof _&&c++}}catch(e){p=!0,y=e}finally{try{d||null==g.return||g.return()}finally{if(p)throw y}}if(c&&null!=s){o=s/c;var x=0,b=!0,T=!1,S=void 0;try{for(var C,k=t[Symbol.iterator]();!(b=(C=k.next()).done);b=!0){var I=C.value;Number.isFinite(I)&&I>=h&&I<=f&&(x+=Math.pow(I-o,2))}}catch(e){T=!0,S=e}finally{try{b||null==k.return||k.return()}finally{if(T)throw S}}l=r?c>1?x/(c-1):0:c>0?x/c:0,u=Math.sqrt(l)}else i=null,a=null;var F={avg:o,count:c,max:a,min:i,stddev:u,sum:s,variance:l};return n&&(F.nullcount=t.length-c),e.percentileParams&&(F.median=v(t,e.percentileParams)),F}function v(e,t){var r=t.fieldType,n=t.value,a=t.orderBy,s=t.isDiscrete,o=p(r,"desc"===a);if(0===(e=i.toConsumableArray(e).filter((function(e){return null!=e})).sort((function(e,t){return o(e,t)}))).length)return null;if(n<=0)return e[0];if(n>=1)return e[e.length-1];var u=(e.length-1)*n,l=Math.floor(u),c=l+1,h=u%1,f=e[l],d=e[c];return c>=e.length||s||"string"==typeof f||"string"==typeof d?f:f*(1-h)+d*h}function p(e,t){var r=t?1:-1,n=t?function(e,t){return t-e}:function(e,t){return e-t},a=y(t);if(!e||!["esriFieldTypeDate","esriFieldTypeString","esriFieldTypeGUID","esriFieldTypeGlobalID"].concat(i.toConsumableArray(l)).includes(e))return function(e,t){return"number"==typeof e&&"number"==typeof t?n(e,t):"string"==typeof e&&"string"==typeof t?a(e,t):r};if("esriFieldTypeDate"===e)return function(e,t){var i=new Date(e).getTime(),a=new Date(t).getTime();return isNaN(i)||isNaN(a)?r:n(i,a)};if(l.has(e))return function(e,t){return n(e,t)};if("esriFieldTypeString"===e)return function(e,t){return a(e,t)};if("esriFieldTypeGUID"===e||"esriFieldTypeGlobalID"===e){var s=y(t);return function(e,t){return s(m(e),m(t))}}return t?function(e,t){return 1}:function(e,t){return-1}}function y(e){return e?function(e,t){var r,n;return(e=null==(r=e)?void 0:r.toUpperCase())>(t=null==(n=t)?void 0:n.toUpperCase())?-1:e<t?1:0}:function(e,t){var r,n;return(e=null==(r=e)?void 0:r.toUpperCase())<(t=null==(n=t)?void 0:n.toUpperCase())?-1:e>t?1:0}}function m(e){return e.substr(24,12)+e.substr(19,4)+e.substr(16,2)+e.substr(14,2)+e.substr(11,2)+e.substr(9,2)+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)+e.substr(0,2)}function g(e,t){var r;for(r in e)c.indexOf(r)>-1&&(Number.isFinite(e[r])||(e[r]=null));return t?(["avg","stddev","variance"].forEach((function(t){null!=e[t]&&(e[t]=Math.ceil(e[t]))})),e):e}function _(e){var t={},r=!0,n=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var o=a.value;(null==o||"string"==typeof o&&""===o.trim())&&(o=null),null==t[o]?t[o]={count:1,data:o}:t[o].count++}}catch(e){n=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(n)throw i}}return{count:t}}function x(e,t,r){var n=e.count,i=[];for(var a in r&&t&&"coded-value"===t.type&&t.codedValues.forEach((function(e){var t=e.code;n.hasOwnProperty(t)||(n[t]={data:t,count:0})})),n){var s=n[a];i.push({value:s.data,count:s.count,label:s.label})}return{uniqueValueInfos:i}}function b(e,t,r,n){var i=null;switch(t){case"log":0!==e&&(i=Math.log(e)*Math.LOG10E);break;case"percent-of-total":Number.isFinite(n)&&0!==n&&(i=e/n*100);break;case"field":Number.isFinite(r)&&0!==r&&(i=e/r);break;case"natural-log":e>0&&(i=Math.log(e));break;case"square-root":e>0&&(i=Math.pow(e,.5))}return i}function T(e,t){var r,n,i,u,l,c,h,f,d,v=(r={field:t.field,normalizationType:t.normalizationType,normalizationField:t.normalizationField,classificationMethod:t.classificationMethod,standardDeviationInterval:t.standardDeviationInterval,breakCount:t.numClasses||5},n=r.field,i=r.classificationMethod||o,u=r.normalizationType,l=r.normalizationField,(c=new(0,a.default)).classificationField=n,c.breakCount=r.breakCount,c.classificationMethod=i,c.standardDeviationInterval="standard-deviation"===i?r.standardDeviationInterval||1:void 0,c.normalizationType=u,c.normalizationField="field"===u?l:void 0,c);return h=e,f=t.minValue,d=t.maxValue,f=null==f?-1/0:f,d=null==d?1/0:d,e=h.filter((function(e){return Number.isFinite(e)&&e>=f&&e<=d})),(0,s.createGenerateRendererClassBreaks)({definition:v,values:e,normalizationTotal:t.normalizationTotal})}function S(e,t){var r=e.classBreaks,n=r.length,i=r[0].minValue,a=r[n-1].maxValue,s="standard-deviation"===t,o=u;return{minValue:i,maxValue:a,classBreakInfos:r=r.map((function(e){var t=e.label,r={minValue:e.minValue,maxValue:e.maxValue,label:t};if(s&&t){var n=t.match(o).map((function(e){return+e.trim()}));2===n.length?(r.minStdDev=n[0],r.maxStdDev=n[1],n[0]<0&&n[1]>0&&(r.hasAvg=!0)):1===n.length&&(t.includes("<")?(r.minStdDev=null,r.maxStdDev=n[0]):t.includes(">")&&(r.minStdDev=n[0],r.maxStdDev=null))}return r})),normalizationTotal:e.normalizationTotal}}function C(e,t){var r=function(e,t){var r=t.field,n=t.classificationMethod,i=t.standardDeviationInterval,a=t.normalizationType,s=t.normalizationField,o=t.normalizationTotal,u=t.minValue,l=t.maxValue,c=t.numBins||10,f=null,v=null,p=null;if(n&&"equal-interval"!==n||a){var y=T(e,{field:r,normalizationType:a,normalizationField:s,normalizationTotal:o,classificationMethod:n,standardDeviationInterval:i,minValue:u,maxValue:l,numClasses:c}).classBreaks;f=y[0].minValue,v=y[y.length-1].maxValue,p=y.map((function(e){return[e.minValue,e.maxValue]}))}else{if(null!=u&&null!=l)f=u,v=l;else{var m=d({values:e,minValue:u,maxValue:l,useSampleStdDev:!a,supportsNullCount:h({normalizationType:a,normalizationField:s,minValue:u,maxValue:l})});f=m.min,v=m.max}p=function(e,t,r){for(var n,i=(t-e)/r,a=[],s=e,o=1;o<=r;o++)n=s+i,n=Number(n.toFixed(16)),a.push([s,o===r?t:n]),s=n;return a}(f,v,c)}return{min:f,max:v,intervals:p}}(e,t),n=r.min,i=r.max,a=r.intervals,s=a.map((function(e,t){return{minValue:a[t][0],maxValue:a[t][1],count:0}})),o=!0,u=!1,l=void 0;try{for(var c,f=e[Symbol.iterator]();!(o=(c=f.next()).done);o=!0){var v=c.value;if(null!=v&&v>=n&&v<=i){var p=k(a,v);p>-1&&s[p].count++}}}catch(e){u=!0,l=e}finally{try{o||null==f.return||f.return()}finally{if(u)throw l}}return{bins:s,minValue:n,maxValue:i,normalizationTotal:t.normalizationTotal}}function k(e,t){for(var r=-1,n=e.length-1;n>=0;n--)if(t>=e[n][0]){r=n;break}return r}})),r.register("59jTx",(function(e,n){t(e.exports,"default",(function(){return d}));var i=r("8TSCy"),a=r("7eJjO"),s=r("79ASa"),o=r("iho5X");r("lNwWH"),r("2VlWd"),r("iJAIC");var u=r("fcwIv"),l=r("kt6hM"),c=new(0,s.JSONMap)({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"}),h=new(0,s.JSONMap)({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"}),f=function(e){"use strict";i.inherits(r,e);var t=i.createSuper(r);function r(){var e;return i.classCallCheck(this,r),(e=t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments)))).breakCount=null,e.classificationField=null,e.classificationMethod=null,e.normalizationField=null,e.normalizationType=null,e.type="class-breaks-definition",i.possibleConstructorReturn(e)}return i.createClass(r,[{key:"standardDeviationInterval",set:function(e){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",e)}},{key:"definedInterval",set:function(e){"defined-interval"===this.classificationMethod&&this._set("definedInterval",e)}}]),r}(l.default);(0,a._)([(0,o.property)({json:{write:!0}})],f.prototype,"breakCount",void 0),(0,a._)([(0,o.property)({json:{write:!0}})],f.prototype,"classificationField",void 0),(0,a._)([(0,o.property)({type:String,json:{read:c.read,write:c.write}})],f.prototype,"classificationMethod",void 0),(0,a._)([(0,o.property)({json:{write:!0}})],f.prototype,"normalizationField",void 0),(0,a._)([(0,o.property)({json:{read:h.read,write:h.write}})],f.prototype,"normalizationType",void 0),(0,a._)([(0,o.property)({value:null,json:{write:!0}})],f.prototype,"standardDeviationInterval",null),(0,a._)([(0,o.property)({value:null,json:{write:!0}})],f.prototype,"definedInterval",null),(0,a._)([(0,o.property)()],f.prototype,"type",void 0);var d=f=(0,a._)([(0,u.subclass)("esri.rest.support.ClassBreaksDefinition")],f)})),r.register("kt6hM",(function(e,n){t(e.exports,"default",(function(){return v}));var i=r("8TSCy"),a=r("7eJjO"),s=r("79ASa"),o=r("1XAcN"),u=r("iho5X");r("lNwWH"),r("2VlWd"),r("iJAIC");var l=r("fcwIv"),c=r("1DHtQ"),h=r("j9ZJv"),f=new(0,s.JSONMap)({classBreaksDef:"class-breaks-definition",uniqueValueDef:"unique-value-definition"}),d=function(e){"use strict";i.inherits(r,e);var t=i.createSuper(r);function r(){var e;return i.classCallCheck(this,r),(e=t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments)))).baseSymbol=null,e.colorRamp=null,e.type=null,i.possibleConstructorReturn(e)}return r}(o.JSONSupport);(0,a._)([(0,u.property)({type:h.default,json:{write:!0}})],d.prototype,"baseSymbol",void 0),(0,a._)([(0,u.property)({types:c.types,json:{read:{reader:c.fromJSON},write:!0}})],d.prototype,"colorRamp",void 0),(0,a._)([(0,u.property)({json:{read:f.read,write:f.write}})],d.prototype,"type",void 0);var v=d=(0,a._)([(0,l.subclass)("esri.rest.support.ClassificationDefinition")],d)})),r.register("hxmJW",(function(e,r){function n(e,t){return Number(e.toFixed(t))}function i(e){var t=e.normalizationTotal;return{classBreaks:a(e),normalizationTotal:t}}function a(e){var t=e.definition,r=t.classificationMethod,i=t.breakCount,a=t.normalizationType,c=t.definedInterval,h=[],f=e.values;if(0===f.length)return[];var d,v,p,y,m,g,_=(f=f.sort((function(e,t){return e-t})))[0],x=f[f.length-1];if("equal-interval"===r)if(f.length>=i){for(var b=(x-_)/i,T=_,S=1;S<i;S++){var C=n(_+S*b,6);h.push({minValue:T,maxValue:C,label:s(T,C,a)}),T=C}h.push({minValue:T,maxValue:x,label:s(T,x,a)})}else f.forEach((function(e){h.push({minValue:e,maxValue:e,label:s(e,e,a)})}));else if("natural-breaks"===r){for(var k=o(f),I=e.valueFrequency||k.valueFrequency,F=function(e,t,r){var n=e.length,i=[];r>n&&(r=n);for(var a=0;a<r;a++)i.push(Math.round(a*n/r-1));i.push(n-1);var s=u(i,e,t,r);return function(e,t,r,n,i,a){for(var s=0,o=0,u=0,c=0,h=!0,f=0;f<2&&h;f++){0===f&&(h=!1);for(var d=0;d<a-1;d++)for(;r[d+1]+1!==r[d+2];){r[d+1]=r[d+1]+1;var v=l(d,r,n,i);u=v.sbMean,s=v.sbSdcm;var p=l(d+1,r,n,i);if(c=p.sbMean,!(s+(o=p.sbSdcm)<t[d]+t[d+1])){r[d+1]=r[d+1]-1;break}t[d]=s,t[d+1]=o,e[d]=u,e[d+1]=c,h=!0}for(var y=a-1;y>0;y--)for(;r[y]!==r[y-1]+1;){r[y]=r[y]-1;var m=l(y-1,r,n,i);u=m.sbMean,s=m.sbSdcm;var g=l(y,r,n,i);if(c=g.sbMean,!(s+(o=g.sbSdcm)<t[y-1]+t[y])){r[y]=r[y]+1;break}t[y-1]=s,t[y]=o,e[y-1]=u,e[y]=c,h=!0}}return h}(s.mean,s.sdcm,i,e,t,r)&&(s=u(i,e,t,r)),i}(k.uniqueValues,I,i),w=_,E=1;E<i;E++)if(k.uniqueValues.length>E){var M=n(k.uniqueValues[F[E]],6);h.push({minValue:w,maxValue:M,label:s(w,M,a)}),w=M}h.push({minValue:w,maxValue:x,label:s(w,x,a)})}else if("quantile"===r)if(f.length>=i&&_!==x){for(var N=_,A=Math.ceil(f.length/i),B=0,O=1;O<i;O++){var z=A+B-1;z>f.length&&(z=f.length-1),z<0&&(z=0),h.push({minValue:N,maxValue:f[z],label:s(N,f[z],a)}),N=f[z],B+=A,A=Math.ceil((f.length-B)/(i-O))}h.push({minValue:N,maxValue:x,label:s(N,x,a)})}else for(var P=-1,R=0;R<f.length;R++){var V=f[R];V!==P&&(P=V,h.push({minValue:P,maxValue:V,label:s(P,V,a)}),P=V)}else if("standard-deviation"===r){var D=function(e){for(var t=0,r=0;r<e.length;r++)t+=e[r];return t/e.length}(f),j=function(e,t){for(var r=0,n=0;n<e.length;n++){var i=e[n];r+=(i-t)*(i-t)}return r/=e.length,Math.sqrt(r)}(f,D);if(0===j)h.push({minValue:f[0],maxValue:f[0],label:s(f[0],f[0],a)});else{for(var q=(d=_,v=x,p=i,y=D,m=j,((g=Math.max(y-d,v-y)/m/p)>=1?1:g>=.5?.5:.25)*j),H=0,Y=_,X=i;X>=1;X--){var G=n(D-(X-.5)*q,6);h.push({minValue:Y,maxValue:G,label:s(Y,G,a)}),Y=G,H++}var U=n(D+.5*q,6);h.push({minValue:Y,maxValue:U,label:s(Y,U,a)}),Y=U,H++;for(var Z=1;Z<=i;Z++)U=H===2*i?x:n(D+(Z+.5)*q,6),h.push({minValue:Y,maxValue:U,label:s(Y,U,a)}),Y=U,H++}}else if("defined-interval"===r){if(!c)return h;for(var L=f[0],J=f[f.length-1],W=Math.ceil((J-L)/c),Q=L,K=1;K<W;K++){var $=n(L+K*c,6);h.push({minValue:Q,maxValue:$,label:s(Q,$,a)}),Q=$}h.push({minValue:Q,maxValue:J,label:s(Q,J,a)})}return h}function s(e,t,r){return e===t?r&&"percent-of-total"===r?e+"%":e.toString():r&&"percent-of-total"===r?e+"% - "+t+"%":e+" - "+t}function o(e){for(var t=[],r=[],n=Number.MIN_VALUE,i=1,a=-1,s=0;s<e.length;s++){var o=e[s];o===n?(i++,r[a]=i):null!==o&&(t.push(o),n=o,i=1,r.push(i),a++)}return{uniqueValues:t,valueFrequency:r}}function u(e,t,r,n){for(var i=[],a=[],s=[],o=0,u=[],c=[],h=0;h<n;h++){var f=l(h,e,t,r);u.push(f.sbMean),c.push(f.sbSdcm),o+=c[h]}for(var d,v=o,p=!0;p||o<v;){p=!1,i=[];for(var y=0;y<n;y++)i.push(e[y]);for(var m=0;m<n;m++)for(var g=e[m]+1;g<=e[m+1];g++)if(d=t[g],m>0&&g!==e[m+1]&&Math.abs(d-u[m])>Math.abs(d-u[m-1]))e[m]=g;else if(m<n-1&&e[m]!==g-1&&Math.abs(d-u[m])>Math.abs(d-u[m+1])){e[m+1]=g-1;break}v=o,o=0,a=[],s=[];for(var _=0;_<n;_++){a.push(u[_]),s.push(c[_]);var x=l(_,e,t,r);u[_]=x.sbMean,c[_]=x.sbSdcm,o+=c[_]}}if(o>v){for(var b=0;b<n;b++)e[b]=i[b],u[b]=a[b],c[b]=s[b];o=v}return{mean:u,sdcm:c}}function l(e,t,r,n){for(var i=0,a=0,s=t[e]+1;s<=t[e+1];s++){var o=n[s];i+=r[s]*o,a+=o}a<=0&&console.log("Exception in Natural Breaks calculation");for(var u=i/a,l=0,c=t[e]+1;c<=t[e+1];c++)l+=n[c]*Math.pow(r[c]-u,2);return{sbMean:u,sbSdcm:l}}t(e.exports,"createGenerateRendererClassBreaks",(function(){return i}))})),r.register("jGyUI",(function(e,n){t(e.exports,"jsonAdapter",(function(){return a}));var i=r("8TSCy"),a={convertToGEGeometry:function(e,t){return null==t?null:e.convertJSONToGeometry(t)},exportPoint:function(e,t,r){var n=new s(e.getPointX(t),e.getPointY(t),r),i=e.hasZ(t),a=e.hasM(t);return i&&(n.z=e.getPointZ(t)),a&&(n.m=e.getPointM(t)),n},exportPolygon:function(e,t,r){return new o(e.exportPaths(t),r,e.hasZ(t),e.hasM(t))},exportPolyline:function(e,t,r){return new u(e.exportPaths(t),r,e.hasZ(t),e.hasM(t))},exportMultipoint:function(e,t,r){return new l(e.exportPoints(t),r,e.hasZ(t),e.hasM(t))},exportExtent:function(e,t,r){var n=e.hasZ(t),i=e.hasM(t),a=new c(e.getXMin(t),e.getYMin(t),e.getXMax(t),e.getYMax(t),r);if(n){var s=e.getZExtent(t);a.zmin=s.vmin,a.zmax=s.vmax}if(i){var o=e.getMExtent(t);a.mmin=o.vmin,a.mmax=o.vmax}return a}};var s=function e(t,r,n){"use strict";i.classCallCheck(this,e),this.x=t,this.y=r,this.spatialReference=n,this.z=void 0,this.m=void 0};var o=function e(t,r,n,a){"use strict";i.classCallCheck(this,e),this.rings=t,this.spatialReference=r,this.hasZ=void 0,this.hasM=void 0,n&&(this.hasZ=n),a&&(this.hasM=a)};var u=function e(t,r,n,a){"use strict";i.classCallCheck(this,e),this.paths=t,this.spatialReference=r,this.hasZ=void 0,this.hasM=void 0,n&&(this.hasZ=n),a&&(this.hasM=a)};var l=function e(t,r,n,a){"use strict";i.classCallCheck(this,e),this.points=t,this.spatialReference=r,this.hasZ=void 0,this.hasM=void 0,n&&(this.hasZ=n),a&&(this.hasM=a)};var c=function e(t,r,n,a,s){"use strict";i.classCallCheck(this,e),this.xmin=t,this.ymin=r,this.xmax=n,this.ymax=a,this.spatialReference=s,this.zmin=void 0,this.zmax=void 0,this.mmin=void 0,this.mmax=void 0}})),r.register("fP7bp",(function(n,i){t(n.exports,"checkProjectionSupport",(function(){return y})),t(n.exports,"project",(function(){return x})),t(n.exports,"projectMany",(function(){return T}));var a=r("8TSCy"),s=r("2TvXO"),o=r("7qybv"),u=r("7RvA5"),l=r("jGyUI"),c=r("eY5Yp"),h=r("eF88h"),f=[0,0];function d(e,t){if(!t)return null;if("x"in t){var r,n={x:0,y:0};return r=a.slicedToArray(e(t.x,t.y,f),2),n.x=r[0],n.y=r[1],null!=t.z&&(n.z=t.z),null!=t.m&&(n.m=t.m),n}if("xmin"in t){var i,s,o={xmin:0,ymin:0,xmax:0,ymax:0};return i=a.slicedToArray(e(t.xmin,t.ymin,f),2),o.xmin=i[0],o.ymin=i[1],s=a.slicedToArray(e(t.xmax,t.ymax,f),2),o.xmax=s[0],o.ymax=s[1],t.hasZ&&(o.zmin=t.zmin,o.zmax=t.zmax,o.hasZ=!0),t.hasM&&(o.mmin=t.mmin,o.mmax=t.mmax,o.hasM=!0),o}return"rings"in t?{rings:v(t.rings,e),hasM:t.hasM,hasZ:t.hasZ}:"paths"in t?{paths:v(t.paths,e),hasM:t.hasM,hasZ:t.hasZ}:"points"in t?{points:p(t.points,e),hasM:t.hasM,hasZ:t.hasZ}:void 0}function v(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var u=s.value;r.push(p(u,t))}}catch(e){i=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(i)throw a}}return r}function p(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var u=s.value,l=t(u[0],u[1],[0,0]);r.push(l),u.length>2&&l.push(u[2]),u.length>3&&l.push(u[3])}}catch(e){i=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(i)throw a}}return r}function y(e,t){return m.apply(this,arguments)}function m(){return(m=a.asyncToGenerator(e(s).mark((function t(r,n){var i;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:return i=Array.isArray(r)?r.map((function(e){return(0,o.isSome)(e.geometry)&&e.geometry.spatialReference})):[r],e.next=5,(0,u.initializeProjection)(i.map((function(e){return{source:e,dest:n}})));case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}var g=d.bind(null,h.lngLatToXY),_=d.bind(null,h.xyToLngLat);function x(e,t,r){if(!e)return e;if(r||(r=t,t=e.spatialReference),!(0,c.isValid)(t)||!(0,c.isValid)(r)||(0,c.equals)(t,r))return e;if((0,h.canProject)(t,r)){var n=(0,c.isWebMercator)(r)?g(e):_(e);return n.spatialReference=r,n}return(0,u.projectMany)(l.jsonAdapter,[e],t,r,null)[0]}var b=new(function(){"use strict";function t(){a.classCallCheck(this,t),this._jobs=[],this._timer=null,this._process=this._process.bind(this)}return a.createClass(t,[{key:"push",value:function(t,r,n){var i=this;return a.asyncToGenerator(e(s).mark((function a(){var o;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.length&&r&&n&&!(0,c.equals)(r,n)){e.next=2;break}return e.abrupt("return",t);case 2:return o={geometries:t,inSpatialReference:r,outSpatialReference:n,resolve:null},e.abrupt("return",(i._jobs.push(o),new Promise((function(e){o.resolve=e,null===i._timer&&(i._timer=setTimeout(i._process,10))}))));case 4:case"end":return e.stop()}}),a)})))()}},{key:"_process",value:function(){this._timer=null;var e=this._jobs.shift();if(e){var t=e.geometries,r=e.inSpatialReference,n=e.outSpatialReference,i=e.resolve;(0,h.canProject)(r,n)?(0,c.isWebMercator)(n)?i(t.map(g)):i(t.map(_)):i((0,u.projectMany)(l.jsonAdapter,t,r,n,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}}}]),t}());function T(e,t,r){return b.push(e,t,r)}})),r.register("ibKgR",(function(e,n){t(e.exports,"toQuantizationTransform",(function(){return c})),t(e.exports,"quantizePoint",(function(){return _})),t(e.exports,"quantizeGeometry",(function(){return T})),t(e.exports,"unquantizeMultipoint",(function(){return S})),t(e.exports,"unquantizePoint",(function(){return C})),t(e.exports,"unquantizePolygon",(function(){return k})),t(e.exports,"unquantizePolyline",(function(){return I}));var i=r("8TSCy"),a=r("7qybv"),s=r("79LpT");var o=function(e,t,r){return[t,r]},u=function(e,t,r){return[t,r,e[2]]},l=function(e,t,r){return[t,r,e[2],e[3]]};function c(e){return e?{originPosition:"upper-left"===e.originPosition?"upperLeft":"lower-left"===e.originPosition?"lowerLeft":e.originPosition,scale:e.tolerance?[e.tolerance,e.tolerance]:[1,1],translate:(0,a.isSome)(e.extent)?[e.extent.xmin,e.extent.ymax]:[0,0]}:null}function h(e,t){var r=e.scale,n=e.translate;return Math.round((t-n[0])/r[0])}function f(e,t){var r=e.scale,n=e.translate;return Math.round((n[1]-t)/r[1])}function d(e,t,r){for(var n,i,a,s,o=[],u=0;u<r.length;u++){var l=r[u];u>0?(a=h(e,l[0]),s=f(e,l[1]),a===n&&s===i||(o.push(t(l,a-n,s-i)),n=a,i=s)):(n=h(e,l[0]),i=f(e,l[1]),o.push(t(l,n,i)))}return o.length>0?o:null}function v(e,t){var r=e.scale,n=e.translate;return t*r[0]+n[0]}function p(e,t){var r=e.scale;return e.translate[1]-t*r[1]}function y(e,t,r){var n=new Array(r.length);if(!r.length)return n;var a=i.slicedToArray(e.scale,2),s=a[0],o=a[1],u=v(e,r[0][0]),l=p(e,r[0][1]);n[0]=t(r[0],u,l);for(var c=1;c<r.length;c++){var h=r[c];u+=h[0]*s,l-=h[1]*o,n[c]=t(h,u,l)}return n}function m(e,t,r){for(var n=new Array(r.length),i=0;i<r.length;i++)n[i]=y(e,t,r[i]);return n}function g(e,t,r,n,i){return t.points=(a=e,s=r.points,c=i,d(a,n?c?l:u:c?u:o,s)),t;var a,s,c}function _(e,t,r,n,i){return t.x=h(e,r.x),t.y=f(e,r.y),t!==r&&(n&&(t.z=r.z),i&&(t.m=r.m)),t}function x(e,t,r,n,i){var a=function(e,t,r,n){for(var i=[],a=r?n?l:u:n?u:o,s=0;s<t.length;s++){var c=d(e,a,t[s]);c&&c.length>=3&&i.push(c)}return i.length?i:null}(e,r.rings,n,i);return a?(t.rings=a,t):null}function b(e,t,r,n,i){var a=function(e,t,r,n){for(var i=[],a=r?n?l:u:n?u:o,s=0;s<t.length;s++){var c=d(e,a,t[s]);c&&c.length>=2&&i.push(c)}return i.length?i:null}(e,r.paths,n,i);return a?(t.paths=a,t):null}function T(e,t){return e&&t?(0,s.isPoint)(t)?_(e,{},t,!1,!1):(0,s.isPolyline)(t)?b(e,{},t,!1,!1):(0,s.isPolygon)(t)?x(e,{},t,!1,!1):(0,s.isMultipoint)(t)?g(e,{},t,!1,!1):(0,s.isExtent)(t)?(a=!1,o=!1,(n={}).xmin=h(r=e,(i=t).xmin),n.ymin=f(r,i.ymin),n.xmax=h(r,i.xmax),n.ymax=f(r,i.ymax),n!==i&&(a&&(n.zmin=i.zmin,n.zmax=i.zmax),o&&(n.mmin=i.mmin,n.mmax=i.mmax)),n):null:null;var r,n,i,a,o}function S(e,t,r,n,i){return(0,a.isSome)(r)&&(t.points=(s=e,c=r.points,h=i,y(s,n?h?l:u:h?u:o,c))),t;var s,c,h}function C(e,t,r,n,i){return(0,a.isNone)(r)||(t.x=v(e,r.x),t.y=p(e,r.y),t!==r&&(n&&(t.z=r.z),i&&(t.m=r.m))),t}function k(e,t,r,n,i){return(0,a.isSome)(r)&&(t.rings=(s=e,c=r.rings,h=i,m(s,n?h?l:u:h?u:o,c))),t;var s,c,h}function I(e,t,r,n,i){return(0,a.isSome)(r)&&(t.paths=(s=e,c=r.paths,h=i,m(s,n?h?l:u:h?u:o,c))),t;var s,c,h}}))}();
//# sourceMappingURL=FeatureServiceSnappingSourceWorker.c3da701c.js.map
