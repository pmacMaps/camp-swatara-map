{"mappings":"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","sources":["node_modules/@arcgis/core/layers/save/featureLayerUtils.js","node_modules/@arcgis/core/core/accessorSupport/originUtils.js","node_modules/@arcgis/core/core/multiOriginJSONSupportUtils.js","node_modules/@arcgis/core/layers/support/fetchService.js","node_modules/@arcgis/core/support/requestPresets.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{difference as e}from\"../../core/arrayUtils.js\";import t from\"../../core/Error.js\";import r from\"../../core/Logger.js\";import{debounce as a,eachAlways as o}from\"../../core/promiseUtils.js\";import{updateOrigins as l}from\"../../core/accessorSupport/originUtils.js\";import s from\"../FeatureLayer.js\";import{parse as n}from\"../support/arcgisLayerUrl.js\";import{fetchFeatureService as i}from\"../support/fetchService.js\";import{isFeatureCollectionLayer as u,isFeatureServiceLayer as p}from\"../support/layerUtils.js\";import c from\"../../portal/Portal.js\";import d from\"../../portal/PortalItem.js\";import{createForItemWrite as y}from\"../../portal/support/jsonContext.js\";import{addTypeKeyword as m,TypeKeyword as f,getWGS84ExtentForItem as w,removeTypeKeyword as h}from\"../../portal/support/portalItemUtils.js\";const v=r.getLogger(\"esri.layers.FeatureLayer\"),b=\"Feature Service\";function I(e,t){return`Layer (title: ${e.title}, id: ${e.id}) of type '${e.declaredClass}' ${t}`}function S(e,r){if(r.type!==b)throw new t(\"feature-layer:portal-item-wrong-type\",I(e,`should have portal item of type \"${b}\"`))}async function g(e){if(await e.load(),u(e))throw new t(\"feature-layer:save\",I(e,\"using an in-memory source cannot be saved to a portal item\"))}function j(e,r){let a=(e.messages??[]).filter((({type:e})=>\"error\"===e)).map((({name:e,message:r,details:a})=>new t(e,r,a)));if(r?.ignoreUnsupported&&(a=a.filter((({name:e})=>\"layer:unsupported\"!==e&&\"symbol:unsupported\"!==e&&\"symbol-layer:unsupported\"!==e&&\"property:unsupported\"!==e&&\"url:unsupported\"!==e))),a.length>0)throw new t(\"feature-layer:save\",\"Failed to save feature layer due to unsupported or invalid content. See 'details.errors' for more detailed information\",{errors:a})}async function L(e,t,r){\"beforeSave\"in e&&\"function\"==typeof e.beforeSave&&await e.beforeSave();const a=e.write({},t);return j(t,r),a}function P(e){const{layer:t,layerJSON:r}=e;return t.isTable?{layers:[],tables:[r]}:{layers:[r],tables:[]}}function J(e){m(e,f.JSAPI),e.typeKeywords&&(e.typeKeywords=e.typeKeywords.filter(((e,t,r)=>r.indexOf(e)===t)))}function N(e){const r=e.portalItem;if(!r)throw v.error(\"save: requires the portalItem property to be set\"),new t(\"feature-layer:portal-item-not-set\",I(e,\"requires the portalItem property to be set\"));if(!r.loaded)throw new t(\"feature-layer:portal-item-not-loaded\",I(e,\"cannot be saved to a portal item that does not exist or is inaccessible\"));S(e,r)}async function O(e,t){return/\\/\\d+\\/?$/.test(e.url??\"\")?P(t[0]):E(e,t)}async function E(e,t){const{layer:{url:r,customParameters:a,apiKey:o}}=t[0];let l=await e.fetchData(\"json\");l&&null!=l.layers&&null!=l.tables||(l=await T(l,{url:r??\"\",customParameters:a,apiKey:o},t.map((e=>e.layer.layerId))));for(const s of t)A(s.layer,s.layerJSON,l);return l}async function T(e,t,r){e||={},e.layers||=[],e.tables||=[];const{url:a,customParameters:o,apiKey:l}=t,{serviceJSON:s,layersJSON:n}=await i(a,{customParameters:o,apiKey:l}),u=$(e.layers,s.layers,r),p=$(e.tables,s.tables,r);e.layers=u.itemResources,e.tables=p.itemResources;const c=[...u.added,...p.added],d=n?[...n.layers,...n.tables]:[];return await x(e,c,a,d),e}function $(t,r,a){const o=e(t,r,((e,t)=>e.id===t.id));t=t.filter((e=>!o.removed.some((t=>t.id===e.id))));const l=o.added.map((({id:e})=>({id:e})));return l.forEach((({id:e})=>{t.push({id:e})})),{itemResources:t,added:l.filter((({id:e})=>!a.includes(e)))}}async function x(e,t,r,a){const l=t.map((({id:e})=>new s({url:r,layerId:e,sourceJSON:a.find((({id:t})=>t===e))})));await o(l.map((e=>e.load()))),l.forEach((t=>{const{layerId:r,loaded:a,defaultPopupTemplate:o}=t;if(!a||null==o)return;A(t,{id:r,popupInfo:o.toJSON()},e)}))}function A(e,t,r){e.isTable?U(r.tables,t):U(r.layers,t)}function U(e,t){if(!e)return;const r=e.findIndex((({id:e})=>e===t.id));-1===r?e.push(t):e[r]=t}function K(e){const{portalItem:t}=e;return p(e)&&!e.dynamicDataSource&&!!t?.loaded&&t.type===b}async function F(e){if(!e?.length)throw new t(\"feature-layer-utils-saveall:missing-parameters\",\"'layers' array should contain at least one feature layer\");await Promise.all(e.map((e=>e.load())));for(const o of e)if(!K(o))throw new t(\"feature-layer-utils-saveall:invalid-parameters\",`'layers' array should only contain layers or tables in a feature service loaded from 'Feature Service' item. ${I(o,\"does not conform\")}`,{layer:o});const r=e.map((e=>e.portalItem.id));if(new Set(r).size>1)throw new t(\"feature-layer-utils-saveall:invalid-parameters\",\"All layers in the 'layers' array should be loaded from the same portal item\");const a=e.map((e=>e.layerId));if(new Set(a).size!==a.length)throw new t(\"feature-layer-utils-saveall:invalid-parameters\",\"'layers' array should contain only one instance each of layer or table in a feature service\")}function R(e,t){let r=d.from(t);return r.id&&(r=r.clone(),r.id=null),r.type??=b,r.portal??=c.getDefault(),S(e,r),r}async function D(e,t){const{url:r,layerId:a,title:o,fullExtent:l,isTable:s}=e,i=n(r),u=null!=i&&\"FeatureServer\"===i.serverType;t.url=u?r:`${r}/${a}`,t.title||=o,t.extent=null,s||null==l||(t.extent=await w(l)),h(t,f.METADATA),h(t,f.MULTI_LAYER),m(t,f.SINGLE_LAYER),s&&m(t,f.TABLE),J(t)}async function q(e,t,r){const a=e.portal;await(a?.signIn()),await(a?.user?.addItem({item:e,data:t,folder:r?.folder}))}const z=a(C);async function C(e,t){await g(e),N(e);const r=e.portalItem,a=y(r),o=await L(e,a,t),s=await O(r,[{layer:e,layerJSON:o}]);return J(r),await r.update({data:s}),l(a),r}const M=a((async(e,t)=>{await F(e);const r=e[0].portalItem,a=y(r),o=await Promise.all(e.map((e=>L(e,a,t)))),s=await O(r,e.map(((e,t)=>({layer:e,layerJSON:o[t]}))));return J(r),await r.update({data:s}),await Promise.all(e.slice(1).map((e=>e.portalItem.reload()))),l(a),r.clone()})),Y=a(_);async function _(e,t,r){await g(e);const a=R(e,t),o=y(a),s=P({layer:e,layerJSON:await L(e,o,r)});return await D(e,a),await q(a,s,r),e.portalItem=a,l(o),a}export{z as save,M as saveAll,Y as saveAs};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{isMultiOriginJSONMixin as r}from\"../multiOriginJSONSupportUtils.js\";function i(i){i&&i.writtenProperties&&i.writtenProperties.forEach((({target:i,propName:t,newOrigin:e})=>{r(i)&&e&&i.originOf(t)!==e&&i.updateOrigin(t,e)}))}export{i as updateOrigins};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nfunction i(i){return i&&\"getAtOrigin\"in i&&\"originOf\"in i}export{i as isMultiOriginJSONMixin};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{fetchArcGISServiceJSON as e}from\"../../support/requestPresets.js\";async function r(r,s){const a=await e(r,s);a.layers=a.layers.filter(t);const n={serviceJSON:a};if((a.currentVersion??0)<10.5)return n;const i=await e(r+\"/layers\",s);return n.layersJSON={layers:i.layers.filter(t),tables:i.tables},n}function t(e){return!e.type||\"Feature Layer\"===e.type}export{r as fetchFeatureService};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport e from\"../request.js\";async function t(t,o){const{data:r}=await e(t,{responseType:\"json\",query:{f:\"json\",...o?.customParameters,token:o?.apiKey}});return r}export{t as fetchArcGISServiceJSON};\n"],"names":["$c60bdef17c1d33f1$var$_e","$c60bdef17c1d33f1$var$_e1","$c60bdef17c1d33f1$var$_r","$c60bdef17c1d33f1$var$_r1","$c60bdef17c1d33f1$var$_t","$lNwWH","parcelRequire","$c60bdef17c1d33f1$var$v","$jHOLN","default","getLogger","$c60bdef17c1d33f1$var$b","$c60bdef17c1d33f1$var$I","e","t","title","id","declaredClass","$c60bdef17c1d33f1$var$S","r","type","$kyj08","async","$c60bdef17c1d33f1$var$g","load","$d1ImW","isFeatureCollectionLayer","$c60bdef17c1d33f1$var$L","beforeSave","a","write","_messages","messages","filter","map","name","message","details","ignoreUnsupported","length","errors","$c60bdef17c1d33f1$var$j","$c60bdef17c1d33f1$var$P","layer","layerJSON","isTable","layers","tables","$c60bdef17c1d33f1$var$J","$7Kuhs","addTypeKeyword","TypeKeyword","JSAPI","typeKeywords","indexOf","$c60bdef17c1d33f1$var$O","_url","test","url","customParameters","apiKey","o","l","fetchData","serviceJSON","s","layersJSON","n","$Hse1P","fetchFeatureService","u","$c60bdef17c1d33f1$var$$","p","itemResources","c","added","d","$g15Jq","layerId","sourceJSON","find","$10vEZ","eachAlways","forEach","loaded","defaultPopupTemplate","$c60bdef17c1d33f1$var$A","popupInfo","toJSON","$c60bdef17c1d33f1$var$x","$c60bdef17c1d33f1$var$T","$c60bdef17c1d33f1$var$E","difference","removed","some","push","includes","$c60bdef17c1d33f1$var$U","findIndex","$c60bdef17c1d33f1$var$K","portalItem","isFeatureServiceLayer","dynamicDataSource","$c60bdef17c1d33f1$export$a1544dad697b423d","debounce","error","$c60bdef17c1d33f1$var$N","$UdTKD","createForItemWrite","update","data","$amEsL","updateOrigins","Promise","all","Set","size","$c60bdef17c1d33f1$var$F","slice","reload","clone","$c60bdef17c1d33f1$export$2bc2a80e311129ac","$iYaGG","from","_type","_portal","portal","$ajJOT","getDefault","$c60bdef17c1d33f1$var$R","fullExtent","i","$lmu5w","parse","serverType","extent","getWGS84ExtentForItem","removeTypeKeyword","METADATA","MULTI_LAYER","SINGLE_LAYER","TABLE","$c60bdef17c1d33f1$var$D","ref","signIn","user","addItem","item","folder","$c60bdef17c1d33f1$var$q","$arTQ0","$78bb5893f129cf8f$export$3437e8e38d02a5f0","writtenProperties","target","propName","newOrigin","isMultiOriginJSONMixin","originOf","updateOrigin","$79b7bd3a8b7f701b$export$3872c8e43f6916e8","$8I1KP","$0829e9379442d38c$export$ed7913757383bb7f","fetchArcGISServiceJSON","$0829e9379442d38c$var$t","_currentVersion","currentVersion","$9pNSx","$6573cb2b2cf773f0$export$5eb6d69d0c7c3def","responseType","query","f","token"],"version":3,"file":"featureLayerUtils.2ef4e790.js.map"}