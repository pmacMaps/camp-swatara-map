function e(e,r,t,a){Object.defineProperty(e,r,{get:t,set:a,enumerable:!0,configurable:!0})}var r=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire594f;r.register("3tlM3",(function(t,a){e(t.exports,"fromItem",(function(){return c})),e(t.exports,"selectLayerClassPath",(function(){return y}));var n=r("bPmsI"),o=r("kNV68"),s=r("h7Mrf"),i=r("g5jKg"),l=r("g0k3L"),u=r("7TC5p");function c(e){return!e.portalItem||e.portalItem instanceof s.default||(e={...e,portalItem:new(0,s.default)(e.portalItem)}),(r=e.portalItem,r.load().then(y).then(p)).then((r=>{const t={portalItem:e.portalItem,...r.properties},a=r.constructor;return Promise.resolve(new a(t))}));var r}function y(e){switch(e.type){case"Map Service":return(t=e,(0,u.requestArcGISServiceJSON)(t.url).then((e=>e.tileInfo))).then((e=>e?{className:"TileLayer"}:{className:"MapImageLayer"}));case"Feature Service":return d(e).then((e=>{if("object"==typeof e){const r={};return null!=e.id&&(r.layerId=e.id),{className:"FeatureLayer",properties:r}}return{className:"GroupLayer"}}));case"Feature Collection":return async function(e){if(await e.load(),(0,l.hasTypeKeyword)(e,"Map Notes"))return{className:"MapNotesLayer"};if((0,l.hasTypeKeyword)(e,"Route Layer"))return{className:"RouteLayer"};const r=await e.fetchData();return 1===(0,i.getNumLayersAndTables)(r)?{className:"FeatureLayer"}:{className:"GroupLayer"}}(e);case"Scene Service":return d(r=e).then((e=>{if("object"==typeof e){const t={};let a;if(null!=e.id?(t.layerId=e.id,a=`${r.url}/layers/${e.id}`):a=r.url,Array.isArray(r.typeKeywords)&&r.typeKeywords.length>0){const e={IntegratedMesh:"IntegratedMeshLayer","3DObject":"SceneLayer",Point:"SceneLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};for(const t of Object.keys(e))if(-1!==r.typeKeywords.indexOf(t))return{className:e[t]}}return(0,u.requestArcGISServiceJSON)(a).then((e=>{let r="SceneLayer";const a={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};return e&&e.layerType&&a[e.layerType]&&(r=a[e.layerType]),{className:r,properties:t}}))}return!1===e?(0,u.requestArcGISServiceJSON)(r.url).then((e=>"Voxel"===(null==e?void 0:e.layerType)?{className:"VoxelLayer"}:{className:"GroupLayer"})):{className:"GroupLayer"}}));case"Image Service":return async function(e){var r,t,a;await e.load();const n=null!=(r=null==(t=e.typeKeywords)?void 0:t.map((e=>e.toLowerCase())))?r:[];if(n.indexOf("elevation 3d layer")>-1)return{className:"ElevationLayer"};if(n.indexOf("tiled imagery")>-1)return{className:"ImageryTileLayer"};const o=await e.fetchData(),s=null==o?void 0:o.layerType;return"ArcGISTiledImageServiceLayer"===s?{className:"ImageryTileLayer"}:"ArcGISImageServiceLayer"===s?{className:"ImageryLayer"}:"map"===(null==(a=(await(0,u.requestArcGISServiceJSON)(e.url)).cacheType)?void 0:a.toLowerCase())?{className:"ImageryTileLayer"}:{className:"ImageryLayer"}}(e);case"Stream Service":case"Feed":return{className:"StreamLayer"};case"Vector Tile Service":return{className:"VectorTileLayer"};case"KML":return{className:"KMLLayer"};case"WFS":return{className:"WFSLayer"};case"WMTS":return{className:"WMTSLayer"};case"WMS":return{className:"WMSLayer"};default:return Promise.reject(new(0,n.default)("portal:unknown-item-type","Unknown item type '${type}'",{type:e.type}))}var r,t}function p(e){return(0,o.layerLookupMap[e.className])().then((r=>({constructor:r,properties:e.properties})))}function d(e){return!e.url||e.url.match(/\/\d+$/)?Promise.resolve({}):e.load().then((()=>e.fetchData())).then((async r=>"Feature Service"===e.type?f(r=await(0,i.preprocessFSItemData)(r,e.url)):(0,i.getNumLayersAndTables)(r)>0?f(r):(0,u.requestArcGISServiceJSON)(e.url).then(f)))}function f(e){return 1===(0,i.getNumLayersAndTables)(e)&&{id:(0,i.getFirstLayerOrTableId)(e)}}})),r.register("kNV68",(function(t,a){e(t.exports,"layerLookupMap",(function(){return n}));const n={BingMapsLayer:async()=>(await r("bnPwL")).default,BuildingSceneLayer:async()=>(await r("9qw7n")).default,CSVLayer:async()=>(await r("cSSNo")).default,ElevationLayer:async()=>(await r("jVT1T")).default,FeatureLayer:async()=>(await r("aJz6v")).default,GroupLayer:async()=>(await r("jiLKM")).default,GeoRSSLayer:async()=>(await r("iJKsl")).default,GeoJSONLayer:async()=>(await r("cmds9")).default,ImageryLayer:async()=>(await r("6yTUN")).default,ImageryTileLayer:async()=>(await r("7Yqat")).default,IntegratedMeshLayer:async()=>(await r("fUU5a")).default,KMLLayer:async()=>(await r("eItwz")).default,MapImageLayer:async()=>(await r("2TOrI")).default,MapNotesLayer:async()=>(await r("12y9u")).default,OGCFeatureLayer:async()=>(await r("5YUGe")).default,OpenStreetMapLayer:async()=>(await r("a50gD")).default,PointCloudLayer:async()=>(await r("31oeA")).default,RouteLayer:async()=>(await r("4P330")).default,SceneLayer:async()=>(await r("34h1L")).default,StreamLayer:async()=>(await r("kWivs")).default,TileLayer:async()=>(await r("inxkO")).default,UnknownLayer:async()=>(await r("dZOHT")).default,UnsupportedLayer:async()=>(await r("dkCj2")).default,VectorTileLayer:async()=>(await r("10gGh")).default,VoxelLayer:async()=>(await r("esFMs")).default,WebTileLayer:async()=>(await r("jbcP5")).default,WFSLayer:async()=>(await r("aSi9V")).default,WMSLayer:async()=>(await r("c8WG0")).default,WMTSLayer:async()=>(await r("lbtBG")).default}})),r.register("bnPwL",(function(e,t){e.exports=import("./"+r("kyEFX").resolve("b9hr7")).then((()=>r("3pzPG")))})),r.register("9qw7n",(function(e,t){e.exports=Promise.all([import("./"+r("kyEFX").resolve("ek5ZZ")),import("./"+r("kyEFX").resolve("7MCPh"))]).then((()=>r("ymhNq")))})),r.register("cSSNo",(function(e,t){e.exports=import("./"+r("kyEFX").resolve("bsXpj")).then((()=>r("crn3X")))})),r.register("jVT1T",(function(e,t){e.exports=import("./"+r("kyEFX").resolve("dFa5l")).then((()=>r("lnTHI")))})),r.register("aJz6v",(function(e,t){e.exports=import("./"+r("kyEFX").resolve("cpDMK")).then((()=>r("iaM5n")))})),r.register("jiLKM",(function(e,t){e.exports=import("./"+r("kyEFX").resolve("jf0AH")).then((()=>r("juqKi")))})),r.register("iJKsl",(function(e,t){e.exports=import("./"+r("kyEFX").resolve("8EeGG")).then((()=>r("9RJUc")))})),r.register("cmds9",(function(e,t){e.exports=import("./"+r("kyEFX").resolve("iLaYo")).then((()=>r("6lALK")))})),r.register("6yTUN",(function(e,t){e.exports=Promise.all([import("./"+r("kyEFX").resolve("gMekQ")),import("./"+r("kyEFX").resolve("lVU1e")),import("./"+r("kyEFX").resolve("cT1yD")),import("./"+r("kyEFX").resolve("em1F7")),import("./"+r("kyEFX").resolve("2QaHH"))]).then((()=>r("fgnlN")))})),r.register("7Yqat",(function(e,t){e.exports=Promise.all([import("./"+r("kyEFX").resolve("gMekQ")),import("./"+r("kyEFX").resolve("lVU1e")),import("./"+r("kyEFX").resolve("cT1yD")),import("./"+r("kyEFX").resolve("em1F7")),import("./"+r("kyEFX").resolve("7wjLF")),import("./"+r("kyEFX").resolve("7icZl"))]).then((()=>r("bkuWn")))})),r.register("fUU5a",(function(e,t){e.exports=Promise.all([import("./"+r("kyEFX").resolve("ek5ZZ")),import("./"+r("kyEFX").resolve("ffUTp"))]).then((()=>r("3o6zT")))})),r.register("eItwz",(function(e,t){e.exports=import("./"+r("kyEFX").resolve("7isub")).then((()=>r("iQ0Vp")))})),r.register("2TOrI",(function(e,t){e.exports=import("./"+r("kyEFX").resolve("kdwC4")).then((()=>r("8aVVa")))})),r.register("12y9u",(function(e,t){e.exports=import("./"+r("kyEFX").resolve("2gcYg")).then((()=>r("9aIgb")))})),r.register("5YUGe",(function(e,t){e.exports=import("./"+r("kyEFX").resolve("jQKJK")).then((()=>r("d4pGn")))})),r.register("a50gD",(function(e,t){e.exports=import("./"+r("kyEFX").resolve("igXf8")).then((()=>r("8T7JM")))})),r.register("31oeA",(function(e,t){e.exports=Promise.all([import("./"+r("kyEFX").resolve("ek5ZZ")),import("./"+r("kyEFX").resolve("kU2iF")),import("./"+r("kyEFX").resolve("d2da2"))]).then((()=>r("9qqTC")))})),r.register("4P330",(function(e,t){e.exports=Promise.all([import("./"+r("kyEFX").resolve("iWJ3Q")),import("./"+r("kyEFX").resolve("fm839"))]).then((()=>r("3e6QC")))})),r.register("34h1L",(function(e,t){e.exports=Promise.all([import("./"+r("kyEFX").resolve("ek5ZZ")),import("./"+r("kyEFX").resolve("hr3FR"))]).then((()=>r("lnDdW")))})),r.register("kWivs",(function(e,t){e.exports=import("./"+r("kyEFX").resolve("3eC3d")).then((()=>r("icBo2")))})),r.register("inxkO",(function(e,t){e.exports=import("./"+r("kyEFX").resolve("bnaj9")).then((()=>r("3E5zb")))})),r.register("dZOHT",(function(e,t){e.exports=import("./"+r("kyEFX").resolve("6HSJT")).then((()=>r("9JOXz")))})),r.register("dkCj2",(function(e,t){e.exports=import("./"+r("kyEFX").resolve("gRtb9")).then((()=>r("5Ul18")))})),r.register("10gGh",(function(e,t){e.exports=import("./"+r("kyEFX").resolve("dXnrw")).then((()=>r("bidwN")))})),r.register("esFMs",(function(e,t){e.exports=Promise.all([import("./"+r("kyEFX").resolve("ek5ZZ")),import("./"+r("kyEFX").resolve("iQYCI"))]).then((()=>r("95Vho")))})),r.register("jbcP5",(function(e,t){e.exports=import("./"+r("kyEFX").resolve("f9Mdh")).then((()=>r("fPeKH")))})),r.register("aSi9V",(function(e,t){e.exports=Promise.all([import("./"+r("kyEFX").resolve("7G5Xn")),import("./"+r("kyEFX").resolve("ddebE"))]).then((()=>r("9xHtw")))})),r.register("c8WG0",(function(e,t){e.exports=import("./"+r("kyEFX").resolve("2HlCV")).then((()=>r("g8shS")))})),r.register("lbtBG",(function(e,t){e.exports=import("./"+r("kyEFX").resolve("jvH1l")).then((()=>r("k4wVx")))})),r.register("g5jKg",(function(t,a){e(t.exports,"load",(function(){return c})),e(t.exports,"preprocessFSItemData",(function(){return f})),e(t.exports,"getNumLayersAndTables",(function(){return v})),e(t.exports,"getFirstLayerOrTableId",(function(){return m}));var n=r("bPmsI"),o=r("kNV68"),s=r("39WmQ"),i=r("7zHk6"),l=r("4ycBe"),u=r("7TC5p");async function c(e,r){const t=e.instance.portalItem;return t&&t.id?(await t.load(r),function(e){const r=e.instance.portalItem;if(-1===e.supportedTypes.indexOf(r.type))throw new(0,n.default)("portal:invalid-layer-item-type","Invalid layer item type '${type}', expected '${expectedType}'",{type:r.type,expectedType:e.supportedTypes.join(", ")})}(e),async function(e,r){const t=e.instance,a=t.portalItem,{url:s,title:c}=a,p=(0,i.createForItem)(a);if("group"===t.type)return t.read({title:c},p),function(e,r){let t;const a=e.portalItem.type;switch(a){case"Feature Service":case"Feature Collection":t=o.layerLookupMap.FeatureLayer;break;case"Stream Service":t=o.layerLookupMap.StreamLayer;break;case"Scene Service":t=o.layerLookupMap.SceneLayer;break;default:throw new(0,n.default)("portal:unsupported-item-type-as-group",`The item type '${a}' is not supported as a 'IGroupLayer'`)}let s;return t().then((e=>(s=e,d(r)))).then((async r=>{return"Feature Service"===a?(r=await f(r,e.portalItem.url),y(e,s,r)):v(r)>0?y(e,s,r):(n=s,(t=e).portalItem.url?(0,u.requestArcGISServiceJSON)(t.portalItem.url).then((e=>{var r,a;function o(e){return{id:e.id,name:e.name}}e&&y(t,n,{layers:null==(r=e.layers)?void 0:r.map(o),tables:null==(a=e.tables)?void 0:a.map(o)})})):Promise.resolve());var t,n}))}(t,e);s&&t.read({url:s},p);const m=await d(e,r);return m&&t.read(m,p),t.resourceReferences={portalItem:a,paths:p.readResourcePaths},t.read({title:c},p),(0,l.loadStyleRenderer)(t,p)}(e,r)):Promise.resolve()}function y(e,r,t){let a=t.layers||[];const n=t.tables||[];"Feature Collection"===e.portalItem.type&&(a.forEach((e=>{var r;"Table"===(null==e||null==(r=e.layerDefinition)?void 0:r.type)&&n.push(e)})),a=a.filter((e=>{var r;return"Table"!==(null==e||null==(r=e.layerDefinition)?void 0:r.type)}))),a.reverse().forEach((a=>{const n=p(e,r,t,a);e.add(n)})),n.reverse().forEach((a=>{const n=p(e,r,t,a);e.tables.add(n)}))}function p(e,r,t,a){const n=new r({portalItem:e.portalItem.clone(),layerId:a.id,sublayerTitleMode:"service-name"});if("Feature Collection"===e.portalItem.type){const r={origin:"portal-item",portal:e.portalItem.portal||s.default.getDefault()};n.read(a,r);const o=t.showLegend;null!=o&&n.read({showLegend:o},r)}return n}function d(e,r){if(!1===e.supportsData)return Promise.resolve(void 0);const t=e.instance;return t.portalItem.fetchData("json",r).catch((()=>null)).then((async e=>{if("stream"!==(r=t).type&&"layerId"in r){let r,a=!0;return e&&v(e)>0&&(null==t.layerId&&(t.layerId=m(e)),r=function(e,r){const t=e.layers;if(t)for(let e=0;e<t.length;e++)if(t[e].id===r)return t[e];const a=e.tables;if(a)for(let e=0;e<a.length;e++)if(a[e].id===r)return a[e];return null}(e,t.layerId),r&&(1===v(e)&&(a=!1),null!=e.showLegend&&(r.showLegend=e.showLegend))),a&&"service-name"!==t.sublayerTitleMode&&(t.sublayerTitleMode="item-title-and-service-name"),r}var r;return e}))}async function f(e,r){var t,a;if(null==(null==(t=e)?void 0:t.layers)||null==(null==(a=e)?void 0:a.tables)){const t=await(0,u.requestArcGISServiceJSON)(r);(e=e||{}).layers=e.layers||(null==t?void 0:t.layers),e.tables=e.tables||(null==t?void 0:t.tables)}return e}function m(e){const r=e.layers;if(r&&r.length)return r[0].id;const t=e.tables;return t&&t.length?t[0].id:null}function v(e){var r,t,a,n;return(null!=(r=null==e||null==(t=e.layers)?void 0:t.length)?r:0)+(null!=(a=null==e||null==(n=e.tables)?void 0:n.length)?a:0)}})),r.register("7TC5p",(function(t,a){e(t.exports,"requestArcGISServiceJSON",(function(){return o}));var n=r("bYA0c");async function o(e){const{data:r}=await(0,n.default)(e,{responseType:"json",query:{f:"json"}});return r}})),r.register("g0k3L",(function(r,t){function a(e,r){return!!e.typeKeywords&&e.typeKeywords.indexOf(r)>-1}e(r.exports,"hasTypeKeyword",(function(){return a}))}));
//# sourceMappingURL=portalLayers.e889cf00.js.map
