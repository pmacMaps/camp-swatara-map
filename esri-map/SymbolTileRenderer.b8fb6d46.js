!function(){function e(e){return e&&e.__esModule?e.default:e}function t(e,t,r,n){Object.defineProperty(e,t,{get:r,set:n,enumerable:!0,configurable:!0})}var r=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire594f;r.register("3VaHl",(function(n,i){var s;s=n.exports,Object.defineProperty(s,"__esModule",{value:!0,configurable:!0}),t(n.exports,"default",(function(){return g}));var a=r("8TSCy"),u=r("2TvXO"),o=r("7eJjO"),f=r("2VlWd"),l=r("10vEZ");r("jHOLN"),r("iJAIC"),r("lNwWH"),r("62edV");var h=r("fcwIv"),c=r("8TwEW"),d=r("2rNrs"),y=r("71FC0"),v=r("aUYE0"),p=r("1Fs6Q"),_=r("CISlQ"),x=function(t){"use strict";a.inherits(n,t);var r=a.createSuper(n);function n(){return a.classCallCheck(this,n),r.apply(this,arguments)}return a.createClass(n,[{key:"install",value:function(e){var t=this,r=new(0,_.WGLFeatureView)(this.tileInfoView,this.layerView,this.layer,(function(){return t.notifyChange("updating")}));this.featuresView=r,e.addChild(r)}},{key:"uninstall",value:function(e){e.removeChild(this.featuresView),this.featuresView.destroy(),this.featuresView=null}},{key:"fetchResource",value:function(e,t){var r=e.url,n=this.featuresView.stage;try{return n.resourceManager.fetchResource(r,{signal:t.signal})}catch(e){return(0,l.isAbortError)(e)?Promise.resolve({width:0,height:0}):Promise.reject(e)}}},{key:"isUpdating",value:function(){var e,t=a.get(a.getPrototypeOf(n.prototype),"isUpdating",this).call(this),r=!this.featuresView||this.featuresView.isUpdating(),i=null==(e=this.featuresView)?void 0:e.hasEmptyAttributeView(),s=t||r||t&&i;return(0,f.default)("esri-2d-log-updating")&&console.log("Updating SymbolTileRenderer ".concat(s,"\n  -> updatingTiles ").concat(t,"\n  -> hasFeaturesView ").concat(!!this.featuresView,"\n  -> updatingFeaturesView ").concat(r)),s}},{key:"hitTest",value:function(e){return this.featuresView.hitTest(e)}},{key:"supportsRenderer",value:function(e){return null!=e&&-1!==["simple","class-breaks","unique-value","dot-density","dictionary"].indexOf(e.type)}},{key:"onConfigUpdate",value:function(e){var t=null;if("visualVariables"in e){var r=((0,y.simplifyVVRenderer)(e).visualVariables||[]).map((function(e){var t=e.clone();return"normalizationField"in e&&(t.normalizationField=null),e.valueExpression&&"$view.scale"!==e.valueExpression&&(t.valueExpression=null,t.field="nop"),t}));t=(0,p.convertVisualVariables)(r)}this.featuresView.setRendererInfo(e,t,this.layerView.featureEffect)}},{key:"onTileData",value:function(e){var t=this.tiles.get(e.tileKey);t&&e.data&&this.featuresView.onTileData(t,e.data),this.layerView.view.labelManager.requestUpdate()}},{key:"onTileError",value:function(e){var t=this.tiles.get(e.tileKey);t&&this.featuresView.onTileError(t)}},{key:"forceAttributeTextureUpload",value:function(){this.featuresView.attributeView.forceTextureUpload()}},{key:"lockGPUUploads",value:function(){this.featuresView.attributeView.lockTextureUpload(),this.tiles.forEach((function(e){return e.lock()}))}},{key:"unlockGPUUploads",value:function(){this.featuresView.attributeView.unlockTextureUpload(),this.tiles.forEach((function(e){return e.unlock()}))}},{key:"getMaterialItems",value:function(t){var r=this;return a.asyncToGenerator(e(u).mark((function n(){return e(u).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.featuresView.getMaterialItems(t));case 1:case"end":return e.stop()}}),n)})))()}},{key:"invalidateLabels",value:function(){this.featuresView.hasLabels&&this.layerView.view.labelManager.requestUpdate()}},{key:"createTile",value:function(e){var t=this,r=this.tileInfoView.getTileBounds((0,c.create)(),e);return new(0,d.FeatureTile)(e,r[0],r[3],this.featuresView.attributeView,(function(){return t.layerView.view.labelManager.requestUpdate()}))}},{key:"disposeTile",value:function(e){this.featuresView.removeChild(e),e.destroy(),this.layerView.view.labelManager.requestUpdate()}}]),n}(v.default),g=x=(0,o._)([(0,h.subclass)("esri.views.2d.layers.features.tileRenderers.SymbolTileRenderer")],x)})),r.register("2rNrs",(function(e,n){t(e.exports,"FeatureTile",(function(){return _}));var i=r("8TSCy"),s=r("gDoEW");r("2VlWd");var a=r("7qybv"),u=r("b4Wmd"),o=r("cMCBC"),f=r("hRgCq"),l=r("0P8XU"),h=r("66IJZ"),c=r("5WctK"),d=r("gINiF"),y=r("kYi9K"),v=r("62JYo"),p=0,_=function(e){"use strict";i.inherits(r,e);var t=i.createSuper(r);function r(e,n,a,u,f){var l;return i.classCallCheck(this,r),(l=t.call(this,e,n,a)).instanceId=p++,l.patchCount=0,l._renderState={current:{geometry:new Map,metrics:null},next:null,swap:!1,swapFrames:0,locked:!1},l._patches=new(0,s.default)(100),l._bufferPatches=new(0,s.default)(100),l._lastCommitTime=0,l._lastMessageWasClear=!1,l.transforms.labelMat2d=(0,o.c)(),l._store=u,l._requestLabelUpdate=f,i.possibleConstructorReturn(l)}return i.createClass(r,[{key:"destroy",value:function(){i.get(i.getPrototypeOf(r.prototype),"destroy",this).call(this),this._renderState.current.geometry.forEach((function(e){return e.destroy()}))}},{key:"labelMetrics",get:function(){return this._renderState.current.metrics}},{key:"hasData",get:function(){return!!this._renderState.current.geometry.size}},{key:"getGeometry",value:function(e){return this._renderState.current.geometry.get(e)}},{key:"setTransform",value:function(e,t){i.get(i.getPrototypeOf(r.prototype),"setTransform",this).call(this,e,t);var n=this.transforms.labelMat2d,s=e.getScreenTransform(n,t),a=(0,l.c)();(0,f.t)(a,[this.x,this.y],s),(0,u.a)(n,a),(0,u.m)(n,e.viewMat2d,n)}},{key:"patch",value:function(e,t){if(this.patchCount++,!e.clear||!this._lastMessageWasClear){this._lastMessageWasClear=e.clear,e.clear&&this._patches.size>=50&&this._dropPatches();var r=e,n=r.addOrUpdate&&this.key.id!==r.addOrUpdate.tileKeyOrigin;t&&n?this._bufferPatches.enqueue(r):(r.sort=r.sort&&!t,this._patches.enqueue(r)),this.requestRender()}}},{key:"commit",value:function(e){if(this._lastCommitTime!==e.time){this._lastCommitTime=e.time;for(var t=0;t<4;t++)this._updateMesh(),this.isReady&&this._updateBufferMesh();this._renderState.swap&&(this._swapRenderStates(),this.requestRender())}}},{key:"lock",value:function(){this._renderState.locked=!0}},{key:"unlock",value:function(){this._renderState.locked=!1,this._flushUpdates(),this._swap()}},{key:"_swapRenderStates",value:function(){if(this._renderState.next){if(this._renderState.locked)return this._renderState.swap=!0,void this.requestRender();if(this._renderState.swap=!0,0===this._renderState.swapFrames)return this._renderState.swapFrames=8,void this.requestRender();1==this._renderState.swapFrames--?this._swap():this.requestRender()}}},{key:"_swap",value:function(){this._renderState.swap&&(this._renderState.swap=!1,(0,a.isSome)(this._renderState.next)&&(this._renderState.current.geometry.forEach((function(e){return e.destroy()})),this._renderState.current=this._renderState.next,this._renderState.next=null,this._requestLabelUpdate()))}},{key:"_flushUpdates",value:function(){for(var e=this._patches.maxSize;this._patches.size&&e--;)this._updateMesh(),this._swap()}},{key:"_updateBufferMesh",value:function(){var e=this._bufferPatches.peek();if(!(0,a.isSome)(e)||!e.clear||null===this._renderState.next)for(;this._bufferPatches.size;){var t=this._bufferPatches.dequeue();(0,a.isSome)(t)&&this._patchBuffer(t)}}},{key:"_updateMesh",value:function(){var e=this._patches.peek();if(!(0,a.isSome)(e)||!e.clear||null===this._renderState.next){var t=this._patches.dequeue();if((0,a.isSome)(t)){if(!0===t.clear){if(!this.isReady)return;return this._renderState.next,void(this._renderState.next={geometry:new Map,metrics:null})}this.requestRender(),this._patch(t),t.end&&(this.ready(),this._swapRenderStates())}}}},{key:"_patch",value:function(e){var t=this;(0,c.forEachGeometryType)((function(r){t._remove(r,e.remove),t._insert(r,e,!1)}))}},{key:"_patchBuffer",value:function(e){var t=this;(0,c.forEachGeometryType)((function(r){t._insert(r,e,!0)}))}},{key:"_insert",value:function(e,t,r){try{var n,i=(0,a.unwrapOr)(this._renderState.next,this._renderState.current),s=null==(n=t.addOrUpdate)?void 0:n.data[e],u=i.geometry;if((0,a.isNone)(s))return;u.has(e)||u.set(e,new(0,v.Geometry)(e,this.stage)),u.get(e).insert(s,t.sort,r),e===h.WGLGeometryType.LABEL&&this._insertLabelMetrics(t.type,s.metrics,t.clear)}catch(e){}}},{key:"_insertLabelMetrics",value:function(e,t,r){var n=(0,a.unwrapOr)(this._renderState.next,this._renderState.current);if(!(0,a.isNone)(t)){var i=y.MetricReader.from(t);if((0,a.isNone)(n.metrics))n.metrics=i;else{if("update"===e)for(var s=i.getCursor();s.next();)n.metrics.delete(s.id);n.metrics.link(i)}}}},{key:"_remove",value:function(e,t){var r=(0,a.unwrapOr)(this._renderState.next,this._renderState.current).geometry.get(e);t&&t.length&&r&&(r.remove(t),this._removeLabelMetrics(t))}},{key:"_removeLabelMetrics",value:function(e){var t=(0,a.unwrapOr)(this._renderState.next,this._renderState.current).metrics,r=!0,n=!1,i=void 0;if(!(0,a.isNone)(t)&&e.length)try{for(var s,u=e[Symbol.iterator]();!(r=(s=u.next()).done);r=!0)for(var o=s.value;t.delete(o););}catch(e){n=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(n)throw i}}}},{key:"_dropPatches",value:function(){for(var e=this,t=new Array,r=!1;this._patches.size;){var n=this._patches.dequeue();if((0,a.isNone)(n))break;if(n.clear){if(r)break;r=!0}t.push(n)}this._patches.clear(),t.forEach((function(t){return e._patches.enqueue(t)}))}}]),r}(d.WGLTile)})),r.register("gDoEW",(function(e,n){t(e.exports,"default",(function(){return a}));var i=r("8TSCy"),s=r("7qybv"),a=function(){"use strict";function e(t){i.classCallCheck(this,e),this.size=0,this._start=0,this.maxSize=t,this._buffer=new Array(t)}return i.createClass(e,[{key:"entries",get:function(){return this._buffer}},{key:"enqueue",value:function(e){if(this.size===this.maxSize){var t=this._buffer[this._start];return this._buffer[this._start]=e,this._start=(this._start+1)%this.maxSize,t}return this._buffer[(this._start+this.size++)%this.maxSize]=e,null}},{key:"dequeue",value:function(){if(0===this.size)return null;var e=this._buffer[this._start];return this._buffer[this._start]=null,this.size--,this._start=(this._start+1)%this.maxSize,e}},{key:"peek",value:function(){return 0===this.size?null:this._buffer[this._start]}},{key:"find",value:function(e){if(0===this.size)return null;var t=!0,r=!1,n=void 0;try{for(var i,a=this._buffer[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var u=i.value;if((0,s.isSome)(u)&&e(u))return u}}catch(e){r=!0,n=e}finally{try{t||null==a.return||a.return()}finally{if(r)throw n}}return null}},{key:"clear",value:function(e){for(var t=this.dequeue();(0,s.isSome)(t);)e&&e(t),t=this.dequeue()}}]),e}()})),r.register("kYi9K",(function(e,n){t(e.exports,"MetricReader",(function(){return u}));var i=r("8TSCy"),s=r("7qybv"),a=4294967296,u=function(){"use strict";function e(t){i.classCallCheck(this,e),this._head=t,this._cursor=t}return i.createClass(e,[{key:"id",get:function(){return this._cursor.id}},{key:"baseZoom",get:function(){return this._cursor.baseZoom}},{key:"anchorX",get:function(){return this._cursor.anchorX}},{key:"anchorY",get:function(){return this._cursor.anchorY}},{key:"directionX",get:function(){return this._cursor.directionX}},{key:"directionY",get:function(){return this._cursor.directionY}},{key:"size",get:function(){return this._cursor.size}},{key:"materialKey",get:function(){return this._cursor.materialKey}},{key:"boundsCount",get:function(){return this._cursor.boundsCount}},{key:"computedMinZoom",value:function(){return this._cursor.computedMinZoom()}},{key:"setComputedMinZoom",value:function(e){return this._cursor.setComputedMinZoom(e)}},{key:"boundsComputedAnchorX",value:function(e){return this._cursor.boundsComputedAnchorX(e)}},{key:"boundsComputedAnchorY",value:function(e){return this._cursor.boundsComputedAnchorY(e)}},{key:"setBoundsComputedAnchorX",value:function(e,t){return this._cursor.setBoundsComputedAnchorX(e,t)}},{key:"setBoundsComputedAnchorY",value:function(e,t){return this._cursor.setBoundsComputedAnchorY(e,t)}},{key:"boundsX",value:function(e){return this._cursor.boundsX(e)}},{key:"boundsY",value:function(e){return this._cursor.boundsY(e)}},{key:"boundsWidth",value:function(e){return this._cursor.boundsWidth(e)}},{key:"boundsHeight",value:function(e){return this._cursor.boundsHeight(e)}},{key:"link",value:function(e){if((0,s.isSome)(e._head))return this._cursor.link(e._head)}},{key:"getCursor",value:function(){return this.copy()}},{key:"copy",value:function(){var t,r=new e(null==(t=this._head)?void 0:t.copy());if(!r._head)return r;for(var n=r._head,i=r._head._link;i;)n._link=i.copy(),i=(n=i)._link;return r}},{key:"peekId",value:function(){var e;return null!=(e=this._cursor.peekId())?e:this._cursor._link.peekId()}},{key:"nextId",value:function(){for(var e=this.id;e===this.id;)if(!this.next())return!1;return!0}},{key:"save",value:function(){this._savedCursor=this._cursor,this._savedOffset=this._cursor._offset}},{key:"restore",value:function(){this._cursor=this._savedCursor,this._cursor._offset=this._savedOffset}},{key:"next",value:function(){if(!this._cursor)return!1;if(!this._cursor.next()){if(!this._cursor._link)return!1;this._cursor=this._cursor._link,this._cursor._offset=0}return!0}},{key:"lookup",value:function(e){for(this._cursor=this._head;this._cursor&&!this._cursor.lookup(e);){if(!this._cursor._link)return!1;this._cursor=this._cursor._link}return!!this._cursor}},{key:"delete",value:function(e){for(var t=this._head,r=null;t;){if(t.delete(e))return t.isEmpty()&&(0,s.isSome)(r)&&(r._link=t._link),!0;r=t,t=t._link}return!1}}],[{key:"from",value:function(t){return new e(o.from(new Float32Array(t)))}}]),e}(),o=function(){"use strict";function e(t){i.classCallCheck(this,e),this._offset=-1,this._link=null,this._count=0,this._deletedCount=0,this._offsets={instance:null},this._buffer=t}return i.createClass(e,[{key:"isEmpty",value:function(){return this._deletedCount===this.count}},{key:"count",get:function(){return this._count||(this._count=this._computeCount()),this._count}},{key:"id",get:function(){return this._buffer[this._offset+0]},set:function(e){this._buffer[this._offset+0]=e}},{key:"baseZoom",get:function(){return this._buffer[this._offset+1]}},{key:"anchorX",get:function(){return this._buffer[this._offset+2]}},{key:"anchorY",get:function(){return this._buffer[this._offset+3]}},{key:"directionX",get:function(){return this._buffer[this._offset+4]}},{key:"directionY",get:function(){return this._buffer[this._offset+5]}},{key:"size",get:function(){return this._buffer[this._offset+6]}},{key:"materialKey",get:function(){return this._buffer[this._offset+7]}},{key:"computedMinZoom",value:function(){return this._buffer[this._offset+8]}},{key:"setComputedMinZoom",value:function(e){this._buffer[this._offset+8]=e}},{key:"boundsCount",get:function(){return this._buffer[this._offset+9]}},{key:"boundsComputedAnchorX",value:function(e){return this._buffer[this._offset+10+6*e+0]}},{key:"boundsComputedAnchorY",value:function(e){return this._buffer[this._offset+10+6*e+1]}},{key:"setBoundsComputedAnchorX",value:function(e,t){this._buffer[this._offset+10+6*e+0]=t}},{key:"setBoundsComputedAnchorY",value:function(e,t){this._buffer[this._offset+10+6*e+1]=t}},{key:"boundsX",value:function(e){return this._buffer[this._offset+10+6*e+2]}},{key:"boundsY",value:function(e){return this._buffer[this._offset+10+6*e+3]}},{key:"boundsWidth",value:function(e){return this._buffer[this._offset+10+6*e+4]}},{key:"boundsHeight",value:function(e){return this._buffer[this._offset+10+6*e+5]}},{key:"link",value:function(e){for(var t=this;t._link;)t=t._link;t._link=e}},{key:"getCursor",value:function(){return this.copy()}},{key:"copy",value:function(){var t=new e(this._buffer);return t._link=this._link,t._offset=this._offset,t._deletedCount=this._deletedCount,t._offsets=this._offsets,t._count=this._count,t}},{key:"peekId",value:function(){var e=this._offset+10+6*this.boundsCount+0;return e>=this._buffer.length?0:this._buffer[e]}},{key:"next",value:function(){for(var e=0;this._offset<this._buffer.length&&e++<100&&(-1===this._offset?this._offset=0:this._offset+=10+6*this.boundsCount,this.id===a););return this.id!==a&&this._offset<this._buffer.length}},{key:"delete",value:function(e){var t=this._offset,r=this.lookup(e);if(r)for(this.id=4294967295,++this._deletedCount;this.next()&&this.id===e;)this.id=4294967295,++this._deletedCount;return this._offset=t,r}},{key:"lookup",value:function(e){var t=this._offset;if((0,s.isNone)(this._offsets.instance)){this._offsets.instance=new Map;var r=this.copy();r._offset=-1;for(var n=0;r.next();)r.id!==n&&(this._offsets.instance.set(r.id,r._offset),n=r.id)}return!!this._offsets.instance.has(e)&&(this._offset=this._offsets.instance.get(e),this.id!==a||(this._offset=t,!1))}},{key:"_computeCount",value:function(){var e=this._offset,t=0;for(this._offset=-1;this.next();)t++;return this._offset=e,t}}],[{key:"from",value:function(t){return new e(new Float32Array(t))}}]),e}()})),r.register("62JYo",(function(e,n){t(e.exports,"Geometry",(function(){return l}));var i=r("8TSCy"),s=r("7qybv"),a=r("PG6ua"),u=r("hDjOj"),o=r("kgLNq"),f=r("4aQus"),l=function(){"use strict";function e(t,r){i.classCallCheck(this,e),this._vaos=new Map,this._indicesInvalid=!1,this.geometryType=t}return i.createClass(e,[{key:"destroy",value:function(){var e=!0,t=!1,r=void 0;try{for(var n,a=this._vaos[Symbol.iterator]();!(e=(n=a.next()).done);e=!0){var u=i.slicedToArray(n.value,2),o=(u[0],u[1]);(0,s.isSome)(o)&&o.dispose(!1)}}catch(e){t=!0,r=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw r}}this._indexBuffer=(0,s.destroyMaybe)(this._indexBuffer),this._vertexBuffer=(0,s.destroyMaybe)(this._vertexBuffer)}},{key:"insert",value:function(e,t,r){if(e.records.byteLength){var n=e.stride;if(this._vertexBuffer&&this._indexBuffer){var i=e.indices.byteLength/4,a=e.vertices.byteLength/n;this._indexBuffer.ensure(i),this._vertexBuffer.ensure(a);var f=e.vertices,l=e.indices,h=o.DisplayRecordReader.from(e.records),c=this._vertexBuffer.insert(f,0,f.byteLength/n,0),d=this._indexBuffer.insert(l,0,l.byteLength/4,c);if(h.forEach((function(e){e.indexFrom+=d,e.vertexFrom+=c})),(0,s.unwrapOrThrow)(this._records,"Expected records to be defined").link(h),t)this._indicesInvalid=!0;else if(this._displayList)for(var y=h.getCursor();y.next();)this._displayList.addRecord(y)}else{var v=e.indices.byteLength/4,p=e.vertices.byteLength/n,_=n/Uint32Array.BYTES_PER_ELEMENT;this._records=o.DisplayRecordReader.from(e.records),this._indexBuffer=new(0,u.Buffer)("index",v,1),this._vertexBuffer=new(0,u.Buffer)("vertex",p,_),this._indexBuffer.insert(e.indices,0,e.indices.byteLength/4,0),this._vertexBuffer.insert(e.vertices,0,e.vertices.byteLength/n,0),t&&(this._indicesInvalid=!0)}}}},{key:"remove",value:function(e){var t=!0,r=!1,n=void 0;if(!(0,s.isNone)(this._records))try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var u=i.value,o=this._records.getCursor();if(o.lookup(u)){for(var f=o.indexFrom,l=o.vertexFrom,h=o.indexCount,c=o.vertexCount;o.next()&&o.id===u;)h+=o.indexCount,c+=o.vertexCount;this._indexBuffer.free(f,h),this._vertexBuffer.free(l,c,!0),this._records.delete(u)}}}catch(e){r=!0,n=e}finally{try{t||null==a.return||a.return()}finally{if(r)throw n}}}},{key:"getVAO",value:function(e,t,r,n){if(!this._vertexBuffer||!this._indexBuffer||(0,s.isNone)(this._records)||!this._vertexBuffer.bufferSize)return null;var i=n?1:0,a=this._vaos.get(i);(this._vertexBuffer.invalidated||this._indexBuffer.invalidated)&&((0,s.applySome)(a,(function(e){return e.dispose(!1)})),a=null),this._vertexBuffer.upload(),this._indexBuffer.upload();var u=this._indexBuffer.getGPUBuffer(e,1===i),o=this._vertexBuffer.getGPUBuffer(e);return a||(a=new(0,f.VertexArrayObject)(e,r,t,{geometry:o},u),this._vaos.set(i,a)),a}},{key:"forEachCommand",value:function(e){if(!(0,s.isNone)(this._records)){if(this._sortIndices(this._records),!this._displayList){var t=this._cursorIndexOrder;this._displayList=a.FeatureDisplayList.from(this,this.geometryType,this._records.getCursor(),t)}this._displayList.forEach(e)}}},{key:"_sortIndices",value:function(e){var t=!!this._indexBuffer.bufferSize;if(this._indicesInvalid){this._indicesInvalid=!1;for(var r=0,n=e.getCursor(),i=[],s=[],a=[];n.next();)s.push(n.index),a.push(n.sortKey),i.push(n.id);s.sort((function(e,t){var r=a[t],n=a[e];return n===r?i[t]-i[e]:r-n}));var u=e.getCursor(),o=t?this._indexBuffer.getCPUBuffer():this._vertexBuffer.getCPUBuffer(),f=!0,l=!1,h=void 0;try{for(var c,d=s[Symbol.iterator]();!(f=(c=d.next()).done);f=!0){var y=c.value;if(!u.seekIndex(y))throw new Error("Expected to find index");if(t){var v=u.indexFrom,p=u.indexCount;u.indexFrom=r;for(var _=0;_<p;_++)this._indexBuffer.set(r++,o.array[v+_])}else{var x=u.vertexFrom,g=u.vertexCount,k=this._vertexBuffer.strideInt,m=x*k,b=m+g*k;u.vertexFrom=r/k;for(var w=m;w<b;w++)this._vertexBuffer.set(r++,o.array[w])}}}catch(e){l=!0,h=e}finally{try{f||null==d.return||d.return()}finally{if(l)throw h}}this._cursorIndexOrder=s,this._displayList=null}}}]),e}()})),r.register("PG6ua",(function(n,i){t(n.exports,"FeatureDisplayList",(function(){return l}));var s=r("8TSCy"),a=r("2TvXO"),u=r("7qybv"),o=r("dmaN0"),f=function(){"use strict";function e(t,r,n,i,a){s.classCallCheck(this,e),this.target=t,this.geometryType=r,this.materialKey=n,this.indexFrom=i,this.indexCount=a}return s.createClass(e,[{key:"indexEnd",get:function(){return this.indexFrom+this.indexCount}},{key:"extend",value:function(e){this.indexCount+=e}}]),e}(),l=function(){"use strict";function t(e,r){s.classCallCheck(this,t),this.geometryType=0,this._target=e,this.geometryType=r}return s.createClass(t,[{key:"addRecord",value:function(e){var t=this._target,r=this.geometryType,n=e.materialKey,i=e.indexFrom,s=e.indexCount,a=e.vertexFrom,l=e.vertexCount;if(s||(i=a,s=l),(0,u.isNone)(this._head)){var h=new f(t,r,n,i,s);this._head=new(0,o.List)(h)}else{for(var c=null,d=this._head;d;){if(i<d.data.indexFrom)return this._insert(n,i,s,c,d);c=d,d=d.next}this._insert(n,i,s,c,null)}}},{key:"forEach",value:function(e){(0,u.isSome)(this._head)&&this._head.forEach(e)}},{key:"infos",value:e(a).mark((function t(){var r,n,i,s,o,f;return e(a).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=!0,n=!1,i=void 0,!(0,u.isSome)(this._head)){e.next=25;break}e.prev=2,s=this._head.values()[Symbol.iterator]();case 4:if(r=(o=s.next()).done){e.next=11;break}return f=o.value,e.next=8,f;case 8:r=!0,e.next=4;break;case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(2),n=!0,i=e.t0;case 17:e.prev=17,e.prev=18,r||null==s.return||s.return();case 20:if(e.prev=20,!n){e.next=23;break}throw i;case 23:return e.finish(20);case 24:return e.finish(17);case 25:case"end":return e.stop()}}),t,this,[[2,13,17,25],[18,,20,24]])}))},{key:"_insert",value:function(e,t,r,n,i){if((0,u.isNone)(n)&&(0,u.isNone)(i)){var s=new f(this._target,this.geometryType,e,t,r);this._head=new(0,o.List)(s)}return(0,u.isNone)(n)&&(0,u.isSome)(i)?this._insertAtHead(e,t,r,i):(0,u.isSome)(n)&&(0,u.isNone)(i)?this._insertAtEnd(e,t,r,n):(0,u.isSome)(n)&&(0,u.isSome)(i)?this._insertAtMiddle(e,t,r,n,i):void 0}},{key:"_insertAtHead",value:function(e,t,r,n){var i=t+r;if(e===n.data.materialKey&&i===n.data.indexFrom)n.data.indexFrom=t,n.data.indexCount+=r;else{var s=new f(this._target,this.geometryType,e,t,r);this._head=new(0,o.List)(s),this._head.next=n}}},{key:"_insertAtEnd",value:function(e,t,r,n){if(n.data.materialKey===e&&n.data.indexEnd===t)n.data.indexCount+=r;else{var i=new f(this._target,this.geometryType,e,t,r),s=new(0,o.List)(i);n.next=s}}},{key:"_insertAtMiddle",value:function(e,t,r,n,i){var s=t+r;if(n.data.materialKey===e&&n.data.indexEnd===t)n.data.indexCount+=r,n.data.materialKey===i.data.materialKey&&n.data.indexEnd===i.data.indexFrom&&(n.data.indexCount+=i.data.indexCount,n.next=i.next);else if(e===i.data.materialKey&&s===i.data.indexFrom)i.data.indexFrom=t,i.data.indexCount+=r;else{var a=new f(this._target,this.geometryType,e,t,r),u=new(0,o.List)(a);n.next=u,u.next=i}}}],[{key:"from",value:function(e,r,n,i){var s=new t(e,r),a=!0,o=!1,f=void 0;if((0,u.isSome)(i))try{for(var l,h=i[Symbol.iterator]();!(a=(l=h.next()).done);a=!0){var c=l.value;n.seekIndex(c),s.addRecord(n)}}catch(e){o=!0,f=e}finally{try{a||null==h.return||h.return()}finally{if(o)throw f}}else for(;n.next();)s.addRecord(n);return s}}]),t}()})),r.register("dmaN0",(function(n,i){t(n.exports,"List",(function(){return o})),t(n.exports,"FreeList",(function(){return f}));var s=r("8TSCy"),a=r("2TvXO"),u=r("7qybv"),o=function(){"use strict";function t(e){if(s.classCallCheck(this,t),Array.isArray(e)){this.data=e[0];for(var r=this,n=1;n<e.length;n++)r.next=new t([e[n]]),r=r.next}else this.data=e}return s.createClass(t,[{key:"values",value:e(a).mark((function t(){var r;return e(a).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=this;case 1:if(!r){e.next=7;break}return e.next=4,r.data;case 4:r=r.next;case 5:e.next=1;break;case 7:case"end":return e.stop()}}),t,this)}))},{key:"forEach",value:function(e){for(var t=this;t;)e(t.data),t=t.next}},{key:"find",value:function(e){var t;return e(this.data)?this:null==(t=this.next)?void 0:t.find(e)}},{key:"max",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,r=e(this.data)>e(t.data)?this:t;return this.next?this.next.max(e,r):r}},{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this===e?t?(t.next=this.next,t):this.next:this.next.remove(e,this)}},{key:"last",get:function(){return this.next?this.next.last:this}}]),t}(),f=function(){"use strict";function e(t){s.classCallCheck(this,e),this._head=null,(0,u.isNone)(t)||(this._head=new o(t))}return s.createClass(e,[{key:"head",get:function(){return this._head}},{key:"maxAvailableSpace",value:function(){if((0,u.isNone)(this._head))return 0;var e=this._head.max((function(e){return e.end-e.start}));return e.data.end-e.data.start}},{key:"firstFit",value:function(e){if((0,u.isNone)(this._head))return null;for(var t=null,r=this._head;r;){var n=r.data.end-r.data.start;if(n===e)return t?t.next=r.next:this._head=r.next,r.data.start;if(n>e){var i=r.data.start;return r.data.start+=e,i}t=r,r=r.next}return null}},{key:"free",value:function(e,t){var r=e+t;if((0,u.isNone)(this._head)){var n=new o({start:e,end:r});this._head=n}else{if(r<=this._head.data.start){if(r===this._head.data.start)return void(this._head.data.start-=t);var i=new o({start:e,end:r});return i.next=this._head,void(this._head=i)}for(var s=this._head,a=s.next;a;){if(a.data.start>=r){if(s.data.end===e){if(s.data.end+=t,s.data.end===a.data.start){var f=a.data.end-a.data.start;return s.data.end+=f,void(s.next=a.next)}return}if(a.data.start===r)return void(a.data.start-=t);var l=new o({start:e,end:r});return l.next=s.next,void(s.next=l)}s=a,a=a.next}if(e!==s.data.end){var h=new o({start:e,end:r});s.next=h}else s.data.end+=t}}}]),e}()})),r.register("hDjOj",(function(e,n){t(e.exports,"Buffer",(function(){return l}));var i=r("8TSCy"),s=r("7qybv"),a=r("8UCU9"),u=r("dmaN0"),o=r("iRJeW"),f=r("8JzMA"),l=function(){"use strict";function e(t,r,n){i.classCallCheck(this,e);var s=a.TypedBuffer.create(r*n*Uint32Array.BYTES_PER_ELEMENT);this.size=r,this.strideInt=n,this.bufferType=t,this.dirty={start:1/0,end:0},this._gpu=null,this._cpu=s,this.clear()}return i.createClass(e,[{key:"elementSize",get:function(){return this._cpu.length/this.strideInt}},{key:"invalidated",get:function(){return this.bufferSize&&!this._gpu}},{key:"invalidate",value:function(){this._invalidateTriangleBuffer(),(0,s.applySome)(this._gpu,(function(e){return e.dispose()})),this._gpu=null}},{key:"_invalidateTriangleBuffer",value:function(){(0,s.applySome)(this._gpuComputeTriangles,(function(e){return e.dispose()})),this._gpuComputeTriangles=null}},{key:"destroy",value:function(){(0,s.applySome)(this._gpu,(function(e){return e.dispose()})),(0,s.applySome)(this._gpuComputeTriangles,(function(e){return e.dispose()})),(0,s.applySome)(this._cpu,(function(e){return e.destroy()})),(0,s.applySome)(this._cpu2,(function(e){return e.destroy()}))}},{key:"clear",value:function(){this.dirty.start=1/0,this.dirty.end=0,this.freeList=new(0,u.FreeList)({start:0,end:this._cpu.length/this.strideInt}),this.fillPointer=0}},{key:"ensure",value:function(e){if(!(this.maxAvailableSpace()>=e)&&e*this.strideInt>this._cpu.length-this.fillPointer){this.invalidate();var t=this._cpu.length/this.strideInt,r=Math.round(1.25*(t+e)),n=r*this.strideInt;this._cpu.expand(n*Uint32Array.BYTES_PER_ELEMENT),this.freeList.free(t,r-t)}}},{key:"set",value:function(e,t){this._cpu.array[e]!==t&&(this._cpu.array[e]=t,this.dirty.start=Math.min(e,this.dirty.start),this.dirty.end=Math.max(e,this.dirty.end))}},{key:"getGPUBuffer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.bufferSize)return null;if(t){if("index"!==this.bufferType)throw new Error("Tired to get triangle buffer, but target is not an index buffer");return(0,s.isNone)(this._gpuComputeTriangles)&&(this._gpuComputeTriangles=this._createComputeBuffer(e)),this._gpuComputeTriangles}return(0,s.isNone)(this._gpu)&&(this._gpu=this._createBuffer(e)),this._gpu}},{key:"getCPUBuffer",value:function(){if(!this._cpu2){var e=this._cpu.slice();this._cpu2=e}return this._cpu2.length!==this._cpu.length&&this._cpu2.expand(this._cpu.length*this._cpu.array.BYTES_PER_ELEMENT),this._cpu2.set(this._cpu),this._cpu2}},{key:"bufferSize",get:function(){return this._cpu.length/this.strideInt}},{key:"maxAvailableSpace",value:function(){return this.freeList.maxAvailableSpace()}},{key:"insert",value:function(e,t,r,n){var i=r*this.strideInt;if(!i)return 0;var a=t*this.strideInt*Uint32Array.BYTES_PER_ELEMENT,u=new Uint32Array(e,a,i),o=(0,s.unwrapOrThrow)(this.freeList.firstFit(r),"First fit region must be defined")*this.strideInt,f=i,l=o/this.strideInt-t;if(0!==n)for(var h=0;h<u.length;h++)u[h]+=n;return this._cpu.array.set(u,o),this.dirty.start=Math.min(this.dirty.start,o),this.dirty.end=Math.max(this.dirty.end,o+f),this.fillPointer=Math.max(this.fillPointer,o+f),l}},{key:"free",value:function(e,t,r){var n=e*this.strideInt,i=(e+t)*this.strideInt;if(!0===r)for(var s=e;s!==e+t;s++)this._cpu.array[s*this.strideInt]=2147450879;this.dirty.start=Math.min(this.dirty.start,n),this.dirty.end=Math.max(this.dirty.end,i),this.freeList.free(e,t)}},{key:"upload",value:function(){if(this.dirty.end){if(this._invalidateTriangleBuffer(),(0,s.isNone)(this._gpu))return this.dirty.start=1/0,void(this.dirty.end=0);this._gpu.setSubDataFromView(this._cpu.array,this.dirty.start,this.dirty.start,this.dirty.end),this.dirty.start=1/0,this.dirty.end=0}}},{key:"_createBuffer",value:function(e){var t=f.Usage.DYNAMIC_DRAW;return"index"===this.bufferType?o.BufferObject.createIndex(e,t,this._cpu.array):o.BufferObject.createVertex(e,t,this._cpu.array)}},{key:"_createComputeBuffer",value:function(e){for(var t=f.Usage.DYNAMIC_DRAW,r=new Uint32Array(this.fillPointer/3),n=0;n<this.fillPointer;n+=3)r[n/3]=this._cpu.array[n];return o.BufferObject.createIndex(e,t,r)}}]),e}()})),r.register("8UCU9",(function(e,n){t(e.exports,"TypedBuffer",(function(){return f}));var i=r("8TSCy"),s=r("2VlWd"),a=r("7qybv"),u=r("dmaN0"),o=(0,s.default)("esri-2d-log-allocations"),f=function(){"use strict";function e(t){i.classCallCheck(this,e),this._array=t}return i.createClass(e,[{key:"array",get:function(){return this._array}},{key:"length",get:function(){return this._array.length}},{key:"expand",value:function(e){var t=h.acquire(e);t.set(this._array),h.release(this._array),this._array=t}},{key:"destroy",value:function(){h.release(this._array)}},{key:"set",value:function(e,t){this._array.set(e._array,t)}},{key:"slice",value:function(){var t=h.acquire(this._array.byteLength);return t.set(this._array),new e(t)}}],[{key:"create",value:function(t){return new e(h.acquire(t))}}]),e}(),l=function(){"use strict";function e(){i.classCallCheck(this,e),this._data=new ArrayBuffer(e.BYTE_LENGTH),this._freeList=new(0,u.FreeList)({start:0,end:this._data.byteLength})}return i.createClass(e,[{key:"buffer",get:function(){return this._data}},{key:"allocate",value:function(e){var t=this._freeList.firstFit(e);return(0,a.isNone)(t)?null:new Uint32Array(this._data,t,e/Uint32Array.BYTES_PER_ELEMENT)}},{key:"free",value:function(e){this._freeList.free(e.byteOffset,e.byteLength)}}],[{key:"BYTE_LENGTH",get:function(){return 64e6}}]),e}(),h=new(function(){"use strict";function e(){i.classCallCheck(this,e),this._bytesAllocated=0,this._pages=[],this._pagesByBuffer=new Map,this._addPage()}return i.createClass(e,[{key:"_bytesTotal",get:function(){return this._pages.length*l.BYTE_LENGTH}},{key:"acquire",value:function(e){if(this._bytesAllocated+=e,o&&console.log("Allocating ".concat(e,", (").concat(this._bytesAllocated," / ").concat(this._bytesTotal,")")),e>l.BYTE_LENGTH)return new Uint32Array(e/Uint32Array.BYTES_PER_ELEMENT);var t=!0,r=!1,n=void 0;try{for(var i,s=this._pages[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){var u=i.value.allocate(e);if((0,a.isSome)(u))return u}}catch(e){r=!0,n=e}finally{try{t||null==s.return||s.return()}finally{if(r)throw n}}return(0,a.unwrapOrThrow)(this._addPage().allocate(e),"Expected to allocate page")}},{key:"release",value:function(e){this._bytesAllocated-=e.byteLength,o&&console.log("Freeing ".concat(e.byteLength,", (").concat(this._bytesAllocated," / ").concat(this._bytesTotal,")"));var t=this._pagesByBuffer.get(e.buffer);t&&t.free(e)}},{key:"_addPage",value:function(){var e=new l;return this._pages.push(e),this._pagesByBuffer.set(e.buffer,e),e}}]),e}())})),r.register("aUYE0",(function(e,n){t(e.exports,"default",(function(){return l}));var i=r("8TSCy"),s=r("7eJjO"),a=r("6dXDO"),u=r("iho5X");r("lNwWH"),r("2VlWd"),r("iJAIC");var o=r("fcwIv"),f=function(e){"use strict";i.inherits(r,e);var t=i.createSuper(r);function r(e){var n;return i.classCallCheck(this,r),(n=t.call(this,e)).tiles=new Map,i.possibleConstructorReturn(n)}return i.createClass(r,[{key:"destroy",value:function(){this.tiles.clear(),this.layer=this.layerView=this.tileInfoView=this.tiles=null}},{key:"updating",get:function(){return this.isUpdating()}},{key:"acquireTile",value:function(e){var t=this,r=this.createTile(e);return r.once("isReady",(function(){return t.notifyChange("updating")})),this.tiles.set(e.id,r),r}},{key:"forceAttributeTextureUpload",value:function(){}},{key:"forEachTile",value:function(e){this.tiles.forEach(e)}},{key:"releaseTile",value:function(e){this.tiles.delete(e.key.id),this.disposeTile(e)}},{key:"isUpdating",value:function(){var e=!0;return this.tiles.forEach((function(t){e=e&&t.isReady})),!e}},{key:"setHighlight",value:function(){}},{key:"invalidateLabels",value:function(){}},{key:"requestUpdate",value:function(){this.layerView.requestUpdate()}}]),r}(a.HandleOwner);(0,s._)([(0,u.property)()],f.prototype,"layer",void 0),(0,s._)([(0,u.property)()],f.prototype,"layerView",void 0),(0,s._)([(0,u.property)()],f.prototype,"tileInfoView",void 0),(0,s._)([(0,u.property)()],f.prototype,"updating",null);var l=f=(0,s._)([(0,o.subclass)("esri.views.2d.layers.features.tileRenderers.BaseTileRenderer")],f)})),r.register("1Fs6Q",(function(e,n){t(e.exports,"getVisualVariableSizeValueRepresentationRatio",(function(){return h})),t(e.exports,"convertVisualVariables",(function(){return v}));var i=r("8TSCy"),s=r("7qybv"),a=r("iXlXu"),u=r("hUDEJ"),o=r("4WoSm"),f=r("66IJZ"),l=r("2VOK9");function h(e,t){if(!e||!t)return e;switch(t){case"radius":case"distance":return 2*e;case"diameter":case"width":return e;case"area":return Math.sqrt(e)}return e}function c(e){return e.map((function(e){return{value:(t=e).value,size:(0,a.toPt)(t.size)};var t}))}function d(e){if("string"==typeof e||"number"==typeof e)return(0,a.toPt)(e);var t=e;return{type:"size",expression:t.expression,stops:c(t.stops)}}var y=function(e){for(var t=[],r=[],n=c(e),i=n.length,s=0;s<6;s++){var u=n[Math.min(s,i-1)];t.push(u.value),r.push(null==u.size?o.NAN_MAGIC_NUMBER:(0,a.pt2px)(u.size))}return{values:new Float32Array(t),sizes:new Float32Array(r)}};function v(e){var t=e&&e.length>0?{}:null,r=t?{}:null;if(!t)return{vvFields:t,vvRanges:r};var n=!0,s=!1,a=void 0;try{for(var u,o=e[Symbol.iterator]();!(n=(u=o.next()).done);n=!0){var h=u.value;if(h.field&&(t[h.type]=h.field),"size"===h.type){r.size||(r.size={});var v=h;switch((0,l.getTypeOfSizeVisualVariable)(v)){case f.WGLVVFlag.SIZE_MINMAX_VALUE:r.size.minMaxValue={minDataValue:v.minDataValue,maxDataValue:v.maxDataValue,minSize:d(v.minSize),maxSize:d(v.maxSize)};break;case f.WGLVVFlag.SIZE_SCALE_STOPS:r.size.scaleStops={stops:c(v.stops)};break;case f.WGLVVFlag.SIZE_FIELD_STOPS:if(v.levels){var _={};for(var g in v.levels)_[g]=y(v.levels[g]);r.size.fieldStops={type:"level-dependent",levels:_}}else r.size.fieldStops=i.objectSpread({type:"static"},y(v.stops));break;case f.WGLVVFlag.SIZE_UNIT_VALUE:r.size.unitValue={unit:v.valueUnit,valueRepresentation:v.valueRepresentation}}}else if("color"===h.type)r.color=x(h);else if("opacity"===h.type)r.opacity=p(h);else if("rotation"===h.type){var k=h;r.rotation={type:k.rotationType}}}}catch(e){s=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(s)throw a}}return{vvFields:t,vvRanges:r}}function p(e){var t={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if("string"==typeof e.field){if(!e.stops)return null;if(e.stops.length>8)return null;for(var r=e.stops,n=0;n<8;++n){var i=r[Math.min(n,r.length-1)];t.values[n]=i.value,t.opacities[n]=i.opacity}}else{if(!(e.stops&&e.stops.length>=0))return null;for(var s=e.stops&&e.stops.length>=0&&e.stops[0].opacity,a=0;a<8;a++)t.values[a]=1/0,t.opacities[a]=s}return t}function _(e,t,r){e[4*t+0]=r.r/255,e[4*t+1]=r.g/255,e[4*t+2]=r.b/255,e[4*t+3]=r.a}function x(e){if((0,s.isNone)(e))return null;if(e.normalizationField)return null;var t={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};if("string"==typeof e.field){if(!e.stops)return null;if(e.stops.length>8)return null;t.field=e.field;for(var r=e.stops,n=0;n<8;++n){var i=r[Math.min(n,r.length-1)];t.values[n]=i.value,_(t.colors,n,i.color)}}else{if(!(e.stops&&e.stops.length>=0))return null;for(var a=e.stops&&e.stops.length>=0&&e.stops[0].color,o=0;o<8;o++)t.values[o]=1/0,_(t.colors,o,a)}for(var f=0;f<32;f+=4)(0,u.premultiplyAlpha)(t.colors,f,!0);return t}})),r.register("CISlQ",(function(e,n){t(e.exports,"WGLFeatureView",(function(){return h}));var i=r("8TSCy"),s=r("2VlWd"),a=r("10vEZ"),u=r("jhrt5"),o=r("hTEz4"),f=r("66IJZ"),l=(0,s.default)("featurelayer-order-by-server-enabled"),h=function(e){"use strict";i.inherits(r,e);var t=i.createSuper(r);function r(e,n,s,a){var u;return i.classCallCheck(this,r),(u=t.call(this,e))._pointToCallbacks=[],u._layer=s,u._layerView=n,u._onUpdate=a,i.possibleConstructorReturn(u)}return i.createClass(r,[{key:"renderChildren",value:function(e){this.attributeView.update(),this.hasAnimation&&e.painter.effects.integrate.draw(e,e.attributeView),i.get(i.getPrototypeOf(r.prototype),"renderChildren",this).call(this,e)}},{key:"hasEmptyAttributeView",value:function(){return this.attributeView.isEmpty()}},{key:"isUpdating",value:function(){return this.attributeView.isUpdating()}},{key:"hitTest",value:function(e){var t=(0,a.createResolver)();return this._pointToCallbacks.push({point:e,resolver:t}),this.requestRender(),t.promise}},{key:"onTileData",value:function(e,t){var r=l&&"orderBy"in this._layer&&this._layer.orderBy,n=(null==r?void 0:r.length)&&!r[0].valueExpression&&r[0].field,i=r&&this._layerView.orderByFields===n;e.patch(t,i),this.contains(e)||this.addChild(e),this.requestRender()}},{key:"onTileError",value:function(e){this.contains(e)||this.addChild(e)}},{key:"updateTransitionProperties",value:function(e,t){i.get(i.getPrototypeOf(r.prototype),"updateTransitionProperties",this).call(this,e,t),this._layerView.featureEffectView.transitionStep(e,t),this._layerView.featureEffectView.transitioning&&this.requestRender()}},{key:"doRender",value:function(e){var t=this._layer,n=t.minScale,s=t.maxScale,a=e.state.scale;a<=(n||1/0)&&a>=s&&i.get(i.getPrototypeOf(r.prototype),"doRender",this).call(this,e)}},{key:"onAttributeStoreUpdate",value:function(){this.hasLabels&&this._layerView.view.labelManager.requestUpdate(),this._onUpdate()}},{key:"hasAnimation",get:function(){return this.hasLabels}},{key:"setStencilReference",value:function(e){if(e.rendererInfo.ddDotSize>1){var t=!0,n=!1,s=void 0;try{for(var a,u=this.children[Symbol.iterator]();!(t=(a=u.next()).done);t=!0){var o=a.value;o.stencilRef=o.key.level+1}}catch(e){n=!0,s=e}finally{try{t||null==u.return||u.return()}finally{if(n)throw s}}}else i.get(i.getPrototypeOf(r.prototype),"setStencilReference",this).call(this,e)}},{key:"hasLabels",get:function(){if("sublayers"in this._layer)return this._layer.sublayers.some((function(e){return e.labelingInfo&&e.labelingInfo.length&&e.labelsVisible}));var e=this._layer.featureReduction,t=e&&"cluster"===e.type&&e.labelsVisible&&e.labelingInfo&&e.labelingInfo.length;return this._layer.labelingInfo&&this._layer.labelingInfo.length&&this._layer.labelsVisible||!!t}},{key:"prepareRenderPasses",value:function(e){var t=this,n=e.registerRenderPass({name:"label",brushes:[u.brushes.label],target:function(){return t.hasLabels?t.children:null},drawPhase:f.WGLDrawPhase.LABEL|f.WGLDrawPhase.LABEL_ALPHA}),s=e.registerRenderPass({name:"geometry",brushes:[u.brushes.fill,u.brushes.line,u.brushes.marker,u.brushes.text],target:function(){return t.children},enableDefaultDraw:function(){return!t._layerView.featureEffectView.hasEffects},effects:[{apply:e.effects.outsideEffect,enable:function(){return t._layerView.featureEffectView.hasEffects},args:function(){return t._layerView.featureEffectView.excludedEffects}},{apply:e.effects.insideEffect,enable:function(){return t._layerView.featureEffectView.hasEffects},args:function(){return t._layerView.featureEffectView.includedEffects}},{apply:e.effects.hittest,enable:function(){return!!t._pointToCallbacks.length},args:function(){return t._pointToCallbacks}}]}),a=e.registerRenderPass({name:"highlight",brushes:[u.brushes.fill,u.brushes.line,u.brushes.marker,u.brushes.text],target:function(){return t.children},drawPhase:f.WGLDrawPhase.HIGHLIGHT,enableDefaultDraw:function(){return!1},effects:[{apply:e.effects.highlight,enable:function(){return!!t._layerView.hasHighlight()}}]});return i.toConsumableArray(i.get(i.getPrototypeOf(r.prototype),"prepareRenderPasses",this).call(this,e)).concat([s,a,n])}}]),r}(o.FeatureContainer)})),r.register("ieqnL",(function(e,r){t(e.exports,"DISPLAY_ID_TEXEL_MASK",(function(){return n})),t(e.exports,"DISPLAY_ID_TYPE_FEATURE",(function(){return s})),t(e.exports,"DISPLAY_ID_TYPE_AGGREGATE",(function(){return a})),t(e.exports,"getDisplayIdType",(function(){return u})),t(e.exports,"getDisplayIdTexel",(function(){return o})),t(e.exports,"getDisplayIdFilterMask",(function(){return f})),t(e.exports,"isAggregateId",(function(){return l})),t(e.exports,"createDisplayId",(function(){return h}));var n=8388607,i=8388608,s=0,a=1,u=function(e){return(e&i)>>>23},o=function(e){return e&n},f=function(e){return u(e)===a?254:255};function l(e){return u(e)===a}function h(e,t){return((t?i:0)|e)>>>0}})),r.register("6Gukk",(function(e,n){t(e.exports,"createDebugLogger",(function(){return a})),t(e.exports,"DEBUG_ATTR_UPDATES",(function(){return u}));var i,s=r("8TSCy"),a=function(e,t){return e&&function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(i=t).warn.apply(i,["DEBUG:"].concat(s.toConsumableArray(r)))}||function(){return null}},u=!1})),r.register("iTfMY",(function(e,r){t(e.exports,"radToByte",(function(){return u})),t(e.exports,"degToByte",(function(){return o})),t(e.exports,"log2",(function(){return f})),t(e.exports,"between",(function(){return l}));Number.POSITIVE_INFINITY;var n=Math.PI,i=128/n,s=1/Math.LN2;function a(e,t){return(e%=t)>=0?e:e+t}function u(e){return a(e*i,256)}function o(e){return a(.7111111111111111*e,256)}function f(e){return Math.log(e)*s}function l(e,t,r){return e>=t&&e<=r||e>=r&&e<=t}})),r.register("2ndsO",(function(e,r){t(e.exports,"e",(function(){return a}));var n,i,s={exports:{}};n=s,void 0!==(i=function(){function e(e,i,s){s=s||2;var a,u,f,h,c,y,v,p=i&&i.length,_=p?i[0]*s:e.length,x=t(e,0,_,s,!0),g=[];if(!x||x.next===x.prev)return g;if(p&&(x=function(e,n,i,s){var a,u,f,h=[];for(a=0,u=n.length;a<u;a++)(f=t(e,n[a]*s,a<u-1?n[a+1]*s:e.length,s,!1))===f.next&&(f.steiner=!0),h.push(d(f));for(h.sort(o),a=0;a<h.length;a++)i=r(i=l(h[a],i),i.next);return i}(e,i,x,s)),e.length>80*s){a=f=e[0],u=h=e[1];for(var k=s;k<_;k+=s)(c=e[k])<a&&(a=c),(y=e[k+1])<u&&(u=y),c>f&&(f=c),y>h&&(h=y);v=0!==(v=Math.max(f-a,h-u))?1/v:0}return n(x,g,s,a,u,v),g}function t(e,t,r,n,i){var s,a;if(i===T(e,t,r,n)>0)for(s=t;s<r;s+=n)a=w(s,e[s],e[s+1],a);else for(s=r-n;s>=t;s-=n)a=w(s,e[s],e[s+1],a);if(a&&_(a,a.next)){var u=a.next;C(a),a=u}return a}function r(e,t){if(!e)return e;t||(t=e);var r,n=e;do{if(r=!1,n.steiner||!_(n,n.next)&&0!==p(n.prev,n,n.next))n=n.next;else{var i=n.prev;if(C(n),(n=t=i)===n.next)break;r=!0}}while(r||n!==t);return t}function n(e,t,o,f,l,h,d){if(e){!d&&h&&function(e,t,r,n){var i=e;do{null===i.z&&(i.z=c(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,r,n,i,s,a,u,o,f=1;do{for(r=e,e=null,s=null,a=0;r;){for(a++,n=r,u=0,t=0;t<f&&(u++,n=n.nextZ);t++);for(o=f;u>0||o>0&&n;)0!==u&&(0===o||!n||r.z<=n.z)?(i=r,r=r.nextZ,u--):(i=n,n=n.nextZ,o--),s?s.nextZ=i:e=i,i.prevZ=s,s=i;r=n}s.nextZ=null,f*=2}while(a>1)}(i)}(e,f,l,h);for(var y,v,p=e;e.prev!==e.next;)if(y=e.prev,v=e.next,h?s(e,f,l,h):i(e))t.push(y.i/o),t.push(e.i/o),t.push(v.i/o),C(e),e=v.next,p=v.next;else if((e=v)===p){d?1===d?n(e=a(r(e),t,o),t,o,f,l,h,2):2===d&&u(e,t,o,f,l,h):n(r(e),t,o,f,l,h,1);break}}}function i(e){var t=e.prev,r=e,n=e.next;if(p(t,r,n)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(y(t.x,t.y,r.x,r.y,n.x,n.y,i.x,i.y)&&p(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function s(e,t,r,n){var i=e.prev,s=e,a=e.next;if(p(i,s,a)>=0)return!1;for(var u=i.x<s.x?i.x<a.x?i.x:a.x:s.x<a.x?s.x:a.x,o=i.y<s.y?i.y<a.y?i.y:a.y:s.y<a.y?s.y:a.y,f=i.x>s.x?i.x>a.x?i.x:a.x:s.x>a.x?s.x:a.x,l=i.y>s.y?i.y>a.y?i.y:a.y:s.y>a.y?s.y:a.y,h=c(u,o,t,r,n),d=c(f,l,t,r,n),v=e.prevZ,_=e.nextZ;v&&v.z>=h&&_&&_.z<=d;){if(v!==e.prev&&v!==e.next&&y(i.x,i.y,s.x,s.y,a.x,a.y,v.x,v.y)&&p(v.prev,v,v.next)>=0)return!1;if(v=v.prevZ,_!==e.prev&&_!==e.next&&y(i.x,i.y,s.x,s.y,a.x,a.y,_.x,_.y)&&p(_.prev,_,_.next)>=0)return!1;_=_.nextZ}for(;v&&v.z>=h;){if(v!==e.prev&&v!==e.next&&y(i.x,i.y,s.x,s.y,a.x,a.y,v.x,v.y)&&p(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;_&&_.z<=d;){if(_!==e.prev&&_!==e.next&&y(i.x,i.y,s.x,s.y,a.x,a.y,_.x,_.y)&&p(_.prev,_,_.next)>=0)return!1;_=_.nextZ}return!0}function a(e,t,n){var i=e;do{var s=i.prev,a=i.next.next;!_(s,a)&&x(s,i,i.next,a)&&m(s,a)&&m(a,s)&&(t.push(s.i/n),t.push(i.i/n),t.push(a.i/n),C(i),C(i.next),i=e=a),i=i.next}while(i!==e);return r(i)}function u(e,t,i,s,a,u){var o=e;do{for(var f=o.next.next;f!==o.prev;){if(o.i!==f.i&&v(o,f)){var l=b(o,f);return o=r(o,o.next),l=r(l,l.next),n(o,t,i,s,a,u),void n(l,t,i,s,a,u)}f=f.next}o=o.next}while(o!==e)}function o(e,t){return e.x-t.x}function f(e){if(e.next.prev===e)return e;for(var t=e;;){var r=t.next;if(r.prev===t||r===t||r===e)break;t=r}return t}function l(e,t){var n=function(e,t){var r,n=t,i=e.x,s=e.y,a=-1/0;do{if(s<=n.y&&s>=n.next.y&&n.next.y!==n.y){var u=n.x+(s-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(u<=i&&u>a){if(a=u,u===i){if(s===n.y)return n;if(s===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!r)return null;if(i===a)return r;var o,f=r,l=r.x,c=r.y,d=1/0;n=r;do{i>=n.x&&n.x>=l&&i!==n.x&&y(s<c?i:a,s,l,c,s<c?a:i,s,n.x,n.y)&&(o=Math.abs(s-n.y)/(i-n.x),m(n,e)&&(o<d||o===d&&(n.x>r.x||n.x===r.x&&h(r,n)))&&(r=n,d=o)),n=n.next}while(n!==f);return r}(e,t);if(!n)return t;var i=b(n,e),s=r(n,n.next),a=f(i);return r(a,a.next),s=f(s),f(t===n?s:t)}function h(e,t){return p(e.prev,e,t.prev)<0&&p(t.next,e,e.next)<0}function c(e,t,r,n,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function d(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function y(e,t,r,n,i,s,a,u){return(i-a)*(t-u)-(e-a)*(s-u)>=0&&(e-a)*(n-u)-(r-a)*(t-u)>=0&&(r-a)*(s-u)-(i-a)*(n-u)>=0}function v(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&x(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&(m(e,t)&&m(t,e)&&function(e,t){var r=e,n=!1,i=(e.x+t.x)/2,s=(e.y+t.y)/2;do{r.y>s!=r.next.y>s&&r.next.y!==r.y&&i<(r.next.x-r.x)*(s-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}(e,t)&&(p(e.prev,e,t.prev)||p(e,t.prev,t))||_(e,t)&&p(e.prev,e,e.next)>0&&p(t.prev,t,t.next)>0)}function p(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function _(e,t){return e.x===t.x&&e.y===t.y}function x(e,t,r,n){var i=k(p(e,t,r)),s=k(p(e,t,n)),a=k(p(r,n,e)),u=k(p(r,n,t));return i!==s&&a!==u||!(0!==i||!g(e,r,t))||!(0!==s||!g(e,n,t))||!(0!==a||!g(r,e,n))||!(0!==u||!g(r,t,n))}function g(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function k(e){return e>0?1:e<0?-1:0}function m(e,t){return p(e.prev,e,e.next)<0?p(e,t,e.next)>=0&&p(e,e.prev,t)>=0:p(e,t,e.prev)<0||p(e,e.next,t)<0}function b(e,t){var r=new S(e.i,e.x,e.y),n=new S(t.i,t.x,t.y),i=e.next,s=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,s.next=n,n.prev=s,n}function w(e,t,r,n){var i=new S(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function C(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function S(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function T(e,t,r,n){for(var i=0,s=t,a=r-n;s<r;s+=n)i+=(e[a]-e[s])*(e[s+1]+e[a+1]),a=s;return i}return e.deviation=function(e,t,r,n){var i=t&&t.length,s=i?t[0]*r:e.length,a=Math.abs(T(e,0,s,r));if(i)for(var u=0,o=t.length;u<o;u++){var f=t[u]*r,l=u<o-1?t[u+1]*r:e.length;a-=Math.abs(T(e,f,l,r))}var h=0;for(u=0;u<n.length;u+=3){var c=n[u]*r,d=n[u+1]*r,y=n[u+2]*r;h+=Math.abs((e[c]-e[y])*(e[d+1]-e[c+1])-(e[c]-e[d])*(e[y+1]-e[c+1]))}return 0===a&&0===h?0:Math.abs((h-a)/a)},e.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},n=0,i=0;i<e.length;i++){for(var s=0;s<e[i].length;s++)for(var a=0;a<t;a++)r.vertices.push(e[i][s][a]);i>0&&(n+=e[i-1].length,r.holes.push(n))}return r},e}())&&(n.exports=i);var a=s.exports})),r.register("ebEEs",(function(e,r){t(e.exports,"DECLUTTER_TILES",(function(){return n})),t(e.exports,"COLLISION_GRID_CELL_SIZE",(function(){return i})),t(e.exports,"DECLUTTER_BUDGET",(function(){return s})),t(e.exports,"FADE_DURATION",(function(){return a}));var n=!0,i=32,s=1.5,a=200})),r.register("8eM7H",(function(e,n){t(e.exports,"TiledDisplayObject",(function(){return o}));var i=r("8TSCy"),s=r("j3x2p"),a=r("2qlsz"),u=r("i90gL"),o=function(e){"use strict";i.inherits(r,e);var t=i.createSuper(r);function r(e,n,s,a,o){var f,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:a,h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:o;return i.classCallCheck(this,r),(f=t.call(this)).triangleCountReportedInDebug=0,f.triangleCount=0,f.texture=null,f.key=new(0,u.default)(e),f.x=n,f.y=s,f.width=a,f.height=o,f.rangeX=l,f.rangeY=h,i.possibleConstructorReturn(f)}return i.createClass(r,[{key:"destroy",value:function(){this.texture&&(this.texture.dispose(),this.texture=null)}},{key:"setTransform",value:function(e,t){var r=t/(e.resolution*e.pixelRatio),n=this.transforms.tileMat3,a=i.slicedToArray(e.toScreenNoRotation([0,0],[this.x,this.y]),2),u=a[0],o=a[1],f=this.width/this.rangeX*r,l=this.height/this.rangeY*r;(0,s.s)(n,f,0,0,0,l,0,u,o,1),(0,s.m)(this.transforms.dvs,e.displayViewMat3,n)}}]),r}(a.DisplayObject)})),r.register("3v0eQ",(function(e,n){t(e.exports,"default",(function(){return h}));var i=r("8TSCy"),s=r("2VlWd"),a=r("66IJZ"),u=r("3FBIK"),o=r("cq8Fg"),f=r("ht01f"),l=function(e,t){return e.key.level-t.key.level!=0?e.key.level-t.key.level:e.key.row-t.key.row!=0?e.key.row-t.key.row:e.key.col-t.key.col},h=function(e){"use strict";i.inherits(r,e);var t=i.createSuper(r);function r(e){var n;return i.classCallCheck(this,r),(n=t.call(this))._tileInfoView=e,i.possibleConstructorReturn(n)}return i.createClass(r,[{key:"requiresDedicatedFBO",get:function(){return!1}},{key:"renderChildren",value:function(e){this.sortChildren(l),this.setStencilReference(e),i.get(i.getPrototypeOf(r.prototype),"renderChildren",this).call(this,e)}},{key:"createRenderParams",value:function(e){var t=e.state,n=i.get(i.getPrototypeOf(r.prototype),"createRenderParams",this).call(this,e);return n.requiredLevel=this._tileInfoView.getClosestInfoForScale(t.scale).level,n.displayLevel=this._tileInfoView.tileInfo.scaleToZoom(t.scale),n}},{key:"prepareRenderPasses",value:function(e){var t=this,n=i.get(i.getPrototypeOf(r.prototype),"prepareRenderPasses",this).call(this,e);return n.push(e.registerRenderPass({name:"stencil",brushes:[f.default],drawPhase:a.WGLDrawPhase.DEBUG|a.WGLDrawPhase.MAP|a.WGLDrawPhase.HIGHLIGHT,target:function(){return t.getStencilTarget()}})),(0,s.default)("esri-tiles-debug")&&n.push(e.registerRenderPass({name:"tileInfo",brushes:[o.default],drawPhase:a.WGLDrawPhase.DEBUG,target:function(){return t.children}})),n}},{key:"getStencilTarget",value:function(){return this.children}},{key:"updateTransforms",value:function(e){var t=!0,r=!1,n=void 0;try{for(var i,s=this.children[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){var a=i.value,u=this._tileInfoView.getTileResolution(a.key);a.setTransform(e,u)}}catch(e){r=!0,n=e}finally{try{t||null==s.return||s.return()}finally{if(r)throw n}}}},{key:"setStencilReference",value:function(e){var t=1,r=!0,n=!1,i=void 0;try{for(var s,a=this.children[Symbol.iterator]();!(r=(s=a.next()).done);r=!0){s.value.stencilRef=t++}}catch(e){n=!0,i=e}finally{try{r||null==a.return||a.return()}finally{if(n)throw i}}}}]),r}(u.default)}))}();
//# sourceMappingURL=SymbolTileRenderer.b8fb6d46.js.map
