function e(e,n,t,r){Object.defineProperty(e,n,{get:t,set:r,enumerable:!0,configurable:!0})}var n=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire594f;n.register("gfFNw",(function(t,r){e(t.exports,"functionHelper",(function(){return ce})),e(t.exports,"extend",(function(){return ue})),e(t.exports,"executeScript",(function(){return se})),e(t.exports,"extractFieldLiterals",(function(){return fe})),e(t.exports,"validateScript",(function(){return de})),e(t.exports,"referencesMember",(function(){return he})),e(t.exports,"referencesFunction",(function(){return ge})),e(t.exports,"findFunctionCalls",(function(){return pe}));var o=n("7e1Ja"),a=n("8dj34"),i=n("lz1nc"),l=n("2mxq8"),c=n("8MibT"),u=n("k6igO"),s=n("b2JWg"),f=n("hyHkL"),d=n("fXK0z"),h=n("axKjD"),g=n("gDYGn"),p=n("effkN"),m=n("jB7L7"),y=n("fVx77"),w=n("aIasu"),E=n("7lxsX"),v=n("4jvWz"),I=n("lHg4e"),N=n("2WnyR"),A=n("eqMhf"),b=n("5vMQI"),C=n("dZxPT"),R=n("etknW"),x=n("7blCc"),T=n("jaaCV");function S(e){return e&&"function"==typeof e.then}const M=100;function F(e){return e instanceof Error?(0,I.reject)(e):(0,I.reject)(new Error(e))}function O(e){return(0,I.resolve)(e)}function U(e,n){const t=[];for(let r=0;r<n.arguments.length;r++)t.push(D(e,n.arguments[r]));return(0,I.all)(t)}function L(e,n,t){return(0,I.create)(((r,o)=>{if(!0===n.preparsed)return r(t(e,null,n.arguments));U(e,n).then((a=>{try{r(t(e,n,a))}catch(e){o(e)}}),o)}))}function k(e,n,t){try{if(!0===n.preparsed){const r=t(e,null,n.arguments);return S(r)?r:(0,I.resolve)(r)}return U(e,n).then((r=>{try{const o=t(e,n,r);return S(o)?o:(0,I.resolve)(o)}catch(e){return F(e)}}))}catch(e){return F(e)}}function D(e,n,t){try{if(n.breakpoint&&!0!==t)return n.breakpoint().then((()=>D(e,n,!0)));switch(n.type){case"VariableDeclarator":return function(e,n){try{let t=null;return t=null===n.init?(0,I.resolve)(null):D(e,n.init),null!==e.localScope?t.then((t=>(0,I.create)((r=>{if(t===f.v&&(t=null),"Identifier"!==n.id.type)throw new Error("Can only assign a regular variable");const o=n.id.name.toLowerCase();e.localScope[o]={value:t,valueset:!0,node:n.init},r(f.v)})))):t.then((t=>(0,I.create)((r=>{if("Identifier"!==n.id.type)throw new Error("Can only assign a regular variable");const o=n.id.name.toLowerCase();t===f.v&&(t=null),e.globalScope[o]={value:t,valueset:!0,node:n.init},r(f.v)}))))}catch(e){return F(e)}}(e,n);case"VariableDeclaration":return z(e,n,0);case"BlockStatement":return function(e,n){try{return B(e,n,0)}catch(e){return F(e)}}(e,n);case"FunctionDeclaration":return function(e,n){try{const t=n.id.name.toLowerCase();return e.globalScope[t]={valueset:!0,node:null,value:new(0,c.default)(n,e)},(0,I.resolve)(f.v)}catch(e){return F(e)}}(e,n);case"ReturnStatement":return E=e,v=n,(0,I.create)(((e,n)=>{null===v.argument?e(new(0,f.R)(f.v)):D(E,v.argument).then((t=>{try{e(new(0,f.R)(t))}catch(e){n(e)}}),n)}));case"IfStatement":return y=e,w=n,(0,I.create)(((e,n)=>{"AssignmentExpression"!==w.test.type&&"UpdateExpression"!==w.test.type?D(y,w.test).then((t=>{try{!0===t?D(y,w.consequent).then(e,n):!1===t?null!==w.alternate?D(y,w.alternate).then(e,n):e(f.v):n(new Error((0,d.nodeErrorMessage)(w.test,"RUNTIME","CANNOT_USE_NONBOOLEAN_IN_CONDITION")))}catch(e){n(e)}}),n):n(new Error((0,d.nodeErrorMessage)(w.test,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION")))}));case"ExpressionStatement":return function(e,n){try{return"AssignmentExpression"===n.expression.type?D(e,n.expression):(n.expression.type,D(e,n.expression).then((e=>(0,I.create)((n=>{n(e===f.v?f.v:new(0,f.I)(e))})))))}catch(e){return(0,I.reject)(e)}}(e,n);case"UpdateExpression":return function(e,n){try{const t=n.argument;if("MemberExpression"===t.type){const r={t:null};return D(e,t.object).then((n=>{let o=null;return r.t=n,!0===t.computed?o=D(e,t.property):"Identifier"===t.property.type&&(o=(0,I.resolve)(t.property.name)),o})).then((e=>(0,I.create)((t=>{const o=r.t;let a;if((0,f.a)(o)){if(!(0,f.j)(e))throw new Error("Invalid Parameter");if(e<0&&(e=o.length+e),e<0||e>=o.length)throw new Error("Assignment outside of array bounds");a=(0,f.t)(o[e]),o[e]="++"===n.operator?a+1:a-1}else if(o instanceof i.default){if(!1===(0,f.f)(e))throw new Error("Dictionary accessor must be a string");if(!0!==o.hasField(e))throw new Error("Invalid Parameter");a=(0,f.t)(o.field(e)),o.setField(e,"++"===n.operator?a+1:a-1)}else{if(!(0,f.k)(o))throw(0,f.b)(o)?new Error("Array is Immutable"):new Error("Invalid Parameter");if(!1===(0,f.f)(e))throw new Error("Feature accessor must be a string");if(!0!==o.hasField(e))throw new Error("Invalid Parameter");a=(0,f.t)(o.field(e)),o.setField(e,"++"===n.operator?a+1:a-1)}!1===n.prefix?t(a):t("++"===n.operator?a+1:a-1)}))))}return(0,I.create)(((t,r)=>{const o="Identifier"===n.argument.type?n.argument.name.toLowerCase():"";if(!o)throw new Error("Invalid identifier");let a;return null!==e.localScope&&void 0!==e.localScope[o]?(a=(0,f.t)(e.localScope[o].value),e.localScope[o]={value:"++"===n.operator?a+1:a-1,valueset:!0,node:n},void(!1===n.prefix?t(a):t("++"===n.operator?a+1:a-1))):void 0!==e.globalScope[o]?(a=(0,f.t)(e.globalScope[o].value),e.globalScope[o]={value:"++"===n.operator?a+1:a-1,valueset:!0,node:n},void(!1===n.prefix?t(a):t("++"===n.operator?a+1:a-1))):void r(new Error("Variable not recognised"))}))}catch(e){return(0,I.reject)(e)}}(e,n);case"AssignmentExpression":return p=e,m=n,(0,I.create)(((e,n)=>{const t=m.left;if("MemberExpression"===t.type)D(p,m.right).then((r=>{try{D(p,t.object).then((o=>{try{let a=null;if(!0===t.computed)a=D(p,t.property);else{if("Identifier"!==t.property.type)throw new Error("Expected computed or identifier for assignemnt target");a=(0,I.resolve)(t.property.name)}a.then((t=>{try{if((0,f.a)(o)){if(!(0,f.j)(t))throw new Error("Invalid Parameter");if(t<0&&(t=o.length+t),t<0||t>o.length)throw new Error("Assignment outside of array bounds");if(t===o.length){if("="!==m.operator)throw new Error("Invalid Parameter");o[t]=G(r,m.operator,o[t],m)}else o[t]=G(r,m.operator,o[t],m)}else if(o instanceof i.default){if(!1===(0,f.f)(t))throw new Error("Dictionary accessor must be a string");if(!0===o.hasField(t))o.setField(t,G(r,m.operator,o.field(t),m));else{if("="!==m.operator)throw new Error("Invalid Parameter");o.setField(t,G(r,m.operator,null,m))}}else{if(!(0,f.k)(o))throw(0,f.b)(o)?new Error("Array is Immutable"):new Error("Invalid Parameter");if(!1===(0,f.f)(t))throw new Error("Feature accessor must be a string");if(!0===o.hasField(t))o.setField(t,G(r,m.operator,o.field(t),m));else{if("="!==m.operator)throw new Error("Invalid Parameter");o.setField(t,G(r,m.operator,null,m))}}e(f.v)}catch(e){n(e)}}),n)}catch(e){n(e)}}),n)}catch(e){n(e)}}),n);else{const r=t.name.toLowerCase();if(null!==p.localScope&&void 0!==p.localScope[r])return void D(p,m.right).then((t=>{try{p.localScope[r]={value:G(t,m.operator,p.localScope[r].value,m),valueset:!0,node:m.right},e(f.v)}catch(e){n(e)}}),n);void 0!==p.globalScope[r]?D(p,m.right).then((t=>{try{p.globalScope[r]={value:G(t,m.operator,p.globalScope[r].value,m),valueset:!0,node:m.right},e(f.v)}catch(e){n(e)}}),n):n(new Error("Cannot assign undeclared variable"))}}));case"ForStatement":return function(e,n){try{return null!==n.init?D(e,n.init).then((()=>(0,I.create)(((t,r)=>{j(e,n,{testResult:!0,lastAction:f.v},(e=>{t(e)}),(e=>{r(e)}),0)})))):(0,I.create)(((t,r)=>{j(e,n,{testResult:!0,lastAction:f.v},(e=>{t(e)}),(e=>{r(e)}),0)}))}catch(e){return(0,I.reject)(e)}}(e,n);case"ForInStatement":return s=e,g=n,(0,I.create)(((e,n)=>{D(s,g.right).then((t=>{try{let r=null;r="VariableDeclaration"===g.left.type?D(s,g.left):(0,I.resolve)(),r.then((()=>{try{let r="";if("VariableDeclaration"===g.left.type){const e=g.left.declarations[0].id;"Identifier"===e.type&&(r=e.name)}else"Identifier"===g.left.type&&(r=g.left.name);if(!r)throw new Error((0,d.nodeErrorMessage)(g,"RUNTIME","INVALIDVARIABLE"));r=r.toLowerCase();let o=null;if(null!==s.localScope&&void 0!==s.localScope[r]&&(o=s.localScope[r]),null===o&&void 0!==s.globalScope[r]&&(o=s.globalScope[r]),null===o)return void n(new Error((0,d.nodeErrorMessage)(g,"RUNTIME","VARIABLENOTDECLARED")));(0,f.a)(t)||(0,f.f)(t)?V(s,g,t,{reject:n,resolve:e},o):(0,f.b)(t)?function(e,n,t,r,o,a){try{if(void 0===a&&(a="i"),0===t.length)return void r.resolve(f.v);_(e,n,t,o,0,a,(e=>{r.resolve(e)}),(e=>{r.reject(e)}),0)}catch(e){r.reject(e)}}(s,g,t,{reject:n,resolve:e},o):t instanceof i.default||(0,f.k)(t)?function(e,n,t,r,o){try{V(e,n,t.keys(),r,o,"k")}catch(e){r.reject(e)}}(s,g,t,{reject:n,resolve:e},o):(0,f.q)(t)?q(t.iterator(s.abortSignal),s,g,t,o,(n=>{e(n)}),(e=>{n(e)}),0):V(s,g,[],{reject:n,resolve:e},o)}catch(e){n(e)}}),n)}catch(e){n(e)}}),n)}));case"BreakStatement":return(0,I.resolve)(f.m);case"EmptyStatement":return(0,I.resolve)(f.v);case"ContinueStatement":return(0,I.resolve)(f.n);case"TemplateElement":return u=n,(0,I.resolve)(u.value?u.value.cooked:"");case"TemplateLiteral":return a=e,l=n,(0,I.create)((e=>{const n=[];(0,h.reduceArrayWithPromises)(l.expressions,((e,t,r,o)=>D(a,t).then((e=>{n[r]=(0,f.d)(e)})))).then((()=>{let t="",r=0;for(const e of l.quasis)t+=e.value?e.value.cooked:"",!1===e.tail&&(t+=n[r]?n[r]:"",r++);e(t)}))}));case"Identifier":return Z(e,n);case"MemberExpression":return function(e,n){try{return D(e,n.object).then((t=>{try{return null===t?(0,I.reject)(new Error((0,d.nodeErrorMessage)(n,"RUNTIME","NOTFOUND"))):!1===n.computed?"Identifier"===n.property.type?t instanceof i.default||(0,f.k)(t)?(0,I.resolve)(t.field(n.property.name)):t instanceof A.default?(0,I.resolve)(J(t,n.property.name,e,n)):(0,I.reject)(new Error((0,d.nodeErrorMessage)(n,"RUNTIME","INVALIDTYPE"))):(0,I.reject)(new Error((0,d.nodeErrorMessage)(n,"RUNTIME","INVALIDTYPE"))):D(e,n.property).then((r=>(0,I.create)(((o,a)=>{if(t instanceof i.default||(0,f.k)(t))(0,f.f)(r)?o(t.field(r)):a(new Error((0,d.nodeErrorMessage)(n,"RUNTIME","INVALIDTYPE")));else if(t instanceof A.default)(0,f.f)(r)?o(J(t,r,e,n)):a(new Error((0,d.nodeErrorMessage)(n,"RUNTIME","INVALIDTYPE")));else if((0,f.a)(t))if((0,f.j)(r)&&isFinite(r)&&Math.floor(r)===r){if(r<0&&(r=t.length+r),r>=t.length||r<0)throw new Error((0,d.nodeErrorMessage)(n,"RUNTIME","OUTOFBOUNDS"));o(t[r])}else a(new Error((0,d.nodeErrorMessage)(n,"RUNTIME","INVALIDTYPE")));else if((0,f.b)(t))if((0,f.j)(r)&&isFinite(r)&&Math.floor(r)===r){if(r<0&&(r=t.length()+r),r>=t.length()||r<0)throw new Error((0,d.nodeErrorMessage)(n,"RUNTIME","OUTOFBOUNDS"));o(t.get(r))}else a(new Error((0,d.nodeErrorMessage)(n,"RUNTIME","INVALIDTYPE")));else if((0,f.f)(t))if((0,f.j)(r)&&isFinite(r)&&Math.floor(r)===r){if(r<0&&(r=t.length+r),r>=t.length||r<0)throw new Error((0,d.nodeErrorMessage)(n,"RUNTIME","OUTOFBOUNDS"));o(t[r])}else a(new Error((0,d.nodeErrorMessage)(n,"RUNTIME","INVALIDTYPE")));else a(new Error((0,d.nodeErrorMessage)(n,"RUNTIME","INVALIDTYPE")))}))))}catch(e){return F(e)}}))}catch(e){return F(e)}}(e,n);case"Literal":return O(n.value);case"CallExpression":return function(e,n){try{if("Identifier"!==n.callee.type)return F((0,d.nodeErrorMessage)(n,"RUNTIME","ONLYNODESSUPPORTED"));if(null!==e.localScope&&void 0!==e.localScope[n.callee.name.toLowerCase()]){const t=e.localScope[n.callee.name.toLowerCase()];return t.value instanceof f.N?t.value.fn(e,n):t.value instanceof c.default?re(e,n,t.value.definition):F((0,d.nodeErrorMessage)(n,"RUNTIME","NOTAFUNCTION"))}if(void 0!==e.globalScope[n.callee.name.toLowerCase()]){const t=e.globalScope[n.callee.name.toLowerCase()];return t.value instanceof f.N?t.value.fn(e,n):t.value instanceof c.default?re(e,n,t.value.definition):F((0,d.nodeErrorMessage)(n,"RUNTIME","NOTAFUNCTION"))}return F((0,d.nodeErrorMessage)(n,"RUNTIME","NOTFOUND"))}catch(e){return F(e)}}(e,n);case"UnaryExpression":return function(e,n){try{return D(e,n.argument).then((e=>(0,I.create)(((t,r)=>{(0,f.i)(e)&&"!"===n.operator?t(!e):"-"===n.operator?t(-1*(0,f.t)(e)):"+"===n.operator?t(1*(0,f.t)(e)):"~"===n.operator?t(~(0,f.t)(e)):r(new Error((0,d.nodeErrorMessage)(n,"RUNTIME","NOTSUPPORTEDUNARYOPERATOR")))}))))}catch(e){return F(e)}}(e,n);case"BinaryExpression":return function(e,n){try{return(0,I.all)([D(e,n.left),D(e,n.right)]).then((e=>(0,I.create)(((t,r)=>{const o=e[0],a=e[1];switch(n.operator){case"|":case"<<":case">>":case">>>":case"^":case"&":t((0,f.h)((0,f.t)(o),(0,f.t)(a),n.operator));case"==":t((0,f.e)(o,a));break;case"!=":t(!(0,f.e)(o,a));break;case"<":case">":case"<=":case">=":t((0,f.g)(o,a,n.operator));break;case"+":(0,f.f)(o)||(0,f.f)(a)?t((0,f.d)(o)+(0,f.d)(a)):t((0,f.t)(o)+(0,f.t)(a));break;case"-":t((0,f.t)(o)-(0,f.t)(a));break;case"*":t((0,f.t)(o)*(0,f.t)(a));break;case"/":t((0,f.t)(o)/(0,f.t)(a));break;case"%":t((0,f.t)(o)%(0,f.t)(a));break;default:r(new Error((0,d.nodeErrorMessage)(n,"RUNTIME","OPERATORNOTRECOGNISED")))}}))))}catch(e){return F(e)}}(e,n);case"LogicalExpression":return r=e,o=n,(0,I.create)(((e,n)=>{"AssignmentExpression"!==o.left.type&&"UpdateExpression"!==o.left.type?"AssignmentExpression"!==o.right.type&&"UpdateExpression"!==o.right.type?D(r,o.left).then((t=>{try{if(!(0,f.i)(t))throw new Error((0,d.nodeErrorMessage)(o,"RUNTIME","ONLYBOOLEAN"));switch(o.operator){case"||":!0===t?e(t):D(r,o.right).then((t=>{try{if(!(0,f.i)(t))throw new Error((0,d.nodeErrorMessage)(o,"RUNTIME","ONLYORORAND"));e(t)}catch(e){n(e)}}),n);break;case"&&":!1===t?e(t):D(r,o.right).then((t=>{try{if(!(0,f.i)(t))throw new Error((0,d.nodeErrorMessage)(o,"RUNTIME","ONLYORORAND"));e(t)}catch(e){n(e)}}),n);break;default:throw new Error((0,d.nodeErrorMessage)(o,"RUNTIME","ONLYORORAND"))}}catch(e){n(e)}}),n):n(new Error((0,d.nodeErrorMessage)(o.right,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"))):n(new Error((0,d.nodeErrorMessage)(o.left,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION")))}));case"ArrayExpression":return function(e,n){try{const t=[];for(let r=0;r<n.elements.length;r++)t.push(D(e,n.elements[r]));return(0,I.all)(t).then((e=>(0,I.create)(((t,r)=>{for(let t=0;t<e.length;t++){if((0,f.c)(e[t]))return void r(new Error((0,d.nodeErrorMessage)(n,"RUNTIME","FUNCTIONCONTEXTILLEGAL")));e[t]===f.v&&(e[t]=null)}t(e)}))))}catch(e){return F(e)}}(e,n);case"ObjectExpression":return function(e,n){try{const t=[];for(let r=0;r<n.properties.length;r++)t.push(D(e,n.properties[r]));return(0,I.all)(t).then((e=>(0,I.create)((n=>{const t={};for(let n=0;n<e.length;n++){const r=e[n];if((0,f.c)(r.value))throw new Error("Illegal Argument");if(!1===(0,f.f)(r.key))throw new Error("Illegal Argument");r.value===f.v?t[r.key.toString()]=null:t[r.key.toString()]=r.value}const r=new(0,i.default)(t);r.immutable=!1,n(r)}))))}catch(e){return F(e)}}(e,n);case"Property":return function(e,n){try{return D(e,n.value).then((t=>(0,I.create)((r=>{"Identifier"===n.key.type?r({key:n.key.name,value:t}):D(e,n.key).then((e=>{r({key:e,value:t})}))}))))}catch(e){return(0,I.reject)(e)}}(e,n);default:return F((0,d.nodeErrorMessage)(n,"RUNTIME","UNREOGNISED"))}}catch(e){return F(e)}var r,o,a,l,u,s,g,p,m,y,w,E,v}function P(e,n,t){try{return D(e,n.body).then((r=>{try{return t.lastAction=r,t.lastAction===f.m||t.lastAction instanceof f.R?(t.testResult=!1,(0,I.resolve)(t)):null!==n.update?D(e,n.update).then((()=>(0,I.resolve)(t))):(0,I.resolve)(t)}catch(e){return(0,I.reject)(e)}}))}catch(e){return(0,I.reject)(e)}}function j(e,n,t,r,o,a){try{(function(e,n,t){try{return null!==n.test?D(e,n.test).then((r=>{try{return!0===e.abortSignal.aborted?(0,I.reject)(new Error("Cancelled")):(t.testResult=r,!1===t.testResult?(0,I.resolve)(t):!0!==t.testResult?(0,I.reject)(new Error((0,d.nodeErrorMessage)(n,"RUNTIME","CANNOT_USE_NONBOOLEAN_IN_CONDITION"))):P(e,n,t))}catch(e){return(0,I.reject)(e)}})):P(e,n,t)}catch(e){return(0,I.reject)(e)}})(e,n,t).then((()=>{try{!0===t.testResult?++a>M?(a=0,setTimeout((()=>{j(e,n,t,r,o,a)}),0)):j(e,n,t,r,o,a):t.lastAction instanceof f.R?r(t.lastAction):r(f.v)}catch(e){o(e)}}),(e=>{o(e)}))}catch(e){o(e)}}function H(e,n,t,r,o,a,i,l,c,u){try{if(r<=a)return void l(f.v);o.value="k"===i?t[a]:a,D(e,n.body).then((s=>{try{s instanceof f.R?l(s):s===f.m?l(f.v):++u>M?(u=0,setTimeout((()=>{H(e,n,t,r,o,a+1,i,l,c,u)}),0)):H(e,n,t,r,o,a+1,i,l,c,u)}catch(e){c(e)}}),(e=>{c(e)}))}catch(e){c(e)}}function _(e,n,t,r,o,a,i,l,c){try{if(t.length()<=o)return void i(f.v);r.value="k"===a?t.get(o):o,D(e,n.body).then((u=>{u instanceof f.R?i(u):u===f.m?i(f.v):++c>M?(c=0,setTimeout((()=>{_(e,n,t,r,o+1,a,i,l,c)}),0)):_(e,n,t,r,o+1,a,i,l,c)}),(e=>{l(e)}))}catch(e){l(e)}}function V(e,n,t,r,o,a){try{if(void 0===a&&(a="i"),0===t.length)return void r.resolve(f.v);H(e,n,t,t.length,o,0,a,(e=>{r.resolve(e)}),(e=>{r.reject(e)}),0)}catch(e){r.reject(e)}}function q(e,n,t,r,o,a,i,c){try{e.next().then((u=>{try{if(null===u)a(f.v);else{const s=l.default.createFromGraphicLikeObject(u.geometry,u.attributes,r);s._underlyingGraphic=u,o.value=s,D(n,t.body).then((l=>{try{l===f.m?a(f.v):l instanceof f.R?a(l):++c>M?(c=0,setTimeout((()=>{q(e,n,t,r,o,a,i,c)}),0)):q(e,n,t,r,o,a,i,c)}catch(e){i(e)}}),(e=>{i(e)}))}}catch(e){i(e)}}),(e=>{i(e)}))}catch(e){i(e)}}function G(e,n,t,r){switch(n){case"=":return e===f.v?null:e;case"/=":return(0,f.t)(t)/(0,f.t)(e);case"*=":return(0,f.t)(t)*(0,f.t)(e);case"-=":return(0,f.t)(t)-(0,f.t)(e);case"+=":return(0,f.f)(t)||(0,f.f)(e)?(0,f.d)(t)+(0,f.d)(e):(0,f.t)(t)+(0,f.t)(e);case"%=":return(0,f.t)(t)%(0,f.t)(e);default:throw new Error((0,d.nodeErrorMessage)(r,"RUNTIME","OPERATORNOTRECOGNISED"))}}function B(e,n,t){try{return t>=n.body.length?(0,I.resolve)(f.v):(0,I.create)(((r,o)=>{D(e,n.body[t]).then((a=>{try{a instanceof f.R||a===f.m||a===f.n||t===n.body.length-1?r(a):B(e,n,t+1).then(r,o)}catch(e){o(e)}}),o)}))}catch(e){return F(e)}}function z(e,n,t){return(0,I.create)(((r,o)=>{t>=n.declarations.length?r(f.v):D(e,n.declarations[t]).then((()=>{t===n.declarations.length-1?r(f.v):z(e,n,t+1).then((()=>{r(f.v)}),o)}),o)}))}let Y=0;function J(e,n,t,r){let o;switch(n=n.toLowerCase()){case"hasz":{const n=e.hasZ;return void 0!==n&&n}case"hasm":{const n=e.hasM;return void 0!==n&&n}case"spatialreference":{let n=e.spatialReference._arcadeCacheId;if(void 0===n){let t=!0;Object.freeze&&Object.isFrozen(e.spatialReference)&&(t=!1),t&&(Y++,e.spatialReference._arcadeCacheId=Y,n=Y)}const t=new(0,i.default)({wkt:e.spatialReference.wkt,wkid:e.spatialReference.wkid});return void 0!==n&&(t._arcadeCacheId="SPREF"+n.toString()),t}}switch(e.type){case"extent":switch(n){case"xmin":case"xmax":case"ymin":case"ymax":case"zmin":case"zmax":case"mmin":case"mmax":{const t=e[n];return void 0!==t?t:null}case"type":return"Extent"}break;case"polygon":switch(n){case"rings":return o=e.cache._arcadeCacheId,void 0===o&&(Y++,o=Y,e.cache._arcadeCacheId=o),new(0,u.default)(e.rings,e.spatialReference,!0===e.hasZ,!0===e.hasM,o);case"type":return"Polygon"}break;case"point":switch(n){case"x":case"y":case"z":case"m":return void 0!==e[n]?e[n]:null;case"type":return"Point"}break;case"polyline":switch(n){case"paths":return o=e.cache._arcadeCacheId,void 0===o&&(Y++,o=Y,e.cache._arcadeCacheId=o),new(0,u.default)(e.paths,e.spatialReference,!0===e.hasZ,!0===e.hasM,o);case"type":return"Polyline"}break;case"multipoint":switch(n){case"points":return o=e.cache._arcadeCacheId,void 0===o&&(Y++,o=Y,e.cache._arcadeCacheId=o),new(0,s.default)(e.points,e.spatialReference,!0===e.hasZ,!0===e.hasM,o,1);case"type":return"Multipoint"}}throw new Error((0,d.nodeErrorMessage)(r,"RUNTIME","PROPERTYNOTFOUND"))}function Z(e,n){return(0,I.create)(((t,r)=>{const o=n.name.toLowerCase();if(null===e.localScope||void 0===e.localScope[o])if(void 0===e.globalScope[o])r(new Error((0,d.nodeErrorMessage)(n,"RUNTIME","VARIABLENOTFOUND")));else{const n=e.globalScope[o];!0===n.valueset?t(n.value):null!==n.d?n.d.then(t,r):(n.d=D(e,n.node),n.d.then((e=>{try{n.value=e,n.valueset=!0,t(e)}catch(e){r(e)}}),r))}else{const n=e.localScope[o];!0===n.valueset?t(n.value):null!==n.d?n.d.then(t,r):(n.d=D(e,n.node),n.d.then((e=>{try{n.value=e,n.valueset=!0,t(e)}catch(e){r(e)}}),r))}}))}const W={};function X(e){return null===e?"":(0,f.a)(e)||(0,f.b)(e)?"Array":(0,f.o)(e)?"Date":(0,f.f)(e)?"String":(0,f.i)(e)?"Boolean":(0,f.j)(e)?"Number":e instanceof a.default?"Attachment":e instanceof o.default?"Portal":e instanceof i.default?"Dictionary":(0,f.k)(e)?"Feature":e instanceof C.default?"Point":e instanceof R.default?"Polygon":e instanceof x.default?"Polyline":e instanceof b.default?"Multipoint":e instanceof N.default?"Extent":(0,f.c)(e)?"Function":(0,f.q)(e)?"FeatureSet":(0,f.r)(e)?"FeatureSetCollection":e===f.v?"":"number"==typeof e&&isNaN(e)?"Number":"Unrecognised Type"}function K(e,n,t,r){return(0,I.create)(((o,a)=>{D(e,n.arguments[t]).then((i=>{try{if((0,f.e)(i,r))return void D(e,n.arguments[t+1]).then(o,a);{const i=n.arguments.length-t;return 1===i?void D(e,n.arguments[t]).then(o,a):(2===i&&o(null),3===i?void D(e,n.arguments[t+2]).then(o,a):void K(e,n,t+2,r).then(o,a))}}catch(e){a(e)}}),a)}))}function Q(e,n,t,r){return(0,I.create)(((o,a)=>{!0===r?D(e,n.arguments[t+1]).then(o,a):3==n.arguments.length-t?D(e,n.arguments[t+2]).then(o,a):D(e,n.arguments[t+2]).then((r=>{try{if(!1===(0,f.i)(r))return void a(new Error("WHEN needs boolean test conditions"));Q(e,n,t+2,r).then(o,a)}catch(e){a(e)}}))}))}function $(e,n){try{const t=e.length,r=Math.floor(t/2);return 0===t?(0,I.resolve)([]):1===t?(0,I.resolve)([e[0]]):(0,I.create)(((o,a)=>{const i=[$(e.slice(0,r),n),$(e.slice(r,t),n)];(0,I.all)(i).then((e=>{try{ee(e[0],e[1],n,[]).then(o,a)}catch(e){a(e)}}),a)}))}catch(e){return F(e)}}function ee(e,n,t,r){return(0,I.create)(((o,a)=>{const i=r;e.length>0||n.length>0?e.length>0&&n.length>0?t(e[0],n[0]).then((l=>{try{isNaN(l)&&(l=1),l<=0?(i.push(e[0]),e=e.slice(1)):(i.push(n[0]),n=n.slice(1)),ee(e,n,t,r).then(o,a)}catch(e){a(e)}}),a):e.length>0?(i.push(e[0]),ee(e=e.slice(1),n,t,r).then(o,a)):n.length>0&&(i.push(n[0]),n=n.slice(1),ee(e,n,t,r).then(o,a)):o(r)}))}function ne(e,n){const t=e.length,r=Math.floor(t/2);return n||(n=function(e,n){return e<n?-1:e===n?0:1}),0===t?[]:1===t?[e[0]]:function(e,n,t){const r=[];for(;e.length>0||n.length>0;)if(e.length>0&&n.length>0){let o=t(e[0],n[0]);isNaN(o)&&(o=1),o<=0?(r.push(e[0]),e=e.slice(1)):(r.push(n[0]),n=n.slice(1))}else e.length>0?(r.push(e[0]),e=e.slice(1)):n.length>0&&(r.push(n[0]),n=n.slice(1));return r}(ne(e.slice(0,r),n),ne(e.slice(r,t),n),n)}function te(e,n,t){try{const r=e.body;if(t.length!==e.params.length)return F(new Error("Invalid Parameter calls to function."));for(let r=0;r<t.length;r++){const o=e.params[r];"Identifier"===o.type&&(n.localScope[o.name.toLowerCase()]={d:null,value:t[r],valueset:!0,node:null})}return D(n,r).then((e=>(0,I.create)(((n,t)=>{e instanceof f.R?n(e.value):e!==f.m?e!==f.n?n(e instanceof f.I?e.value:e):t(new Error("Cannot Continue from a Function")):t(new Error("Cannot Break from a Function"))}))))}catch(e){return(0,I.reject)(e)}}function re(e,n,t){return k(e,n,(function(n,r,o){const a={spatialReference:e.spatialReference,services:e.services,console:e.console,lrucache:e.lrucache,interceptor:e.interceptor,localScope:{},abortSignal:e.abortSignal,globalScope:e.globalScope,depthCounter:e.depthCounter+1};if(a.depthCounter>64)throw new Error("Exceeded maximum function depth");return te(t,a,o)}))}function oe(e){return function(){const n={abortSignal:e.context.abortSignal,spatialReference:e.context.spatialReference,console:e.context.console,lrucache:e.context.lrucache,interceptor:e.context.interceptor,services:e.context.services,localScope:{},globalScope:e.context.globalScope,depthCounter:e.context.depthCounter+1};if(n.depthCounter>64)throw new Error("Exceeded maximum function depth");return te(e.definition,n,arguments)}}(0,p.registerFunctions)(W,L),(0,v.registerFunctions)(W,L),(0,w.registerFunctions)(W,L),(0,y.registerFunctions)(W,L),(0,E.registerFunctions)(W,L),(0,m.registerFunctions)({functions:W,compiled:!1,signatures:null,failDefferred:null,evaluateIdentifier:null,arcadeCustomFunctionHandler:null,mode:"async",standardFunction:L,standardFunctionAsync:k}),W.typeof=function(e,n){return L(e,n,(function(e,n,t){(0,f.p)(t,1,1);const r=X(t[0]);if("Unrecognised Type"===r)throw new Error("Unrecognised Type");return r}))},W.iif=function(e,n){return(0,I.create)(((t,r)=>{(0,f.p)(null===n.arguments?[]:n.arguments,3,3),D(e,n.arguments[0]).then((o=>{try{if(!1===(0,f.i)(o))return void r(new Error("IF Function must have a boolean test condition"));(0,I.all)([D(e,n.arguments[1]),D(e,n.arguments[2])]).then((e=>{t(o?e[0]:e[1])}),r)}catch(e){r(e)}}),r)}))},W.decode=function(e,n){return(0,I.create)(((t,r)=>{n.arguments.length<2?r(new Error("Missing Parameters")):2!==n.arguments.length?(n.arguments.length-1)%2!=0?D(e,n.arguments[0]).then((o=>{try{K(e,n,1,o).then(t,r)}catch(e){r(e)}}),r):r(new Error("Must have a default value result.")):D(e,n.arguments[1]).then(t,r)}))},W.when=function(e,n){try{return n.arguments.length<3?F("Missing Parameters"):n.arguments.length%2==0?F("Must have a default value result."):D(e,n.arguments[0]).then((t=>(0,I.create)(((r,o)=>{!1!==(0,f.i)(t)?Q(e,n,0,t).then(r,o):o(new Error("WHEN needs boolean test conditions"))}))))}catch(e){return F(e)}},W.sort=function(e,n){return k(e,n,(function(e,n,t){(0,f.p)(t,1,2);let r=t[0];if((0,f.b)(r)&&(r=r.toArray()),!1===(0,f.a)(r))return F(Error("Illegal Argument"));if(t.length>1)return!1===(0,f.c)(t[1])?F(Error("Illegal Argument")):$(r,oe(t[1]));{let e=r;if(0===e.length)return(0,I.resolve)([]);const n={};for(let t=0;t<e.length;t++){const r=X(e[t]);""!==r&&(n[r]=!0)}if(!0===n.Array||!0===n.Dictionary||!0===n.Feature||!0===n.Point||!0===n.Polygon||!0===n.Polyline||!0===n.Multipoint||!0===n.Extent||!0===n.Function)return(0,I.resolve)(e.slice(0));let t=0,o="";for(const e in n)t++,o=e;return t>1||"String"===o?e=ne(e,(function(e,n){if(null==e||e===f.v)return null==n||n===f.v?0:1;if(null==n||n===f.v)return-1;const t=(0,f.d)(e),r=(0,f.d)(n);return t<r?-1:t===r?0:1})):"Number"===o?e=ne(e,(function(e,n){return e-n})):"Boolean"===o?e=ne(e,(function(e,n){return e===n?0:n?-1:1})):"Date"===o&&(e=ne(e,(function(e,n){return n-e}))),(0,I.resolve)(e)}}))};const ae={failDefferred:F,resolveDeffered:O,fixSpatialReference:f.s,parseArguments:U,standardFunction:L,standardFunctionAsync:k,evaluateIdentifier:Z,arcadeCustomFunction:oe};for(const e in W)W[e]={value:new(0,f.N)(W[e]),valueset:!0,node:null};const ie=function(){};function le(e){console.log(e)}(ie.prototype=W).infinity={value:Number.POSITIVE_INFINITY,valueset:!0,node:null},ie.prototype.pi={value:Math.PI,valueset:!0,node:null};const ce=ae;function ue(e){const n={mode:"async",compiled:!1,functions:{},signatures:[],standardFunction:L,standardFunctionAsync:k,failDefferred:F,evaluateIdentifier:Z,arcadeCustomFunctionHandler:oe};for(let t=0;t<e.length;t++)e[t].registerFunctions(n);for(const e in n.functions)W[e]={value:new(0,f.N)(n.functions[e]),valueset:!0,node:null},ie.prototype[e]=W[e];for(let e=0;e<n.signatures.length;e++)(0,d.addFunctionDeclaration)(n.signatures[e],"async")}function se(e,n){let t=n.spatialReference;null==t&&(t=new(0,T.default)({wkid:102100}));const r=function(e,n){const t=new ie;null==e&&(e={}),null==n&&(n={});const r=new(0,i.default)({newline:"\n",tab:"\t",singlequote:"'",doublequote:'"',forwardslash:"/",backwardslash:"\\"});r.immutable=!1,t.textformatting={value:r,valueset:!0,node:null};for(const e in n)t[e]={value:new(0,f.N)(n[e]),native:!0,valueset:!0,node:null};for(const n in e)e[n]&&"esri.Graphic"===e[n].declaredClass?t[n]={value:l.default.createFromGraphic(e[n]),valueset:!0,node:null}:t[n]={value:e[n],valueset:!0,node:null};return t}(n.vars,n.customfunctions);return D({spatialReference:t,services:n.services,abortSignal:void 0===n.abortSignal||null===n.abortSignal?{aborted:!1}:n.abortSignal,globalScope:r,console:n.console?n.console:le,lrucache:n.lrucache,interceptor:n.interceptor,localScope:null,depthCounter:1},e.body[0].body).then((e=>(0,I.create)(((n,t)=>{e instanceof f.R&&(e=e.value),e instanceof f.I&&(e=e.value),e===f.v&&(e=null),e!==f.m?e!==f.n?e instanceof f.N||e instanceof c.default?t(new Error("Cannot return FUNCTION")):n(e):t(new Error("Cannot return CONTINUE")):t(new Error("Cannot return BREAK"))}))))}function fe(e,n){return(0,d.findFieldLiterals)(e)}function de(e,n){return(0,d.validateScript)(e,n,"full")}function he(e,n){return(0,d.referencesMember)(e,n)}function ge(e,n){return(0,d.referencesFunction)(e,n)}function pe(e){return(0,d.findFunctionCalls)(e)}ue([g.A])})),n.register("jB7L7",(function(t,r){e(t.exports,"registerFunctions",(function(){return I}));var o=n("1mmm2"),a=n("k26HV"),i=n("hyHkL"),l=n("DM8Rh"),c=n("lHg4e"),u=n("2WnyR"),s=n("eqMhf"),f=n("jVdcX"),d=n("5vMQI"),h=n("dZxPT"),g=n("etknW"),p=n("7blCc"),m=n("86d4E"),y=n("zPXCh");function w(e){return 0===o.version.indexOf("4.")?g.default.fromExtent(e):new(0,g.default)({spatialReference:e.spatialReference,rings:[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]})}function E(e){if((0,i.p)(e,2,2),e[0]instanceof s.default&&e[1]instanceof s.default);else if(e[0]instanceof s.default&&null===e[1]);else if(e[1]instanceof s.default&&null===e[0]);else if(null!==e[0]||null!==e[1])throw new Error("Illegal Argument")}function v(e,n){if("polygon"!==e.type&&"polyline"!==e.type&&"extent"!==e.type)return(0,c.resolve)(0);let t=1;(e.spatialReference.vcsWkid||e.spatialReference.latestVcsWkid)&&(t=(0,l.getMetersPerVerticalUnitForSR)(e.spatialReference)/(0,y.getMetersPerUnitForSR)(e.spatialReference));let r=0;if("polyline"===e.type)for(const n of e.paths)for(let e=1;e<n.length;e++)r+=(0,l.segmentLength3d)(n[e],n[e-1],t);else if("polygon"===e.type)for(const n of e.rings){for(let e=1;e<n.length;e++)r+=(0,l.segmentLength3d)(n[e],n[e-1],t);(n[0][0]!==n[n.length-1][0]||n[0][1]!==n[n.length-1][1]||void 0!==n[0][2]&&n[0][2]!==n[n.length-1][2])&&(r+=(0,l.segmentLength3d)(n[0],n[n.length-1],t))}else"extent"===e.type&&(r+=2*(0,l.segmentLength3d)([e.xmin,e.ymin,0],[e.xmax,e.ymin,0],t),r+=2*(0,l.segmentLength3d)([e.xmin,e.ymin,0],[e.xmin,e.ymax,0],t),r*=2,r+=4*Math.abs((0,i.C)(e.zmax,0)*t-(0,i.C)(e.zmin,0)*t));const o=new(0,p.default)({hasZ:!1,hasM:!1,spatialReference:e.spatialReference,paths:[[0,0],[0,r]]});return(0,f.planarLength)(o,n)}function I(e){"async"===e.mode&&(e.functions.disjoint=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){return E(t=(0,i.H)(t)),null===t[0]||null===t[1]||(0,f.disjoint)(t[0],t[1])}))},e.functions.intersects=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){return E(t=(0,i.H)(t)),null!==t[0]&&null!==t[1]&&(0,f.intersects)(t[0],t[1])}))},e.functions.touches=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){return E(t=(0,i.H)(t)),null!==t[0]&&null!==t[1]&&(0,f.touches)(t[0],t[1])}))},e.functions.crosses=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){return E(t=(0,i.H)(t)),null!==t[0]&&null!==t[1]&&(0,f.crosses)(t[0],t[1])}))},e.functions.within=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){return E(t=(0,i.H)(t)),null!==t[0]&&null!==t[1]&&(0,f.within)(t[0],t[1])}))},e.functions.contains=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){return E(t=(0,i.H)(t)),null!==t[0]&&null!==t[1]&&(0,f.contains)(t[0],t[1])}))},e.functions.overlaps=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){return E(t=(0,i.H)(t)),null!==t[0]&&null!==t[1]&&(0,f.overlaps)(t[0],t[1])}))},e.functions.equals=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){return(0,i.p)(t,2,2),t[0]===t[1]||(t[0]instanceof s.default&&t[1]instanceof s.default?(0,f.equals)(t[0],t[1]):!(!(0,i.o)(t[0])||!(0,i.o)(t[1]))&&t[0].getTime()===t[1].getTime())}))},e.functions.relate=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){if(t=(0,i.H)(t),(0,i.p)(t,3,3),t[0]instanceof s.default&&t[1]instanceof s.default)return(0,f.relate)(t[0],t[1],(0,i.d)(t[2]));if(t[0]instanceof s.default&&null===t[1])return!1;if(t[1]instanceof s.default&&null===t[0])return!1;if(null===t[0]&&null===t[1])return!1;throw new Error("Illegal Argument")}))},e.functions.intersection=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){return E(t=(0,i.H)(t)),null===t[0]||null===t[1]?null:(0,f.intersect)(t[0],t[1])}))},e.functions.union=function(n,t){return e.standardFunctionAsync(n,t,(function(e,t,r){const o=[];if(0===(r=(0,i.H)(r)).length)throw new Error("Function called with wrong number of Parameters");if(1===r.length)if((0,i.a)(r[0])){const e=(0,i.H)(r[0]);for(let n=0;n<e.length;n++)if(null!==e[n]){if(!(e[n]instanceof s.default))throw new Error("Illegal Argument");o.push(e[n])}}else{if(!(0,i.b)(r[0])){if(r[0]instanceof s.default)return(0,i.s)((0,a.cloneGeometry)(r[0]),n.spatialReference);if(null===r[0])return null;throw new Error("Illegal Argument")}{const e=(0,i.H)(r[0].toArray());for(let n=0;n<e.length;n++)if(null!==e[n]){if(!(e[n]instanceof s.default))throw new Error("Illegal Argument");o.push(e[n])}}}else for(let e=0;e<r.length;e++)if(null!==r[e]){if(!(r[e]instanceof s.default))throw new Error("Illegal Argument");o.push(r[e])}return 0===o.length?null:(0,f.union)(o)}))},e.functions.difference=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){return E(t=(0,i.H)(t)),null!==t[0]&&null===t[1]?(0,a.cloneGeometry)(t[0]):null===t[0]?null:(0,f.difference)(t[0],t[1])}))},e.functions.symmetricdifference=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){return E(t=(0,i.H)(t)),null===t[0]&&null===t[1]?null:null===t[0]?(0,a.cloneGeometry)(t[1]):null===t[1]?(0,a.cloneGeometry)(t[0]):(0,f.symmetricDifference)(t[0],t[1])}))},e.functions.clip=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){if(t=(0,i.H)(t),(0,i.p)(t,2,2),!(t[1]instanceof u.default)&&null!==t[1])throw new Error("Illegal Argument");if(null===t[0])return null;if(!(t[0]instanceof s.default))throw new Error("Illegal Argument");return null===t[1]?null:(0,f.clip)(t[0],t[1])}))},e.functions.cut=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){if(t=(0,i.H)(t),(0,i.p)(t,2,2),!(t[1]instanceof p.default)&&null!==t[1])throw new Error("Illegal Argument");if(null===t[0])return[];if(!(t[0]instanceof s.default))throw new Error("Illegal Argument");return null===t[1]?[(0,a.cloneGeometry)(t[0])]:(0,f.cut)(t[0],t[1])}))},e.functions.area=function(n,t){return e.standardFunctionAsync(n,t,(function(e,t,r){if((0,i.p)(r,1,2),null===(r=(0,i.H)(r))[0])return 0;if((0,i.q)(r[0]))return r[0].sumArea((0,a.convertSquareUnitsToCode)((0,i.C)(r[1],-1)),!1,n.abortSignal).then((e=>{if(n.abortSignal.aborted)throw new Error("Operation has been cancelled.");return e}));if((0,i.a)(r[0])||(0,i.b)(r[0])){const e=(0,i.K)(r[0],n.spatialReference);return null===e?0:(0,f.planarArea)(e,(0,a.convertSquareUnitsToCode)((0,i.C)(r[1],-1)))}if(!(r[0]instanceof s.default))throw new Error("Illegal Argument");return(0,f.planarArea)(r[0],(0,a.convertSquareUnitsToCode)((0,i.C)(r[1],-1)))}))},e.functions.areageodetic=function(n,t){return e.standardFunctionAsync(n,t,(function(e,t,r){if((0,i.p)(r,1,2),null===(r=(0,i.H)(r))[0])return 0;if((0,i.q)(r[0]))return r[0].sumArea((0,a.convertSquareUnitsToCode)((0,i.C)(r[1],-1)),!0,n.abortSignal).then((e=>{if(n.abortSignal.aborted)throw new Error("Operation has been cancelled.");return e}));if((0,i.a)(r[0])||(0,i.b)(r[0])){const e=(0,i.K)(r[0],n.spatialReference);return null===e?0:(0,f.geodesicArea)(e,(0,a.convertSquareUnitsToCode)((0,i.C)(r[1],-1)))}if(!(r[0]instanceof s.default))throw new Error("Illegal Argument");return(0,f.geodesicArea)(r[0],(0,a.convertSquareUnitsToCode)((0,i.C)(r[1],-1)))}))},e.functions.length=function(n,t){return e.standardFunctionAsync(n,t,(function(e,t,r){if((0,i.p)(r,1,2),null===(r=(0,i.H)(r))[0])return 0;if((0,i.q)(r[0]))return r[0].sumLength((0,a.convertLinearUnitsToCode)((0,i.C)(r[1],-1)),!1,n.abortSignal).then((e=>{if(n.abortSignal.aborted)throw new Error("Operation has been cancelled.");return e}));if((0,i.a)(r[0])||(0,i.b)(r[0])){const e=(0,i.J)(r[0],n.spatialReference);return null===e?0:(0,f.planarLength)(e,(0,a.convertLinearUnitsToCode)((0,i.C)(r[1],-1)))}if(!(r[0]instanceof s.default))throw new Error("Illegal Argument");return(0,f.planarLength)(r[0],(0,a.convertLinearUnitsToCode)((0,i.C)(r[1],-1)))}))},e.functions.length3d=function(n,t){return e.standardFunctionAsync(n,t,(function(e,t,r){if((0,i.p)(r,1,2),null===(r=(0,i.H)(r))[0])return 0;if((0,i.a)(r[0])||(0,i.b)(r[0])){const e=(0,i.J)(r[0],n.spatialReference);return null===e?0:!0===e.hasZ?v(e,(0,a.convertLinearUnitsToCode)((0,i.C)(r[1],-1))):(0,f.planarLength)(e,(0,a.convertLinearUnitsToCode)((0,i.C)(r[1],-1)))}if(!(r[0]instanceof s.default))throw new Error("Illegal Argument");return!0===r[0].hasZ?v(r[0],(0,a.convertLinearUnitsToCode)((0,i.C)(r[1],-1))):(0,f.planarLength)(r[0],(0,a.convertLinearUnitsToCode)((0,i.C)(r[1],-1)))}))},e.functions.lengthgeodetic=function(n,t){return e.standardFunctionAsync(n,t,(function(e,t,r){if((0,i.p)(r,1,2),null===(r=(0,i.H)(r))[0])return 0;if((0,i.q)(r[0]))return r[0].sumLength((0,a.convertLinearUnitsToCode)((0,i.C)(r[1],-1)),!0,n.abortSignal).then((e=>{if(n.abortSignal.aborted)throw new Error("Operation has been cancelled.");return e}));if((0,i.a)(r[0])||(0,i.b)(r[0])){const e=(0,i.J)(r[0],n.spatialReference);return null===e?0:(0,f.geodesicLength)(e,(0,a.convertLinearUnitsToCode)((0,i.C)(r[1],-1)))}if(!(r[0]instanceof s.default))throw new Error("Illegal Argument");return(0,f.geodesicLength)(r[0],(0,a.convertLinearUnitsToCode)((0,i.C)(r[1],-1)))}))},e.functions.distance=function(n,t){return e.standardFunctionAsync(n,t,(function(e,t,r){r=(0,i.H)(r),(0,i.p)(r,2,3);let o=r[0];((0,i.a)(r[0])||(0,i.b)(r[0]))&&(o=(0,i.L)(r[0],n.spatialReference));let l=r[1];if(((0,i.a)(r[1])||(0,i.b)(r[1]))&&(l=(0,i.L)(r[1],n.spatialReference)),!(o instanceof s.default))throw new Error("Illegal Argument");if(!(l instanceof s.default))throw new Error("Illegal Argument");return(0,f.distance)(o,l,(0,a.convertLinearUnitsToCode)((0,i.C)(r[2],-1)))}))},e.functions.distancegeodetic=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){t=(0,i.H)(t),(0,i.p)(t,2,3);const r=t[0],o=t[1];if(!(r instanceof h.default))throw new Error("Illegal Argument");if(!(o instanceof h.default))throw new Error("Illegal Argument");const l=new(0,p.default)({paths:[],spatialReference:r.spatialReference});return l.addPath([r,o]),(0,f.geodesicLength)(l,(0,a.convertLinearUnitsToCode)((0,i.C)(t[2],-1)))}))},e.functions.densify=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){if(t=(0,i.H)(t),(0,i.p)(t,2,3),null===t[0])return null;if(!(t[0]instanceof s.default))throw new Error("Illegal Argument");const r=(0,i.t)(t[1]);if(isNaN(r))throw new Error("Illegal Argument");if(r<=0)throw new Error("Illegal Argument");return t[0]instanceof g.default||t[0]instanceof p.default?(0,f.densify)(t[0],r,(0,a.convertLinearUnitsToCode)((0,i.C)(t[2],-1))):t[0]instanceof u.default?(0,f.densify)(w(t[0]),r,(0,a.convertLinearUnitsToCode)((0,i.C)(t[2],-1))):t[0]}))},e.functions.densifygeodetic=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){if(t=(0,i.H)(t),(0,i.p)(t,2,3),null===t[0])return null;if(!(t[0]instanceof s.default))throw new Error("Illegal Argument");const r=(0,i.t)(t[1]);if(isNaN(r))throw new Error("Illegal Argument");if(r<=0)throw new Error("Illegal Argument");return t[0]instanceof g.default||t[0]instanceof p.default?(0,f.geodesicDensify)(t[0],r,(0,a.convertLinearUnitsToCode)((0,i.C)(t[2],-1))):t[0]instanceof u.default?(0,f.geodesicDensify)(w(t[0]),r,(0,a.convertLinearUnitsToCode)((0,i.C)(t[2],-1))):t[0]}))},e.functions.generalize=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){if(t=(0,i.H)(t),(0,i.p)(t,2,4),null===t[0])return null;if(!(t[0]instanceof s.default))throw new Error("Illegal Argument");const r=(0,i.t)(t[1]);if(isNaN(r))throw new Error("Illegal Argument");return(0,f.generalize)(t[0],r,(0,i.z)((0,i.C)(t[2],!0)),(0,a.convertLinearUnitsToCode)((0,i.C)(t[3],-1)))}))},e.functions.buffer=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){if(t=(0,i.H)(t),(0,i.p)(t,2,3),null===t[0])return null;if(!(t[0]instanceof s.default))throw new Error("Illegal Argument");const r=(0,i.t)(t[1]);if(isNaN(r))throw new Error("Illegal Argument");return 0===r?(0,a.cloneGeometry)(t[0]):(0,f.buffer)(t[0],r,(0,a.convertLinearUnitsToCode)((0,i.C)(t[2],-1)))}))},e.functions.buffergeodetic=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){if(t=(0,i.H)(t),(0,i.p)(t,2,3),null===t[0])return null;if(!(t[0]instanceof s.default))throw new Error("Illegal Argument");const r=(0,i.t)(t[1]);if(isNaN(r))throw new Error("Illegal Argument");return 0===r?(0,a.cloneGeometry)(t[0]):(0,f.geodesicBuffer)(t[0],r,(0,a.convertLinearUnitsToCode)((0,i.C)(t[2],-1)))}))},e.functions.offset=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){if(t=(0,i.H)(t),(0,i.p)(t,2,6),null===t[0])return null;if(!(t[0]instanceof g.default||t[0]instanceof p.default))throw new Error("Illegal Argument");const r=(0,i.t)(t[1]);if(isNaN(r))throw new Error("Illegal Argument");const o=(0,i.t)((0,i.C)(t[4],10));if(isNaN(o))throw new Error("Illegal Argument");const l=(0,i.t)((0,i.C)(t[5],0));if(isNaN(l))throw new Error("Illegal Argument");return(0,f.offset)(t[0],r,(0,a.convertLinearUnitsToCode)((0,i.C)(t[2],-1)),(0,i.d)((0,i.C)(t[3],"round")).toLowerCase(),o,l)}))},e.functions.rotate=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){t=(0,i.H)(t),(0,i.p)(t,2,3);let r=t[0];if(null===r)return null;if(!(r instanceof s.default))throw new Error("Illegal Argument");r instanceof u.default&&(r=g.default.fromExtent(r));const o=(0,i.t)(t[1]);if(isNaN(o))throw new Error("Illegal Argument");const a=(0,i.C)(t[2],null);if(null===a)return(0,f.rotate)(r,o);if(a instanceof h.default)return(0,f.rotate)(r,o,a);throw new Error("Illegal Argument")}))},e.functions.centroid=function(n,t){return e.standardFunctionAsync(n,t,(function(e,t,r){if(r=(0,i.H)(r),(0,i.p)(r,1,1),null===r[0])return null;let o=r[0];if(((0,i.a)(r[0])||(0,i.b)(r[0]))&&(o=(0,i.L)(r[0],n.spatialReference)),null===o)return null;if(!(o instanceof s.default))throw new Error("Illegal Argument");return o instanceof h.default?(0,i.s)((0,a.cloneGeometry)(r[0]),n.spatialReference):o instanceof g.default?o.centroid:o instanceof p.default?(0,l.centroidPolyline)(o):o instanceof d.default?(0,l.centroidMultiPoint)(o):o instanceof u.default?o.center:null}))},e.functions.multiparttosinglepart=function(n,t){return e.standardFunctionAsync(n,t,(function(e,t,r){r=(0,i.H)(r),(0,i.p)(r,1,1);const o=[];if(null===r[0])return null;if(!(r[0]instanceof s.default))throw new Error("Illegal Argument");return r[0]instanceof h.default||r[0]instanceof u.default?[(0,i.s)((0,a.cloneGeometry)(r[0]),n.spatialReference)]:(0,f.simplify)(r[0]).then((e=>{if(e instanceof g.default){const n=[],t=[];for(let r=0;r<e.rings.length;r++)if(e.isClockwise(e.rings[r])){const t=(0,m.fromJSON)({rings:[e.rings[r]],hasZ:!0===e.hasZ,hazM:!0===e.hasM,spatialReference:e.spatialReference.toJSON()});n.push(t)}else t.push({ring:e.rings[r],pt:e.getPoint(r,0)});for(let e=0;e<t.length;e++)for(let r=0;r<n.length;r++)if(n[r].contains(t[e].pt)){n[r].addRing(t[e].ring);break}return n}if(e instanceof p.default){const n=[];for(let t=0;t<e.paths.length;t++){const r=(0,m.fromJSON)({paths:[e.paths[t]],hasZ:!0===e.hasZ,hazM:!0===e.hasM,spatialReference:e.spatialReference.toJSON()});n.push(r)}return n}if(r[0]instanceof d.default){const e=(0,i.s)((0,a.cloneGeometry)(r[0]),n.spatialReference);for(let n=0;n<e.points.length;n++)o.push(e.getPoint(n));return o}return null}))}))},e.functions.issimple=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){if(t=(0,i.H)(t),(0,i.p)(t,1,1),null===t[0])return!0;if(!(t[0]instanceof s.default))throw new Error("Illegal Argument");return(0,f.isSimple)(t[0])}))},e.functions.simplify=function(n,t){return e.standardFunctionAsync(n,t,(function(e,n,t){if(t=(0,i.H)(t),(0,i.p)(t,1,1),null===t[0])return null;if(!(t[0]instanceof s.default))throw new Error("Illegal Argument");return(0,f.simplify)(t[0])}))})}})),n.register("jVdcX",(function(t,r){e(t.exports,"clip",(function(){return f})),e(t.exports,"cut",(function(){return d})),e(t.exports,"contains",(function(){return h})),e(t.exports,"crosses",(function(){return g})),e(t.exports,"distance",(function(){return p})),e(t.exports,"equals",(function(){return m})),e(t.exports,"intersects",(function(){return y})),e(t.exports,"touches",(function(){return w})),e(t.exports,"within",(function(){return E})),e(t.exports,"disjoint",(function(){return v})),e(t.exports,"overlaps",(function(){return I})),e(t.exports,"relate",(function(){return N})),e(t.exports,"isSimple",(function(){return A})),e(t.exports,"simplify",(function(){return b})),e(t.exports,"difference",(function(){return C})),e(t.exports,"symmetricDifference",(function(){return R})),e(t.exports,"intersect",(function(){return x})),e(t.exports,"union",(function(){return T})),e(t.exports,"offset",(function(){return S})),e(t.exports,"buffer",(function(){return M})),e(t.exports,"geodesicBuffer",(function(){return F})),e(t.exports,"rotate",(function(){return U})),e(t.exports,"generalize",(function(){return L})),e(t.exports,"densify",(function(){return k})),e(t.exports,"geodesicDensify",(function(){return D})),e(t.exports,"planarArea",(function(){return P})),e(t.exports,"planarLength",(function(){return j})),e(t.exports,"geodesicArea",(function(){return H})),e(t.exports,"geodesicLength",(function(){return _})),n("ixrNB");var o=n("lHDjA"),a=(n("dZxPT"),n("86d4E"));function i(e){var n;return Array.isArray(e)?null==(n=e[0])?void 0:n.spatialReference:null==e?void 0:e.spatialReference}function l(e){return e?Array.isArray(e)?e.map(l):e.toJSON?e.toJSON():e:e}function c(e){return Array.isArray(e)?e.map((e=>(0,a.fromJSON)(e))):(0,a.fromJSON)(e)}let u;async function s(e,n){return(await async function(){return u||(u=(0,o.open)("geometryEngineWorker",{strategy:"distributed"})),u}()).invoke("executeGEOperation",{operation:e,parameters:l(n)})}async function f(e,n){return c(await s("clip",[i(e),e,n]))}async function d(e,n){return c(await s("cut",[i(e),e,n]))}function h(e,n){return s("contains",[i(e),e,n])}function g(e,n){return s("crosses",[i(e),e,n])}function p(e,n,t){return s("distance",[i(e),e,n,t])}function m(e,n){return s("equals",[i(e),e,n])}function y(e,n){return s("intersects",[i(e),e,n])}function w(e,n){return s("touches",[i(e),e,n])}function E(e,n){return s("within",[i(e),e,n])}function v(e,n){return s("disjoint",[i(e),e,n])}function I(e,n){return s("overlaps",[i(e),e,n])}function N(e,n,t){return s("relate",[i(e),e,n,t])}function A(e){return s("isSimple",[i(e),e])}async function b(e){return c(await s("simplify",[i(e),e]))}async function C(e,n){return c(await s("difference",[i(e),e,n]))}async function R(e,n){return c(await s("symmetricDifference",[i(e),e,n]))}async function x(e,n){return c(await s("intersect",[i(e),e,n]))}async function T(e,n=null){const t=function(e,n){let t;return Array.isArray(e)?t=e:(t=[],t.push(e),null!=n&&t.push(n)),t}(e,n);return c(await s("union",[i(t),t]))}async function S(e,n,t,r,o,a){return c(await s("offset",[i(e),e,n,t,r,o,a]))}async function M(e,n,t,r=!1){const o=[i(e),e,n,t,r];return c(await s("buffer",o))}async function F(e,n,t,r,o,a){const l=[i(e),e,n,t,r,o,a];return c(await s("geodesicBuffer",l))}function O(e){return"xmin"in e?e.center:"x"in e?e:e.extent.center}async function U(e,n,t){var r;if(null==e)throw new Error("Illegal Argument Exception");const o=e.spatialReference;t=null!=(r=t)?r:O(e);const a=e.constructor.fromJSON(await s("rotate",[o,e,n,t]));return a.spatialReference=o,a}async function L(e,n,t,r){return c(await s("generalize",[i(e),e,n,t,r]))}async function k(e,n,t){return c(await s("densify",[i(e),e,n,t]))}async function D(e,n,t,r=0){return c(await s("geodesicDensify",[i(e),e,n,t,r]))}function P(e,n){return s("planarArea",[i(e),e,n])}function j(e,n){return s("planarLength",[i(e),e,n])}function H(e,n,t){return s("geodesicArea",[i(e),e,n,t])}function _(e,n,t){return s("geodesicLength",[i(e),e,n,t])}}));
//# sourceMappingURL=arcadeAsyncRuntime.15f41995.js.map
