!function(){function e(e,t,r,n){Object.defineProperty(e,t,{get:r,set:n,enumerable:!0,configurable:!0})}function t(e){return e&&e.__esModule?e.default:e}var r=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire594f;r.register("dEIm1",(function(t,n){e(t.exports,"featureAdapter",(function(){return p})),e(t.exports,"FeatureStore2D",(function(){return v}));var a=r("8TSCy"),i=r("gDoEW"),u=r("amfHf");r("2VlWd");var s=r("7qybv"),o=r("38gAI"),d=r("ayLat"),c=r("eOTSy"),l=r("esg0R");function f(e,t){return e<<16|t}function h(e){return(4294901760&e)>>>16}function y(e){return 65535&e}var p={getObjectId:function(e){return e.getObjectId()},getAttributes:function(e){return e.readAttributes()},getAttribute:function(e,t){return e.readAttribute(t)},cloneWithGeometry:function(e,t){return e},getGeometry:function(e){return e.readHydratedGeometry()},getCentroid:function(e,t){return e.readCentroid()}},v=function(e){"use strict";a.inherits(r,e);var t=a.createSuper(r);function r(e,n,s){var d;return a.classCallCheck(this,r),(d=t.call(this,e,n)).featureAdapter=p,d.events=new(0,u.default),d._featureSetsByInstance=new Map,d._objectIdToDisplayId=new Map,d._spatialIndexInvalid=!0,d._indexSearchCache=new(0,i.default)(50),d._index=(0,o.r)(9,(function(e){return{minX:d._storage.getXMin(e),minY:d._storage.getYMin(e),maxX:d._storage.getXMax(e),maxY:d._storage.getYMax(e)}})),d._storage=n,d.mode=s,a.possibleConstructorReturn(d)}return a.createClass(r,[{key:"storage",get:function(){return this._storage}},{key:"storeStatistics",get:function(){var e=0,t=0,r=0;return this.forEach((function(n){var a=n.readGeometry();a&&(t+=a.isPoint?1:a.lengths.reduce((function(e,t){return e+t}),0),r+=a.isPoint?1:a.lengths.length,e+=1)})),{featureCount:e,vertexCount:t,ringCount:r}}},{key:"hasInstance",value:function(e){return this._featureSetsByInstance.has(e)}},{key:"onTileData",value:function(e,t){if((0,s.isNone)(t.addOrUpdate))return t;if(t.addOrUpdate.attachStorage(this._storage),"snapshot"===this.mode){for(var r=t.addOrUpdate.getCursor();r.next();){var n=r.getDisplayId();this.setComputedAttributes(this._storage,r,n,e.scale)}return t}this._featureSetsByInstance.set(t.addOrUpdate.instance,t.addOrUpdate);for(var a=t.addOrUpdate.getCursor();a.next();)this._insertFeature(a,e.scale);return this._spatialIndexInvalid=!0,this.events.emit("changed"),t}},{key:"search",value:function(e){var t=this;this._rebuildIndex();var r=e.id,n=this._indexSearchCache.find((function(e){return e.tileId===r}));if((0,s.isSome)(n))return n.readers;var a=new Map,i=this._searchIndex(e.bounds),u=[],o=!0,d=!1,c=void 0;try{for(var f,p=i[Symbol.iterator]();!(o=(f=p.next()).done);o=!0){var v=f.value,g=this._storage.getInstanceId(v),_=h(g),I=y(g);a.has(_)||a.set(_,[]),a.get(_).push(I)}}catch(e){d=!0,c=e}finally{try{o||null==p.return||p.return()}finally{if(d)throw c}}return a.forEach((function(e,r){var n=t._featureSetsByInstance.get(r);u.push(l.FeatureSetReaderIndirect.from(n,e))})),this._indexSearchCache.enqueue({tileId:r,readers:u}),u}},{key:"insert",value:function(e){for(var t=e.getCursor(),r=this._storage;t.next();){var n,a=f(t.instance,t.getIndex()),i=t.getObjectId(),u=null!=(n=this._objectIdToDisplayId.get(i))?n:this._storage.createDisplayId();t.setDisplayId(u),r.setInstanceId(u,a),this._objectIdToDisplayId.set(i,u)}this._featureSetsByInstance.set(e.instance,e),this._spatialIndexInvalid=!0}},{key:"remove",value:function(e){var t=this._objectIdToDisplayId.get(e);if(t){var r=this._storage.getInstanceId(t),n=y(r),a=h(r),i=this._featureSetsByInstance.get(a);this._objectIdToDisplayId.delete(e),this._storage.releaseDisplayId(t),i.removeAtIndex(n),i.isEmpty&&this._featureSetsByInstance.delete(a),this._spatialIndexInvalid=!0}}},{key:"forEach",value:function(e){var t=this;this._objectIdToDisplayId.forEach((function(r){var n=t._storage.getInstanceId(r),a=t._lookupFeature(n);e(a)}))}},{key:"forEachUnsafe",value:function(e){var t=this;this._objectIdToDisplayId.forEach((function(r){var n=t._storage.getInstanceId(r),a=h(n),i=y(n),u=t._getFeatureSet(a);u.setIndex(i),e(u)}))}},{key:"forEachInBounds",value:function(e,t){var r=this._searchIndex(e),n=!0,a=!1,i=void 0;try{for(var u,o=r[Symbol.iterator]();!(n=(u=o.next()).done);n=!0){var d=u.value,c=this.lookupFeatureByDisplayId(d,this._storage);t((0,s.unwrap)(c))}}catch(e){a=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(a)throw i}}}},{key:"forEachBounds",value:function(e,t,r){this._rebuildIndex();var n=[0,0,0,0],a=!0,i=!1,u=void 0;try{for(var s,o=e[Symbol.iterator]();!(a=(s=o.next()).done);a=!0){var c=s.value;if(c.readGeometry()){var l=c.getDisplayId();n[0]=this._storage.getXMin(l),n[1]=this._storage.getYMin(l),n[2]=this._storage.getXMax(l),n[3]=this._storage.getYMax(l),t((0,d.fromRect)(r,n))}}}catch(e){i=!0,u=e}finally{try{a||null==o.return||o.return()}finally{if(i)throw u}}}},{key:"sweepFeatures",value:function(e,t,r){var n=this;this._spatialIndexInvalid=!0,this._objectIdToDisplayId.forEach((function(a,i){e.has(a)||(t.releaseDisplayId(a),r&&r.unsetAttributeData(a),n._objectIdToDisplayId.delete(i))})),this.events.emit("changed")}},{key:"sweepFeatureSets",value:function(e){var t=this;this._spatialIndexInvalid=!0,this._featureSetsByInstance.forEach((function(r,n){e.has(n)||t._featureSetsByInstance.delete(n)}))}},{key:"lookupObjectId",value:function(e,t){var r=this.lookupFeatureByDisplayId(e,t);return(0,s.isNone)(r)?null:r.getObjectId()}},{key:"lookupDisplayId",value:function(e){return this._objectIdToDisplayId.get(e)}},{key:"lookupFeatureByDisplayId",value:function(e,t){var r=t.getInstanceId(e);return this._lookupFeature(r)}},{key:"lookupByDisplayIdUnsafe",value:function(e){var t=this._storage.getInstanceId(e),r=h(t),n=y(t),a=this._getFeatureSet(r);return a?(a.setIndex(n),a):null}},{key:"_insertFeature",value:function(e,t){var r=this._storage,n=e.getObjectId(),a=f(e.instance,e.getIndex());r.getInstanceId(e.getDisplayId());var i=this._objectIdToDisplayId.get(n);i||(i=r.createDisplayId(),this._objectIdToDisplayId.set(n,i),this._spatialIndexInvalid=!0),e.setDisplayId(i),r.setInstanceId(i,a),this.setComputedAttributes(r,e,i,t)}},{key:"_searchIndex",value:function(e){this._rebuildIndex();var t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this._index.search(t)}},{key:"_rebuildIndex",value:function(){var e=this;if(this._spatialIndexInvalid){var t=[];"snapshot"===this.mode?this._featureSetsByInstance.forEach((function(r){for(var n=r.getCursor();n.next();){var a=n.getDisplayId();e._storage.setBounds(a,n)&&t.push(a)}})):this._objectIdToDisplayId.forEach((function(r){var n=e._storage.getInstanceId(r);e._storage.setBounds(r,e._lookupFeature(n))&&t.push(r)})),this._index.clear(),this._index.load(t),this._indexSearchCache.clear(),this._spatialIndexInvalid=!1}}},{key:"_lookupFeature",value:function(e){var t=h(e),r=y(e),n=this._getFeatureSet(t);if(!n)return null;var a=n.getCursor();return a.setIndex(r),a}},{key:"_getFeatureSet",value:function(e){return this._featureSetsByInstance.get(e)}}]),r}(c.Store2D)})),r.register("eOTSy",(function(n,a){e(n.exports,"Store2D",(function(){return h}));var i=r("8TSCy"),u=r("2TvXO"),s=r("2VlWd"),o=r("7qybv"),d=r("9doMy"),c=r("3nnTb"),l=r("6v4Fw"),f=r("31Af0"),h=function(){"use strict";function e(t,r){i.classCallCheck(this,e),this._canCacheExpressionValue=!1,this._sourceInfo=t,this._bitsets={computed:r.getBitset(r.createBitset())}}return i.createClass(e,[{key:"invalidate",value:function(){this._bitsets.computed.clear()}},{key:"updateSchema",value:function(e,r){var n=this;return i.asyncToGenerator(t(u).mark((function a(){var i,c,l,f,h,y;return t(u).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=(0,d.diff)(n._schema,r),n._schema=r,r&&!(0,o.isNone)(i)&&(0,d.hasDiff)(i,"attributes")){t.next=3;break}return t.abrupt("return");case 3:(0,s.default)("esri-2d-update-debug")&&console.debug("Applying Update - Store:",i),n._bitsets.computed.clear(),e.targets[r.name]=!0,c=r.attributes,l=[],f=[],t.t0=regeneratorRuntime.keys(c);case 6:if((t.t1=t.t0()).done){t.next=20;break}h=t.t1.value,y=c[h],t.t2=y.type,t.next="field"===t.t2?12:"expression"===t.t2?13:"label-expression"===t.t2?15:"statistic"===t.t2?17:18;break;case 12:return t.abrupt("break",18);case 13:return l.push(n._createArcadeComputedField(y)),t.abrupt("break",18);case 15:return l.push(n._createLabelArcadeComputedField(y)),t.abrupt("break",18);case 17:f.push(y);case 18:t.next=6;break;case 20:return t.next=22,Promise.all(l);case 22:n._computedFields=t.sent,n._canCacheExpressionValue=!n._computedFields.some((function(e){return"expression"===e.type&&e.expression.referencesScale()})),n._statisticFields=f;case 25:case"end":return t.stop()}}),a)})))()}},{key:"setComputedAttributes",value:function(e,t,r,n){var a=this._bitsets.computed;if(!this._canCacheExpressionValue||!a.has(r)){a.set(r);var i=!0,u=!1,s=void 0;try{for(var o,d=this._computedFields[Symbol.iterator]();!(i=(o=d.next()).done);i=!0){var c=o.value,l=this._evaluateField(t,c,n);switch(c.resultType){case"numeric":e.setComputedNumericAtIndex(r,c.fieldIndex,l);break;case"string":e.setComputedStringAtIndex(r,c.fieldIndex,l)}}}catch(e){u=!0,s=e}finally{try{i||null==d.return||d.return()}finally{if(u)throw s}}}}},{key:"_createArcadeComputedField",value:function(e){var r=this;return i.asyncToGenerator(t(u).mark((function n(){var a,s;return t(u).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=r._sourceInfo.spatialReference,s=r._sourceInfo.fieldsIndex,t.t0=i,t.t1={},t.t2=e,t.next=6,(0,c.createRendererExpression)(e.valueExpression,a,s);case 6:return t.t3=t.sent,t.t4={expression:t.t3},t.abrupt("return",t.t0.objectSpread.call(t.t0,t.t1,t.t2,t.t4));case 9:case"end":return t.stop()}}),n)})))()}},{key:"_createLabelArcadeComputedField",value:function(e){var r=this;return i.asyncToGenerator(t(u).mark((function n(){var a,s,o,d,c;return t(u).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=r._sourceInfo.spatialReference,s=r._sourceInfo.fieldsIndex,t.next=4,f;case 4:return o=t.sent,d=o.createLabelFunction,t.next=8,d(e.label,s,a);case 8:return c=t.sent,t.abrupt("return",i.objectSpread({},e,{builder:c}));case 10:case"end":return t.stop()}}),n)})))()}},{key:"_evaluateField",value:function(e,t,r){switch(t.type){case"label-expression":var n=e.readArcadeFeature();return t.builder.evaluate(n)||"";case"expression":var a=t.expression;return(0,l.default)(a,e,{$view:{scale:r}})}}}]),e}()})),r.register("6v4Fw",(function(t,n){e(t.exports,"default",(function(){return u}));var a=r("8TSCy"),i=r("jHOLN");function u(e,t,r){e.referencesGeometry();var n=t.readArcadeFeature();try{return e.evaluate(a.objectSpread({},r,{$feature:n}))}catch(e){return i.default.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",e),null}}})),r.register("31Af0",(function(e,t){e.exports=r("4WKyX")(r("aNJCr").getBundleURL("cz7gJ")+r("iE7OH").resolve("eeyk4")).then((function(){return r("gZc4S")}))})),r.register("4WKyX",(function(e,t){"use strict";var n=r("2prpb");e.exports=n((function(e){return new Promise((function(t,r){var n=document.getElementsByTagName("script");if([].concat(n).some((function(t){return t.src===e})))t();else{var a=document.createElement("link");a.href=e,a.rel="preload",a.as="script",document.head.appendChild(a);var i=document.createElement("script");i.async=!0,i.type="text/javascript",i.charset="utf-8",i.src=e,i.onerror=function(t){var n=new TypeError("Failed to fetch dynamically imported module: ".concat(e,". Error: ").concat(t.message));i.onerror=i.onload=null,i.remove(),r(n)},i.onload=function(){i.onerror=i.onload=null,t()},document.getElementsByTagName("head")[0].appendChild(i)}}))}))})),r.register("2prpb",(function(e,t){"use strict";var r={},n={},a={};function i(e){switch(e){case"preload":return n;case"prefetch":return a;default:return r}}e.exports=function(e,t){return function(r){var n=i(t);return n[r]?n[r]:n[r]=e.apply(null,arguments).catch((function(e){throw delete n[r],e}))}}})),r.register("aNJCr",(function(t,r){var n;e(t.exports,"getBundleURL",(function(){return n}),(function(e){return n=e}));var a={};function i(e){return(""+e).replace(/^((?:https?|file|ftp|(chrome|moz)-extension):\/\/.+)\/[^/]+$/,"$1")+"/"}n=function(e){var t=a[e];return t||(t=function(){try{throw new Error}catch(t){var e=(""+t.stack).match(/(https?|file|ftp|(chrome|moz)-extension):\/\/[^)\n]+/g);if(e)return i(e[2])}return"/"}(),a[e]=t),t}})),r.register("iE7OH",(function(t,r){var n,a;e(t.exports,"register",(function(){return n}),(function(e){return n=e})),e(t.exports,"resolve",(function(){return a}),(function(e){return a=e}));var i={};n=function(e){for(var t=Object.keys(e),r=0;r<t.length;r++)i[t[r]]=e[t[r]]},a=function(e){var t=i[e];if(null==t)throw new Error("Could not resolve bundle with id "+e);return t}})),r.register("esg0R",(function(t,n){e(t.exports,"FeatureSetReaderIndirect",(function(){return u}));var a=r("8TSCy"),i=r("jBcNl"),u=function(e){"use strict";a.inherits(r,e);var t=a.createSuper(r);function r(e,n){var u;return a.classCallCheck(this,r),(u=t.call(this,i.FeatureSetReader.createInstance(),e.fullSchema()))._currentIndex=-1,u._reader=e,u._indices=n,a.possibleConstructorReturn(u)}return a.createClass(r,[{key:"hasNext",get:function(){return this._currentIndex+1<this._indices.length}},{key:"getSize",value:function(){return this._indices.length}},{key:"getCursor",value:function(){return this.copy()}},{key:"copy",value:function(){var e=new r(this._reader.copy(),this._indices);return e._currentIndex=this._currentIndex,e}},{key:"next",value:function(){for(;this._nextIndex()&&!this._reader._getExists(););return this._currentIndex<this._indices.length}},{key:"_nextIndex",value:function(){return++this._currentIndex<this._indices.length&&(this._reader.setIndex(this._indices[this._currentIndex]),!0)}},{key:"setArcadeSpatialReference",value:function(e){this._reader.setArcadeSpatialReference(e)}},{key:"attachStorage",value:function(e){this._reader.attachStorage(e)}},{key:"geometryType",get:function(){return this._reader.geometryType}},{key:"hasFeatures",get:function(){return this._reader.hasFeatures}},{key:"exceededTransferLimit",get:function(){return this._reader.exceededTransferLimit}},{key:"hasZ",get:function(){return this._reader.hasZ}},{key:"hasM",get:function(){return this._reader.hasM}},{key:"getStorage",value:function(){return this._reader.getStorage()}},{key:"getComputedNumeric",value:function(e){return this._reader.getComputedNumericAtIndex(0)}},{key:"setComputedNumeric",value:function(e,t){return this._reader.setComputedNumericAtIndex(t,0)}},{key:"getComputedString",value:function(e){return this._reader.getComputedStringAtIndex(0)}},{key:"setComputedString",value:function(e,t){return this._reader.setComputedStringAtIndex(0,t)}},{key:"getComputedNumericAtIndex",value:function(e){return this._reader.getComputedNumericAtIndex(e)}},{key:"setComputedNumericAtIndex",value:function(e,t){this._reader.setComputedNumericAtIndex(e,t)}},{key:"getComputedStringAtIndex",value:function(e){return this._reader.getComputedStringAtIndex(e)}},{key:"setComputedStringAtIndex",value:function(e,t){return this._reader.setComputedStringAtIndex(e,t)}},{key:"transform",value:function(e,t,r,n){var a=this.copy();return a._reader=this._reader.transform(e,t,r,n),a}},{key:"readAttribute",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._reader.readAttribute(e,t)}},{key:"readAttributes",value:function(){return this._reader.readAttributes()}},{key:"joinAttributes",value:function(e){return this._reader.joinAttributes(e)}},{key:"readArcadeFeature",value:function(){return this._reader.readArcadeFeature()}},{key:"geometry",value:function(){return this._reader.geometry()}},{key:"field",value:function(e){return this.readAttribute(e,!0)}},{key:"hasField",value:function(e){return this._reader.hasField(e)}},{key:"setField",value:function(e,t){return this._reader.setField(e,t)}},{key:"keys",value:function(){return this._reader.keys()}},{key:"castToText",value:function(){return this._reader.castToText()}},{key:"getQuantizationTransform",value:function(){return this._reader.getQuantizationTransform()}},{key:"getFieldNames",value:function(){return this._reader.getFieldNames()}},{key:"getAttributeHash",value:function(){return this._reader.getAttributeHash()}},{key:"getObjectId",value:function(){return this._reader.getObjectId()}},{key:"getDisplayId",value:function(){return this._reader.getDisplayId()}},{key:"setDisplayId",value:function(e){return this._reader.setDisplayId(e)}},{key:"getGroupId",value:function(){return this._reader.getGroupId()}},{key:"setGroupId",value:function(e){return this._reader.setGroupId(e)}},{key:"getXHydrated",value:function(){return this._reader.getXHydrated()}},{key:"getYHydrated",value:function(){return this._reader.getYHydrated()}},{key:"getX",value:function(){return this._reader.getX()}},{key:"getY",value:function(){return this._reader.getY()}},{key:"setIndex",value:function(e){return this._reader.setIndex(e)}},{key:"getIndex",value:function(){return this._reader.getIndex()}},{key:"readLegacyFeature",value:function(){return this._reader.readLegacyFeature()}},{key:"readOptimizedFeature",value:function(){return this._reader.readOptimizedFeature()}},{key:"readLegacyPointGeometry",value:function(){return this._reader.readLegacyPointGeometry()}},{key:"readLegacyGeometry",value:function(){return this._reader.readLegacyGeometry()}},{key:"readLegacyCentroid",value:function(){return this._reader.readLegacyCentroid()}},{key:"readGeometryArea",value:function(){return this._reader.readGeometryArea()}},{key:"readUnquantizedGeometry",value:function(){return this._reader.readUnquantizedGeometry()}},{key:"readHydratedGeometry",value:function(){return this._reader.readHydratedGeometry()}},{key:"readGeometry",value:function(){return this._reader.readGeometry()}},{key:"readCentroid",value:function(){return this._reader.readCentroid()}},{key:"_readAttribute",value:function(e,t){throw new Error("Error: Should not be called. Underlying _reader should be used instead")}},{key:"_readAttributes",value:function(){throw new Error("Error: Should not be called. Underlying _reader should be used instead")}}],[{key:"from",value:function(e,t){return new r(e.copy(),t)}}]),r}(i.FeatureSetReader)}))}();
//# sourceMappingURL=Pipeline.73decabb.js.map
