!function(){function e(e){return e&&e.__esModule?e.default:e}function r(e,r,t,n){Object.defineProperty(e,r,{get:t,set:n,enumerable:!0,configurable:!0})}var t=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire594f;t.register("IXEcm",(function(n,i){var o;o=n.exports,Object.defineProperty(o,"__esModule",{value:!0,configurable:!0}),r(n.exports,"default",(function(){return M}));var a=t("8TSCy"),l=t("2TvXO"),s=t("7eJjO"),u=t("3MVX3"),p=t("9pNSx"),d=t("kyj08"),c=t("flPLJ"),f=t("jHOLN"),y=t("7qybv"),v=t("8NioF"),h=t("8EPEw"),g=t("10vEZ"),b=t("kYueh"),w=t("iho5X");t("iJAIC");var m=t("eB8sj"),I=t("fcwIv"),C=t("kced1"),S=t("4LDxK"),x=t("jy0BF"),_=t("aLy89"),k=t("5N5S1"),T=t("9bAYR"),P=t("3GzOb"),O=t("fqCyP"),j=t("j1B22"),R=t("gRgX5"),F=t("buMuJ"),A=t("ko0sb"),q=t("l1hgk"),L=t("3IRkA"),N=t("37qRo"),E=f.default.getLogger("esri.layers.PointCloudLayer"),B=(0,A.defineFieldProperties)(),J=function(r){"use strict";a.inherits(n,r);var t=a.createSuper(n);function n(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];var o;return a.classCallCheck(this,n),(o=t.call.apply(t,[this].concat(a.toConsumableArray(r)))).operationalLayerType="PointCloudLayer",o.popupEnabled=!0,o.popupTemplate=null,o.opacity=1,o.filters=[],o.fields=null,o.fieldsIndex=null,o.outFields=null,o.path=null,o.legendEnabled=!0,o.renderer=null,o.type="point-cloud",a.possibleConstructorReturn(o)}return a.createClass(n,[{key:"normalizeCtorArgs",value:function(e,r){return"string"==typeof e?a.objectSpread({url:e},r):e}},{key:"defaultPopupTemplate",get:function(){return this.attributeStorageInfo?this.createPopupTemplate():null}},{key:"getFieldDomain",value:function(e){var r=this.fieldsIndex.get(e);return r&&r.domain?r.domain:null}},{key:"readServiceFields",value:function(e,r,t){return Array.isArray(e)?e.map((function(e){var r=new(0,F.default);return"FieldTypeInteger"===e.type&&((e=(0,c.clone)(e)).type="esriFieldTypeInteger"),r.read(e,t),r})):Array.isArray(r.attributeStorageInfo)?r.attributeStorageInfo.map((function(e){return new(0,F.default)({name:e.name,type:"ELEVATION"===e.name?"double":"integer"})})):null}},{key:"elevationInfo",set:function(e){this._set("elevationInfo",e),this._validateElevationInfo()}},{key:"writeRenderer",value:function(e,r,t,n){(0,h.setDeepValue)("layerDefinition.drawingInfo.renderer",e.write({},n),r)}},{key:"load",value:function(e){var r=this,t=(0,y.isSome)(e)?e.signal:null,n=this.loadFromPortal({supportedTypes:["Scene Service"]},e).catch(g.throwIfAbortError).then((function(){return r._fetchService(t)}));return this.addResolvingPromise(n),Promise.resolve(this)}},{key:"createPopupTemplate",value:function(e){var r=(0,N.createPopupTemplate)(this,e);return this._formatPopupTemplateReturnsField(r),this._formatPopupTemplateRGBField(r),r}},{key:"_formatPopupTemplateReturnsField",value:function(e){var r=this.fieldsIndex.get("RETURNS");if(r){var t=e.fieldInfos.find((function(e){return e.fieldName===r.name}));if(t){var n=new(0,q.default)({name:"pcl-returns-decoded",title:r.alias||r.name,expression:"\n        var returnValue = $feature.".concat(r.name,';\n        return (returnValue % 16) + " / " + Floor(returnValue / 16);\n      ')});e.expressionInfos=a.toConsumableArray(e.expressionInfos||[]).concat([n]),t.fieldName="expression/pcl-returns-decoded"}}}},{key:"_formatPopupTemplateRGBField",value:function(e){var r=this.fieldsIndex.get("RGB");if(r){var t=e.fieldInfos.find((function(e){return e.fieldName===r.name}));if(t){var n=new(0,q.default)({name:"pcl-rgb-decoded",title:r.alias||r.name,expression:"\n        var rgb = $feature.".concat(r.name,';\n        var red = Floor(rgb / 65536, 0);\n        var green = Floor((rgb - (red * 65536)) / 256,0);\n        var blue = rgb - (red * 65536) - (green * 256);\n\n        return "rgb(" + red + "," + green + "," + blue + ")";\n      ')});e.expressionInfos=a.toConsumableArray(e.expressionInfos||[]).concat([n]),t.fieldName="expression/pcl-rgb-decoded"}}}},{key:"queryCachedStatistics",value:function(r,t){var n=this;return a.asyncToGenerator(e(l).mark((function i(){var o,a,s,u,c,f,y,v;return e(l).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.load(t);case 2:if(e.sent,n.attributeStorageInfo){e.next=4;break}throw new(0,d.default)("scenelayer:no-cached-statistics","Cached statistics are not available for this layer");case 4:if(o=n.fieldsIndex.get(r)){e.next=7;break}throw new(0,d.default)("pointcloudlayer:field-unexisting","Field '".concat(r,"' does not exist on the layer"));case 7:a=!0,s=!1,u=void 0,e.prev=8,c=n.attributeStorageInfo[Symbol.iterator]();case 10:if(a=(f=c.next()).done){e.next=18;break}if((y=f.value).name!==o.name){e.next=15;break}return v=(0,b.join)(n.parsedUrl.path,"./statistics/".concat(y.key)),e.abrupt("return",(0,p.default)(v,{query:{f:"json",token:n.apiKey},responseType:"json",signal:t?t.signal:null}).then((function(e){return e.data})));case 15:a=!0,e.next=10;break;case 18:e.next=24;break;case 20:e.prev=20,e.t0=e.catch(8),s=!0,u=e.t0;case 24:e.prev=24,e.prev=25,a||null==c.return||c.return();case 27:if(e.prev=27,!s){e.next=30;break}throw u;case 30:return e.finish(27);case 31:return e.finish(24);case 32:throw new(0,d.default)("pointcloudlayer:no-cached-statistics","Cached statistics for this attribute are not available");case 33:case"end":return e.stop()}}),i,null,[[8,20,24,32],[25,,27,31]])})))()}},{key:"saveAs",value:function(r,t){var n=this;return a.asyncToGenerator(e(l).mark((function i(){return e(l).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n._debouncedSaveOperations(O.SaveOperationType.SAVE_AS,a.objectSpread({},t,{getTypeKeywords:function(){return n._getTypeKeywords()},portalItemLayerType:"point-cloud"}),r));case 1:case"end":return e.stop()}}),i)})))()}},{key:"save",value:function(){var r=this;return a.asyncToGenerator(e(l).mark((function t(){var n;return e(l).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={getTypeKeywords:function(){return r._getTypeKeywords()},portalItemLayerType:"point-cloud"},e.abrupt("return",r._debouncedSaveOperations(O.SaveOperationType.SAVE,n));case 2:case"end":return e.stop()}}),t)})))()}},{key:"validateLayer",value:function(e){if(e.layerType&&"PointCloud"!==e.layerType)throw new(0,d.default)("pointcloudlayer:layer-type-not-supported","PointCloudLayer does not support this layer type",{layerType:e.layerType});if(isNaN(this.version.major)||isNaN(this.version.minor))throw new(0,d.default)("layer:service-version-not-supported","Service version is not supported.",{serviceVersion:this.version.versionString,supportedVersions:"1.x-2.x"});if(this.version.major>2)throw new(0,d.default)("layer:service-version-too-new","Service version is too new.",{serviceVersion:this.version.versionString,supportedVersions:"1.x-2.x"})}},{key:"hasCachedStatistics",value:function(e){return null!=this.attributeStorageInfo&&this.attributeStorageInfo.some((function(r){return r.name===e}))}},{key:"_getTypeKeywords",value:function(){return["PointCloud"]}},{key:"_validateElevationInfo",value:function(){var e=this.elevationInfo;e&&("absolute-height"!==e.mode&&E.warn(".elevationInfo=","Point cloud layers only support absolute-height elevation mode"),e.featureExpressionInfo&&"0"!==e.featureExpressionInfo.expression&&E.warn(".elevationInfo=","Point cloud layers do not support featureExpressionInfo"))}}]),n}((0,O.SceneService)((0,_.ArcGISService)((0,k.OperationalLayer)((0,T.PortalLayer)((0,P.ScaleRangeLayer)((0,v.MultiOriginJSONMixin)((0,x.APIKeyMixin)(S.default))))))));(0,s._)([(0,w.property)({type:["PointCloudLayer"]})],J.prototype,"operationalLayerType",void 0),(0,s._)([(0,w.property)(R.popupEnabled)],J.prototype,"popupEnabled",void 0),(0,s._)([(0,w.property)({type:u.default,json:{name:"popupInfo",write:!0}})],J.prototype,"popupTemplate",void 0),(0,s._)([(0,w.property)({readOnly:!0,json:{read:!1}})],J.prototype,"defaultPopupTemplate",null),(0,s._)([(0,w.property)({readOnly:!0,json:{write:!1,read:!1,origins:{"web-document":{write:!1,read:!1}}}})],J.prototype,"opacity",void 0),(0,s._)([(0,w.property)({type:["show","hide"]})],J.prototype,"listMode",void 0),(0,s._)([(0,w.property)({types:[j.types],json:{origins:{service:{read:{source:"filters"}}},name:"layerDefinition.filters",write:!0}})],J.prototype,"filters",void 0),(0,s._)([(0,w.property)({type:[F.default]})],J.prototype,"fields",void 0),(0,s._)([(0,w.property)(B.fieldsIndex)],J.prototype,"fieldsIndex",void 0),(0,s._)([(0,m.reader)("service","fields",["fields","attributeStorageInfo"])],J.prototype,"readServiceFields",null),(0,s._)([(0,w.property)(B.outFields)],J.prototype,"outFields",void 0),(0,s._)([(0,w.property)({readOnly:!0})],J.prototype,"attributeStorageInfo",void 0),(0,s._)([(0,w.property)(R.elevationInfo)],J.prototype,"elevationInfo",null),(0,s._)([(0,w.property)({type:String,json:{origins:{"web-scene":{read:!0,write:!0},"portal-item":{read:!0,write:!0}},read:!1}})],J.prototype,"path",void 0),(0,s._)([(0,w.property)(R.legendEnabled)],J.prototype,"legendEnabled",void 0),(0,s._)([(0,w.property)({types:L.types,json:{origins:{service:{read:{source:"drawingInfo.renderer"}}},name:"layerDefinition.drawingInfo.renderer",write:{target:{"layerDefinition.drawingInfo.renderer":{types:L.types},"layerDefinition.drawingInfo.transparency":{type:Number}}}}})],J.prototype,"renderer",void 0),(0,s._)([(0,C.writer)("renderer")],J.prototype,"writeRenderer",null),(0,s._)([(0,w.property)({json:{read:!1},readOnly:!0})],J.prototype,"type",void 0);var M=J=(0,s._)([(0,I.subclass)("esri.layers.PointCloudLayer")],J)})),t.register("j1B22",(function(e,n){r(e.exports,"types",(function(){return s}));var i=t("5Oihw"),o=t("ggI7u"),a=t("3Zhym"),l=t("cXrsq"),s={key:"type",base:o.default,typeMap:{value:l.default,bitfield:i.default,return:a.default}}})),t.register("5Oihw",(function(e,n){r(e.exports,"default",(function(){return y}));var i,o=t("8TSCy"),a=t("7eJjO"),l=t("flPLJ"),s=t("iho5X"),u=t("iJAIC"),p=t("bSafx"),d=t("fcwIv"),c=t("ggI7u"),f=i=function(e){"use strict";o.inherits(t,e);var r=o.createSuper(t);function t(e){var n;return o.classCallCheck(this,t),(n=r.call(this,e)).requiredClearBits=null,n.requiredSetBits=null,n.type="bitfield",o.possibleConstructorReturn(n)}return o.createClass(t,[{key:"clone",value:function(){return new i({field:this.field,requiredClearBits:(0,l.clone)(this.requiredClearBits),requiredSetBits:(0,l.clone)(this.requiredSetBits)})}}]),t}(c.default);(0,a._)([(0,s.property)({type:[u.Integer],json:{write:{enabled:!0,overridePolicy:function(){return{enabled:!0,isRequired:!this.requiredSetBits}}}}})],f.prototype,"requiredClearBits",void 0),(0,a._)([(0,s.property)({type:[u.Integer],json:{write:{enabled:!0,overridePolicy:function(){return{enabled:!0,isRequired:!this.requiredClearBits}}}}})],f.prototype,"requiredSetBits",void 0),(0,a._)([(0,p.enumeration)({pointCloudBitfieldFilter:"bitfield"})],f.prototype,"type",void 0);var y=f=i=(0,a._)([(0,d.subclass)("esri.layers.pointCloudFilters.PointCloudBitfieldFilter")],f)})),t.register("ggI7u",(function(e,n){r(e.exports,"default",(function(){return p}));var i=t("8TSCy"),o=t("7eJjO"),a=t("1XAcN"),l=t("iho5X");t("lNwWH"),t("2VlWd"),t("iJAIC");var s=t("fcwIv"),u=function(e){"use strict";i.inherits(t,e);var r=i.createSuper(t);function t(e){var n;return i.classCallCheck(this,t),(n=r.call(this,e)).field=null,n.type=null,i.possibleConstructorReturn(n)}return i.createClass(t,[{key:"clone",value:function(){return console.warn(".clone() is not implemented for "+this.declaredClass),null}}]),t}(a.JSONSupport);(0,o._)([(0,l.property)({type:String,json:{write:{enabled:!0,isRequired:!0}}})],u.prototype,"field",void 0),(0,o._)([(0,l.property)({readOnly:!0,nonNullable:!0,json:{read:!1}})],u.prototype,"type",void 0);var p=u=(0,o._)([(0,s.subclass)("esri.layers.pointCloudFilters.PointCloudFilter")],u)})),t.register("3Zhym",(function(e,n){r(e.exports,"default",(function(){return f}));var i=t("8TSCy"),o=t("7eJjO"),a=t("flPLJ"),l=t("iho5X");t("iJAIC");var s,u=t("bSafx"),p=t("fcwIv"),d=t("ggI7u"),c=s=function(e){"use strict";i.inherits(t,e);var r=i.createSuper(t);function t(e){var n;return i.classCallCheck(this,t),(n=r.call(this,e)).includedReturns=[],n.type="return",i.possibleConstructorReturn(n)}return i.createClass(t,[{key:"clone",value:function(){return new s({field:this.field,includedReturns:(0,a.clone)(this.includedReturns)})}}]),t}(d.default);(0,o._)([(0,l.property)({type:[["firstOfMany","last","lastOfMany","single"]],json:{write:{enabled:!0,isRequired:!0}}})],c.prototype,"includedReturns",void 0),(0,o._)([(0,u.enumeration)({pointCloudReturnFilter:"return"})],c.prototype,"type",void 0);var f=c=s=(0,o._)([(0,p.subclass)("esri.layers.pointCloudFilters.PointCloudReturnFilter")],c)})),t.register("cXrsq",(function(e,n){r(e.exports,"default",(function(){return f}));var i=t("8TSCy"),o=t("7eJjO"),a=t("flPLJ"),l=t("iho5X");t("iJAIC");var s,u=t("bSafx"),p=t("fcwIv"),d=t("ggI7u"),c=s=function(e){"use strict";i.inherits(t,e);var r=i.createSuper(t);function t(e){var n;return i.classCallCheck(this,t),(n=r.call(this,e)).mode="exclude",n.type="value",n.values=[],i.possibleConstructorReturn(n)}return i.createClass(t,[{key:"clone",value:function(){return new s({field:this.field,mode:this.mode,values:(0,a.clone)(this.values)})}}]),t}(d.default);(0,o._)([(0,l.property)({type:["exclude","include"],json:{write:{enabled:!0,isRequired:!0}}})],c.prototype,"mode",void 0),(0,o._)([(0,u.enumeration)({pointCloudValueFilter:"value"})],c.prototype,"type",void 0),(0,o._)([(0,l.property)({type:[Number],json:{write:{enabled:!0,isRequired:!0}}})],c.prototype,"values",void 0);var f=c=s=(0,o._)([(0,p.subclass)("esri.layers.pointCloudFilters.PointCloudValueFilter")],c)})),t.register("3IRkA",(function(e,n){r(e.exports,"types",(function(){return u}));var i=t("f4BeK"),o=t("7HItt"),a=t("cI2nj"),l=t("hcWUq"),s=t("bTD2f"),u={key:"type",base:o.default,typeMap:{"point-cloud-class-breaks":i.default,"point-cloud-rgb":a.default,"point-cloud-stretch":l.default,"point-cloud-unique-value":s.default},errorContext:"renderer"}})),t.register("cI2nj",(function(e,n){r(e.exports,"default",(function(){return f}));var i=t("8TSCy"),o=t("7eJjO"),a=t("flPLJ"),l=t("iho5X");t("iJAIC");var s,u=t("bSafx"),p=t("fcwIv"),d=t("7HItt"),c=s=function(e){"use strict";i.inherits(t,e);var r=i.createSuper(t);function t(e){var n;return i.classCallCheck(this,t),(n=r.call(this,e)).type="point-cloud-rgb",n.field=null,i.possibleConstructorReturn(n)}return i.createClass(t,[{key:"clone",value:function(){return new s(i.objectSpread({},this.cloneProperties(),{field:(0,a.clone)(this.field)}))}}]),t}(d.default);(0,o._)([(0,u.enumeration)({pointCloudRGBRenderer:"point-cloud-rgb"})],c.prototype,"type",void 0),(0,o._)([(0,l.property)({type:String,json:{write:!0}})],c.prototype,"field",void 0);var f=c=s=(0,o._)([(0,p.subclass)("esri.renderers.PointCloudRGBRenderer")],c)})),t.register("amEsL",(function(e,n){r(e.exports,"updateOrigins",(function(){return o}));var i=t("arTQ0");function o(e){e&&e.writtenProperties&&e.writtenProperties.forEach((function(e){var r=e.target;e.newOrigin&&e.oldOrigin!==e.newOrigin&&(0,i.isMultiOriginJSONMixin)(r)&&r.updateOrigin(e.propName,e.newOrigin)}))}})),t.register("arTQ0",(function(e,t){function n(e){return e&&"getAtOrigin"in e&&"originOf"in e}r(e.exports,"isMultiOriginJSONMixin",(function(){return n}))}))}();
//# sourceMappingURL=PointCloudLayer.701227ab.js.map
