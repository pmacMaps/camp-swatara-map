!function(){function e(e,t,r,i){Object.defineProperty(e,t,{get:r,set:i,enumerable:!0,configurable:!0})}var t=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire594f;t.register("90RBb",(function(r,i){e(r.exports,"createSymbolSchema",(function(){return u}));var a=t("8TSCy"),n=t("66IJZ"),l=t("ktHf8");function s(e){var t;return"line-marker"===e.type?{type:"line-marker",color:null==(t=e.color)?void 0:t.toJSON(),placement:e.placement,style:e.style}:e.constructor.fromJSON(e.toJSON()).toJSON()}function o(e){return hydrateKey(e)}function u(e,t,r){if(!e)return null;switch(e.type){case"simple-fill":case"picture-fill":return function(e,t,r){var i=t.supportsOutlineFills,u=(0,l.createMaterialKey)(n.WGLGeometryType.FILL,a.objectSpread({},t,{isOutlinedFill:i})),c=r?o(u):u,f=e.clone(),d=f.outline;t.supportsOutlineFills||(f.outline=null);var p=a.objectSpread({materialKey:c,hash:f.hash(),isOutlinedFill:!!t.supportsOutlineFills},s(f));if(t.supportsOutlineFills)return p;var y=[];if(y.push(p),d){var m=(0,l.createMaterialKey)(n.WGLGeometryType.LINE,a.objectSpread({},t,{isOutline:!0})),v=a.objectSpread({materialKey:r?o(m):m,hash:d.hash()},s(d));y.push(v)}return{type:"composite-symbol",layers:y,hash:y.reduce((function(e,t){return t.hash+e}),"")}}(e,t,r);case"simple-marker":case"picture-marker":return h=e,x=t,S=r,V=(0,l.createMaterialKey)(n.WGLGeometryType.MARKER,x),w=S?o(V):V,z=s(h),a.objectSpread({materialKey:w,hash:h.hash()},z,{angle:h.angle,maxVVSize:x.maxVVSize});case"simple-line":return function(e,t,r){var i=(0,l.createMaterialKey)(n.WGLGeometryType.LINE,t),u=r?o(i):i,c=e.clone(),f=c.marker;c.marker=null;var d=[];if(d.push(a.objectSpread({materialKey:u,hash:c.hash()},s(c))),f){var p,y=(0,l.createMaterialKey)(n.WGLGeometryType.MARKER,t),m=r?o(y):y;f.color=null!=(p=f.color)?p:c.color,d.push(a.objectSpread({materialKey:m,hash:f.hash(),lineWidth:c.width},s(f)))}return{type:"composite-symbol",layers:d,hash:d.reduce((function(e,t){return t.hash+e}),"")}}(e,t,r);case"text":return p=e,y=t,m=r,v=(0,l.createMaterialKey)(n.WGLGeometryType.TEXT,y),b=m?o(v):v,g=s(p),a.objectSpread({materialKey:b,hash:p.hash()},g,{angle:p.angle,maxVVSize:y.maxVVSize});case"label":return u=t,c=r,f=(i=e).toJSON(),d=(0,l.createMaterialKey)(n.WGLGeometryType.LABEL,a.objectSpread({},u,{placement:f.labelPlacement})),a.objectSpread({materialKey:c?o(d):d,hash:i.hash()},f,{labelPlacement:f.labelPlacement});case"cim":return{type:"cim",rendererKey:t.vvFlags,data:e.data,maxVVSize:t.maxVVSize};case"CIMSymbolReference":return{type:"cim",rendererKey:t.vvFlags,data:e,maxVVSize:t.maxVVSize};case"web-style":return a.objectSpread({},s(e),{type:"web-style",hash:e.hash(),rendererKey:t.vvFlags,maxVVSize:t.maxVVSize});default:throw new Error("symbol not supported ".concat(e.type))}var i,u,c,f,d,p,y,m,v,b,g,h,x,S,V,w,z}})),t.register("li6vg",(function(r,i){e(r.exports,"createSymbolSchemaOptions",(function(){return S})),e(r.exports,"createSchema",(function(){return w})),e(r.exports,"createMatcherSchema",(function(){return G}));var a=t("8TSCy"),n=t("kyj08"),l=t("2VlWd"),s=t("flPLJ"),o=t("jHOLN"),u=t("7qybv"),c=t("iXlXu"),f=t("5WctK"),d=t("8Zy9c"),p=t("90RBb"),y=t("a8gd3"),m=t("71FC0"),v=t("bPKxZ"),b=t("9M3e1"),g=(p=t("90RBb"),o.default.getLogger("esri.views.2d.layers.features.schemaUtils")),h="ValidationError",x={esriGeometryPoint:["above-right","above-center","above-left","center-center","center-left","center-right","below-center","below-left","below-right"],esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along"],esriGeometryMultipoint:null};function S(e){var t=0,r=0,i=!1,a=!0,n=!0;if((0,u.isSome)(e)){if(r=(0,y.getPtMaxVVSize)(e),"visualVariables"in e&&(t=(0,d.getVVFlags)(e.visualVariables||[]),i="dot-density"===e.type),"dictionary"===e.type)return{maxVVSize:r,supportsOutlineFills:!1,vvFlags:t,stride:{fill:"default"}};if(!i){var l=e.getSymbols();"backgroundFillSymbol"in e&&e.backgroundFillSymbol&&l.push(e.backgroundFillSymbol);var s=!0,o=!1,c=void 0;try{for(var f,p=l[Symbol.iterator]();!(s=(f=p.next()).done);s=!0){var m=f.value;if("cim"===m.type&&(a=!1),"simple-fill"===m.type||"picture-fill"===m.type){var v=m.outline;v&&"none"!==v.style&&"solid"!==v.style&&(n=!1);var b=v&&"none"!==v.style&&"solid"!==v.style,g="simple-fill"===m.type&&"none"!==m.style&&"solid"!==m.style;("picture-fill"===m.type||g||b)&&(a=!1)}}}catch(e){o=!0,c=e}finally{try{s||null==p.return||p.return()}finally{if(o)throw c}}}}return i&&(n=!1),{vvFlags:t,maxVVSize:r,supportsOutlineFills:n,stride:{fill:i?"dot-density":a?"simple":"default"}}}function V(e,t){var r=(0,s.clone)(e);return r.some((function(e){return function(e,t){var r=e.labelPlacement,i=x[t];if(!e.symbol)return g.warn("No ILabelClass symbol specified."),!0;if(!i)return g.error(new(0,n.default)("mapview-labeling:unsupported-geometry-type","Unable to create labels for Feature Layer, ".concat(t," is not supported"))),!0;if(!i.some((function(e){return e===r}))){var a=i[0];r&&g.warn("Found invalid label placement type ".concat(r," for ").concat(t,". Defaulting to ").concat(a)),e.labelPlacement=a}return!1}(e,t)}))?[]:r}function w(e){return(0,l.default)("esri-2d-update-debug")&&console.debug("Created new schema",z(e,!0)),z(e)}function z(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{var r,i,a=C(e,t),n={};return a.map((function(t){return F(n,e,t)})),{source:{definitionExpression:e.definitionExpression,fields:e.fields.map((function(e){return e.toJSON()})),gdbVersion:e.gdbVersion,historicMoment:null==(r=e.historicMoment)?void 0:r.getTime(),outFields:e.availableFields,pixelBuffer:e.pixelBuffer,spatialReference:e.spatialReference.toJSON(),timeExtent:null==(i=e.timeExtent)?void 0:i.toJSON(),customParameters:e.customParameters},attributes:{fields:{},indexCount:0},processors:a,targets:n}}catch(e){if(e.fieldName===h)return g.error(e),null;throw e}}function F(e,t,r){switch(r.target){case"feature":return void I(e,T(t),r);case"aggregate":if(!("featureReduction"in t))return;var i=t.featureReduction;if("selection"===i.type)throw new(0,n.default)(h,"Mapview does not support `selection` reduction type",i);return I(e,T(t),r),l=i,s=r,(a=e).aggregate||(a.aggregate={name:"aggregate",input:"feature",filters:null,attributes:{},params:{clusterRadius:(0,c.pt2px)(l.clusterRadius/2),clusterPixelBuffer:64*Math.ceil((0,c.pt2px)(l.clusterMaxSize)/64),fields:s.aggregateFields}}),void E(a.aggregate,s.attributes.fields)}var a,l,s}function E(e,t){for(var r in t){var i=t[r];if(i.target===e.name){var a=e.attributes[r];a?(a.context.mesh=a.context.mesh||i.context.mesh,a.context.storage=a.context.storage||i.context.storage):e.attributes[r]=i}}return e}function T(e){var t,r,i,a,n;return[null!=(t=null==(r=(0,u.unwrap)(e.filter))?void 0:r.toJSON())?t:null,null!=(i=null==(a=(0,u.unwrap)(null==(n=(0,u.unwrap)(e.featureEffect))?void 0:n.filter))?void 0:a.toJSON())?i:null]}function I(e,t,r){return e.feature||(e.feature={name:"feature",input:"source",filters:t,attributes:{}}),E(e.feature,r.attributes.fields),e}function M(e,t){return t.field?O(e,a.objectSpread({},t,{type:"field",field:t.field})):t.valueExpression?O(e,a.objectSpread({},t,{type:"expression",valueExpression:t.valueExpression})):{field:null,fieldIndex:null}}function O(e,t){switch(t.type){case"expression":var r=t.valueExpression;if(!e.fields[r]){var i=e.indexCount++;e.fields[r]=a.objectSpread({},t,{name:r,fieldIndex:i})}return{fieldIndex:e.fields[r].fieldIndex};case"label-expression":var n=JSON.stringify(t.label);if(!e.fields[n]){var l=e.indexCount++;e.fields[n]=a.objectSpread({},t,{name:n,fieldIndex:l})}return{fieldIndex:e.fields[n].fieldIndex};case"field":var s=t.field;return"aggregate"===t.target&&e.fields[s]||(e.fields[s]=a.objectSpread({},t,{name:s})),{field:s};case"statistic":return e.fields[t.name]=a.objectSpread({},t),{field:t.name}}}function C(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=new Array,i=0;return r.push(R(e,i++,t)),r}function L(e,t,r,i,n){var l=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=O(t,{type:"label-expression",target:i,context:{mesh:!0},resultType:"string",label:{labelExpression:r.labelExpression,labelExpressionInfo:r.labelExpressionInfo?{expression:r.labelExpressionInfo.expression}:null,symbol:!!r.symbol,where:r.where}}),o=s.fieldIndex,u=S(e);return a.objectSpread({},(0,p.createSymbolSchema)(r,u,l),{fieldIndex:o,target:i,index:n})}function R(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i={indexCount:0,fields:{}},l="featureReduction"in e&&e.featureReduction,s=l?"aggregate":"feature";if("sublayers"in e){var o={type:"subtype",subtypeField:e.subtypeField,renderers:{},stride:{fill:"default"}},c={type:"subtype",mapping:{},target:"feature"},f={type:"subtype",classes:{}},d={type:"symbol",target:"feature",aggregateFields:[],attributes:i,storage:c,mesh:{matcher:o,aggregateMatcher:null,labels:f,sortKey:null}},y=new Set,m=0,g=!0,x=!1,w=void 0;try{for(var z,F=function(e,t){var a=t.value,l=a.renderer,d=a.subtypeCode,p=a.labelingInfo,v=a.labelsVisible,b=G(i,s,l,r),g=k(i,s,l),x=v&&p;if("visualVariables"in l&&l.visualVariables&&l.visualVariables.length)throw new(0,n.default)(h,"Visual variables are currently not supported for subtype layers");if("dictionary"===b.type)throw new(0,n.default)(h,"Dictionary renderer is not supported in subtype layers");if("subtype"===b.type)throw new(0,n.default)(h,"Nested subtype renderers is not supported");if((0,u.isSome)(g)&&"subtype"===g.type)throw new(0,n.default)(h,"Nested subtype storage is not supported");if((0,u.isSome)(g)&&"dot-density"===g.type)throw new(0,n.default)(h,"Dot density attributes are not supported in subtype layers");if(y.has(d))throw new(0,n.default)(h,"Subtype codes for sublayers must be unique");y.add(d),o.renderers[d]=b,c.mapping[d]=g,x&&(f.classes[d]=x.map((function(e){return L(l,i,e,"feature",m++,r)})))},E=e.sublayers[Symbol.iterator]();!(g=(z=E.next()).done);g=!0)F(E,z)}catch(e){x=!0,w=e}finally{try{g||null==E.return||E.return()}finally{if(x)throw w}}return d}if("heatmap"===e.renderer.type){var T=e.renderer,I=T.blurRadius,O=T.fieldOffset,C=T.field;return{type:"heatmap",aggregateFields:[],attributes:i,target:s,storage:null,mesh:{blurRadius:I,fieldOffset:O,field:M(i,{target:s,field:C,resultType:"numeric"}).field}}}var R=[],K="aggregate"===s?(0,v.createClusterRenderer)(R,e.renderer,l,null):e.renderer;j(i,R);var _=G(i,s,K,r),A=null,P=k(i,s,K),J=(0,b.toJSONGeometryType)(e.geometryType),W=e.labelsVisible&&e.labelingInfo||[],D=[];if(l){if("selection"===l.type)throw new(0,n.default)(h,"Mapview does not support `selection` reduction type",l);if(l.symbol){var B=S(K);A={type:"simple",symbol:(0,p.createSymbolSchema)(l.symbol,B,r),stride:B.stride}}D=l&&l.labelsVisible&&l.labelingInfo||[]}W=V(W,J),D=V(D,J);var H=0,X=a.toConsumableArray(W.map((function(e){return L(K,i,e,"feature",H++,r)}))).concat(a.toConsumableArray(D.map((function(e){return L(K,i,e,"aggregate",H++,r)})))),q=N(i,e.orderBy);return{type:"symbol",target:s,attributes:i,aggregateFields:R,storage:P,mesh:{matcher:_,labels:{type:"simple",classes:X},aggregateMatcher:A,sortKey:q}}}function N(e,t){if((0,u.isNone)(t)||!t.length)return null;t.length>1&&g.warn("Layer rendering currently only supports ordering by 1 orderByInfo, but found ".concat(t.length,". All but the first will be discarded"));var r=t[0],i="ascending"===r.order?"asc":"desc";return r.field?{field:r.field,order:i}:r.valueExpression?{fieldIndex:O(e,{type:"expression",target:"feature",valueExpression:r.valueExpression,resultType:"numeric"}).fieldIndex,order:i}:(g.error(new(0,n.default)(h,"Expected to find a field or valueExpression for OrderByInfo",r)),null)}function j(e,t){var r={mesh:!0,storage:!0},i=!0,a=!1,n=void 0;try{for(var l,s=t[Symbol.iterator]();!(i=(l=s.next()).done);i=!0){var o=l.value,u=o.name,c=o.outStatistic,f=c.statisticType,d=c.onStatisticField,p=null,y=null,m=null,v="numeric",b="feature";"onStatisticValueExpression"in c?y=O(e,{type:"expression",target:b,valueExpression:c.onStatisticValueExpression,resultType:v}).fieldIndex:"onStatisticNormalizationField"in c?(p=O(e,{type:"field",target:b,field:d,resultType:v}).field,m=c.onStatisticNormalizationField):p=O(e,{type:"field",target:b,field:d,resultType:v}).field,O(e,{type:"statistic",target:"aggregate",name:u,context:r,inField:p,inNormalizationField:m,inFieldIndex:y,statisticType:f})}}catch(e){a=!0,n=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw n}}}function k(e,t,r){switch(r.type){case"dot-density":return i=e,a=t,(n=r.attributes)&&n.length?{type:"dot-density",mapping:n.map((function(e,t){var r=M(i,{valueExpression:e.valueExpression,field:e.field,resultType:"numeric",target:a});return{binding:t,field:r.field,fieldIndex:r.fieldIndex}})),target:a}:{type:"dot-density",mapping:[],target:a};case"simple":case"class-breaks":case"unique-value":case"dictionary":return function(e,t,r){if(!r||!r.length)return{type:"visual-variable",mapping:[],target:t};var i={storage:!0},a="numeric";return{type:"visual-variable",mapping:(0,m.simplifyVisualVariables)(r).map((function(r){var n,l=(0,f.getVVType)(r.type),s=M(e,{target:t,valueExpression:r.valueExpression,field:r.field,context:i,resultType:a}),o=s.field,u=s.fieldIndex;switch(r.type){case"size":return"$view.scale"===r.valueExpression?null:{type:"size",binding:l,field:o,fieldIndex:u,normalizationField:M(e,{target:t,field:r.normalizationField,context:i,resultType:a}).field,valueRepresentation:null!=(n=r.valueRepresentation)?n:null};case"color":return{type:"color",binding:l,field:o,fieldIndex:u,normalizationField:M(e,{target:t,field:r.normalizationField,context:i,resultType:a}).field};case"opacity":return{type:"opacity",binding:l,field:o,fieldIndex:u,normalizationField:M(e,{target:t,field:r.normalizationField,context:i,resultType:a}).field};case"rotation":return{type:"rotation",binding:l,field:o,fieldIndex:u}}})).filter((function(e){return e})),target:t}}(e,t,r.visualVariables);case"heatmap":return null}var i,a,n}function G(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=(0,u.unwrapOr)(e,{indexCount:0,fields:{}});switch(r.type){case"simple":case"dot-density":return K(a,r,i);case"class-breaks":return _(a,t,r,i);case"unique-value":return A(a,t,r,i);case"dictionary":return P(a,r,i)}}function K(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=t.getSymbols(),a=i.length?i[0]:null,n=S(t);return{type:"simple",symbol:(0,p.createSymbolSchema)(a,n,r),stride:n.stride}}function _(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a={mesh:!0,use:"renderer.field"},n=r.backgroundFillSymbol,l=M(e,{target:t,field:r.field,valueExpression:r.valueExpression,resultType:"numeric",context:a}),s=l.field,o=l.fieldIndex,u=r.normalizationType,c="log"===u?"esriNormalizeByLog":"percent-of-total"===u?"esriNormalizeByPercentOfTotal":"field"===u?"esriNormalizeByField":null,f=S(r),d=r.classBreakInfos.map((function(e){return{symbol:(0,p.createSymbolSchema)(e.symbol,f,i),min:e.minValue,max:e.maxValue}})).sort((function(e,t){return e.min-t.min}));return{type:"interval",attributes:e.fields,field:s,fieldIndex:o,backgroundFillSymbol:(0,p.createSymbolSchema)(n,f,i),defaultSymbol:(0,p.createSymbolSchema)(r.defaultSymbol,f,i),intervals:d,normalizationField:r.normalizationField,normalizationTotal:r.normalizationTotal,normalizationType:c,isMaxInclusive:r.isMaxInclusive,stride:f.stride}}function A(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],l=[],s=r.backgroundFillSymbol,o={target:t,context:{mesh:!0},resultType:"string"};if(r.field&&"string"!=typeof r.field)throw new(0,n.default)(h,"Expected renderer.field to be a string",r);var u=M(e,a.objectSpread({},o,{field:r.field,valueExpression:r.valueExpression})),c=u.field,f=u.fieldIndex,d=S(r),y=!0,m=!1,v=void 0;try{for(var b,g=r.uniqueValueInfos[Symbol.iterator]();!(y=(b=g.next()).done);y=!0){var x=b.value;l.push({value:""+x.value,symbol:(0,p.createSymbolSchema)(x.symbol,d,i)})}}catch(e){m=!0,v=e}finally{try{y||null==g.return||g.return()}finally{if(m)throw v}}return{type:"map",attributes:e.fields,field:c,fieldIndex:f,field2:M(e,a.objectSpread({},o,{field:r.field2})).field,field3:M(e,a.objectSpread({},o,{field:r.field3})).field,fieldDelimiter:r.fieldDelimiter,backgroundFillSymbol:(0,p.createSymbolSchema)(s,d),defaultSymbol:(0,p.createSymbolSchema)(r.defaultSymbol,d),map:l,stride:d.stride}}function P(e,t){var r=S(t);return{type:"dictionary",config:t.config,fieldMap:t.fieldMap,scaleExpression:t.scaleExpression,url:t.url,symbolOptions:r,stride:r.stride}}})),t.register("8Zy9c",(function(r,i){e(r.exports,"getVVFlags",(function(){return l}));var a=t("66IJZ"),n=t("2VOK9");function l(e){if(!e)return a.WGLVVFlag.NONE;var t=0,r=!0,i=!1,l=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=s.value;if("size"===u.type){var c=(0,n.getTypeOfSizeVisualVariable)(u);t|=c,"outline"===u.target&&(t|=c<<4)}else"color"===u.type?t|=a.WGLVVFlag.COLOR:"opacity"===u.type?t|=a.WGLVVFlag.OPACITY:"rotation"===u.type&&(t|=a.WGLVVFlag.ROTATION)}}catch(e){i=!0,l=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw l}}return t}})),t.register("a8gd3",(function(r,i){e(r.exports,"getPtMaxVVSize",(function(){return l}));t("8TSCy"),t("2TvXO"),t("iXlXu"),t("4FBKO");var a=t("i50K3"),n=t("4WoSm");t("d2StF"),t("2rjRQ");function l(e){if(!("visualVariables"in e))return 0;if(!e.hasVisualVariables("size"))return 0;var t=e.getVisualVariablesForType("size");if(!t[0])return 0;var r=t[0];if("outline"===r.target)return 0;if("stops"===r.transformationType)return r.stops.map((function(e){return e.size})).reduce(s,0);if("clamped-linear"===r.transformationType){var i,a;return i="number"==typeof r.maxSize?r.maxSize:r.maxSize.stops.map((function(e){return e.size})).reduce(s,0),a="number"==typeof r.minSize?r.minSize:r.minSize.stops.map((function(e){return e.size})).reduce(s,0),Math.max(i,a)}return"real-world-size"===r.transformationType?30:void 0}n.AVERAGE_GLYPH_MOSAIC_ITEM.metrics,new(0,a.default)(0,0,24,24);function s(e,t){return Math.max(e,t)}})),t.register("d2StF",(function(r,i){e(r.exports,"TILE_SIZE",(function(){return y})),e(r.exports,"PIXEL_BUFFER",(function(){return m})),e(r.exports,"intersectingInternationalDateline",(function(){return v})),e(r.exports,"isTextSymbol",(function(){return b})),e(r.exports,"isMarkerSymbol",(function(){return g})),e(r.exports,"graphicGeometryToNumber",(function(){return h})),e(r.exports,"getTextSymbolSize",(function(){return x})),e(r.exports,"polygonFromExtent",(function(){return S}));var a=t("8TSCy"),n=t("6J0KG"),l=t("7qybv"),s=t("iXlXu"),o=t("fTq43"),u=t("8TwEW"),c=t("7E1SV"),f=t("6S0qa"),d=t("4WoSm"),p=t("a7brS"),y=512,m=50;function v(e,t){if(!t.isWrappable)return null;var r=a.slicedToArray((0,c.getSpatialReferenceMinMaxX)(t),2),i=r[0],n=r[1];return e[2]>n?[(0,u.create)([e[0],e[1],n,e[3]]),(0,u.create)([i,e[1],i+e[2]-n,e[3]])]:e[0]<i?[(0,u.create)([i,e[1],e[2],e[3]]),(0,u.create)([n-(i-e[0]),e[1],n,e[3]])]:null}function b(e){return"text"===e||"esriTS"===e}function g(e){return"simple-marker"===e||"picture-marker"===e||"esriSMS"===e||"esriPMS"===e}function h(e){switch((0,l.unwrap)(e.geometry).type){case"point":case"multipoint":return 0;case"polyline":return 1;case"polygon":case"extent":return 2}return 0}function x(e,t,r){var i,a,l;if(!r||0===r.glyphMosaicItems.length)return e;var o=(0,n.bidiText)(t.text)[1],u=r.glyphMosaicItems,c=(0,p.shapeGlyphs)(u,o,{scale:(0,s.pt2px)(t.font.size)/d.GLYPH_SIZE,angle:null!=(i=t.angle)?i:0,xOffset:null!=(a=t.xoffset)?a:0,yOffset:null!=(l=t.yoffset)?l:0,hAlign:(0,f.getXAnchorDirection)(t.horizontalAlignment||"center"),vAlign:(0,f.getYAnchorDirection)(t.verticalAlignment||"baseline"),maxLineWidth:Math.max(32,Math.min(t.lineWidth||512,512)),lineHeight:d.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(t.lineHeight||1,4)),decoration:t.font.decoration||"none",isCIM:!1}).bounds;return e[0]=(0,s.pt2px)(c.x-c.halfWidth),e[1]=(0,s.pt2px)(c.y-c.halfHeight),e[2]=(0,s.pt2px)(c.width),e[3]=(0,s.pt2px)(c.height),e}function S(e){if(!e)return null;var t=e.xmin,r=e.ymin,i=e.xmax,a=e.ymax,n=e.spatialReference;return new(0,o.default)({rings:[[[t,r],[t,a],[i,a],[i,r],[t,r]]],spatialReference:n})}})),t.register("71FC0",(function(r,i){e(r.exports,"simplifyVVRenderer",(function(){return o})),e(r.exports,"simplifyVisualVariables",(function(){return u}));var a=t("8TSCy"),n=t("jHOLN"),l=t("iXlXu"),s=n.default.getLogger("esri.renderers.visualVariables.support.utils"),o=function(e){if(!("visualVariables"in e)||!e.visualVariables||!e.visualVariables.length)return e;var t=e.clone(),r=t.visualVariables.map((function(e){return c(e)?f(e):e}));return t.visualVariables=r,t};function u(e){return e.map((function(e){return c(e)?f(e.clone()):e}))}function c(e){return("size"===e.type||"color"===e.type||"opacity"===e.type)&&null!=e.stops}function f(e){return e.stops=(t=e.type,(r=e.stops).length<=8?r:(s.warn("Found ".concat(r.length," Visual Variable stops, but MapView only supports ").concat(8,". Displayed stops will be simplified.")),r.length>16?function(e,t){for(var r=a.toArray(t),i=r[0],n=r.slice(1),s=n.pop(),o=n[0].value,u=n[n.length-1].value,c=(u-o)/6,f=[],p=o;p<u;p+=c){for(var y=0;p>=n[y].value;)y++;var m=n[y],v=t[y-1],b=p-v.value,g=m.value===v.value?1:b/(m.value-v.value);if("color"===e){var h=n[y],x=t[y-1],S=h.color.clone();S.r=d(x.color.r,S.r,g),S.g=d(x.color.g,S.g,g),S.b=d(x.color.b,S.b,g),S.a=d(x.color.a,S.a,g),f.push({value:p,color:S,label:h.label})}else if("size"===e){var V=n[y],w=t[y-1],z=(0,l.toPt)(V.size),F=d((0,l.toPt)(w.size),z,g);f.push({value:p,size:F,label:V.label})}else{var E=n[y],T=d(t[y-1].opacity,E.opacity,g);f.push({value:p,opacity:T,label:E.label})}}return[i].concat(a.toConsumableArray(f),[s])}(t,r):function(e){for(var t=a.toArray(e),r=t[0],i=t.slice(1),n=i.pop();i.length>6;){for(var l=0,s=0,o=1;o<i.length;o++){var u=i[o-1],c=i[o],f=Math.abs(c.value-u.value);f>s&&(s=f,l=o)}i.splice(l,1)}return[r].concat(a.toConsumableArray(i),[n])}(r))),e;var t,r}function d(e,t,r){return(1-r)*e+r*t}})),t.register("bPKxZ",(function(r,i){e(r.exports,"createClusterRenderer",(function(){return m})),e(r.exports,"isClusterCompatibleRenderer",(function(){return h})),e(r.exports,"findSizeVV",(function(){return v})),e(r.exports,"createClusterCountSizeVariable",(function(){return g}));var a=t("8TSCy"),n=t("kyj08"),l=t("2VlWd"),s=t("jHOLN"),o=t("7qybv"),u=t("fsJts"),c=t("2rUeJ"),f=t("8Eg1f"),d=t("a5FxJ"),p=s.default.getLogger("esri.views.2d.layers.support.clusterUtils");l.default.add("esri-cluster-arcade-enabled",!0);var y=(0,l.default)("esri-cluster-arcade-enabled"),m=function(e,t,r,i){var a=t.clone();if(!h(a))return a;var n=!0,l=!1,s=void 0;if(r.fields)try{for(var u,c=r.fields[Symbol.iterator]();!(n=(u=c.next()).done);n=!0){var f=u.value;x(e,f)}}catch(e){l=!0,s=e}finally{try{n||null==c.return||c.return()}finally{if(l)throw s}}if("visualVariables"in a){var d=(a.visualVariables||[]).filter((function(e){return"$view.scale"!==e.valueExpression})),p=v(d);d.forEach((function(t){"rotation"===t.type?t.field?t.field=V(e,t.field,"avg_angle"):t.valueExpression&&(t.field=S(e,t.valueExpression,"avg_angle"),t.valueExpression=null):t.normalizationField?(t.field=V(e,t.field,"norm",t.normalizationField),t.normalizationField=null):t.field?t.field=V(e,t.field,"avg"):(t.field=S(e,t.valueExpression,"avg"),t.valueExpression=null)})),(0,o.isNone)(p)&&!b(d)&&(d.push(g(r,i)),a.dynamicClusterSize=!0),a.visualVariables=d}switch(a.type){case"simple":break;case"unique-value":a.field?a.field=V(e,a.field,"mode"):a.valueExpression&&(a.field=S(e,a.valueExpression,"mode"),a.valueExpression=null);break;case"class-breaks":a.normalizationField?(a.field=V(e,a.field,"norm",a.normalizationField),a.normalizationField=null):a.field?a.field=V(e,a.field,"avg"):(a.field=S(e,a.valueExpression,"avg"),a.valueExpression=null)}return a},v=function(e){var t=!0,r=!1,i=void 0;try{for(var a,n=e[Symbol.iterator]();!(t=(a=n.next()).done);t=!0){var l=a.value;if("size"===l.type)return l}}catch(e){r=!0,i=e}finally{try{t||null==n.return||n.return()}finally{if(r)throw i}}return null},b=function(e){var t=!0,r=!1,i=void 0;try{for(var a,n=e[Symbol.iterator]();!(t=(a=n.next()).done);t=!0){if("cluster_count"===a.value.field)return!0}}catch(e){r=!0,i=e}finally{try{t||null==n.return||n.return()}finally{if(r)throw i}}return!1},g=function(e,t){var r=[new(0,f.default)({value:0,size:0}),new(0,f.default)({value:1})];if((0,o.isNone)(t))return new(0,c.default)({field:"cluster_count",stops:a.toConsumableArray(r).concat([new(0,f.default)({value:2,size:0})])});var i=Object.keys(t).reduce((function(i,n){return a.objectSpread({},i,a.defineProperty({},n,a.toConsumableArray(r).concat([new(0,f.default)({value:Math.max(2,t[n].minValue),size:e.clusterMinSize}),new(0,f.default)({value:Math.max(3,t[n].maxValue),size:e.clusterMaxSize})])))}),{});return new(0,d.LevelDependentSizeVariable)({field:"cluster_count",levels:i})},h=function(e){var t=function(t){return p.error(new(0,n.default)("Unsupported-renderer",t,{renderer:e}))};if("unique-value"===e.type){if(e.field2||e.field3)return t("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),!1}else if("class-breaks"===e.type){if(e.normalizationField){var r=e.normalizationType;if("field"!==r)return t("FeatureReductionCluster does not support a normalizationType of ".concat(r)),!1}}else if("simple"!==e.type)return t("FeatureReductionCluster does not support renderers of type ".concat(e.type)),!1;if(!y){if("valueExpression"in e&&e.valueExpression)return t("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if(("visualVariables"in e&&e.visualVariables||[]).some((function(e){return!(!("valueExpression"in e)||!e.valueExpression)})))return t("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),!1}return!0};function x(e,t){var r=t.name,i=t.outStatistic,a=i.onStatisticField,l=i.onStatisticValueExpression,s=i.statisticType;if(l){var o=(0,u.createMD5Hash)(l.toLowerCase());e.push({name:r,outStatistic:{onStatisticField:o,onStatisticValueExpression:l,statisticType:s}})}else a?e.push({name:r,outStatistic:{onStatisticField:a,statisticType:s}}):p.error(new(0,n.default)("mapview-unsupported-field","Unable to handle field",{field:t}))}function S(e,t,r){var i=(0,u.createMD5Hash)(t),a="mode"===r?"cluster_type_".concat(i):"cluster_avg_".concat(i);return e.some((function(e){return e.name===a}))||e.push({name:a,outStatistic:{onStatisticField:i,onStatisticValueExpression:t,statisticType:r}}),a}function V(e,t,r,i){if("cluster_count"===t||e.some((function(e){return e.name===t})))return t;var a=function(e,t,r){switch(e){case"avg":case"avg_angle":return"cluster_avg_".concat(t);case"mode":return"cluster_type_".concat(t);case"norm":var i=r,a=t.toLowerCase()+",norm:field,"+i.toLowerCase();return"cluster_avg_"+(0,u.createMD5Hash)(a)}}(r,t,i);return e.some((function(e){return e.name===a}))||("norm"===r?e.push({name:a,outStatistic:{onStatisticField:t,onStatisticNormalizationField:i,statisticType:r}}):e.push({name:a,outStatistic:{onStatisticField:t,statisticType:r}})),a}})),t.register("a5FxJ",(function(r,i){e(r.exports,"LevelDependentSizeVariable",(function(){return p}));var a=t("8TSCy"),n=t("7eJjO"),l=t("flPLJ"),s=t("iho5X");t("iJAIC");var o,u=t("fcwIv"),c=t("kced1"),f=t("2rUeJ"),d=t("1OaQa"),p=o=function(e){"use strict";a.inherits(r,e);var t=a.createSuper(r);function r(){return a.classCallCheck(this,r),t.apply(this,arguments)}return a.createClass(r,[{key:"writeLevels",value:function(e,t,r){for(var i in e){var a=this.levels[i];return void(t.stops=a)}}},{key:"clone",value:function(){return new o({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:(0,d.isSizeVariable)(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:(0,d.isSizeVariable)(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map((function(e){return e.clone()})),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone(),levels:(0,l.clone)(this.levels)})}}]),r}(f.default);(0,n._)([(0,s.property)()],p.prototype,"levels",void 0),(0,n._)([(0,c.writer)("levels")],p.prototype,"writeLevels",null),p=o=(0,n._)([(0,u.subclass)("esri.views.2d.engine.LevelDependentSizeVariable")],p)}))}();
//# sourceMappingURL=mapViewDeps.49108226.js.map
