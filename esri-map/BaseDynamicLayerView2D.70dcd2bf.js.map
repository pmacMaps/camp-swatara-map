{"mappings":"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","sources":["node_modules/@arcgis/core/views/2d/layers/support/ExportStrategy.js","node_modules/@arcgis/core/views/2d/viewStateUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../../chunks/tslib.es6.js\";import e from\"../../../../core/Accessor.js\";import{debounce as i}from\"../../../../core/promiseUtils.js\";import{property as o}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/arrayUtils.js\";import\"../../../../core/has.js\";import\"../../../../core/accessorSupport/ensureType.js\";import{subclass as r}from\"../../../../core/accessorSupport/decorators/subclass.js\";import s from\"../../../../geometry/Extent.js\";import{create as a}from\"../../../../geometry/support/aaBoundingRect.js\";import{getInfo as p}from\"../../../../geometry/support/spatialReferenceUtils.js\";import n from\"../../../../layers/support/TileInfo.js\";import{getOuterSize as m,getBBox as l}from\"../../viewStateUtils.js\";import{Bitmap as d}from\"../../engine/Bitmap.js\";import h from\"../../tiling/TileInfoView.js\";import c from\"../../tiling/TileKey.js\";const u=a(),g=[0,0],f=new c(0,0,0,0),x={container:null,fetchSource:null,requestUpdate:null,imageMaxWidth:2048,imageMaxHeight:2048,imageRotationSupported:!1,imageNormalizationSupported:!1,hidpi:!1};let y=class extends e{constructor(t){super(t),this._imagePromise=null,this.bitmaps=[],this.hidpi=x.hidpi,this.imageMaxWidth=x.imageMaxWidth,this.imageMaxHeight=x.imageMaxHeight,this.imageRotationSupported=x.imageRotationSupported,this.imageNormalizationSupported=x.imageNormalizationSupported,this.update=i((async(t,e)=>{if(!t.stationary||this.destroyed)return null;const i=t.state,o=p(i.spatialReference),r=this.hidpi?t.pixelRatio:1,s=this.imageNormalizationSupported&&i.worldScreenWidth&&i.worldScreenWidth<i.size[0];s?(g[0]=i.worldScreenWidth,g[1]=i.size[1]):this.imageRotationSupported?(g[0]=i.size[0],g[1]=i.size[1]):m(g,i);const a=Math.floor(g[0]*r)>this.imageMaxWidth||Math.floor(g[1]*r)>this.imageMaxHeight,n=o&&(i.extent.xmin<o.valid[0]||i.extent.xmax>o.valid[1]),l=!this.imageNormalizationSupported&&n,d=!a&&!l,h=this.imageRotationSupported?i.rotation:0;if(d){const t=s?i.paddedViewState.center:i.center;this._imagePromise=this._singleExport(i,g,t,i.resolution,h,r,e)}else{let t=Math.min(this.imageMaxWidth,this.imageMaxHeight);l&&(t=Math.min(i.worldScreenWidth,t)),this._imagePromise=this._tiledExport(i,t,h,r,e)}return this._imagePromise.then((async t=>{if(this._imagePromise=null,!this.destroyed){this.bitmaps=null!=t?t:[];for(const e of this.container.children)t.includes(e)||e.fadeOut().then((()=>{e.remove()}));for(const e of t)this.container.addChild(e),e.fadeIn()}})).catch((t=>{throw this._imagePromise=null,t}))}),5e3)}destroy(){this.bitmaps=[]}get updating(){return!this.destroyed&&null!==this._imagePromise}updateExports(t){for(const e of this.container.children){if(!e.visible||!e.stage)return;t(e),e.invalidateTexture(),e.requestRender()}}async _export(t,e,i,o,r,s){const a=await this.fetchSource(t,Math.floor(e*r),Math.floor(i*r),{rotation:o,pixelRatio:r,signal:s}),p=new d(a,\"additive\");return p.x=t.xmin,p.y=t.ymax,p.resolution=t.width/e,p.rotation=o,p.pixelRatio=r,p}async _singleExport(t,e,i,o,r,a,p){l(u,i,o,e);const n=new s(u[0],u[1],u[2],u[3],t.spatialReference);return[await this._export(n,e[0],e[1],r,a,p)]}_tiledExport(t,e,i,o,r){const a=n.create({size:e,spatialReference:t.spatialReference,scales:[t.scale]}),p=new h(a),m=p.getTileCoverage(t);if(!m)return null;const l=[];return m.forEach(((a,n,m,d)=>{f.set(a,n,m,d),p.getTileBounds(u,f);const h=new s(u[0],u[1],u[2],u[3],t.spatialReference);l.push(this._export(h,e,e,i,o,r))})),Promise.all(l)}};t([o()],y.prototype,\"_imagePromise\",void 0),t([o()],y.prototype,\"bitmaps\",void 0),t([o()],y.prototype,\"container\",void 0),t([o()],y.prototype,\"fetchSource\",void 0),t([o()],y.prototype,\"hidpi\",void 0),t([o()],y.prototype,\"imageMaxWidth\",void 0),t([o()],y.prototype,\"imageMaxHeight\",void 0),t([o()],y.prototype,\"imageRotationSupported\",void 0),t([o()],y.prototype,\"imageNormalizationSupported\",void 0),t([o()],y.prototype,\"requestUpdate\",void 0),t([o()],y.prototype,\"updating\",null),y=t([r(\"esri.views.2d.layers.support.ExportStrategy\")],y);const S=y;export{S as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nconst t=Math.PI/180;function n(n){return n*t}function o(t,n,o){const{resolution:r,size:u}=o;return t[0]=r*(Math.round(n[0]/r)+u[0]%2*.5),t[1]=r*(Math.round(n[1]/r)+u[1]%2*.5),t}function r(t,o){const r=n(o.rotation),u=Math.abs(Math.cos(r)),a=Math.abs(Math.sin(r)),[s,c]=o.size;return t[0]=Math.round(c*a+s*u),t[1]=Math.round(c*u+s*a),t}function u(t,n,o,r){const[u,a]=n,[s,c]=r,i=.5*o;return t[0]=u-i*s,t[1]=a-i*c,t[2]=u+i*s,t[3]=a+i*c,t}function a(t,n){const[o,r,u,a]=t,[s,c,i,e]=n;return!(o>i||u<s||r>e||a<c)}export{a as bboxIntersects,u as getBBox,r as getOuterSize,o as snapToPixel};\n"],"names":["$8TSCy","parcelRequire","$2d931d6b90a5af57$var$u","$8TwEW","create","$2d931d6b90a5af57$var$g","$2d931d6b90a5af57$var$f","$i90gL","default","$2d931d6b90a5af57$var$x","$2d931d6b90a5af57$var$y","e1","t1","_this","_super","call","this","_imagePromise","bitmaps","hidpi","imageMaxWidth","imageMaxHeight","imageRotationSupported","imageNormalizationSupported","update","$10vEZ","debounce","asyncToGenerator","$parcel$interopDefault","$2TvXO","mark","_callee1","t2","e2","_$i","_$o","_$r","s1","_$a","n1","l1","d1","h1","_$t","_$t1","stationary","_this1","destroyed","state","$eY5Yp","getInfo","spatialReference","pixelRatio","worldScreenWidth","size","$eA3h8","getOuterSize","Math","floor","extent","xmin","valid","xmax","rotation","paddedViewState","center","_singleExport","resolution","min","_tiledExport","then","_callee","t3","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_iterator","_step","_$e","_iteratorNormalCompletion1","_didIteratorError1","_iteratorError1","_iterator1","_step1","_$e1","undefined","container","children","Symbol","iterator","next","done","value","includes","fadeOut","remove","_ctx","t0","return","addChild","fadeIn","catch","t4","key","t5","visible","stage","invalidateTexture","requestRender","err","t6","e3","i1","o1","r1","s2","p1","fetchSource","signal","sent","$1ScYs","Bitmap","x","y","ymax","width","t7","e4","i2","o2","r2","a1","p2","n2","getBBox","$gINRd","_export","t8","e5","i3","o3","r3","$xQ42o","scales","scale","p3","$cqGfY","m1","getTileCoverage","l2","forEach","a2","n3","m2","d2","set","getTileBounds","_$h","push","Promise","all","$jymfC","$7eJjO","_","$iho5X","property","prototype","$2d931d6b90a5af57$export$2e2bcd8739ae039","$fcwIv","subclass","$a9d6f7e22103568f$var$t","PI","$a9d6f7e22103568f$export$6cff2cb15ed83407","u2","abs","cos","sin","_size","slicedToArray","s","c","round","$a9d6f7e22103568f$export$9cafdf24ffa90680","_n","u3","_r","i"],"version":3,"file":"BaseDynamicLayerView2D.70dcd2bf.js.map"}