!function(){function e(e){return e&&e.__esModule?e.default:e}var r=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire594f;r.register("lnx4K",(function(t,a){var n,o,s,i;n=t.exports,o="default",s=function(){return B},Object.defineProperty(n,o,{get:s,set:i,enumerable:!0,configurable:!0});var l=r("8TSCy"),u=r("2TvXO"),c=r("7eJjO"),p=r("d2yMj"),f=r("30Aps"),y=r("2l1wP"),d=r("1XAcN"),h=r("flPLJ"),m=r("bQCqB"),v=r("9MlGz"),b=r("jHOLN"),L=r("7qybv"),g=r("10vEZ"),w=r("kYueh"),I=r("iho5X");r("iJAIC");var _,S=r("fcwIv"),k=r("kced1"),x=r("j40xv"),O=r("ajJOT"),T=r("iYaGG"),j=r("jgJQw"),J=r("eJLrr"),M=0,R=b.default.getLogger("esri.Basemap"),A=_=function(t){"use strict";l.inherits(n,t);var a=l.createSuper(n);function n(e){var r;l.classCallCheck(this,n),(r=a.call(this,e)).id=null,r.portalItem=null,r.spatialReference=null,r.thumbnailUrl=null,r.title="Basemap",r.id=Date.now().toString(16)+"-basemap-"+M++,r.baseLayers=new(0,p.default),r.referenceLayers=new(0,p.default);var t=function(e){e.parent&&e.parent!==l.assertThisInitialized(r)&&"remove"in e.parent&&e.parent.remove(e),e.parent=l.assertThisInitialized(r),"elevation"===e.type&&R.error("Layer '".concat(e.title,", id:").concat(e.id,"' of type '").concat(e.type,"' is not supported as a basemap layer and will therefore be ignored."))},o=function(e){e.parent=null};return r.baseLayers.on("after-add",(function(e){return t(e.item)})),r.referenceLayers.on("after-add",(function(e){return t(e.item)})),r.baseLayers.on("after-remove",(function(e){return o(e.item)})),r.referenceLayers.on("after-remove",(function(e){return o(e.item)})),l.possibleConstructorReturn(r)}return l.createClass(n,[{key:"initialize",value:function(){var e=this;this.when().catch((function(r){R.error("#load()","Failed to load basemap (title: '".concat(e.title,"', id: '").concat(e.id,"')"),r)})),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}},{key:"destroy",value:function(){var e,r=this.baseLayers.removeAll(),t=!0,a=!1,n=void 0;try{for(var o,s=r[Symbol.iterator]();!(t=(o=s.next()).done);t=!0){o.value.destroy()}}catch(e){a=!0,n=e}finally{try{t||null==s.return||s.return()}finally{if(a)throw n}}var i=this.referenceLayers.removeAll(),l=!0,u=!1,c=void 0;try{for(var p,f=i[Symbol.iterator]();!(l=(p=f.next()).done);l=!0){p.value.destroy()}}catch(e){u=!0,c=e}finally{try{l||null==f.return||f.return()}finally{if(u)throw c}}this.baseLayers.destroy(),this.referenceLayers.destroy(),null==(e=this.portalItem)||e.destroy(),this.portalItem=null}},{key:"normalizeCtorArgs",value:function(e){return e&&"resourceInfo"in e&&(this._set("resourceInfo",e.resourceInfo),delete(e=l.objectSpread({},e)).resourceInfo),e}},{key:"baseLayers",set:function(e){this._set("baseLayers",(0,f.referenceSetter)(e,this._get("baseLayers")))}},{key:"_writeBaseLayers",value:function(e,r,t){var a=[];e?(t=l.objectSpread({},t,{layerContainerType:"basemap"}),this.baseLayers.forEach((function(e){var r=(0,J.getLayerJSON)(e,t.webmap?t.webmap.getLayerJSONFromResourceInfo(e):null,t);(0,L.isSome)(r)&&a.push(r)})),this.referenceLayers.forEach((function(e){var r=(0,J.getLayerJSON)(e,t.webmap?t.webmap.getLayerJSONFromResourceInfo(e):null,t);(0,L.isSome)(r)&&(r.isReference=!0,a.push(r))})),r.baseMapLayers=a):r.baseMapLayers=a}},{key:"referenceLayers",set:function(e){this._set("referenceLayers",(0,f.referenceSetter)(e,this._get("referenceLayers")))}},{key:"writeTitle",value:function(e,r){r.title=e||"Basemap"}},{key:"load",value:function(e){return this.addResolvingPromise(this._loadFromSource(e)),Promise.resolve(this)}},{key:"loadAll",value:function(){var e=this;return(0,v.loadAll)(this,(function(r){r(e.baseLayers,e.referenceLayers)}))}},{key:"clone",value:function(){var e={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.slice(),referenceLayers:this.referenceLayers.slice()};return this.loaded&&(e.loadStatus="loaded"),new _({resourceInfo:this.resourceInfo}).set(e)}},{key:"read",value:function(e,r){this.resourceInfo||this._set("resourceInfo",{data:e,context:r}),l.get(l.getPrototypeOf(n.prototype),"read",this).call(this,e,r)}},{key:"write",value:function(e,r){return e=e||{},r&&r.origin||(r=l.objectSpread({origin:"web-map"},r)),l.get(l.getPrototypeOf(n.prototype),"write",this).call(this,e,r),!this.loaded&&this.resourceInfo&&this.resourceInfo.data.baseMapLayers&&(e.baseMapLayers=this.resourceInfo.data.baseMapLayers.map((function(e){var r=(0,h.clone)(e);return r.url&&(0,w.isProtocolRelative)(r.url)&&(r.url="https:".concat(r.url)),r.templateUrl&&(0,w.isProtocolRelative)(r.templateUrl)&&(r.templateUrl="https:".concat(r.templateUrl)),r}))),e}},{key:"_loadFromSource",value:function(r){var t=this;return l.asyncToGenerator(e(u).mark((function a(){var n,o,s,i,l;return e(u).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.resourceInfo,o=t.portalItem,(0,g.throwIfAborted)(r),s=[],n?(i=n.context?n.context.url:null,s.push(t._loadLayersFromJSON(n.data,i,r)),n.data.id&&!n.data.title&&(l=n.data.id,s.push((0,j.getBasemapTitle)(l).then((function(e){e&&t.read({title:e},n.context)}))))):o&&s.push(t._loadFromItem(o,r)),e.next=6,Promise.all(s);case 6:case"end":return e.stop()}}),a)})))()}},{key:"_loadLayersFromJSON",value:function(t,a,n){var o=this;return l.asyncToGenerator(e(u).mark((function s(){var i,l,c,p,f,y,d,h,m;return e(u).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=o.resourceInfo&&o.resourceInfo.context,l=o.portalItem&&o.portalItem.portal||i&&i.portal||null,c=i&&"web-scene"===i.origin?"web-scene":"web-map",e.next=5,r("j9Wkz");case 5:return p=e.sent,f=p.populateOperationalLayers,y=[],(0,g.throwIfAborted)(n),t.baseMapLayers&&Array.isArray(t.baseMapLayers)&&(d={context:{origin:c,url:a,portal:l,layerContainerType:"basemap"},defaultLayerType:"DefaultTileLayer"},h=f(o.baseLayers,t.baseMapLayers.filter((function(e){return!e.isReference})),d),y.push(h),m=f(o.referenceLayers,t.baseMapLayers.filter((function(e){return e.isReference})),d),y.push(m)),e.next=11,(0,g.eachAlways)(y);case 11:case"end":return e.stop()}}),s)})))()}},{key:"_loadFromItem",value:function(r,t){var a=this;return l.asyncToGenerator(e(u).mark((function n(){var o,s,i;return e(u).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.load(t);case 2:return o=e.sent,e.next=5,o.fetchData("json",t);case 5:return s=e.sent,i=(0,w.urlToObject)(r.itemUrl),e.abrupt("return",(a._set("resourceInfo",{data:s.baseMap,context:{origin:"web-map",portal:r.portal||O.default.getDefault(),url:i}}),a.read(a.resourceInfo.data,a.resourceInfo.context),a.read({spatialReference:s.spatialReference},a.resourceInfo.context),a.read({title:r.title,thumbnailUrl:r.thumbnailUrl},{origin:"portal-item",portal:r.portal||O.default.getDefault(),url:i}),a._loadLayersFromJSON(a.resourceInfo.data,i,t)));case 8:case"end":return e.stop()}}),n)})))()}}],[{key:"fromId",value:function(e){var r=j.esriBasemapDefinitions[e];if(r){if(r.deprecated){var t=null;"dark-gray"===e?t="dark-gray-vector":"gray"===e?t="gray-vector":"streets"===e?t="streets-vector":"topo"===e&&(t="topo-vector"),(0,y.deprecated)(R,"The ".concat(e," basemap has entered mature support and is no longer being updated."),{replacement:t,see:"https://arcg.is/1iq8aD",warnOnce:!0})}return _.fromJSON(r)}return null}}]),n}((0,d.JSONSupportMixin)(m.default));(0,c._)([(0,I.property)({json:{write:{ignoreOrigin:!0,target:"baseMapLayers",writer:function(e,r,t,a){this._writeBaseLayers(e,r,a)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{baseMapLayers:{type:p.default}},writer:function(e,r,t,a){this._writeBaseLayers(e,r,a)}}}}}})],A.prototype,"baseLayers",null),(0,c._)([(0,I.property)({type:String,json:{origins:{"web-scene":{write:!0}}}})],A.prototype,"id",void 0),(0,c._)([(0,I.property)({type:T.default})],A.prototype,"portalItem",void 0),(0,c._)([(0,I.property)()],A.prototype,"referenceLayers",null),(0,c._)([(0,I.property)({readOnly:!0})],A.prototype,"resourceInfo",void 0),(0,c._)([(0,I.property)({type:x.default})],A.prototype,"spatialReference",void 0),(0,c._)([(0,I.property)()],A.prototype,"thumbnailUrl",void 0),(0,c._)([(0,I.property)({type:String,json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],A.prototype,"title",void 0),(0,c._)([(0,k.writer)("title")],A.prototype,"writeTitle",null);var B=A=_=(0,c._)([(0,S.subclass)("esri.Basemap")],A)})),r.register("j9Wkz",(function(e,t){e.exports=Promise.all([r("4WKyX")(r("aNJCr").getBundleURL("gQmW2")+r("iE7OH").resolve("ihA8s")),r("4WKyX")(r("aNJCr").getBundleURL("gQmW2")+r("iE7OH").resolve("92xMW"))]).then((function(){return r("99BmW")}))}))}();
//# sourceMappingURL=Basemap.8c5f84d8.js.map
