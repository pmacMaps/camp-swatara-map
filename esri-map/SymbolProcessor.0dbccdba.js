!function(){function e(e,t,o,r){Object.defineProperty(e,t,{get:o,set:r,enumerable:!0,configurable:!0})}var t=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire594f;t.register("k9Ouu",(function(o,r){e(o.exports,"CIMEffectHelper",(function(){return s}));var i=t("79LpT"),n=t("eA5AD"),l=t("fORtl"),a=t("4qQLM");class s{static executeEffects(e,t,o){const r=(0,n.cloneAndDecodeGeometry)(t);let i=new(0,l.SimpleGeometryCursor)(r);for(const t of e){const e=(0,a.getEffectOperator)(t);e&&(i=e.execute(i,t,1.3333333333333333,o))}return i}static next(e){const t=e.next();return(0,n.deltaEncodeGeometry)(t),t}static applyEffects(e,t,o){if(!e)return t;let r=new(0,l.SimpleGeometryCursor)(t);for(const t of e){const e=(0,a.getEffectOperator)(t);e&&(r=e.execute(r,t,1,o))}let n,s=null;for(;n=r.next();)s?(0,i.isPolyline)(s)?(0,i.isPolyline)(n)&&s.paths.push(...n.paths):(0,i.isPolygon)(s)&&(0,i.isPolygon)(n)&&s.rings.push(...n.rings):s=n;return s}}})),t.register("aNOUb",(function(o,r){e(o.exports,"analyzeCIMSymbol",(function(){return I})),e(o.exports,"analyzeCIMResource",(function(){return q}));var i=t("jgs9n"),n=t("flPLJ"),l=t("jHOLN"),a=t("7qybv"),s=t("iXlXu"),c=t("1TSdR"),f=t("3nnTb"),u=t("4FBKO"),m=t("6LoaD"),p=t("8rAvb"),y=t("1o7Kk"),h=t("k9Ouu"),g=t("kNgwU"),d=t("4WoSm"),S=t("kyAlm"),v=t("7J5Re");const C=l.default.getLogger("esri.symbols.cim.cimAnalyzer");function b(e){switch(e){case"Butt":return m.CapType.BUTT;case"Square":return m.CapType.SQUARE;default:return m.CapType.ROUND}}function M(e){switch(e){case"Bevel":return m.JoinType.BEVEL;case"Miter":return m.JoinType.MITER;default:return m.JoinType.ROUND}}function N(e){switch(e){case"Left":default:return"left";case"Right":return"right";case"Center":return"center";case"Justify":return C.warnOnce("Horizontal alignment 'justify' is not implemented. Falling back to 'center'."),"center"}}function O(e){switch(e){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function k(e,t,o,r){let i;e[t]?i=e[t]:(i={},e[t]=i),i[o]=r}function x(e){const t=e.markerPlacement;return t&&t.angleToLine?m.Alignment.MAP:m.Alignment.SCREEN}async function I(e,t,o,r,i){const n=null!=r?r:[];if(!e)return n;let l,a;const s={};if("CIMSymbolReference"!==e.type)return C.error("Expect cim type to be 'CIMSymbolReference'"),n;if(l=e.symbol,a=e.primitiveOverrides,a){const e=[];for(const o of a){const r=o.valueExpressionInfo;if(r&&t){const i=r.expression,n=(0,f.createRendererExpression)(i,t.spatialReference,t.fields).then((e=>{e&&k(s,o.primitiveName,o.propertyName,e)}));e.push(n)}else null!=o.value&&k(s,o.primitiveName,o.propertyName,o.value)}e.length>0&&await Promise.all(e)}const c=[];switch(_(l,o,c),c.length>0&&await Promise.all(c),l.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":!function(e,t,o,r,i,n,l){if(!e)return;const a=e.symbolLayers;if(!a)return;const s=e.effects;let c;const f=u.CIMSymbolHelper.getSize(e);"CIMPointSymbol"===e.type&&"Map"===e.angleAlignment&&(c=m.Alignment.MAP);let p=a.length;for(;p--;){const m=a[p];if(!m||!1===m.enable)continue;let y;s&&s.length&&(y=[...s]);const h=m.effects;h&&h.length&&(s?y.push(...h):y=[...h]);const g=[];let d;u.OverrideHelper.findEffectOverrides(y,t,g),d=g.length>0?U(y,g,o,r):y;const S=[];switch(u.OverrideHelper.findApplicableOverrides(m,t,S),m.type){case"CIMSolidFill":P(m,d,o,S,r,i);break;case"CIMPictureFill":w(m,d,o,S,r,n,i);break;case"CIMHatchFill":H(m,d,o,S,r,i);break;case"CIMGradientFill":L(m,d,o,S,r,i);break;case"CIMSolidStroke":A(m,d,o,S,r,i,"CIMPolygonSymbol"===e.type,f);break;case"CIMPictureStroke":R(m,d,o,S,r,i,"CIMPolygonSymbol"===e.type,f);break;case"CIMGradientStroke":E(m,d,o,S,r,i,"CIMPolygonSymbol"===e.type,f);break;case"CIMCharacterMarker":if(z(m,d,o,S,r,i))break;break;case"CIMPictureMarker":if(z(m,d,o,S,r,i))break;"CIMLineSymbol"===e.type&&(c=x(m)),X(m,d,o,S,r,n,i,c,f);break;case"CIMVectorMarker":if(z(m,d,o,S,r,i))break;"CIMLineSymbol"===e.type&&(c=x(m)),J(m,d,o,S,r,i,n,c,f,l);break;default:C.error("Cannot analyze CIM layer",m.type)}}}(l,a,s,t,n,o,i)}return n}function P(e,t,o,r,i,n){const l=e.primitiveName,a=(0,y.fromCIMColor)(e.color),[s,f]=B(r,l,t,null,null),u=(0,c.numericHash)(JSON.stringify(e)+f).toString();n.push({type:"fill",templateHash:u,materialHash:s?()=>u:u,cim:e,materialOverrides:null,colorLocked:e.colorLocked,color:G(l,o,"Color",i,a,$),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:t,applyRandomOffset:!1,sampleAlphaOnly:!0})}function w(e,t,o,r,i,n,l){const s=e.primitiveName,f=e.tintColor?(0,y.fromCIMColor)(e.tintColor):{r:255,g:255,b:255,a:1},[u,m]=B(r,s,t,null,null),p=(0,c.numericHash)(JSON.stringify(e)+m).toString(),h=(0,c.numericHash)(`${e.url}${JSON.stringify(e.colorSubstitutions)}`).toString();let g=(0,y.getValue)(e.scaleX);if("width"in e){const t=e.width;let o=1;const r=n.getResource(e.url);(0,a.isSome)(r)&&(o=r.width/r.height),g/=o*(e.height/t)}l.push({type:"fill",templateHash:p,materialHash:u?()=>h:h,cim:e,materialOverrides:null,colorLocked:e.colorLocked,effects:t,color:G(s,o,"TintColor",i,f,$),height:G(s,o,"Height",i,e.height),scaleX:G(s,o,"ScaleX",i,g),angle:G(s,o,"Rotation",i,(0,y.getValue)(e.rotation)),offsetX:G(s,o,"OffsetX",i,(0,y.getValue)(e.offsetX)),offsetY:G(s,o,"OffsetY",i,(0,y.getValue)(e.offsetY)),url:e.url,applyRandomOffset:!1,sampleAlphaOnly:!1})}function H(e,t,o,r,i,n){const l=["Rotation","OffsetX","OffsetY"],a=r.filter((t=>t.primitiveName!==e.primitiveName&&!l.includes(t.propertyName))),s=e.primitiveName,[f,u]=B(r,s,t,null,null),m=(0,c.numericHash)(JSON.stringify(e)+u).toString(),p=(0,c.numericHash)(`${e.separation}${JSON.stringify(e.lineSymbol)}`).toString();let h={r:255,g:255,b:255,a:1};if(e.lineSymbol){var g;const t=null===(g=e.lineSymbol)||void 0===g?void 0:g.symbolLayers.find((e=>"CIMSolidStroke"===e.type));t&&(h=(0,y.fromCIMColor)(t.color))}n.push({type:"fill",templateHash:m,materialHash:f?j(p,o,a,i):p,cim:e,materialOverrides:a,colorLocked:e.colorLocked,effects:t,color:h,height:G(s,o,"Separation",i,e.separation),scaleX:1,angle:G(s,o,"Rotation",i,(0,y.getValue)(e.rotation)),offsetX:G(s,o,"OffsetX",i,(0,y.getValue)(e.offsetX)),offsetY:G(s,o,"OffsetY",i,(0,y.getValue)(e.offsetY)),applyRandomOffset:!1,sampleAlphaOnly:!0})}function L(e,t,o,r,i,n){const l=e.primitiveName,[a,s]=B(r,l,t,null,null),f=(0,c.numericHash)(JSON.stringify(e)+s).toString();n.push({type:"fill",templateHash:f,materialHash:a?j(f,o,r,i):f,cim:e,materialOverrides:null,colorLocked:e.colorLocked,effects:t,color:{r:128,g:128,b:128,a:1},height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,applyRandomOffset:!1,sampleAlphaOnly:!1})}function A(e,t,o,r,i,n,l,a){const s=e.primitiveName,f=(0,y.fromCIMColor)(e.color),u=void 0!==e.width?e.width:4,m=b(e.capStyle),p=M(e.joinStyle),h=e.miterLimit,[g,d]=B(r,s,t,null,null),S=(0,c.numericHash)(JSON.stringify(e)+d).toString();let v,C;if(t&&t instanceof Array&&t.length>0){const e=t[t.length-1];if("CIMGeometricEffectDashes"===e.type&&"NoConstraint"===e.lineDashEnding&&null===e.offsetAlongLine){const e=(t=[...t]).pop();v=e.dashTemplate,C=e.scaleDash}}n.push({type:"line",templateHash:S,materialHash:g?()=>S:S,cim:e,materialOverrides:null,isOutline:l,colorLocked:e.colorLocked,effects:t,color:G(s,o,"Color",i,f,$),width:G(s,o,"Width",i,u),cap:G(s,o,"CapStyle",i,m),join:G(s,o,"JoinStyle",i,p),miterLimit:G(s,o,"MiterLimit",i,h),referenceWidth:a,zOrder:Y(e.name),dashTemplate:v,scaleDash:C,sampleAlphaOnly:!0})}function R(e,t,o,r,i,n,l,a){const s=(0,c.numericHash)(`${e.url}${JSON.stringify(e.colorSubstitutions)}`).toString(),f=e.primitiveName,u=(0,y.fromCIMColor)(e.tintColor),m=void 0!==e.width?e.width:4,p=b(e.capStyle),h=M(e.joinStyle),g=e.miterLimit,[d,S]=B(r,f,t,null,null),v=(0,c.numericHash)(JSON.stringify(e)+S).toString();n.push({type:"line",templateHash:v,materialHash:d?()=>s:s,cim:e,materialOverrides:null,isOutline:l,colorLocked:e.colorLocked,effects:t,color:G(f,o,"TintColor",i,u,$),width:G(f,o,"Width",i,m),cap:G(f,o,"CapStyle",i,p),join:G(f,o,"JoinStyle",i,h),miterLimit:G(f,o,"MiterLimit",i,g),referenceWidth:a,zOrder:Y(e.name),dashTemplate:null,scaleDash:!1,url:e.url,sampleAlphaOnly:!1})}function E(e,t,o,r,i,n,l,a){const s=e.primitiveName,f=void 0!==e.width?e.width:4,u=b(e.capStyle),m=M(e.joinStyle),p=e.miterLimit,[y,h]=B(r,s,t,null,null),g=(0,c.numericHash)(JSON.stringify(e)+h).toString();n.push({type:"line",templateHash:g,materialHash:y?j(g,o,r,i):g,cim:e,materialOverrides:null,isOutline:l,colorLocked:e.colorLocked,effects:t,color:{r:128,g:128,b:128,a:1},width:G(s,o,"Width",i,f),cap:G(s,o,"CapStyle",i,u),join:G(s,o,"JoinStyle",i,m),miterLimit:G(s,o,"MiterLimit",i,p),referenceWidth:a,zOrder:Y(e.name),dashTemplate:null,scaleDash:!1,sampleAlphaOnly:!1})}function z(e,t,o,r,i,n){const l=e.markerPlacement;if(!l||"CIMMarkerPlacementInsidePolygon"!==l.type)return!1;const a=l,f=Math.abs(a.stepX),u=Math.abs(a.stepY);if(0===f||0===u)return!0;const m=["Rotation","OffsetX","OffsetY"],p=r.filter((t=>t.primitiveName!==e.primitiveName&&!m.includes(t.propertyName))),h="url"in e?e.url:null,[g,S]=B(r,a.primitiveName,t,null,null),v=(0,c.numericHash)(JSON.stringify(e)+S).toString();let C,b,M=null;if("Random"===l.gridType){const e=(0,s.px2pt)(d.RANDOM_INSIDE_POLYGON_TEXTURE_SIZE),t=Math.max(Math.floor(e/f),1),o=Math.max(Math.floor(e/u),1);C=u*o,M=e=>e?e*o:0,b=t*f/C}else l.shiftOddRows?(C=2*u,M=e=>e?2*e:0,b=f/u*.5):(C=u,M=null,b=f/u);let N={r:255,g:255,b:255,a:1};return"tintColor"in e&&(N=(0,y.fromCIMColor)(e.tintColor)),n.push({type:"fill",templateHash:v,materialHash:g?j(v,o,p,i):v,cim:e,materialOverrides:p,colorLocked:e.colorLocked,effects:t,color:G(a.primitiveName,o,"TintColor",i,N,$),height:G(a.primitiveName,o,"StepY",i,C,M),scaleX:b,angle:G(a.primitiveName,o,"GridAngle",i,a.gridAngle),offsetX:G(a.primitiveName,o,"OffsetX",i,(0,y.getValue)(a.offsetX)),offsetY:G(a.primitiveName,o,"OffsetY",i,(0,y.getValue)(a.offsetY)),url:h,applyRandomOffset:"Random"===l.gridType,sampleAlphaOnly:!h}),!0}function X(e,t,o,r,i,l,s,m,p){const h=e.primitiveName,d=(0,y.getValue)(e.size);let S=(0,y.getValue)(e.scaleX);var C;const b=(0,y.getValue)(e.rotation),M=(0,y.getValue)(e.offsetX),N=(0,y.getValue)(e.offsetY),O=e.tintColor?(0,y.fromCIMColor)(e.tintColor):{r:255,g:255,b:255,a:1},k=(0,c.numericHash)(`${e.url}${JSON.stringify(e.colorSubstitutions)}${JSON.stringify(e.animatedSymbolProperties)}`).toString(),x=W(e.markerPlacement,r,o,i),I=function(e,t,o,r){const i=[];if(u.OverrideHelper.findApplicableOverrides(e,t,i),0===i.length)return e;for(const e of i)if(e.valueExpressionInfo){const t=o[e.primitiveName]&&o[e.primitiveName][e.propertyName];t instanceof f.ArcadeExpression&&(e.fn=(e,o,i)=>(0,g.default)(t,e,{$view:i},r.geometryType,o))}return(t,o,r)=>{for(const e of i)e.fn&&(e.value=e.fn(t,o,r));const l=(0,n.clone)(e),a=e.primitiveName;for(const e of i)if(e.primitiveName===a){const t=D(e.propertyName);null!=e.value&&e.value!==l[t]&&(l[t]=e.value)}return l}}(e.animatedSymbolProperties,r,o,i),[P,w]=B(r,h,t,x,I),H=(0,c.numericHash)(JSON.stringify(e)+w).toString(),L=null!==(C=e.anchorPoint)&&void 0!==C?C:{x:0,y:0};if("width"in e){const t=e.width;let o=1;const r=l.getResource(e.url);(0,a.isSome)(r)&&(o=r.width/r.height),S/=o*(d/t)}function A(e,t){return(0,y.evaluateValueOrFunction)(I,e,t)}const R=e.animatedSymbolProperties&&!0===e.animatedSymbolProperties.randomizeStartTime?(e,t,o,r)=>{const i=(0,v.getMaterialGroup)(r),n=A(e,t);return k+`-MATERIALGROUP(${i})`+`-ASP(${JSON.stringify(n)})`}:P?(e,t)=>{const o=A(e,t);return k+`-ASP(${JSON.stringify(o)})`}:k;s.push({type:"marker",templateHash:H,materialHash:R,cim:e,materialOverrides:null,colorLocked:e.colorLocked,effects:t,scaleSymbolsProportionally:!1,alignment:m,size:G(h,o,"Size",i,d),scaleX:G(h,o,"ScaleX",i,S),rotation:G(h,o,"Rotation",i,b),offsetX:G(h,o,"OffsetX",i,M),offsetY:G(h,o,"OffsetY",i,N),color:G(h,o,"TintColor",i,O,$),anchorPoint:{x:L.x,y:-L.y},isAbsoluteAnchorPoint:"Relative"!==e.anchorPointUnits,outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,frameHeight:0,rotateClockwise:e.rotateClockwise,referenceSize:p,sizeRatio:1,markerPlacement:x,url:e.url,animatedSymbolProperties:I})}function J(e,t,o,r,i,n,l,a,s,c){const f=e.markerGraphics;if(!f)return;let u=0;if(e.scaleSymbolsProportionally){const t=e.frame;t&&(u=t.ymax-t.ymin)}const m=W(e.markerPlacement,r,o,i);for(const p of f)if(p){const f=p.symbol;if(!f)continue;switch(f.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":T(e,t,m,null,p,r,o,i,n,l,a,s,u,c);break;case"CIMTextSymbol":F(e,t,m,p,o,r,i,n,a,s,u)}}}function F(e,t,o,r,i,n,l,a,s,f,m){u.OverrideHelper.findApplicableOverrides(r,n,[]);const p=r.geometry;if(!("x"in p)||!("y"in p))return;const h=r.symbol,g=function(e){return e.underline?"underline":e.strikethrough?"line-through":"none"}(h),d=function(e){let t="",o="";if(e){const r=e.toLowerCase();r.includes("italic")?t="italic":r.includes("oblique")&&(t="oblique"),r.includes("bold")?o="bold":r.includes("light")&&(o="lighter")}return{style:t,weight:o}}(h.fontStyleName),v=(0,S.getFontFamily)(h.fontFamilyName);h.font={family:v,decoration:g,...d};const C=e.frame,b=p.x-.5*(C.xmin+C.xmax),M=p.y-.5*(C.ymin+C.ymax),k=e.size/m,x=e.primitiveName,I=(0,y.getValue)(h.height)*k,P=(0,y.getValue)(h.angle),w=(0,y.getValue)(e.offsetX)+((0,y.getValue)(h.offsetX)+b)*k,H=(0,y.getValue)(e.offsetY)+((0,y.getValue)(h.offsetY)+M)*k,L=(0,y.fromCIMColor)(u.CIMSymbolHelper.getFillColor(h));let A=(0,y.fromCIMColor)(u.CIMSymbolHelper.getStrokeColor(h)),R=u.CIMSymbolHelper.getStrokeWidth(h);R||(A=(0,y.fromCIMColor)(u.CIMSymbolHelper.getFillColor(h.haloSymbol)),R=h.haloSize*k);const[E,z]=B(n,x,t,o,null),X=JSON.stringify(e.effects)+Number(e.colorLocked)+JSON.stringify(e.anchorPoint)+e.anchorPointUnits+JSON.stringify(e.markerPlacement),J=(0,c.numericHash)(JSON.stringify(r)+X+z).toString();let F=G(r.primitiveName,i,"TextString",l,r.textString,y._adjustTextCase,h.textCase);if(null==F)return;const{fontStyleName:T}=h,V=v+(T?"-"+T.toLowerCase():"-regular"),Y=V;"string"==typeof F&&F.includes("[")&&h.fieldMap&&(F=(0,y.createLabelOverrideFunction)(h.fieldMap,F,h.textCase)),a.push({type:"text",templateHash:J,materialHash:E||"function"==typeof F||F.match(/\[(.*?)\]/)?(e,t,o)=>Y+"-"+(0,y.evaluateValueOrFunction)(F,e,t,o):Y+"-"+(0,c.numericHash)(F),cim:h,materialOverrides:null,colorLocked:e.colorLocked,effects:t,alignment:s,anchorPoint:{x:e.anchorPoint?e.anchorPoint.x:0,y:e.anchorPoint?e.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==e.anchorPointUnits,fontName:V,decoration:g,weight:G(x,i,"Weight",l,d.weight),style:G(x,i,"Size",l,d.style),size:G(x,i,"Size",l,I),angle:G(x,i,"Rotation",l,P),offsetX:G(x,i,"OffsetX",l,w),offsetY:G(x,i,"OffsetY",l,H),horizontalAlignment:N(h.horizontalAlignment),verticalAlignment:O(h.verticalAlignment),text:F,color:L,outlineColor:A,outlineSize:R,referenceSize:f,sizeRatio:1,markerPlacement:o})}function T(e,t,o,r,i,n,l,s,f,m,g,d,S,v){const C=i.symbol,b=C.symbolLayers;if(!b)return;if(v)return void V(e,t,o,r,i,l,n,s,f,m,g,d,S);let M=b.length;if(K(b))return void function(e,t,o,r,i,n,l,a,s,f,m,h,g){const d=i.geometry,S=n[0],v=n[1],C=(0,p.getExtent)(d);if(!C)return;const[b,M,N]=(0,p.getSDFMetrics)(C,e.frame,e.size,e.anchorPoint,"Relative"!==e.anchorPointUnits),O={type:"sdf",geom:d,asFill:!0},k=e.primitiveName,x=(0,y.getValue)(e.size),I=(0,y.getValue)(e.rotation),P=(0,y.getValue)(e.offsetX),w=(0,y.getValue)(e.offsetY),H=v.path,L=v.primitiveName,A=S.primitiveName,R=(0,y.fromCIMColor)(u.CIMSymbolHelper.getFillColor(v)),E=(0,y.fromCIMColor)(u.CIMSymbolHelper.getStrokeColor(S)),z=u.CIMSymbolHelper.getStrokeWidth(S);let X=!1,J="";for(const e of l)e.primitiveName!==L&&e.primitiveName!==A&&e.primitiveName!==k||(void 0!==e.value?J+=`-${e.primitiveName}-${e.propertyName}-${JSON.stringify(e.value)}`:e.valueExpressionInfo&&(X=!0));const F=JSON.stringify({...e,markerGraphics:null}),T=(0,c.numericHash)(JSON.stringify(O)+H).toString(),V={type:"marker",templateHash:(0,c.numericHash)(JSON.stringify(i)+JSON.stringify(v)+JSON.stringify(S)+F+J).toString(),materialHash:X?()=>T:T,cim:O,materialOverrides:null,colorLocked:e.colorLocked,effects:t,scaleSymbolsProportionally:e.scaleSymbolsProportionally,alignment:m,anchorPoint:{x:M,y:N},isAbsoluteAnchorPoint:!1,size:G(e.primitiveName,a,"Size",s,x),rotation:G(e.primitiveName,a,"Rotation",s,I),offsetX:G(e.primitiveName,a,"OffsetX",s,P),offsetY:G(e.primitiveName,a,"OffsetY",s,w),scaleX:1,frameHeight:g,rotateClockwise:e.rotateClockwise,referenceSize:h,sizeRatio:b,color:G(L,a,"Color",s,R,$),outlineColor:G(A,a,"Color",s,E,$),outlineWidth:G(A,a,"Width",s,z),markerPlacement:o,path:H,animatedSymbolProperties:r};f.push(V)}(e,t,o,r,i,b,n,l,s,f,g,d,S);const N=h.CIMEffectHelper.applyEffects(C.effects,i.geometry,m.geometryEngine);if(N)for(;M--;){const v=b[M];if(v&&!1!==v.enable)switch(v.type){case"CIMSolidFill":case"CIMSolidStroke":{const C=h.CIMEffectHelper.applyEffects(v.effects,N,m.geometryEngine),b=(0,p.getExtent)(C);if(!b)continue;var O;const[M,k,x]=(0,p.getSDFMetrics)(b,e.frame,e.size,e.anchorPoint,"Relative"!==e.anchorPointUnits),I="CIMSolidFill"===v.type,P={type:"sdf",geom:C,asFill:I},w=e.primitiveName,H=null!==(O=(0,y.getValue)(e.size))&&void 0!==O?O:10,L=(0,y.getValue)(e.rotation),A=(0,y.getValue)(e.offsetX),R=(0,y.getValue)(e.offsetY),E=v.path,z=v.primitiveName,X=(0,y.fromCIMColor)(I?u.CIMSymbolHelper.getFillColor(v):u.CIMSymbolHelper.getStrokeColor(v)),J=I?{r:0,g:0,b:0,a:0}:(0,y.fromCIMColor)(u.CIMSymbolHelper.getStrokeColor(v)),F=u.CIMSymbolHelper.getStrokeWidth(v);if(!I&&!F)break;let T=!1,V="";for(const e of n)e.primitiveName!==z&&e.primitiveName!==w||(void 0!==e.value?V+=`-${e.primitiveName}-${e.propertyName}-${JSON.stringify(e.value)}`:e.valueExpressionInfo&&(T=!0));(0,a.isSome)(t)&&"function"==typeof t&&(T=!0);const Y=JSON.stringify({...e,markerGraphics:null}),D=(0,c.numericHash)(JSON.stringify(P)+E).toString(),U={type:"marker",templateHash:(0,c.numericHash)(JSON.stringify(i)+JSON.stringify(v)+Y+V).toString(),materialHash:T?()=>D:D,cim:P,materialOverrides:null,colorLocked:e.colorLocked,effects:t,scaleSymbolsProportionally:e.scaleSymbolsProportionally,alignment:g,anchorPoint:{x:k,y:x},isAbsoluteAnchorPoint:!1,size:G(e.primitiveName,l,"Size",s,H),rotation:G(e.primitiveName,l,"Rotation",s,L),offsetX:G(e.primitiveName,l,"OffsetX",s,A),offsetY:G(e.primitiveName,l,"OffsetY",s,R),scaleX:1,frameHeight:S,rotateClockwise:e.rotateClockwise,referenceSize:d,sizeRatio:M,color:G(z,l,"Color",s,X,$),outlineColor:G(z,l,"Color",s,J,$),outlineWidth:G(z,l,"Width",s,F),markerPlacement:o,animatedSymbolProperties:r,path:E};f.push(U);break}default:V(e,t,o,r,i,l,n,s,f,m,g,d,S)}}}function V(e,t,o,r,i,n,l,f,m,p,h,g,d){const S=function(e,t){return{type:e.type,enable:!0,name:e.name,colorLocked:e.colorLocked,primitiveName:e.primitiveName,anchorPoint:e.anchorPoint,anchorPointUnits:e.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:e.rotateClockwise,rotation:0,size:e.size,billboardMode3D:e.billboardMode3D,depth3D:e.depth3D,frame:e.frame,markerGraphics:[t],scaleSymbolsProportionally:e.scaleSymbolsProportionally,respectFrame:e.respectFrame,clippingPath:e.clippingPath}}(e,i);let v=[];const C=["Rotation","OffsetX","OffsetY"];v=l.filter((t=>t.primitiveName!==e.primitiveName||!C.includes(t.propertyName)));let b="";for(const e of l)void 0!==e.value&&(b+=`-${e.primitiveName}-${e.propertyName}-${JSON.stringify(e.value)}`);const[M,N,O]=u.CIMSymbolHelper.getTextureAnchor(S,p),k=e.primitiveName,x=(0,y.getValue)(e.rotation),I=(0,y.getValue)(e.offsetX),P=(0,y.getValue)(e.offsetY),w=(0,c.numericHash)(JSON.stringify(S)+b).toString(),H={type:"marker",templateHash:w,materialHash:v.length>0||(0,a.isSome)(t)&&"function"==typeof t?j(w,n,v,f):w,cim:S,materialOverrides:v,colorLocked:e.colorLocked,effects:t,scaleSymbolsProportionally:e.scaleSymbolsProportionally,alignment:h,anchorPoint:{x:M,y:N},isAbsoluteAnchorPoint:!1,size:e.size,rotation:G(k,n,"Rotation",f,x),offsetX:G(k,n,"OffsetX",f,I),offsetY:G(k,n,"OffsetY",f,P),color:{r:255,g:255,b:255,a:1},outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,scaleX:1,frameHeight:d,rotateClockwise:e.rotateClockwise,referenceSize:g,sizeRatio:O/(0,s.pt2px)(e.size),markerPlacement:o,animatedSymbolProperties:r};m.push(H)}function Y(e){if(e&&0===e.indexOf("Level_")){const t=parseInt(e.substr(6),10);if(!isNaN(t))return t}return 0}function $(e){if(!e||0===e.length)return null;const t=new(0,i.default)(e).toRgba();return{r:t[0],g:t[1],b:t[2],a:t[3]}}function G(e,t,o,r,i,n,l){const a=t[e];if(a){const e=a[o];if("string"==typeof e||"number"==typeof e||e instanceof Array)return n?n.call(null,e,l):e;if(null!=e&&e instanceof f.ArcadeExpression)return(t,o,a)=>{let s=(0,g.default)(e,t,{$view:a},r.geometryType,o);return null!==s&&n&&(s=n.call(null,s,l)),null!==s?s:i}}return i}function D(e){return e?e.charAt(0).toLowerCase()+e.substr(1):e}function U(e,t,o,r){for(const e of t)if(e.valueExpressionInfo){const t=o[e.primitiveName]&&o[e.primitiveName][e.propertyName];t instanceof f.ArcadeExpression&&(e.fn=(e,o,i)=>(0,g.default)(t,e,{$view:i},r.geometryType,o))}return(o,r,i)=>{for(const e of t)e.fn&&(e.value=e.fn(o,r,i));const l=[];for(let o of e){const e=null==o?void 0:o.primitiveName;if(e){let r=!1;for(const i of t)if(i.primitiveName===e){const e=D(i.propertyName);null!=i.value&&i.value!==o[e]&&(r||(o=(0,n.clone)(o),r=!0),o[e]=i.value)}}l.push(o)}return l}}function W(e,t,o,r){const i=[];if(u.OverrideHelper.findApplicableOverrides(e,t,i),0===i.length)return e;for(const e of i)if(e.valueExpressionInfo){const t=o[e.primitiveName]&&o[e.primitiveName][e.propertyName];t instanceof f.ArcadeExpression&&(e.fn=(e,o,i)=>(0,g.default)(t,e,{$view:i},r.geometryType,o))}return(t,o,r)=>{for(const e of i)e.fn&&(e.value=e.fn(t,o,r));const l=(0,n.clone)(e),a=e.primitiveName;for(const e of i)if(e.primitiveName===a){const t=D(e.propertyName);null!=e.value&&e.value!==l[t]&&(l[t]=e.value)}return l}}function j(e,t,o,r){for(const e of o)if(e.valueExpressionInfo){const o=t[e.primitiveName]&&t[e.primitiveName][e.propertyName];o instanceof f.ArcadeExpression&&(e.fn=(e,t,i)=>(0,g.default)(o,e,{$view:i},r.geometryType,t))}return(t,r,i)=>{for(const e of o)e.fn&&(e.value=e.fn(t,r,i));return(0,c.numericHash)(e+u.OverrideHelper.buildOverrideKey(o)).toString()}}function q(e,t){if(!t||0===t.length)return e;const o=JSON.parse(JSON.stringify(e));return u.OverrideHelper.applyOverrides(o,t),o}function B(e,t,o,r,i){let n=!1,l="";for(const o of e)o.primitiveName===t&&(void 0!==o.value?l+=`-${o.primitiveName}-${o.propertyName}-${JSON.stringify(o.value)}`:o.valueExpressionInfo&&(n=!0));return(0,a.isSome)(o)&&"function"==typeof o&&(n=!0),(0,a.isSome)(r)&&"function"==typeof r&&(n=!0),(0,a.isSome)(i)&&"function"==typeof i&&(n=!0),[n,l]}function _(e,t,o){if(e&&t)switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":{const r=e.symbolLayers;if(!r)return;for(const e of r)switch(Z(e,t,o),e.type){case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":case"CIMPictureStroke":case"CIMGradientStroke":case"CIMCharacterMarker":case"CIMPictureMarker":"url"in e&&e.url&&o.push(t.fetchResource(e.url,null));break;case"CIMVectorMarker":{const r=e.markerGraphics;if(!r)continue;for(const e of r)if(e){const r=e.symbol;r&&_(r,t,o)}}}}}}const K=e=>e&&2===e.length&&e[0].enable&&e[1].enable&&"CIMSolidStroke"===e[0].type&&"CIMSolidFill"===e[1].type&&!e[0].effects&&!e[1].effects;let Q;function Z(e,t,o){e.effects&&!(0,a.isSome)(t.geometryEngine)&&(Q?o.push(Q):(0,y.isGeometryEngineRequired)(e.effects)&&(Q=(0,y.importGeometryEngine)(),o.push(Q),Q.then((e=>t.geometryEngine=e))))}})),t.register("8rAvb",(function(o,r){e(o.exports,"getSDFInfo",(function(){return a})),e(o.exports,"getExtent",(function(){return c})),e(o.exports,"getSDFMetrics",(function(){return f})),e(o.exports,"buildSDF",(function(){return u}));var i=t("7Dw9j"),n=t("79LpT"),l=t("i50K3");function a(e){if(!e)return null;switch(e.type){case"CIMPointSymbol":{const t=e.symbolLayers;return t&&1===t.length?a(t[0]):null}case"CIMVectorMarker":{var t;const o=e.markerGraphics;if(!o||1!==o.length)return null;const r=o[0];if(!r)return null;const i=r.geometry;if(!i)return null;const n=r.symbol;return!n||"CIMPolygonSymbol"!==n.type&&"CIMLineSymbol"!==n.type||(null===(t=n.symbolLayers)||void 0===t?void 0:t.some((e=>!!e.effects)))?null:{geom:i,asFill:"CIMPolygonSymbol"===n.type}}case"sdf":return{geom:e.geom,asFill:e.asFill}}return null}function s(e){let t=1/0,o=-1/0,r=1/0,i=-1/0;for(const n of e)for(const e of n)e[0]<t&&(t=e[0]),e[0]>o&&(o=e[0]),e[1]<r&&(r=e[1]),e[1]>i&&(i=e[1]);return[t,r,o,i]}function c(e){return e?e.rings?s(e.rings):e.paths?s(e.paths):(0,n.isExtent)(e)?[e.xmin,e.ymin,e.xmax,e.ymax]:null:null}function f(e,t,o,r,i){const[n,l,a,s]=e;if(a<n||s<l)return[0,0,0];const c=a-n,f=s-l,u=Math.floor(31.5),m=(128-2*(u+1))/Math.max(c,f),p=Math.round(c*m)+2*u,y=Math.round(f*m)+2*u;let h=1;t&&(h=y/m/(t.ymax-t.ymin));let g=0,d=0;if(r)if(i){if(t&&o&&t.ymax-t.ymin>0){const e=(t.xmax-t.xmin)/(t.ymax-t.ymin);g=r.x/(o*e),d=r.y/o}}else g=r.x,d=r.y;return g=.5*(t.xmax+t.xmin)+g*(t.xmax-t.xmin),d=.5*(t.ymax+t.ymin)+d*(t.ymax-t.ymin),g-=n,d-=l,g*=m,d*=m,g+=u,d+=u,[h,g/p-.5,-(d/y-.5)]}function u(e){const t=function(e){return e?e.rings?e.rings:e.paths?e.paths:void 0!==e.xmin&&void 0!==e.ymin&&void 0!==e.xmax&&void 0!==e.ymax?[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]:null:null}(e.geom),o=function(e){let t=1/0,o=-1/0,r=1/0,i=-1/0;for(const n of e)for(const e of n)e[0]<t&&(t=e[0]),e[0]>o&&(o=e[0]),e[1]<r&&(r=e[1]),e[1]>i&&(i=e[1]);return new(0,l.default)(t,r,o-t,i-r)}(t),r=Math.floor(31.5),i=(128-2*(r+1))/Math.max(o.width,o.height),n=Math.round(o.width*i)+2*r,a=Math.round(o.height*i)+2*r,s=[];for(const n of t)if(n&&n.length>1){const t=[];for(const l of n){let[n,a]=l;n-=o.x,a-=o.y,n*=i,a*=i,n+=r-.5,a+=r-.5,e.asFill?t.push([n,a]):t.push([Math.round(n),Math.round(a)])}if(e.asFill){const e=t.length-1;t[0][0]===t[e][0]&&t[0][1]===t[e][1]||t.push(t[0])}s.push(t)}const c=function(e,t,o,r){const i=t*o,n=new Array(i),l=r*r+1;for(let e=0;e<i;++e)n[e]=l;for(const i of e){const e=i.length;for(let l=1;l<e;++l){const e=i[l-1],a=i[l];let s,c,f,u;e[0]<a[0]?(s=e[0],c=a[0]):(s=a[0],c=e[0]),e[1]<a[1]?(f=e[1],u=a[1]):(f=a[1],u=e[1]);let m=Math.floor(s)-r,p=Math.floor(c)+r,y=Math.floor(f)-r,h=Math.floor(u)+r;m<0&&(m=0),p>t&&(p=t),y<0&&(y=0),h>o&&(h=o);const g=a[0]-e[0],d=a[1]-e[1],S=g*g+d*d;for(let r=m;r<p;r++)for(let i=y;i<h;i++){let l,s,c=(r-e[0])*g+(i-e[1])*d;c<0?(l=e[0],s=e[1]):c>S?(l=a[0],s=a[1]):(c/=S,l=e[0]+c*g,s=e[1]+c*d);const f=(r-l)*(r-l)+(i-s)*(i-s),u=(o-i-1)*t+r;f<n[u]&&(n[u]=f)}}}for(let e=0;e<i;++e)n[e]=Math.sqrt(n[e]);return n}(s,n,a,r);return e.asFill&&function(e,t,o,r,i){for(const n of e){const e=n.length;for(let l=1;l<e;++l){const e=n[l-1],a=n[l];let s,c,f,u;e[0]<a[0]?(s=e[0],c=a[0]):(s=a[0],c=e[0]),e[1]<a[1]?(f=e[1],u=a[1]):(f=a[1],u=e[1]);let m=Math.floor(s),p=Math.floor(c)+1,y=Math.floor(f),h=Math.floor(u)+1;m<r&&(m=r),p>t-r&&(p=t-r),y<r&&(y=r),h>o-r&&(h=o-r);for(let n=y;n<h;++n){if(e[1]>n==a[1]>n)continue;const l=(o-n-1)*t;for(let t=m;t<p;++t)t<(a[0]-e[0])*(n-e[1])/(a[1]-e[1])+e[0]&&(i[l+t]=-i[l+t]);for(let e=r;e<m;++e)i[l+e]=-i[l+e]}}}}(s,n,a,r,c),[m(c,r),n,a]}function m(e,t){const o=2*t,r=e.length,n=new Uint8Array(4*r);for(let t=0;t<r;++t){const r=.5-e[t]/o;(0,i.packFloatRGBA)(r,n,4*t)}return n}})),t.register("kNgwU",(function(o,r){e(o.exports,"default",(function(){return a}));var i=t("kyj08"),n=t("jHOLN"),l=t("ibKgR");function a(e,t,o,r,a){const c=e.referencesGeometry()&&a?function(e,t,o){const{transform:r,hasZ:a,hasM:c}=o;s.has(t)||s.set(t,function(e){const t={};switch(e){case"esriGeometryPoint":return(e,o,r,i)=>(0,l.unquantizePoint)(o,t,e,r,i);case"esriGeometryPolygon":return(e,o,r,i)=>(0,l.unquantizePolygon)(o,t,e,r,i);case"esriGeometryPolyline":return(e,o,r,i)=>(0,l.unquantizePolyline)(o,t,e,r,i);case"esriGeometryMultipoint":return(e,o,r,i)=>(0,l.unquantizeMultipoint)(o,t,e,r,i);default:return n.default.getLogger("esri.views.2d.support.arcadeOnDemand").error(new(0,i.default)("mapview-arcade",`Unable to handle geometryType: ${e}`)),e=>e}}(t));const f=s.get(t)(e.geometry,r,a,c);return{...e,geometry:f}}(t,r,a):t,f=e.repurposeFeature(c);try{return e.evaluate({...o,$feature:f})}catch(e){return n.default.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",e),null}}const s=new Map})),t.register("kyAlm",(function(t,o){e(t.exports,"getFontFamily",(function(){return r})),e(t.exports,"getFullyQualifiedFontName",(function(){return i}));function r(e){const t=e.toLowerCase().split(" ").join("-");switch(t){case"serif":return"noto-serif";case"sans-serif":return"arial-unicode-ms";case"monospace":return"ubuntu-mono";case"fantasy":return"cabin-sketch";case"cursive":return"redressed";default:return t}}function i(e){const t=function(e){if(!e.weight)return"";switch(e.weight.toLowerCase()){case"bold":case"bolder":return"-bold"}return""}(e)+function(e){if(!e.style)return"";switch(e.style.toLowerCase()){case"italic":case"oblique":return"-italic"}return""}(e);return r(e.family)+(t.length>0?t:"-regular")}})),t.register("7J5Re",(function(o,r){e(o.exports,"getRandomValue",(function(){return n})),e(o.exports,"getMaterialGroup",(function(){return l}));var i=t("1TSdR");function n(e,t){let o;if("string"==typeof e)o=(0,i.numericHash)(e+`-seed(${t})`);else{let r=12;o=e^t;do{o=107*(o>>8^o)+r|0}while(0!=--r)}return(1+o/-2147483648)/2}function l(e){return Math.floor(n(e,a)*s)}const a=53290320,s=10}))}();
//# sourceMappingURL=SymbolProcessor.0dbccdba.js.map
