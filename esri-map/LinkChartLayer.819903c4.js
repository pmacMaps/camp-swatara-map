!function(){function e(e,t,n,r){Object.defineProperty(e,t,{get:n,set:r,enumerable:!0,configurable:!0})}var t=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire594f;t.register("kwgac",(function(n,r){var i;i=n.exports,Object.defineProperty(i,"__esModule",{value:!0,configurable:!0}),e(n.exports,"default",(function(){return N}));var o=t("7eJjO");t("2ILM8");var a=t("d2yMj"),s=t("kyj08"),l=t("jHOLN"),u=t("10vEZ"),p=t("iho5X");t("iJAIC"),t("lNwWH"),t("2VlWd");var d=t("fcwIv"),c=t("bUB3w"),h=t("4LDxK"),y=t("akQYU"),f=t("awxBI"),m=t("2LhMc"),g=t("jUvZS"),_=t("gIXJ2"),v=t("3GzOb"),I=t("2H1WN"),x=t("kRWdR"),b=t("agz0E"),w=t("9GUDt"),E=t("gINRd"),T=t("d1Fqh"),M=t("95Tg0");let C=class extends((0,_.BlendLayer)((0,v.ScaleRangeLayer)(h.default))){normalizeCtorArgs(e){return{url:e.url,title:e.title,dataPreloadedInLocalCache:e.dataPreloadedInLocalCache,defaultLinkChartConfig:e.defaultLinkChartConfig}}_initializeLayerProperties(e){var t,n,r,i,o,a;if(!this.title&&this.url){const e=this.url.split("/");this.title=e[e.length-2]}const u=new Set;let p=[],d=[];if(e.inclusionModeDefinition&&(!e.inclusionModeDefinition.namedTypeDefinitions||e.inclusionModeDefinition.namedTypeDefinitions.size<1))throw new(0,s.default)("knowledge-graph:composite-layer-constructor","If an explicit inclusion definition is defined, at least one namedTypeDefinition must also be defined");var c,h,y,f;null===(t=e.knowledgeGraph.dataModel.entityTypes)||void 0===t||t.forEach((e=>{e.name&&this._graphTypeLookup.set(e.name,e)})),null===(n=e.knowledgeGraph.dataModel.relationshipTypes)||void 0===n||n.forEach((e=>{e.name&&this._graphTypeLookup.set(e.name,e)})),(null===(r=e.inclusionModeDefinition)||void 0===r?void 0:r.generateAllSublayers)?(p=null!==(c=e.knowledgeGraph.dataModel.entityTypes)&&void 0!==c?c:[],d=null!==(h=e.knowledgeGraph.dataModel.relationshipTypes)&&void 0!==h?h:[]):(null===(i=e.inclusionModeDefinition)||void 0===i?void 0:i.namedTypeDefinitions)&&(null===(o=e.inclusionModeDefinition)||void 0===o?void 0:o.namedTypeDefinitions.size)>0?null===(a=e.inclusionModeDefinition)||void 0===a||a.namedTypeDefinitions.forEach(((t,n)=>{var r,i;if(!this._graphTypeLookup.get(n))return l.default.getLogger(this).warn(`A named type, ${n}, was in the inclusion list that wasn't in the data model and will be removed`),void(null===(r=e.inclusionModeDefinition)||void 0===r||r.namedTypeDefinitions.delete(n));this._graphTypeLookup.get(n)instanceof w.default||"strictOrigin"in this._graphTypeLookup.get(n)?u.has(n)||(u.add(n),d.push(this._graphTypeLookup.get(n))):this._graphTypeLookup.get(n)instanceof b.default||"properties"in this._graphTypeLookup.get(n)?u.has(n)||(u.add(n),p.push(this._graphTypeLookup.get(n))):(l.default.getLogger(this).warn(`A named type, ${n}, was in the inclusion list that wasn't properly modeled and will be removed`),null===(i=e.inclusionModeDefinition)||void 0===i||i.namedTypeDefinitions.delete(n))})):(p=null!==(y=e.knowledgeGraph.dataModel.entityTypes)&&void 0!==y?y:[],d=null!==(f=e.knowledgeGraph.dataModel.relationshipTypes)&&void 0!==f?f:[]);const g=new(0,m.KnowledgeGraphLayerDataManager)({knowledgeGraph:e.knowledgeGraph,inclusionModeDefinition:e.inclusionModeDefinition});this.knowledgeGraph=e.knowledgeGraph,this.memberEntityTypes=p,this.memberRelationshipTypes=d,this.dataManager=g}load(e){return this.addResolvingPromise(new Promise((t=>{(0,x.fetchKnowledgeGraph)(this.url).then((n=>{var r,i,o,a,s;if(this._initializeLayerProperties({knowledgeGraph:n,inclusionModeDefinition:this._originalInclusionList}),(null===(r=this.dataManager.inclusionModeDefinition)||void 0===r||null===(i=r.namedTypeDefinitions)||void 0===i?void 0:i.size)||(this.dataManager.inclusionModeDefinition={generateAllSublayers:!1,namedTypeDefinitions:new Map},null===(o=this.dataManager.knowledgeGraph.dataModel.entityTypes)||void 0===o||o.forEach((e=>{var t;e.name&&(null===(t=this.dataManager.inclusionModeDefinition)||void 0===t||t.namedTypeDefinitions.set(e.name,{useAllData:!0}))})),null===(a=this.dataManager.knowledgeGraph.dataModel.relationshipTypes)||void 0===a||a.forEach((e=>{var t;e.name&&(null===(t=this.dataManager.inclusionModeDefinition)||void 0===t||t.namedTypeDefinitions.set(e.name,{useAllData:!0}))}))),this.dataPreloadedInLocalCache)this.loadLayerAssumingLocalCache(),this.dataManager.inclusionModeDefinition&&(this.dataManager.inclusionModeDefinition.generateAllSublayers=!1),null===(s=this.dataManager.inclusionModeDefinition)||void 0===s||s.namedTypeDefinitions.forEach((e=>{var t;e.useAllData=!1,null===(t=e.members)||void 0===t||t.forEach((e=>{let t;t=e.linkChartLocation instanceof f.default?e.linkChartLocation:e.linkChartLocation?(0,y.convertFromGeometry)(e.linkChartLocation):null,this.linkChartDiagramLookup.set(e.id,t),t&&2===t.coords.length&&0===t.lengths.length?this.linkChartGeohashLookup.set(e.id,(0,c.encodeGeohash)(t.coords[1],t.coords[0],m.GEOHASH_ENCODING_PRECISION)):this.linkChartGeohashLookup.set(e.id,"")})),this.addResolvingPromise(this._initializeDiagram().then((async()=>{this.layers.forEach((async e=>{await e.refreshCachedQueryEngine()})),this.tables.forEach((async e=>{await e.refreshCachedQueryEngine()}))})))}));else{var l;const t="GEOGRAPHIC"===(null===(l=this.defaultLinkChartConfig)||void 0===l?void 0:l.layoutMode);this.addResolvingPromise(this.dataManager.refreshCacheContent(void 0,!1,t,!0).then((async()=>{(0,u.throwIfAborted)(e);const t=[],n=[];this.loadLayerAssumingLocalCache(),this.dataManager.inclusionModeDefinition&&(this.dataManager.inclusionModeDefinition.generateAllSublayers=!1,this.dataManager.inclusionModeDefinition.namedTypeDefinitions.forEach((e=>{e.useAllData=!1}))),await this._initializeDiagram(),this.layers.forEach((e=>{n.push(e.refreshCachedQueryEngine()),t.push(new Promise((t=>{e.on("layerview-create",(()=>{t(null)}))})))})),this.tables.forEach((e=>{n.push(e.refreshCachedQueryEngine())})),await Promise.all(n)})))}t(null)}))}))),Promise.resolve(this)}async addRecords(e){await this._handleNewRecords(e)}async expand(e){const t=await this.dataManager.getConnectedRecordIds(e),n=t.filter((e=>{var t;return!(null===(t=this.sublayerIdsCache.get(e.typeName))||void 0===t?void 0:t.has(e.id))}));return await this._handleNewRecords(t),{records:n}}loadLayerAssumingLocalCache(){var e,t;this.memberRelationshipTypes.forEach((e=>{const t=new(0,g.default)({objectType:e,parentCompositeLayer:this,graphType:"relationship",title:e.name});t.geometryType?this.layers.push(t):this.tables.push(t),this.dataManager.sublayerCaches.has(e.name)||this.dataManager.sublayerCaches.set(e.name,new Map)})),this.memberEntityTypes.forEach((e=>{const t=new(0,g.default)({objectType:e,parentCompositeLayer:this,graphType:"entity",title:e.name});t.geometryType?this.layers.push(t):this.tables.push(t),this.dataManager.sublayerCaches.has(e.name)||this.dataManager.sublayerCaches.set(e.name,new Map)})),(null===(e=this.dataManager.inclusionModeDefinition)||void 0===e?void 0:e.namedTypeDefinitions)&&(null===(t=this.dataManager.inclusionModeDefinition)||void 0===t||t.namedTypeDefinitions.forEach(((e,t)=>{var n;const r=((e,t,n)=>(e.has(t)||e.set(t,n()),e.get(t)))(this.sublayerIdsCache,t,(()=>new Set));null===(n=e.members)||void 0===n||n.forEach((e=>{if(r.add(e.id),e.linkChartLocation)if(e.linkChartLocation instanceof f.default)this.linkChartDiagramLookup.set(e.id,e.linkChartLocation),2===e.linkChartLocation.coords.length&&0===e.linkChartLocation.lengths.length?this.linkChartGeohashLookup.set(e.id,(0,c.encodeGeohash)(e.linkChartLocation.coords[1],e.linkChartLocation.coords[0],m.GEOHASH_ENCODING_PRECISION)):this.linkChartGeohashLookup.set(e.id,"");else{const t=(0,y.convertFromGeometry)(e.linkChartLocation);this.linkChartDiagramLookup.set(e.id,e.linkChartLocation?t:null),"x"in e.linkChartLocation&&"y"in e.linkChartLocation?this.linkChartGeohashLookup.set(e.id,(0,c.encodeGeohash)(e.linkChartLocation.x,e.linkChartLocation.y,m.GEOHASH_ENCODING_PRECISION)):this.linkChartGeohashLookup.set(e.id,"")}}))})))}async calculateLinkChartLayout(e="RADIAL_TREE",t){const n=[],r=[];var i,o;this.dataManager.sublayerCaches.forEach(((e,t)=>{this.dataManager.entityTypeNames.has(t)?e.forEach((e=>{n.push({typeName:t,feature:e})})):this.dataManager.relationshipTypeNames.has(t)&&e.forEach((e=>{r.push({typeName:t,feature:e})}))})),this.linkChartDiagramLookup=new Map;const a=new Map,u=new Map,p=new Map,d=new Map,h=new Uint8Array(n.length),f=new Float64Array(n.length),g=new Float64Array(n.length),_=new Uint32Array(r.length),v=new Uint32Array(r.length),x=[],b=null!==(i=null==t?void 0:t.xScaleFactor)&&void 0!==i?i:1,w=null!==(o=null==t?void 0:t.yScaleFactor)&&void 0!==o?o:1,C=new(0,E.default)({xmin:-1e-7,ymin:-1e-7,xmax:1e-7,ymax:1e-7});let N,L="FORCE_DIRECTED",S=0,O=0;switch(L="GEOGRAPHIC"===e?"FORCE_DIRECTED":e,L){case"FORCE_DIRECTED":N=I.LCForceDirectedLayout.apply;break;case"COMMUNITY":N=I.LCCommunityLayout.apply;break;case"HIERARCHICAL":N=I.LCHierarchicalLayout.apply;break;case"RADIAL_TREE":N=I.LCRadialTreeLayout.apply;break;case"SMART_TREE":N=I.LCSmartTreeLayout.apply;break;default:N=I.LCSimpleLayout.apply}n.forEach((({typeName:n,feature:r})=>{var i;if(null==t||null===(i=t.lockedNodeLocations)||void 0===i?void 0:i.has(r.attributes[m.MOCK_OID_FIELD_NAME])){"GEOGRAPHIC"===e&&this.dataManager.geographicLookup.has(n)?h[S]=I.NodeFlag.IsGeographic:h[S]=I.NodeFlag.None;const i=t.lockedNodeLocations.get(r.attributes[m.MOCK_OID_FIELD_NAME]);f[S]=i.x,g[S]=i.y}else if("GEOGRAPHIC"===e&&this.dataManager.geographicLookup.has(n)){var o;h[S]=I.NodeFlag.IsGeographic;let e=null;const t=r.attributes[this.dataManager.geographicLookup.get(n).name];switch(null===(o=this.dataManager.geographicLookup.get(n))||void 0===o?void 0:o.geometryType){case"esriGeometryPoint":f[S]=null==t?void 0:t.x,g[S]=null==t?void 0:t.y;break;case"esriGeometryPolygon":e=null==t?void 0:t.centroid,null!=(null==e?void 0:e.x)&&null!=(null==e?void 0:e.y)?(f[S]=e.x,g[S]=e.y):h[S]=I.NodeFlag.IsMovable;break;case"esriGeometryPolyline":case"esriGeometryMultipoint":var a;e=null==t||null===(a=t.extent)||void 0===a?void 0:a.center,null!=(null==e?void 0:e.x)&&null!=(null==e?void 0:e.y)?(f[S]=e.x,g[S]=e.y):h[S]=I.NodeFlag.IsMovable;break;default:h[S]=I.NodeFlag.IsMovable}(null==f[S]||null==g[S]||Number.isNaN(f[S])||Number.isNaN(g[S]))&&(h[S]=I.NodeFlag.IsMovable,f[S]=0,g[S]=0)}else h[S]=I.NodeFlag.IsMovable,f[S]=0,g[S]=0;d.set(r.attributes[m.MOCK_OID_FIELD_NAME],S),x[S]={feature:r,typeName:n},S++}));let G=!1;if(r.forEach((e=>{const t=d.get(e.feature.attributes[m.MOCK_ORIGIN_ID_FIELD_NAME]),n=d.get(e.feature.attributes[m.MOCK_DESTINATION_ID_FIELD_NAME]);void 0!==t&&void 0!==n?(_[O]=t,v[O]=n,O++):(G=!0,this.linkChartDiagramLookup.set(e.feature.attributes[m.MOCK_ORIGIN_ID_FIELD_NAME],null),this.linkChartGeohashLookup.set(e.feature.attributes[m.MOCK_ORIGIN_ID_FIELD_NAME],null))})),G&&l.default.getLogger(this).warn("A relationship is a member of this layer that has either origin or destination entity nodes that are not members. The diagram geometry will be set to null"),await(0,I.load)(),!N(h,f,g,_,v))throw new(0,s.default)("knowledge-graph:layout-failed","Attempting to arrange the records in the specified layout failed");for(let e=0;e<x.length;e++){if(h[e]===I.NodeFlag.IsMovable&&(f[e]=f[e]*b,g[e]=g[e]*w),g[e]>84.9999&&(g[e]=84.9999),g[e]<-84.9999&&(g[e]=-84.9999),f[e]>179.9999&&(f[e]=179.9999),f[e]<-179.9999&&(f[e]=-179.9999),x[e].feature.attributes[m.MOCK_LAYOUT_GEOMETRY_FIELD_NAME]=new(0,T.default)(f[e],g[e]),a.has(x[e].typeName)){const t=a.get(x[e].typeName);null==t||t.set(x[e].feature.attributes[m.MOCK_OID_FIELD_NAME],x[e].feature)}else{const t=new Map;t.set(x[e].feature.attributes[m.MOCK_OID_FIELD_NAME],x[e].feature),a.set(x[e].typeName,t)}p.set(x[e].feature.attributes[m.MOCK_OID_FIELD_NAME],x[e].feature);const t=(0,y.convertFromGeometry)(x[e].feature.attributes[m.MOCK_LAYOUT_GEOMETRY_FIELD_NAME]);this.linkChartDiagramLookup.set(x[e].feature.attributes[m.MOCK_OID_FIELD_NAME],x[e].feature.attributes[m.MOCK_LAYOUT_GEOMETRY_FIELD_NAME]?t:null),this.linkChartGeohashLookup.set(x[e].feature.attributes[m.MOCK_OID_FIELD_NAME],(0,c.encodeGeohash)(x[e].feature.attributes[m.MOCK_LAYOUT_GEOMETRY_FIELD_NAME].y,x[e].feature.attributes[m.MOCK_LAYOUT_GEOMETRY_FIELD_NAME].x,m.GEOHASH_ENCODING_PRECISION)),x[e].feature.attributes[m.MOCK_LAYOUT_GEOMETRY_FIELD_NAME].x<C.xmin&&(C.xmin=x[e].feature.attributes[m.MOCK_LAYOUT_GEOMETRY_FIELD_NAME].x),x[e].feature.attributes[m.MOCK_LAYOUT_GEOMETRY_FIELD_NAME].x>C.xmax&&(C.xmax=x[e].feature.attributes[m.MOCK_LAYOUT_GEOMETRY_FIELD_NAME].x),x[e].feature.attributes[m.MOCK_LAYOUT_GEOMETRY_FIELD_NAME].y<C.ymin&&(C.ymin=x[e].feature.attributes[m.MOCK_LAYOUT_GEOMETRY_FIELD_NAME].y),x[e].feature.attributes[m.MOCK_LAYOUT_GEOMETRY_FIELD_NAME].y>C.ymax&&(C.ymax=x[e].feature.attributes[m.MOCK_LAYOUT_GEOMETRY_FIELD_NAME].y)}return this.linkChartExtent.xmin=C.xmin,this.linkChartExtent.xmax=C.xmax,this.linkChartExtent.ymin=C.ymin,this.linkChartExtent.ymax=C.ymax,r.forEach((e=>{var t,n;const r=null===(t=x[d.get(e.feature.attributes[m.MOCK_ORIGIN_ID_FIELD_NAME])])||void 0===t?void 0:t.feature.attributes[m.MOCK_LAYOUT_GEOMETRY_FIELD_NAME],i=null===(n=x[d.get(e.feature.attributes[m.MOCK_DESTINATION_ID_FIELD_NAME])])||void 0===n?void 0:n.feature.attributes[m.MOCK_LAYOUT_GEOMETRY_FIELD_NAME];if(!r||!i)return;const o=new(0,M.default)({paths:[[r.x,r.y],[i.x,i.y]]});if(e.feature.attributes[m.MOCK_LAYOUT_GEOMETRY_FIELD_NAME]=o,u.has(e.typeName)){const t=u.get(e.typeName);null==t||t.set(e.feature.attributes[m.MOCK_OID_FIELD_NAME],e.feature)}else{const t=new Map;t.set(e.feature.attributes[m.MOCK_OID_FIELD_NAME],e.feature),u.set(e.typeName,t)}p.set(e.feature.attributes[m.MOCK_OID_FIELD_NAME],e.feature);const a=(0,y.convertFromGeometry)(e.feature.attributes[m.MOCK_LAYOUT_GEOMETRY_FIELD_NAME]);this.linkChartDiagramLookup.set(e.feature.attributes[m.MOCK_OID_FIELD_NAME],e.feature.attributes[m.MOCK_LAYOUT_GEOMETRY_FIELD_NAME]?a:null),this.linkChartGeohashLookup.set(e.feature.attributes[m.MOCK_OID_FIELD_NAME],"")})),this._currentLinkChartConfig={layoutMode:e,xScaleFactor:b,yScaleFactor:w},{nodes:a,links:u,idMap:p}}async applyNewLinkChartLayout(e="RADIAL_TREE",t){const n=[];await this.calculateLinkChartLayout(e,t),this.layers.forEach((e=>{n.push(e.refreshCachedQueryEngine())})),await Promise.all(n),this.layers.forEach((e=>{e.emit("refresh",{dataChanged:!0})}))}getCurrentNodeLocations(){var e,t;const n=new Map;return null===(e=this.dataManager.inclusionModeDefinition)||void 0===e||null===(t=e.namedTypeDefinitions)||void 0===t||t.forEach((e=>{var t;null==e||null===(t=e.members)||void 0===t||t.forEach((e=>{const t=e.linkChartLocation;let r;const i=e.id;t&&(r="x"in t?{x:t.x,y:t.y}:{x:t.coords[0],y:t.coords[1]},n.set(i,new(0,T.default)({x:r.x,y:r.y})))}))})),n}async synchronizeInclusionListWithCache(){return new Promise((e=>{var t;null===(t=this.dataManager.inclusionModeDefinition)||void 0===t||t.namedTypeDefinitions.forEach(((e,t)=>{if(e.useAllData=!1,e.members&&e.members.size>0){if(!this.dataManager.sublayerCaches.get(t))return;const n=Array.from(this.dataManager.sublayerCaches.get(t).keys());Array.from(e.members.keys()).filter((e=>!n.includes(e))).forEach((t=>{var n;null===(n=e.members)||void 0===n||n.delete(t)}))}})),e()}))}async refreshLinkChartCache(e){await this.dataManager.refreshCacheContent(e);const t=[];this.layers.forEach((e=>{t.push(e.refreshCachedQueryEngine())})),await Promise.all(t),this.layers.forEach((e=>{e.emit("refresh",{dataChanged:!0})}))}async _handleNewRecords(e){const t=[];this.dataManager.addToLayerInclusionSet(e);for(const n of e)this.sublayerIdsCache.has(n.typeName)||(this.sublayerIdsCache.set(n.typeName,new Set),t.push(n.typeName)),this.sublayerIdsCache.get(n.typeName).add(n.id);for(const e of t)if(this._graphTypeLookup.has(e)){const t=this._graphTypeLookup.get(e),n="endPoints"in t?"relationship":"entity",r=new(0,g.default)({objectType:t,parentCompositeLayer:this,graphType:n,title:e});"entity"===n?this.dataManager.entityTypeNames.add(e):this.dataManager.relationshipTypeNames.add(e),r.geometryType?this.layers.push(r):this.tables.push(r),this.dataManager.sublayerCaches.set(e,new Map)}await this.dataManager.refreshCacheContent(e.map((e=>e.id))),await this.applyNewLinkChartLayout(this._currentLinkChartConfig.layoutMode,{xScaleFactor:this._currentLinkChartConfig.xScaleFactor,yScaleFactor:this._currentLinkChartConfig.xScaleFactor})}async _initializeDiagram(){var e,t;this.defaultLinkChartConfig?this.defaultLinkChartConfig.doNotRecalculateLayout?(null===(e=this.dataManager.inclusionModeDefinition)||void 0===e||null===(t=e.namedTypeDefinitions)||void 0===t||t.forEach((e=>{var t;null==e||null===(t=e.members)||void 0===t||t.forEach((e=>{const t=e.linkChartLocation;let n;const r=e.id;if(!t)return;n="x"in t?{x:t.x,y:t.y}:{x:t.coords[0],y:t.coords[1]};const i=(0,y.convertFromGeometry)(n);this.linkChartDiagramLookup.set(r,i),this.linkChartGeohashLookup.set(r,(0,c.encodeGeohash)(n.x,n.y,m.GEOHASH_ENCODING_PRECISION)),this.linkChartExtent.xmin>n.x&&(this.linkChartExtent.xmin=n.x),this.linkChartExtent.xmax<n.x&&(this.linkChartExtent.xmax=n.x),this.linkChartExtent.ymin>n.y&&(this.linkChartExtent.ymin=n.y),this.linkChartExtent.ymax<n.y&&(this.linkChartExtent.ymax=n.y)}))})),this.memberRelationshipTypes.forEach((e=>{var t;e.name&&(null===(t=this.dataManager.sublayerCaches.get(e.name))||void 0===t||t.forEach((e=>{const t=this.linkChartDiagramLookup.get(e.attributes[m.MOCK_ORIGIN_ID_FIELD_NAME]),n=this.linkChartDiagramLookup.get(e.attributes[m.MOCK_DESTINATION_ID_FIELD_NAME]);if(t&&n){const r=(0,y.convertFromGeometry)(new(0,M.default)({paths:[[t.coords[0],t.coords[1]],[n.coords[0],n.coords[1]]]}));this.linkChartDiagramLookup.set(e.attributes[m.MOCK_OID_FIELD_NAME],r)}else this.linkChartDiagramLookup.set(e.attributes[m.MOCK_OID_FIELD_NAME],null);this.linkChartGeohashLookup.set(e.attributes[m.MOCK_OID_FIELD_NAME],"")})))}))):await this.calculateLinkChartLayout(this.defaultLinkChartConfig.layoutMode,{xScaleFactor:this.defaultLinkChartConfig.xScaleFactor,yScaleFactor:this.defaultLinkChartConfig.yScaleFactor,lockedNodeLocations:this.getCurrentNodeLocations()}):await this.calculateLinkChartLayout("RADIAL_TREE",{lockedNodeLocations:this.getCurrentNodeLocations()})}constructor(e){if(super(e),this.dataPreloadedInLocalCache=!1,this._currentLinkChartConfig={layoutMode:"RADIAL_TREE",xScaleFactor:1,yScaleFactor:1},this._graphTypeLookup=new Map,this.layers=new(0,a.default),this.linkChartDiagramLookup=new Map,this.linkChartExtent=new(0,E.default)({xmin:-1e-7,ymin:-1e-7,xmax:1e-7,ymax:1e-7}),this.linkChartGeohashLookup=new Map,this.sublayerIdsCache=new Map,this.tables=new(0,a.default),this.type="link-chart",this._originalInclusionList=e.inclusionModeDefinition,e.dataPreloadedInLocalCache&&!e.inclusionModeDefinition)throw new(0,s.default)("knowledge-graph:linkchart-layer-constructor","If creating a link chart composite layer and configured that data is already loaded in the cache, you must specify an inclusion list so the Composite Layer knows what records belong to it")}};(0,o._)([(0,p.property)()],C.prototype,"dataPreloadedInLocalCache",void 0),(0,o._)([(0,p.property)()],C.prototype,"defaultLinkChartConfig",void 0),(0,o._)([(0,p.property)()],C.prototype,"dataManager",void 0),(0,o._)([(0,p.property)()],C.prototype,"knowledgeGraph",void 0),(0,o._)([(0,p.property)()],C.prototype,"layers",void 0),(0,o._)([(0,p.property)()],C.prototype,"linkChartDiagramLookup",void 0),(0,o._)([(0,p.property)()],C.prototype,"linkChartExtent",void 0),(0,o._)([(0,p.property)()],C.prototype,"linkChartGeohashLookup",void 0),(0,o._)([(0,p.property)()],C.prototype,"memberEntityTypes",void 0),(0,o._)([(0,p.property)()],C.prototype,"memberRelationshipTypes",void 0),(0,o._)([(0,p.property)()],C.prototype,"sublayerIdsCache",void 0),(0,o._)([(0,p.property)()],C.prototype,"tables",void 0),(0,o._)([(0,p.property)({json:{read:!1}})],C.prototype,"type",void 0),C=(0,o._)([(0,d.subclass)("esri.layers.LinkChartLayer")],C);const N=C})),t.register("bUB3w",(function(t,n){e(t.exports,"decodeGeohashXY",(function(){return p})),e(t.exports,"setGeohashXY",(function(){return d})),e(t.exports,"setGeohashBuf",(function(){return c})),e(t.exports,"encodeGeohash",(function(){return h}));const r=new Float64Array(2),i=new Float64Array(2);function o(e){return"0123456789bcdefghjkmnpqrstuvwxyz"[e]}function a(e){return(e[0]+e[1])/2}function s(e,t,n){return e[0]=t,e[1]=n,e}function l(e,t){const n=a(e),r=t,i=!t;e[0]=i*e[0]+r*n,e[1]=i*n+r*e[1]}function u(e,t){const n=t>a(e);return l(e,n),n}function p(e,t){let n=-90,r=90,i=-180,o=180;for(let a=0;a<t;a++){const t=Math.ceil((a+1)/2),s=Math.floor((a+1)/2),l=1-a%2,u=30-(3*t+2*s),p=30-(2*t+3*s),d=3*l+2*(1-l),c=2*l+3*(1-l),h=3*l+7*(1-l)<<p,y=(7*l+3*(1-l)<<u&e.geohashX)>>u,f=(h&e.geohashY)>>p;for(let e=d-1;e>=0;e--){const t=(i+o)/2,n=y&1<<e?1:0;i=(1-n)*i+n*t,o=(1-n)*t+n*o}for(let e=c-1;e>=0;e--){const t=(n+r)/2,i=f&1<<e?1:0;n=(1-i)*n+i*t,r=(1-i)*t+i*r}}return[i,n,o,r]}function d(e,t,n,r){r%2&&(r+=1);let i=0,o=0,a=-90,s=90,l=-180,u=180;for(let e=0;e<r/2;e++){for(let t=0;t<5;t++){const r=(l+u)/2,o=n>r?1:0;i|=o<<29-(t+5*e),l=(1-o)*l+o*r,u=(1-o)*r+o*u}for(let n=0;n<5;n++){const r=(a+s)/2,i=t>r?1:0;o|=i<<29-(n+5*e),a=(1-i)*a+i*r,s=(1-i)*r+i*s}}e.geohashX=i,e.geohashY=o}function c(e,t,n,r,i){i%2&&(i+=1);let o=0,a=0,s=-90,l=90,u=-180,p=180;for(let e=0;e<i/2;e++){for(let t=0;t<5;t++){const n=(u+p)/2,i=r>n?1:0;o|=i<<29-(t+5*e),u=(1-i)*u+i*n,p=(1-i)*n+i*p}for(let t=0;t<5;t++){const r=(s+l)/2,i=n>r?1:0;a|=i<<29-(t+5*e),s=(1-i)*s+i*r,l=(1-i)*r+i*l}}e[2*t]=o,e[2*t+1]=a}function h(e,t,n){let a="";const l=s(r,-90,90),p=s(i,-180,180);for(let r=0;r<n;r++){let n=0;r%2?(n|=u(l,e)<<4,n|=u(p,t)<<3,n|=u(l,e)<<2,n|=u(p,t)<<1,n|=u(l,e)<<0):(n|=u(p,t)<<4,n|=u(l,e)<<3,n|=u(p,t)<<2,n|=u(l,e)<<1,n|=u(p,t)<<0),a+=o(n)}return a}})),t.register("2LhMc",(function(n,r){e(n.exports,"MOCK_OID_FIELD_NAME",(function(){return v})),e(n.exports,"MOCK_ORIGIN_ID_FIELD_NAME",(function(){return I})),e(n.exports,"MOCK_DESTINATION_ID_FIELD_NAME",(function(){return x})),e(n.exports,"MOCK_LAYOUT_GEOMETRY_FIELD_NAME",(function(){return b})),e(n.exports,"GEOHASH_ENCODING_PRECISION",(function(){return w})),e(n.exports,"KnowledgeGraphLayerDataManager",(function(){return T}));var i=t("7eJjO"),o=t("jymfC"),a=t("kyj08"),s=t("jHOLN"),l=t("37plS"),u=t("iho5X");t("iJAIC"),t("lNwWH"),t("2VlWd");var p=t("fcwIv"),d=t("bUB3w"),c=t("fTq43"),h=t("7RvA5"),y=t("eY5Yp"),f=t("30UUK"),m=t("kRWdR"),g=t("3wwuz"),_=t("cRlei");const v="ESRI__ID",I="ESRI__ORIGIN_ID",x="ESRI__DESTINATION_ID",b="ESRI__LAYOUT_GEOMETRY",w=12,E=s.default.getLogger("esri.rest.knowledgeGraph.knowledgeGraphLayer.KnowledgeGraphLayerDataManager");let T=class extends o.default{addToLayerInclusionSet(e){e.forEach((({typeName:e,id:t})=>{if(!this.inclusionModeDefinition)throw new(0,a.default)("knowledge-graph:layer-data-manager","You cannot add to a layer's exclusion list if it was not created with an exclusion list originally");if(this.inclusionModeDefinition.namedTypeDefinitions.has(e)){if(this.inclusionModeDefinition.namedTypeDefinitions.has(e)){const n=this.inclusionModeDefinition.namedTypeDefinitions.get(e);if(n.useAllData)throw new(0,a.default)("knowledge-graph:layer-data-manager","You cannot add members to an exclusion list for a sublayer where the sublayer is set to always retrieve its entire data set");n.members||(n.members=new Map),n.members.set(t,{id:t}),this._memberIdTypeLookup.set(t,e)}}else{const n=new Map;n.set(t,{id:t}),this.inclusionModeDefinition.namedTypeDefinitions.set(e,{useAllData:!1,members:n}),this._memberIdTypeLookup.set(t,e)}}))}getById(e){return f.default.getInstance().readFromStoreById(e)}async getData(e,t,n){var r;if(t.objectType.name&&(null===(r=this.inclusionModeDefinition)||void 0===r?void 0:r.namedTypeDefinitions)&&this.inclusionModeDefinition.namedTypeDefinitions.size>0&&!this.inclusionModeDefinition.namedTypeDefinitions.has(t.objectType.name))return[];let i;if(i=e||new(0,_.default)({where:"1=1",outFields:["*"]}),"link-chart"===t.parentCompositeLayer.type){var o,a;const e=t.parentCompositeLayer,n=this._processingCacheUpdatesLookup.get(null!==(a=t.objectType.name)&&void 0!==a?a:""),r=i.outFields,l=i.geometry;let u="",p="";var s;l&&l.extent&&(u=(0,d.encodeGeohash)(l.extent.ymin,l.extent.xmin,w),p=(0,d.encodeGeohash)(l.extent.ymax,l.extent.xmax,w)),r&&1===r.length&&r[0]===v&&"1=1"===i.where||await Promise.all(null!=n?n:[]);const c=this.sublayerCaches.has(null!==(s=t.objectType.name)&&void 0!==s?s:"")?Array.from(null===(o=this.sublayerCaches.get(t.objectType.name))||void 0===o?void 0:o.values()):[],h=[];return c.forEach((n=>{if(n.geometry=e.linkChartDiagramLookup.get(n.attributes[t.objectIdField]),n.attributes[b]=n.geometry,u&&p){const r=e.linkChartGeohashLookup.get(n.attributes[t.objectIdField]);r?r>=u&&r<=p&&h.push(n):h.push(n)}else h.push(n)})),h}return this.retrieveDataFromService(i,t,n)}async getConnectedRecordIds(e){const t=[],n=[],r=new Map;return e.forEach((e=>{if(this._memberIdTypeLookup.has(e)){var t;const n=this._memberIdTypeLookup.get(e);if(!this.entityTypeNames.has(n))return;r.has(n)?null===(t=r.get(n))||void 0===t||t.push(e):r.set(n,[e])}})),r.forEach(((e,r)=>{const i=`MATCH (n:${r})-[r]-(m) WHERE id(n) IN $ids RETURN id(r), type(r), id(m), labels(m)[0]`,o=new Promise((n=>{(async()=>{const n=(await(0,m.executeQueryStreaming)(this.knowledgeGraph,new(0,g.default)({openCypherQuery:i,bindParameters:{ids:e}}))).resultRowsStream.getReader();try{for(;;){const{done:e,value:r}=await n.read();if(e)break;for(let e=0;e<r.length;e++){const n=r[e];t.push({id:n[0],typeName:n[1]}),t.push({id:n[2],typeName:n[3]})}}}catch(e){if("AbortError"!==e.name)throw e;E.info("Request aborted as expected")}})().then((()=>{n()}))}));n.push(o)})),await Promise.all(n),t}async refreshCacheContent(e,t,n,r=!0){var i,o,s,l,u,p;const d=f.default.getInstance(),c=[],h=new Map,y=new Map;null===(i=this.knowledgeGraph.dataModel.entityTypes)||void 0===i||i.forEach((e=>{e.name&&y.set(e.name,e)})),null===(o=this.knowledgeGraph.dataModel.relationshipTypes)||void 0===o||o.forEach((e=>{e.name&&y.set(e.name,e)})),e||this.inclusionModeDefinition?e?e.forEach((e=>{if(this._memberIdTypeLookup.has(e)){var t;const n=this._memberIdTypeLookup.get(e);h.has(n)?null===(t=h.get(n))||void 0===t||t.push(e):h.set(n,[e])}})):null===(s=this.inclusionModeDefinition)||void 0===s||null===(l=s.namedTypeDefinitions)||void 0===l||l.forEach(((e,t)=>{e.useAllData?h.set(t,null):e.members&&e.members.forEach((e=>{var n;h.has(t)&&null!==h.get(t)?null===(n=h.get(t))||void 0===n||n.push(e.id):h.set(t,[e.id])}))})):(null===(u=this.knowledgeGraph.dataModel.entityTypes)||void 0===u||u.forEach((e=>{e.name&&h.set(e.name,null)})),null===(p=this.knowledgeGraph.dataModel.entityTypes)||void 0===p||p.forEach((e=>{e.name&&h.set(e.name,null)})));for(const[e,i]of h){var _;const o=new Promise((o=>{(async()=>{var o,s;const l=new Set,u=[];let p,c="",h=!1;if(t||(null===(o=y.get(e))||void 0===o||null===(s=o.properties)||void 0===s||s.forEach((e=>{e.name&&l.add(e.name)}))),n&&this.geographicLookup.has(e)){var f;const t=null===(f=this.geographicLookup.get(e))||void 0===f?void 0:f.name;t&&l.add(t)}if(this.entityTypeNames.has(e))c=`MATCH (n:${e}) ${i?"WHERE id(n) IN $ids ":""}return ID(n)`,l.forEach((e=>{c+=`, n.${e}`,u.push(e)}));else{if(!this.relationshipTypeNames.has(e))throw new(0,a.default)("knowledge-graph:layer-data-manager",`The graph type of ${e} could not be determined. Was this type set in the KG data model and inclusion definition?`);h=!0,c=`MATCH ()-[n:${e}]->() ${i?"WHERE id(n) IN $ids ":""}return ID(n), id(startNode(n)), id(endNode(n))`,l.forEach((e=>{c+=`, n.${e}`,u.push(e)}))}p=new(0,g.default)(i?{openCypherQuery:c,bindParameters:{ids:i}}:{openCypherQuery:c});const _=(await(0,m.executeQueryStreaming)(this.knowledgeGraph,p)).resultRowsStream.getReader();for(;;){var I,x,b,w;const{done:t,value:n}=await _.read();if(t)break;const i=[];for(let e=0;e<n.length;e++){const t=n[e];let r=0,o=0;const a={properties:{}};for(a.id=t[r],r++,o++,h&&(a.originId=t[r],r++,o++,a.destinationId=t[r],r++,o++);r<t.length;r++)a.properties[u[r-o]]=t[r];i.push(a)}const o=d.writeToStore(i,v,null===(I=this.geographicLookup.get(e))||void 0===I?void 0:I.name);this.sublayerCaches.has(e)||this.sublayerCaches.set(e,new Map),r&&!(null===(x=this.inclusionModeDefinition)||void 0===x?void 0:x.namedTypeDefinitions.has(e))&&(null===(b=this.inclusionModeDefinition)||void 0===b||b.namedTypeDefinitions.set(e,{useAllData:!1,members:new Map})),r&&!(null===(w=this.inclusionModeDefinition)||void 0===w?void 0:w.namedTypeDefinitions.get(e).members)&&(this.inclusionModeDefinition.namedTypeDefinitions.get(e).members=new Map);const a=this.sublayerCaches.get(e);o.forEach((t=>{var n,i;null==a||a.set(t.attributes[v],t),r&&!(null===(n=this.inclusionModeDefinition)||void 0===n?void 0:n.namedTypeDefinitions.get(e).members.has(t.attributes[v]))&&(null===(i=this.inclusionModeDefinition)||void 0===i||i.namedTypeDefinitions.get(e).members.set(t.attributes[v],{id:t.attributes[v]}),this._memberIdTypeLookup.set(t.attributes[v],e))}))}})().then((()=>{o(null)}))}));c.push(o),null===(_=this._processingCacheUpdatesLookup.get(e))||void 0===_||_.push(o)}await Promise.all(c)}removeFromLayer(e){const t=new Set;e.forEach((e=>{var n;this._memberIdTypeLookup.get(e)&&t.add(this._memberIdTypeLookup.get(e)),this._memberIdTypeLookup.delete(e),null===(n=this.inclusionModeDefinition)||void 0===n||n.namedTypeDefinitions.forEach((t=>{var n;(null===(n=t.members)||void 0===n?void 0:n.has(e))&&t.members.delete(e)}))})),t.forEach((t=>{var n;null===(n=this.sublayerCaches.get(t))||void 0===n||n.forEach(((n,r)=>{var i;e.includes(r)&&(null===(i=this.sublayerCaches.get(t))||void 0===i||i.delete(r))}))}))}async retrieveDataFromService(e,t,n){var r,i,o,a,s,u,p,d,_;const I=f.default.getInstance(),x=new Set,b=[];let w,E="",T=[];const M="relationship"===t.graphType,C=null===(o=null===(r=this.inclusionModeDefinition)||void 0===r||null===(i=r.namedTypeDefinitions)||void 0===i?void 0:i.get(t.objectType.name))||void 0===o?void 0:o.useAllData,N=t.parentCompositeLayer.sublayerIdsCache.get(t.objectType.name);let L=!C&&N?Array.from(N).sort():null;if(null===(u=null===(a=this.inclusionModeDefinition)||void 0===a||null===(s=a.namedTypeDefinitions)||void 0===s?void 0:s.get(t.objectType.name))||void 0===u?void 0:u.useAllData)(null===(_=null===(p=this.inclusionModeDefinition)||void 0===p||null===(d=p.namedTypeDefinitions)||void 0===d?void 0:d.get(t.objectType.name))||void 0===_?void 0:_.useAllData)&&null!=e.objectIds&&(L=e.objectIds);else if(null!=e.objectIds&&L&&L.length>0){const t=e.objectIds;e.objectIds=L.filter((e=>t.includes(e)))}else if(null!=e.objectIds)L=e.objectIds;else{var S,O,G,D;if((null===(S=this.inclusionModeDefinition)||void 0===S?void 0:S.namedTypeDefinitions.has(t.objectType.name))&&(!(null===(O=this.inclusionModeDefinition.namedTypeDefinitions.get(t.objectType.name))||void 0===O?void 0:O.members)||(null===(G=this.inclusionModeDefinition.namedTypeDefinitions.get(t.objectType.name))||void 0===G||null===(D=G.members)||void 0===D?void 0:D.size)<1))return e.objectIds=[],[];e.objectIds=L}if(null!=e.outFields){const n=e.outFields;n.includes("*")?t.fields.forEach((e=>{x.add(e.name)})):n.forEach((e=>{e!==v&&e!==t.geometryFieldName&&x.add(e)}))}if(null!=e.geometry){var R,k;const n=e.geometry;let r;if((null==n||null===(R=n.extent)||void 0===R?void 0:R.spatialReference)&&!(null===(k=n.spatialReference)||void 0===k?void 0:k.isWGS84)?(await(0,h.initializeProjection)(n.extent.spatialReference,y.WGS84),r=(0,h.project)(n.extent,y.WGS84)):r=n.extent,null!=e.where&&"1=1"!==e.where){const n=await(0,l.parseWhereClause)(e.where.toUpperCase(),t.fieldsIndex);t.fields.forEach((e=>{n.fieldNames.includes(e.name)&&x.add(e.name)}))}E=M?`Match ()-[n:${t.objectType.name}]->() WHERE esri.graph.ST_Intersects($param_filter_geom, n.${t.geometryFieldName}) return ID(n), id(startNode(r)), id(endNode(r))`:`Match (n:${t.objectType.name}) WHERE esri.graph.ST_Intersects($param_filter_geom, n.${t.geometryFieldName}) return ID(n)`,t.geometryFieldName&&x.add(t.geometryFieldName),x.forEach((e=>{E+=`, n.${e}`,b.push(e)})),w=new(0,g.default)({openCypherQuery:E,bindParameters:{param_filter_geom:new(0,c.default)({rings:[[[r.xmin,r.ymin],[r.xmin,r.ymax],[r.xmax,r.ymax],[r.xmax,r.ymin],[r.xmin,r.ymin]]]})}})}else{let n="";if(null!=e.where&&"1=1"!==e.where){const r=await(0,l.parseWhereClause)(e.where,t.fieldsIndex);t.fields.forEach((e=>{r.fieldNames.includes(e.name)&&x.add(e.name)}));const i=["column-reference","string","number","binary-expression"],o=["=","<","<=","<>",">",">=","AND","OR","LIKE"];let a=!1;const s=e=>{if("column-reference"===e.type)return`n.${e.column}`;if("string"===e.type)return`'${e.value}'`;if("number"===e.type)return`${e.value}`;if("binary-expression"===e.type&&i.includes(e.left.type)&&i.includes(e.right.type)&&o.includes(e.operator))return`${s(e.left)} ${e.operator} ${s(e.right)}`;if("binary-expression"===e.type&&"LIKE"===e.operator){let t="";if("function"===e.left.type&&"column-reference"===e.left.args.value[0].type)t+=`lower(n.${e.left.args.value[0].column})`;else{if("column-reference"!==e.left.type)return a=!0,"";t+=`lower(n.${e.left.column})`}if(t+=" CONTAINS (","string"!==e.right.type)return a=!0,"";{let n=e.right.value;"%"===n.charAt(0)&&(n=n.slice(1)),"%"===n.charAt(n.length-1)&&(n=n.slice(0,-1)),t+=`'${n.toLowerCase()}')`}return t}return a=!0,""};n=s(r.parseTree),a&&(n="")}let r="";r=M?`Match ()-[n:${t.objectType.name}]->()`:`Match (n:${t.objectType.name})`;let i=!1;L&&(i=!0,r+=" WHERE ID(n) IN $ids"),n&&(r+=i?" AND":" WHERE",r+=` ${n}`),r+=" return ID(n)",M&&(r+=", id(startNode(n)), id(endNode(n))"),e.returnGeometry&&t.geometryFieldName&&x.add(t.geometryFieldName),x.forEach((e=>{r+=`, n.${e}`,b.push(e)})),w=new(0,g.default)(L?{openCypherQuery:r,bindParameters:{ids:L}}:{openCypherQuery:r})}const F=(await(0,m.executeQueryStreaming)(t.parentCompositeLayer.dataManager.knowledgeGraph,w,n)).resultRowsStream.getReader();for(;;){var A;const{done:e,value:n}=await F.read();if(e)break;const r=[];for(let e=0;e<n.length;e++){const t=n[e];let i=0,o=0;const a={properties:{}};for(a.id=t[i],i++,o++,M&&(a.originId=t[i],i++,o++,a.destinationId=t[i],i++,o++);i<t.length;i++)a.properties[b[i-o]]=t[i];r.push(a)}T=T.concat(I.writeToStore(r,v,null===(A=t.parentCompositeLayer.dataManager.geographicLookup.get(t.objectType.name))||void 0===A?void 0:A.name))}return T}constructor(e){var t,n,r;super(e),this.inclusionModeDefinition={generateAllSublayers:!0,namedTypeDefinitions:new Map},this.entityTypeNames=new Set,this.relationshipTypeNames=new Set,this.geographicLookup=new Map,this.sublayerCaches=new Map,this._processingCacheUpdatesLookup=new Map,this._memberIdTypeLookup=new Map;const i=new Map;null===(t=e.knowledgeGraph.dataModel.entityTypes)||void 0===t||t.forEach((t=>{var n,r;t.name&&(i.set(t.name,"entity"),this._processingCacheUpdatesLookup.set(t.name,[]),e.inclusionModeDefinition&&!(null===(n=e.inclusionModeDefinition)||void 0===n?void 0:n.generateAllSublayers)||this.entityTypeNames.add(t.name),null===(r=t.properties)||void 0===r||r.forEach((e=>{var n;e.geometryType&&"esriGeometryNull"!==e.geometryType&&this.geographicLookup.set(t.name,{name:null!==(n=e.name)&&void 0!==n?n:"",geometryType:e.geometryType})})))})),null===(n=e.knowledgeGraph.dataModel.relationshipTypes)||void 0===n||n.forEach((t=>{var n,r;t.name&&(i.set(t.name,"relationship"),this._processingCacheUpdatesLookup.set(t.name,[]),e.inclusionModeDefinition&&!(null===(n=e.inclusionModeDefinition)||void 0===n?void 0:n.generateAllSublayers)||this.relationshipTypeNames.add(t.name),null===(r=t.properties)||void 0===r||r.forEach((e=>{var n;e.geometryType&&"esriGeometryNull"!==e.geometryType&&this.geographicLookup.set(t.name,{name:null!==(n=e.name)&&void 0!==n?n:"",geometryType:e.geometryType})})))})),null===(r=e.inclusionModeDefinition)||void 0===r||r.namedTypeDefinitions.forEach(((t,n)=>{var r;if("entity"===i.get(n))this.entityTypeNames.add(n);else{var o;if("relationship"!==i.get(n))return E.warn(`A named type, ${n}, was in the inclusion list that wasn't in the data model and will be removed`),void(null===(o=e.inclusionModeDefinition)||void 0===o||o.namedTypeDefinitions.delete(n));this.relationshipTypeNames.add(n)}const a=new Map;null===(r=t.members)||void 0===r||r.forEach((e=>{this._memberIdTypeLookup.set(e.id,n);const t=this.getById(e.id);t&&a.set(e.id,t)})),this.sublayerCaches.set(n,a)}))}};(0,i._)([(0,u.property)()],T.prototype,"knowledgeGraph",void 0),(0,i._)([(0,u.property)()],T.prototype,"inclusionModeDefinition",void 0),(0,i._)([(0,u.property)()],T.prototype,"entityTypeNames",void 0),(0,i._)([(0,u.property)()],T.prototype,"relationshipTypeNames",void 0),(0,i._)([(0,u.property)()],T.prototype,"geographicLookup",void 0),(0,i._)([(0,u.property)()],T.prototype,"sublayerCaches",void 0),T=(0,i._)([(0,p.subclass)("esri.rest.knowledgeGraph.knowledgeGraphLayer.KnowledgeGraphLayerDataManager")],T)})),t.register("30UUK",(function(n,r){e(n.exports,"default",(function(){return a}));var i=t("akQYU"),o=t("ft2bT");class a{static getInstance(){return a.instance||(a.instance=new a),a.instance}static resetInstance(){a.instance&&(a.instance=null)}deleteFromStore(e){e.forEach((e=>{this._featureLookup.delete(e)}))}readFromStoreByList(e){const t=[];return e.forEach((e=>{const n=this.readFromStoreById(e);n&&t.push(n)})),t}readFromStoreById(e){var t;return null!==(t=this._featureLookup.get(e))&&void 0!==t?t:null}writeToStore(e,t,n){const r=[];return e.forEach((e=>{if(!e||!e.id)return;e.properties||(e.properties=[]);let a,s=null;if(n&&(s=e.properties[n]?(0,i.convertFromGeometry)(e.properties[n]):null),"originId"in e&&"destinationId"in e&&(e.properties.ESRI__ORIGIN_ID=e.originId,e.properties.ESRI__DESTINATION_ID=e.destinationId),e.properties[t]=e.id,e.id&&this._featureLookup.has(e.id)&&this._featureLookup.get(e.id).attributes){const n=this._featureLookup.get(e.id);a=new(0,o.OptimizedFeature)(s?JSON.parse(JSON.stringify(s)):(null==n?void 0:n.geometry)?JSON.parse(JSON.stringify(n.geometry)):null,JSON.parse(JSON.stringify(Object.assign(n.attributes,e.properties))),null,e.properties[t])}else a=new(0,o.OptimizedFeature)(s?JSON.parse(JSON.stringify(s)):null,e.properties,null,e.properties[t]);this._featureLookup.set(e.id,a),r.push(a)})),r}constructor(){this._featureLookup=new Map}}})),t.register("kRWdR",(function(n,r){e(n.exports,"executeQueryStreaming",(function(){return x})),e(n.exports,"fetchKnowledgeGraph",(function(){return b})),t("2ILM8");var i=t("dLARP"),o=t("9pNSx"),a=t("kyj08"),s=t("jHOLN"),l=(t("e5EIu"),t("cLkhz")),u=t("iaSQb"),p=t("koDKQ"),d=t("HiSol"),c=t("42VyF"),h=(t("2UpjE"),t("RxWHX")),y=t("f1ogG"),f=(t("7jgXl"),t("Pe3X5"));const m=async e=>{const t=new(0,u.default)({url:e}),n=[];return n.push(w(t)),n.push(async function(e){return _(e)}(t)),await Promise.all(n),t},g=async e=>{e.dataModel=await S(e)},_=async e=>{var t,n;const r=(await(0,o.default)(e.url,{query:{f:"json"}})).data;return r.capabilities=null==r||null===(t=r.capabilities)||void 0===t?void 0:t.split(","),r.supportedQueryFormats=null==r||null===(n=r.supportedQueryFormats)||void 0===n?void 0:n.split(","),e.serviceDefinition=new(0,p.default)(r),e.serviceDefinition},v=async(e,t,n)=>{const r=`${e.url}/graph/query`;await T(e);const i=await C(r,n);i.data.body=await async function(e,t){const n=await(0,d.getWasmInterface)(),r=new n.GraphQueryRequestEncoder;if(r.deleteLater(),r.output_spatial_reference=n.SpatialReferenceUtil.WGS84(),r.open_cypher_query=e.openCypherQuery,e.bindParameters)for(const[t,i]of Object.entries(e.bindParameters))M(t,i,r,n);if(e.bindGeometryQuantizationParameters)(0,c.setInputQuantizationParametersOnEncoder)(e.bindGeometryQuantizationParameters,r);else{var i,o;if(t.dataModel||await w(t),4326!==(null===(i=t.dataModel)||void 0===i||null===(o=i.spatialReference)||void 0===o?void 0:o.wkid))throw new(0,a.default)("knowledge-graph:SR-quantization-mismatch","If the DataModel indicates a coordinate system other than WGS84, inputQuantizationParameters must be provided to the query encoder");r.input_quantization_parameters=n.InputQuantizationUtil.WGS84_lossless()}e.outputQuantizationParameters&&(0,c.setOutputQuantizationParametersOnEncoder)(e.outputQuantizationParameters,r,n);try{r.encode()}catch(e){throw new(0,a.default)("knowledge-graph:query-encoding-failed","Attempting to encode the query failed",{error:e})}const s=r.get_encoding_result();if(0!==s.error.error_code)throw new(0,a.default)("knowledge-graph:query-encoding-failed","Attempting to encode the query failed",{errorCode:s.error.error_code,errorMessage:s.error.error_message});return s.get_byte_buffer()}(t,e);const o=await E(i.data.url,i.data);if(e.dataModel)return new(0,l.default)({resultRowsStream:await L(o,e.dataModel)});throw new(0,a.default)("knowledge-graph:undefined-data-model","The KnowledgeGraph supplied did not have a data model")},I=async(e,t)=>fetch(e,t);async function x(e,t,n){return v(e,t,n)}async function b(e){return m(e)}async function w(e){return g(e)}async function E(e,t){return I(e,t)}async function T(e){(null===i.id||void 0===i.id?void 0:i.id.findCredential(e.url))||(e.dataModel?await S(e):await w(e))}function M(e,t,n,r){null==t?n.set_param_key_value(e,""):"object"!=typeof t||t instanceof Date?n.set_param_key_value(e,t):t instanceof f.default?n.set_param_key_value(e,(0,c.geometryToWasm)(t,r)):t instanceof Array?n.set_param_key_value(e,(0,c.bindParamArrayToWasm)(t,r)):n.set_param_key_value(e,(0,c.bindParamObjectToWasm)(t,r))}async function C(e,t){return(0,o.default)(e,{responseType:"native-request-init",method:"post",query:{f:"pbf",...null==t?void 0:t.query},body:"x",headers:{"Content-Type":"application/octet-stream"},signal:null==t?void 0:t.signal,timeout:null==t?void 0:t.timeout})}function N(e,t,n){e.push_buffer(new Uint8Array(t));const r=[];let i=0;for(;e.next_row();){i||(i=e.get_header_keys().size());const t=new Array(i);for(let r=0;r<i;r++){const i=e.get_value(r);t[r]=(0,y.decodedWasmObjToQueryResponseObj)(i,n)}r.push(t)}if(e.has_error())throw new(0,a.default)("knowledge-graph:stream-decoding-error","One or more result rows were not successfully decoded",{errorCode:e.error.error_code,errorMessage:e.error.error_message});return r}async function L(e,t){const n=e.headers.get("content-type");if(e.headers.get("content-length")&&s.default.getLogger("esri.rest.knowledgeGraph.knowledgeGraphService").warnOnce("Found `Content-Length` header when expecting a streaming HTTP response! Please investigate whether all intermediate HTTP proxies and/or load balancers are configured such that they don't forcefully buffer the entire response before returning it to the client. A valid HTTP streaming response should use Chunked Transfer Encoding and not have a Content Length defined."),null==n?void 0:n.includes("application/x-protobuf")){var r;const n=null===(r=e.body)||void 0===r?void 0:r.getReader(),i=new((await(0,d.getWasmInterface)()).GraphQueryDecoder);return i.deleteLater(),new ReadableStream({async start(e){try{return function r(){return null==n?void 0:n.read().then((({done:o,value:s})=>{if(o){let t;if(i.has_error()&&(t=new(0,a.default)("knowledge-graph:stream-decoding-error","One or more result rows were not successfully decoded",{errorCode:i.error.error_code,errorMessage:i.error.error_message})),n.releaseLock(),t)throw e.error(t),t;return void e.close()}const l=N(i,s,t);return l.length>0&&e.enqueue(l),r()}))}()}catch(t){null==n||n.releaseLock(),e.error(new(0,a.default)("knowledge-graph:stream-decoding-error","The server returned a valid response, but there was an error decoding the response stream",{error:t})),e.close()}}})}throw new(0,a.default)("knowledge-graph:unexpected-server-response","server returned an unexpected response",{responseType:n,data:e.text()})}async function S(e){var t;const n=`${e.url}/dataModel/queryDataModel`,r=await(0,o.default)(n,{responseType:"array-buffer",query:{f:"pbf"}}),i=null===(t=r.getHeader)||void 0===t?void 0:t.call(r,"content-type"),s=r.data;if(null==i?void 0:i.includes("application/x-protobuf")){const e=(await(0,d.getWasmInterface)()).decode_data_model_from_protocol_buffer(new Uint8Array(s));if(!e)throw new(0,a.default)("knowledge-graph:data-model-decode-failure","The server responded to the data model query, but the response failed to be decoded.  This typically occurs when the Knowledge JS API (4.26 or later) is used with an unsupported backend (11.0 or earlier)");return(0,h.wasmToDataModel)(e)}throw new(0,a.default)("knowledge-graph:unexpected-server-response","server returned an unexpected response",{responseType:i,data:r.data})}})),t.register("e5EIu",(function(n,r){e(n.exports,"default",(function(){return u}));var i=t("7eJjO"),o=t("jymfC"),a=t("iho5X");t("iJAIC"),t("lNwWH"),t("2VlWd");var s=t("fcwIv");let l=class extends o.default{constructor(e){super(e),this.resultRows=[]}};(0,i._)([(0,a.property)()],l.prototype,"resultRows",void 0),l=(0,i._)([(0,s.subclass)("esri.rest.knowledgeGraph.GraphQueryResult")],l);const u=l})),t.register("cLkhz",(function(n,r){e(n.exports,"default",(function(){return u}));var i=t("7eJjO"),o=t("jymfC"),a=t("iho5X");t("iJAIC"),t("lNwWH"),t("2VlWd");var s=t("fcwIv");let l=class extends o.default{constructor(e){super(e),this.resultRowsStream=new ReadableStream}};(0,i._)([(0,a.property)()],l.prototype,"resultRowsStream",void 0),l=(0,i._)([(0,s.subclass)("esri.rest.knowledgeGraph.GraphQueryResult")],l);const u=l})),t.register("iaSQb",(function(n,r){e(n.exports,"default",(function(){return d}));var i=t("7eJjO"),o=t("1XAcN"),a=t("iho5X");t("iJAIC"),t("lNwWH"),t("2VlWd");var s=t("fcwIv"),l=t("2qZyH"),u=t("koDKQ");let p=class extends o.JSONSupport{constructor(e){super(e),this.dataModel=null,this.serviceDefinition=null}};(0,i._)([(0,a.property)({type:String,json:{write:!0}})],p.prototype,"url",void 0),(0,i._)([(0,a.property)({type:l.default,json:{write:!0}})],p.prototype,"dataModel",void 0),(0,i._)([(0,a.property)({type:u.default,json:{write:!0}})],p.prototype,"serviceDefinition",void 0),p=(0,i._)([(0,s.subclass)("esri.rest.knowledgeGraph.KnowledgeGraph")],p);const d=p})),t.register("2qZyH",(function(n,r){e(n.exports,"default",(function(){return c}));var i=t("7eJjO"),o=t("1XAcN"),a=t("iho5X");t("iJAIC"),t("lNwWH"),t("2VlWd");var s=t("fcwIv"),l=t("j40xv"),u=t("agz0E"),p=t("9GUDt");let d=class extends o.JSONSupport{constructor(e){super(e),this.timestamp=null,this.spatialReference=null,this.strict=null,this.objectIdField=null,this.globalIdField=null,this.arcgisManaged=null,this.identifierInfo=null,this.searchIndexes=null,this.entityTypes=null,this.relationshipTypes=null}};(0,i._)([(0,a.property)({type:Date,json:{type:Number,write:{writer:(e,t)=>{t.timestamp=null==e?void 0:e.getTime()}}}})],d.prototype,"timestamp",void 0),(0,i._)([(0,a.property)({type:l.default,json:{write:!0}})],d.prototype,"spatialReference",void 0),(0,i._)([(0,a.property)({type:Boolean,json:{write:!0}})],d.prototype,"strict",void 0),(0,i._)([(0,a.property)({type:String,json:{write:!0}})],d.prototype,"objectIdField",void 0),(0,i._)([(0,a.property)({type:String,json:{write:!0}})],d.prototype,"globalIdField",void 0),(0,i._)([(0,a.property)()],d.prototype,"arcgisManaged",void 0),(0,i._)([(0,a.property)()],d.prototype,"identifierInfo",void 0),(0,i._)([(0,a.property)()],d.prototype,"searchIndexes",void 0),(0,i._)([(0,a.property)({type:[u.default],json:{write:!0}})],d.prototype,"entityTypes",void 0),(0,i._)([(0,a.property)({type:[p.default],json:{write:!0}})],d.prototype,"relationshipTypes",void 0),d=(0,i._)([(0,s.subclass)("esri.rest.knowledgeGraph.DataModel")],d);const c=d})),t.register("agz0E",(function(n,r){e(n.exports,"default",(function(){return l}));var i=t("7eJjO");t("jHOLN"),t("iJAIC"),t("lNwWH"),t("2VlWd"),t("kyj08");var o=t("fcwIv"),a=t("OTjL7");let s=class extends a.default{constructor(e){super(e)}};s=(0,i._)([(0,o.subclass)("esri.rest.knowledgeGraph.EntityType")],s);const l=s})),t.register("OTjL7",(function(n,r){e(n.exports,"default",(function(){return d}));var i=t("7eJjO"),o=t("1XAcN"),a=t("iho5X");t("iJAIC"),t("lNwWH"),t("2VlWd");var s=t("fcwIv"),l=t("blbiD"),u=t("aFWVO");let p=class extends o.JSONSupport{constructor(e){super(e),this.name=null,this.alias=null,this.role=null,this.strict=null,this.properties=null,this.fieldIndexes=null}};(0,i._)([(0,a.property)({type:String,json:{write:!0}})],p.prototype,"name",void 0),(0,i._)([(0,a.property)({type:String,json:{write:!0}})],p.prototype,"alias",void 0),(0,i._)([(0,a.property)({type:String,json:{write:!0}})],p.prototype,"role",void 0),(0,i._)([(0,a.property)({type:Boolean,json:{write:!0}})],p.prototype,"strict",void 0),(0,i._)([(0,a.property)({type:[u.default],json:{write:!0}})],p.prototype,"properties",void 0),(0,i._)([(0,a.property)({type:[l.default],json:{write:!0}})],p.prototype,"fieldIndexes",void 0),p=(0,i._)([(0,s.subclass)("esri.rest.knowledgeGraph.GraphObjectType")],p);const d=p})),t.register("blbiD",(function(n,r){e(n.exports,"default",(function(){return u}));var i=t("7eJjO"),o=t("1XAcN"),a=t("iho5X");t("iJAIC"),t("lNwWH"),t("2VlWd");var s=t("fcwIv");let l=class extends o.JSONSupport{constructor(e){super(e),this.name=null,this.unique=null,this.ascending=null,this.description=null,this.fieldNames=null}};(0,i._)([(0,a.property)({type:String,json:{write:!0}})],l.prototype,"name",void 0),(0,i._)([(0,a.property)({type:Boolean,json:{write:!0}})],l.prototype,"unique",void 0),(0,i._)([(0,a.property)({type:Boolean,json:{write:!0}})],l.prototype,"ascending",void 0),(0,i._)([(0,a.property)({type:String,json:{write:!0}})],l.prototype,"description",void 0),(0,i._)([(0,a.property)({type:[String],json:{write:!0}})],l.prototype,"fieldNames",void 0),l=(0,i._)([(0,s.subclass)("esri.rest.knowledgeGraph.FieldIndex")],l);const u=l})),t.register("aFWVO",(function(n,r){e(n.exports,"default",(function(){return u}));var i=t("7eJjO"),o=t("1XAcN"),a=t("iho5X");t("iJAIC"),t("lNwWH"),t("2VlWd");var s=t("fcwIv");let l=class extends o.JSONSupport{constructor(e){super(e),this.name=null,this.alias=null,this.fieldType=null,this.geometryType=null,this.hasM=null,this.hasZ=null,this.nullable=null,this.editable=null,this.required=null,this.defaultVisibility=null,this.systemMaintained=null,this.role=null,this.defaultValue=null}};(0,i._)([(0,a.property)({type:String,json:{write:!0}})],l.prototype,"name",void 0),(0,i._)([(0,a.property)({type:String,json:{write:!0}})],l.prototype,"alias",void 0),(0,i._)([(0,a.property)({type:String,json:{write:!0}})],l.prototype,"fieldType",void 0),(0,i._)([(0,a.property)({type:String,json:{write:!0}})],l.prototype,"geometryType",void 0),(0,i._)([(0,a.property)({type:Boolean,json:{write:!0}})],l.prototype,"hasM",void 0),(0,i._)([(0,a.property)({type:Boolean,json:{write:!0}})],l.prototype,"hasZ",void 0),(0,i._)([(0,a.property)({type:Boolean,json:{write:!0}})],l.prototype,"nullable",void 0),(0,i._)([(0,a.property)({type:Boolean,json:{write:!0}})],l.prototype,"editable",void 0),(0,i._)([(0,a.property)({type:Boolean,json:{write:!0}})],l.prototype,"required",void 0),(0,i._)([(0,a.property)({type:Boolean,json:{write:!0}})],l.prototype,"defaultVisibility",void 0),(0,i._)([(0,a.property)({type:Boolean,json:{write:!0}})],l.prototype,"systemMaintained",void 0),(0,i._)([(0,a.property)()],l.prototype,"role",void 0),(0,i._)([(0,a.property)({type:Object,json:{type:String,write:{writer:(e,t)=>{t.defaultValue=null!=e?e.toString():null}}}})],l.prototype,"defaultValue",void 0),l=(0,i._)([(0,s.subclass)("esri.rest.knowledgeGraph.GraphProperty")],l);const u=l})),t.register("9GUDt",(function(n,r){e(n.exports,"default",(function(){return u}));var i=t("7eJjO"),o=t("iho5X");t("iJAIC"),t("lNwWH"),t("2VlWd");var a=t("fcwIv"),s=t("OTjL7");let l=class extends s.default{constructor(e){super(e),this.endPoints=[]}};(0,i._)([(0,o.property)()],l.prototype,"endPoints",void 0),l=(0,i._)([(0,a.subclass)("esri.rest.knowledgeGraph.RelationshipType")],l);const u=l})),t.register("koDKQ",(function(n,r){e(n.exports,"default",(function(){return u}));var i=t("7eJjO"),o=t("1XAcN"),a=t("iho5X");t("iJAIC"),t("lNwWH"),t("2VlWd");var s=t("fcwIv");let l=class extends o.JSONSupport{constructor(e){super(e),this.capabilities=[],this.supportsSearch=!1,this.supportedQueryFormats=[],this.allowGeometryUpdates=!1,this.searchMaxRecordCount=null,this.serviceCapabilities=null,this.maxRecordCount=null,this.description="",this.copyrightText="",this.units="",this.spatialReference=null,this.currentVersion=null,this.dateFieldsTimeReference=null,this.serviceItemId="",this.supportsDocuments=!1,this.dataEditingNotSupported=!1,this.schemaEditingNotSupported=!1}};(0,i._)([(0,a.property)({type:[String],json:{write:!0}})],l.prototype,"capabilities",void 0),(0,i._)([(0,a.property)({type:Boolean,json:{write:!0}})],l.prototype,"supportsSearch",void 0),(0,i._)([(0,a.property)({type:[String],json:{write:!0}})],l.prototype,"supportedQueryFormats",void 0),(0,i._)([(0,a.property)({type:Boolean,json:{write:!0}})],l.prototype,"allowGeometryUpdates",void 0),(0,i._)([(0,a.property)({type:Number,json:{write:!0}})],l.prototype,"searchMaxRecordCount",void 0),(0,i._)([(0,a.property)({type:Object,json:{write:!0}})],l.prototype,"serviceCapabilities",void 0),(0,i._)([(0,a.property)({type:Number,json:{write:!0}})],l.prototype,"maxRecordCount",void 0),(0,i._)([(0,a.property)({type:String,json:{write:!0}})],l.prototype,"description",void 0),(0,i._)([(0,a.property)({type:String,json:{write:!0}})],l.prototype,"copyrightText",void 0),(0,i._)([(0,a.property)({type:String,json:{write:!0}})],l.prototype,"units",void 0),(0,i._)([(0,a.property)({type:Object,json:{write:!0}})],l.prototype,"spatialReference",void 0),(0,i._)([(0,a.property)({type:Number,json:{write:!0}})],l.prototype,"currentVersion",void 0),(0,i._)([(0,a.property)({type:Object,json:{write:!0}})],l.prototype,"dateFieldsTimeReference",void 0),(0,i._)([(0,a.property)({type:String,json:{write:!0}})],l.prototype,"serviceItemId",void 0),(0,i._)([(0,a.property)({type:Boolean,json:{write:!0}})],l.prototype,"supportsDocuments",void 0),(0,i._)([(0,a.property)({type:Boolean,json:{write:!0}})],l.prototype,"dataEditingNotSupported",void 0),(0,i._)([(0,a.property)({type:Boolean,json:{write:!0}})],l.prototype,"schemaEditingNotSupported",void 0),l=(0,i._)([(0,s.subclass)("esri.rest.knowledgeGraph.ServiceDefinition")],l);const u=l})),t.register("HiSol",(function(n,r){e(n.exports,"getWasmInterface",(function(){return u}));var i=t("i9j5X"),o=t("2VlWd");const a="esri/rest/knowledgeGraph/wasmInterface/";let s,l=null;async function u(){const e=null!=l?l:s;if(e)return e;const n=(0,o.default)("wasm-simd");return s=async function(e){if(e){const{default:e}=await t("c2nnk").then((e=>e.a));return e({locateFile:e=>(0,i.getAssetUrl)(a+e)})}const{default:n}=await t("aX9XM").then((e=>e.a));return n({locateFile:e=>(0,i.getAssetUrl)(a+e)})}(n),s}})),t.register("c2nnk",(function(e,n){e.exports=t("4WKyX")(t("aNJCr").getBundleURL("ayCdK")+t("iE7OH").resolve("iQC3G")).then((()=>t("isg6B")))})),t.register("aX9XM",(function(e,n){e.exports=t("4WKyX")(t("aNJCr").getBundleURL("ayCdK")+t("iE7OH").resolve("gsX1a")).then((()=>t("62j0I")))})),t.register("42VyF",(function(n,r){e(n.exports,"bindParamArrayToWasm",(function(){return p})),e(n.exports,"bindParamObjectToWasm",(function(){return d})),e(n.exports,"geometryToWasm",(function(){return c})),e(n.exports,"setInputQuantizationParametersOnEncoder",(function(){return h})),e(n.exports,"setOutputQuantizationParametersOnEncoder",(function(){return y})),t("2ILM8");var i=t("kyj08"),o=t("eaHvJ"),a=t("d1Fqh"),s=t("fTq43"),l=t("95Tg0"),u=t("Pe3X5");function p(e,t){const n=new t.ArrayValue;return n.deleteLater(),e.forEach((e=>{n.add_value(f(e,t))})),n}function d(e,t){const n=new t.ObjectValue;n.deleteLater();for(const[r,i]of Object.entries(e))n.set_key_value(r,f(i,t));return n}function c(e,t){if(e instanceof o.default)return function(e,t){const n=new t.GeometryValue;n.deleteLater(),n.geometry_type=n.geometry_type=t.esriGeometryType.esriGeometryMultipoint,n.has_z=e.hasZ,n.has_m=e.hasM;const r=[],i=[];i[0]=e.points.length;let o=0;return e.points.forEach((e=>{e.forEach((e=>{r[o]=e,o++}))})),n.coords=new Float64Array(r),n.lengths=new Uint32Array(i),n}(e,t);if(e instanceof a.default)return function(e,t){const n=new t.GeometryValue;n.deleteLater(),n.geometry_type=t.esriGeometryType.esriGeometryPoint,n.has_z=e.hasZ,n.has_m=e.hasM;const r=[],i=[];i[0]=1,r[0]=e.x,r[1]=e.y;let o=2;return e.hasZ&&(r[o]=e.z,o++),e.hasM&&(r[o]=e.m,o++),n.coords=new Float64Array(r),n.lengths=new Uint32Array(i),n}(e,t);if(e instanceof l.default||e instanceof s.default)return function(e,t){const n=new t.GeometryValue;n.deleteLater(),n.has_z=e.hasZ,n.has_m=e.hasM;const r=[],i=[];let o=[];e instanceof l.default?(n.geometry_type=t.esriGeometryType.esriGeometryPolyline,o=e.paths):e instanceof s.default&&(n.geometry_type=t.esriGeometryType.esriGeometryPolygon,o=e.rings);let a=0,u=0;return o.forEach((e=>{let t=0;e.forEach((e=>{t++,e.forEach((e=>{r[u]=e,u++}))})),i[a]=t,a++})),n.coords=new Float64Array(r),n.lengths=new Uint32Array(i),n}(e,t);throw new(0,i.default)("knowledge-graph:unsupported-geometry","Only Point, Multipoint, Polyline, and Polygon geometry are supported by ArcGIS Knowledge",{geometry:e})}function h(e,t){t.input_quantization_parameters={xy_resolution:e.xyResolution,x_false_origin:e.xFalseOrigin,y_false_origin:e.yFalseOrigin,z_resolution:e.zResolution,z_false_origin:e.zFalseOrigin,m_resolution:e.mResolution,m_false_origin:e.mFalseOrigin}}function y(e,t,n){if(!e.extent)throw new(0,i.default)("knowledge-graph:illegal-output-quantization","The Output quantization provided to the encoder had an illegal value as part of its extent",e.extent);if(!e.quantizeMode)throw new(0,i.default)("knowledge-graph:illegal-output-quantization","The Output quantization contained an illegal mode setting",e.quantizeMode);if(!e.tolerance)throw new(0,i.default)("knowledge-graph:illegal-output-quantization","The Output quantization contained an illegal tolerance setting",e.quantizeMode);t.output_quantization_parameters={extent:{xmax:e.extent.xmax,ymax:e.extent.ymax,xmin:e.extent.xmin,ymin:e.extent.ymin},quantize_mode:n.esriQuantizeMode[e.quantizeMode],tolerance:e.tolerance}}function f(e,t){if(null==e)return"";if("object"!=typeof e)return e;if(e instanceof Date)return e;if(e instanceof u.default)return c(e,t);if(Array.isArray(e)){const n=new t.ArrayValue;return n.deleteLater(),e.forEach((e=>{n.add_value(f(e,t))})),n}return d(e,t)}})),t.register("2UpjE",(function(n,r){e(n.exports,"namedObjectToWasm",(function(){return u})),e(n.exports,"inputQuantizationParemetersToWasmFormat",(function(){return p})),t("2ILM8");var i=t("kyj08"),o=t("loKeU"),a=t("5bd09"),s=t("42VyF"),l=t("Pe3X5");function u(e,t){if(!e.typeName)throw new(0,i.default)("knowledge-graph:no-type-name","You must indicate the entity/relationship named object type to apply edits");if(e instanceof o.default){const n=new t.EntityValue;n.deleteLater(),n.type_name=e.typeName;for(const[r,i]of Object.entries(e.properties))n.set_key_value(r,d(i,t));return e.id&&n.set_id(e.id),n}if(e instanceof a.default){const n=new t.RelationshipValue;n.deleteLater(),n.type_name=e.typeName;for(const[r,i]of Object.entries(e.properties))n.set_key_value(r,d(i,t));return e.id&&n.set_id(e.id),e.originId&&e.destinationId&&n.set_related_entity_ids(e.originId,e.destinationId),n}throw new(0,i.default)("knowledge-graph:applyEdits-encoding-failure","Could not determine the type of a named graph object passed to the encoder")}function p(e){return{xy_resolution:e.xyResolution,x_false_origin:e.xFalseOrigin,y_false_origin:e.yFalseOrigin,z_resolution:e.zResolution,z_false_origin:e.zFalseOrigin,m_resolution:e.mResolution,m_false_origin:e.mFalseOrigin}}function d(e,t){return null==e?"":"object"!=typeof e||e instanceof Date?e:e instanceof l.default?(0,s.geometryToWasm)(e,t):""}})),t.register("loKeU",(function(n,r){e(n.exports,"default",(function(){return p}));var i=t("7eJjO");t("2ILM8");var o=t("iho5X");t("iJAIC"),t("lNwWH"),t("2VlWd");var a=t("fcwIv"),s=t("4L325"),l=t("d1Fqh");let u=class extends s.default{constructor(e){super(e),this.layoutGeometry=null}};(0,i._)([(0,o.property)({type:l.default,json:{write:!0}})],u.prototype,"layoutGeometry",void 0),u=(0,i._)([(0,a.subclass)("esri.rest.knowledgeGraph.Entity")],u);const p=u})),t.register("4L325",(function(n,r){e(n.exports,"default",(function(){return u}));var i=t("7eJjO"),o=t("iho5X");t("iJAIC"),t("lNwWH"),t("2VlWd");var a=t("fcwIv"),s=t("YVtRK");let l=class extends s.default{constructor(e){super(e),this.typeName=null,this.id=null}};(0,i._)([(0,o.property)({type:String,json:{write:!0}})],l.prototype,"typeName",void 0),(0,i._)([(0,o.property)({type:String,json:{write:!0}})],l.prototype,"id",void 0),l=(0,i._)([(0,a.subclass)("esri.rest.knowledgeGraph.GraphNamedObject")],l);const u=l})),t.register("YVtRK",(function(n,r){e(n.exports,"default",(function(){return u}));var i=t("7eJjO"),o=t("1XAcN"),a=t("iho5X");t("iJAIC"),t("lNwWH"),t("2VlWd");var s=t("fcwIv");let l=class extends o.JSONSupport{constructor(e){super(e),this.properties=null}};(0,i._)([(0,a.property)({json:{write:!0}})],l.prototype,"properties",void 0),l=(0,i._)([(0,s.subclass)("esri.rest.knowledgeGraph.GraphObject")],l);const u=l})),t.register("5bd09",(function(n,r){e(n.exports,"default",(function(){return p}));var i=t("7eJjO");t("2ILM8");var o=t("iho5X");t("iJAIC"),t("lNwWH"),t("2VlWd");var a=t("fcwIv"),s=t("4L325"),l=t("95Tg0");let u=class extends s.default{constructor(e){super(e),this.originId=null,this.destinationId=null,this.layoutGeometry=null}};(0,i._)([(0,o.property)({type:String,json:{write:!0}})],u.prototype,"originId",void 0),(0,i._)([(0,o.property)({type:String,json:{write:!0}})],u.prototype,"destinationId",void 0),(0,i._)([(0,o.property)({type:l.default,json:{write:!0}})],u.prototype,"layoutGeometry",void 0),u=(0,i._)([(0,a.subclass)("esri.rest.Relationship.Relationship")],u);const p=u})),t.register("RxWHX",(function(n,r){e(n.exports,"wasmToDataModel",(function(){return c}));var i=t("j40xv"),o=t("2qZyH"),a=t("agz0E"),s=t("blbiD"),l=(t("OTjL7"),t("aFWVO")),u=t("9GUDt"),p=t("4YDPB"),d=t("92Xer");function c(e){var t,n,r,a,s,l,u,p,c,h,y;return e.deleteLater(),new(0,o.default)({timestamp:e.timestamp,spatialReference:new(0,i.default)(e.spatial_reference),strict:e.strict,objectIdField:e.objectid_property,globalIdField:e.globalid_property,arcgisManaged:e.arcgis_managed,identifierInfo:{identifierMappingInfo:{identifierInfoType:d.EsriIdentifierInfoType[null===(t=e.identifier_info)||void 0===t||null===(n=t.identifier_mapping_info)||void 0===n||null===(r=n.identifier_info_type)||void 0===r?void 0:r.value],databaseNativeIdentifier:null===(a=e.identifier_info)||void 0===a||null===(s=a.identifier_mapping_info)||void 0===s?void 0:s.database_native_identifier,uniformPropertyIdentifier:{identifierPropertyName:null===(l=e.identifier_info)||void 0===l||null===(u=l.identifier_mapping_info)||void 0===u||null===(p=u.uniform_property_identifier)||void 0===p?void 0:p.identifier_property_name}},identifierGenerationInfo:{uuidMethodHint:d.EsriUuidMethodHintTypes[null===(c=e.identifier_info)||void 0===c||null===(h=c.identifier_generation_info)||void 0===h||null===(y=h.uuid_method_hint)||void 0===y?void 0:y.value]}},searchIndexes:w(e.search_indexes),entityTypes:_(e.entity_types),relationshipTypes:b(e.relationship_types)})}function h(e){return e.deleteLater(),new(0,a.default)(f(e))}function y(e){return e.deleteLater(),new(0,s.default)({name:e.name,unique:e.unique,ascending:e.ascending,description:e.description,fieldNames:v(e.fields)})}function f(e){return{name:e.name,alias:e.alias,role:d.NamedObjectTypes[e.role.value]?d.NamedObjectTypes[e.role.value]:null,strict:e.strict,properties:I(e.properties),fieldIndexes:x(e.field_indexes)}}function m(e){return e.deleteLater(),new(0,l.default)({alias:e.alias,name:e.name,fieldType:d.EsriFieldTypes[e.field_type.value]?d.EsriFieldTypes[e.field_type.value]:null,geometryType:d.EsriGeometryTypes[e.geometry_type.value]?d.EsriGeometryTypes[e.geometry_type.value]:null,hasM:e.has_m,hasZ:e.has_z,nullable:e.nullable,editable:e.editable,required:e.required,defaultVisibility:e.default_visibility,systemMaintained:e.system_maintained,role:d.EsriGraphPropertyRole[e.role.value],defaultValue:e.default_value})}function g(e){e.deleteLater();const t=f(e),n=[];for(let t=0;t<e.end_points.size();t++){const r=e.end_points.get(t);n.push({originEntityType:r.origin_entity_type,destinationEntityType:r.dest_entity_type})}return new(0,u.default)(Object.assign({endPoints:n},t))}function _(e){const t=[];for(let n=0;n<e.size();n++)t.push(h(e.get(n)));return t}function v(e){const t=[];for(let n=0;n<e.size();n++)t.push(e.get(n));return t}function I(e){const t=[];for(let n=0;n<e.size();n++)t.push(m(e.get(n)));return t}function x(e){const t=[];for(let n=0;n<e.size();n++)t.push(y(e.get(n)));return t}function b(e){const t=[];for(let n=0;n<e.size();n++)t.push(g(e.get(n)));return t}function w(e){const t=[];for(let n=0;n<e.size();n++){const n=new(0,p.default),r=e.get(0);n.name=r.name,n.supportedCategory=d.EsriNamedTypeCategory[r.supported_category.value];const i=r.analyzers.size();for(let e=0;e<i;e++)n.analyzers.push({name:r.analyzers.get(e).name});for(let e=0;e<r.search_properties.keys().size();e++){const t=r.search_properties.keys().get(e),i=r.search_properties.get(t),o=[];for(let e=0;e<i.property_names.size();e++)o.push(i.property_names.get(e));n.searchProperties.set(t,{propertyNames:o})}t.push(n)}return t}})),t.register("4YDPB",(function(n,r){e(n.exports,"default",(function(){return u}));var i=t("7eJjO"),o=t("jymfC"),a=t("iho5X");t("iJAIC"),t("lNwWH"),t("2VlWd");var s=t("fcwIv");let l=class extends o.default{constructor(e){super(e),this.name=null,this.supportedCategory=null,this.analyzers=[],this.searchProperties=new Map}};(0,i._)([(0,a.property)()],l.prototype,"name",void 0),(0,i._)([(0,a.property)()],l.prototype,"supportedCategory",void 0),(0,i._)([(0,a.property)()],l.prototype,"analyzers",void 0),(0,i._)([(0,a.property)()],l.prototype,"searchProperties",void 0),l=(0,i._)([(0,s.subclass)("esri.rest.knowledgeGraph.SearchIndex")],l);const u=l})),t.register("92Xer",(function(t,n){var r,i,o,a,s,l,u,p;e(t.exports,"NamedObjectTypes",(function(){return r})),e(t.exports,"EsriFieldTypes",(function(){return i})),e(t.exports,"EsriGeometryTypes",(function(){return o})),e(t.exports,"EsriUuidMethodHintTypes",(function(){return a})),e(t.exports,"EsriNamedTypeCategory",(function(){return s})),e(t.exports,"EsriGraphPropertyRole",(function(){return l})),e(t.exports,"EsriIdentifierInfoType",(function(){return u})),(p=r||(r={}))[p.Regular=0]="Regular",p[p.Provenance=1]="Provenance",p[p.Document=2]="Document",function(e){e[e.esriFieldTypeSmallInteger=0]="esriFieldTypeSmallInteger",e[e.esriFieldTypeInteger=1]="esriFieldTypeInteger",e[e.esriFieldTypeSingle=2]="esriFieldTypeSingle",e[e.esriFieldTypeDouble=3]="esriFieldTypeDouble",e[e.esriFieldTypeString=4]="esriFieldTypeString",e[e.esriFieldTypeDate=5]="esriFieldTypeDate",e[e.esriFieldTypeOID=6]="esriFieldTypeOID",e[e.esriFieldTypeGeometry=7]="esriFieldTypeGeometry",e[e.esriFieldTypeBlob=8]="esriFieldTypeBlob",e[e.esriFieldTypeRaster=9]="esriFieldTypeRaster",e[e.esriFieldTypeGUID=10]="esriFieldTypeGUID",e[e.esriFieldTypeGlobalID=11]="esriFieldTypeGlobalID",e[e.esriFieldTypeXML=12]="esriFieldTypeXML",e[e.esriFieldTypeBigInteger=13]="esriFieldTypeBigInteger"}(i||(i={})),function(e){e[e.esriGeometryNull=0]="esriGeometryNull",e[e.esriGeometryPoint=1]="esriGeometryPoint",e[e.esriGeometryMultipoint=2]="esriGeometryMultipoint",e[e.esriGeometryPolyline=3]="esriGeometryPolyline",e[e.esriGeometryPolygon=4]="esriGeometryPolygon",e[e.esriGeometryEnvelope=5]="esriGeometryEnvelope",e[e.esriGeometryAny=6]="esriGeometryAny",e[e.esriGeometryMultiPatch=7]="esriGeometryMultiPatch"}(o||(o={})),function(e){e[e.esriMethodHintUNSPECIFIED=0]="esriMethodHintUNSPECIFIED",e[e.esriUUIDESRI=1]="esriUUIDESRI",e[e.esriUUIDRFC4122=2]="esriUUIDRFC4122"}(a||(a={})),function(e){e[e.esriTypeUNSPECIFIED=0]="esriTypeUNSPECIFIED",e[e.esriTypeEntity=1]="esriTypeEntity",e[e.esriTypeRelationship=2]="esriTypeRelationship",e[e.esriTypeBoth=4]="esriTypeBoth"}(s||(s={})),function(e){e[e.esriGraphPropertyUNSPECIFIED=0]="esriGraphPropertyUNSPECIFIED",e[e.esriGraphPropertyRegular=1]="esriGraphPropertyRegular",e[e.esriGraphPropertyDocumentName=2]="esriGraphPropertyDocumentName",e[e.esriGraphPropertyDocumentTitle=3]="esriGraphPropertyDocumentTitle",e[e.esriGraphPropertyDocumentUrl=4]="esriGraphPropertyDocumentUrl",e[e.esriGraphPropertyDocumentText=5]="esriGraphPropertyDocumentText",e[e.esriGraphPropertyDocumentKeywords=6]="esriGraphPropertyDocumentKeywords",e[e.esriGraphPropertyDocumentContentType=7]="esriGraphPropertyDocumentContentType",e[e.esriGraphPropertyDocumentMetadata=8]="esriGraphPropertyDocumentMetadata",e[e.esriGraphPropertyDocumentFileExtension=9]="esriGraphPropertyDocumentFileExtension"}(l||(l={})),function(e){e[e.esriIdentifierInfoTypeUNSPECIFIED=0]="esriIdentifierInfoTypeUNSPECIFIED",e[e.esriIdentifierInfoTypeDatabaseNative=1]="esriIdentifierInfoTypeDatabaseNative",e[e.esriIdentifierInfoTypeUniformProperty=2]="esriIdentifierInfoTypeUniformProperty"}(u||(u={}))})),t.register("f1ogG",(function(n,r){e(n.exports,"decodedWasmObjToQueryResponseObj",(function(){return y}));var i=t("jHOLN"),o=t("loKeU"),a=(t("YVtRK"),t("gZb4U")),s=t("aW369"),l=t("5bd09"),u=t("5BfMn"),p=t("2lbCb"),d=t("5REfj");const c=i.default.getLogger("esri.rest.knowledgeGraph.WasmToQueryResponseObjConstructors"),h=(e,t)=>{if(null==e)return null;if("object"!=typeof e)return e;if("getDate"in e)return e;if("geometry_type"in e)switch(e.geometry_type.value){case null:return null;case u.WasmGeometryTypeCodes.ESRI_GEOMETRY_POINT:return(0,d.wasmToPointGeometry)(e);case u.WasmGeometryTypeCodes.ESRI_GEOMETRY_MULTIPOINT:return(0,d.wasmToMultipointGeometry)(e);case u.WasmGeometryTypeCodes.ESRI_GEOMETRY_POLYLINE:return(0,d.wasmToPolylineGeometry)(e);case u.WasmGeometryTypeCodes.ESRI_GEOMETRY_POLYGON:return(0,d.wasmToPolygonGeometry)(e);case u.WasmGeometryTypeCodes.ESRI_GEOMETRY_ENVELOPE:case u.WasmGeometryTypeCodes.ESRI_GEOMETRY_MULTI_PATCH:return c.warnOnce("Envelope and Multipatch are not supported on knowledge entities, but one of those geometry types was detected. Result interpreted as null"),null;case u.WasmGeometryTypeCodes.ESRI_GEOMETRY_NULL:case u.WasmGeometryTypeCodes.ESRI_GEOMETRY_ANY:default:return c.warnOnce("Unknown or blank geometry type returned - Result interpreted as null"),null}else{if(!("object_value_type"in e))return c.warnOnce("A decoded value came back of a type that is not supported. Result interpreted as null"),null;switch(e.object_value_type.value){case p.WasmGraphQueryResponseTypeCodes.OBJECT:return function(e,t){return new(0,a.default)(m(e,t))}(e,t);case p.WasmGraphQueryResponseTypeCodes.ENTITY:return f(e,t);case p.WasmGraphQueryResponseTypeCodes.RELATIONSHIP:return g(e,t);case p.WasmGraphQueryResponseTypeCodes.PATH:return function(e,t){const n=e.entity_count(),r=e.relationship_count(),i=[];for(let o=0;o<n;o++)i.push(f(e.get_entity_at(o),t)),o<r&&i.push(g(e.get_relationship_at(o),t));return new(0,s.default)({path:i})}(e,t);case p.WasmGraphQueryResponseTypeCodes.ARRAY:return function(e,t){const n=[],r=e.count();for(let i=0;i<r;i++){const r=e.get_value_at(i);n.push(y(r,t))}return n}(e,t);default:return c.warnOnce("Unknown graph object type detected!  Result interpreted as null"),null}}};function y(e,t){return h(e,t)}function f(e,t){const n=e.type_name,r=m(e,t),i=e.get_id();return new(0,o.default)(Object.assign({typeName:n,id:i},r))}function m(e,t){const n={},r=e.key_count();for(let i=0;i<r;i++)n[e.get_key_at(i)]=y(e.get_value_at(i),t);return{properties:n}}function g(e,t){const n=e.type_name,r=m(e,t);return new(0,l.default)(Object.assign({typeName:n,id:e.get_id(),originId:e.get_origin_entity_id(),destinationId:e.get_destination_entity_id()},r))}})),t.register("gZb4U",(function(n,r){e(n.exports,"default",(function(){return l}));var i=t("7eJjO");t("jHOLN"),t("iJAIC"),t("lNwWH"),t("2VlWd"),t("kyj08");var o=t("fcwIv"),a=t("YVtRK");let s=class extends a.default{constructor(e){super(e)}};s=(0,i._)([(0,o.subclass)("esri.rest.knowledgeGraph.ObjectValue")],s);const l=s})),t.register("aW369",(function(n,r){e(n.exports,"default",(function(){return p}));var i=t("7eJjO"),o=t("1XAcN"),a=t("iho5X");t("iJAIC"),t("lNwWH"),t("2VlWd");var s=t("fcwIv"),l=t("YVtRK");let u=class extends o.JSONSupport{constructor(e){super(e),this.path=null}};(0,i._)([(0,a.property)({type:[l.default],json:{write:!0}})],u.prototype,"path",void 0),u=(0,i._)([(0,s.subclass)("esri.rest.knowledgeGraph.Path")],u);const p=u})),t.register("5BfMn",(function(t,n){var r,i;e(t.exports,"WasmGeometryTypeCodes",(function(){return r})),(i=r||(r={}))[i.ESRI_GEOMETRY_NULL=0]="ESRI_GEOMETRY_NULL",i[i.ESRI_GEOMETRY_POINT=1]="ESRI_GEOMETRY_POINT",i[i.ESRI_GEOMETRY_MULTIPOINT=2]="ESRI_GEOMETRY_MULTIPOINT",i[i.ESRI_GEOMETRY_POLYLINE=3]="ESRI_GEOMETRY_POLYLINE",i[i.ESRI_GEOMETRY_POLYGON=4]="ESRI_GEOMETRY_POLYGON",i[i.ESRI_GEOMETRY_ENVELOPE=5]="ESRI_GEOMETRY_ENVELOPE",i[i.ESRI_GEOMETRY_ANY=6]="ESRI_GEOMETRY_ANY",i[i.ESRI_GEOMETRY_MULTI_PATCH=7]="ESRI_GEOMETRY_MULTI_PATCH"})),t.register("2lbCb",(function(t,n){var r,i,o;e(t.exports,"WasmGraphQueryResponseTypeCodes",(function(){return r})),(o=r||(r={}))[o.OBJECT=0]="OBJECT",o[o.ENTITY=1]="ENTITY",o[o.RELATIONSHIP=2]="RELATIONSHIP",o[o.PATH=3]="PATH",o[o.ARRAY=4]="ARRAY",function(e){e[e.view=0]="view",e[e.edit=1]="edit"}(i||(i={}))})),t.register("5REfj",(function(n,r){e(n.exports,"wasmToMultipointGeometry",(function(){return p})),e(n.exports,"wasmToPointGeometry",(function(){return d})),e(n.exports,"wasmToPolylineGeometry",(function(){return c})),e(n.exports,"wasmToPolygonGeometry",(function(){return h}));var i=t("kyj08"),o=t("eaHvJ"),a=t("d1Fqh"),s=t("fTq43"),l=t("95Tg0"),u=t("5BfMn");function p(e){const t={},n=f(e,t),r=e.lengths,i=e.coords,a=r[0];t.points=[];let s=0;for(let e=0;e<a;e++){const e=[];for(let t=0;t<n;t++)e[t]=i[s],s++;t.points.push(e)}return new(0,o.default)(t)}function d(e){const t={};let n=2;f(e,t);const r=e.coords;return t.x=r[0],t.y=r[1],e.has_z&&(t.z=r[n],n++),e.has_m&&(t.m=r[n]),new(0,a.default)(t)}function c(e){return new(0,l.default)(y(e))}function h(e){return new(0,s.default)(y(e))}function y(e){const t={},n=f(e,t),r=e.lengths,o=e.coords;let a="";if(e.geometry_type.value===u.WasmGeometryTypeCodes.ESRI_GEOMETRY_POLYGON)a="rings";else{if(e.geometry_type.value!==u.WasmGeometryTypeCodes.ESRI_GEOMETRY_POLYLINE)throw new(0,i.default)("KnowledgeGraph:illegal-geometry-type","Illegal Geometry type for multipath conversion");a="paths"}t[a]=[];let s=0;return r.forEach((e=>{const r=[];for(let t=0;t<e;t++){const e=[];for(let t=0;t<n;t++)e[t]=o[s],s++;r.push(e)}t[a].push(r)})),t}function f(e,t){let n=2;return e.has_z?(t.hasZ=e.has_z,n++):t.hasZ=!1,e.has_m?(t.hasM=e.has_m,n++):t.hasM=!1,n}})),t.register("7jgXl",(function(n,r){e(n.exports,"decoderToApplyEditsResponse",(function(){return o}));var i=t("3ZQSr");function o(e){const t=new(0,i.default);t.hasError=e.has_error(),t.hasError&&(t.error={errorCode:e.error.error_code,errorMessage:e.error.error_message});const n=e.get_edit_results_count();for(let r=0;r<n;r++){const n=e.get_edit_results_at(r),i=e.get_edit_results_type_name_at(r),o=[],a=[],s=[],l=n.get_add_results_count(),u=n.get_update_results_count(),p=n.get_delete_results_count();for(let e=0;e<l;e++){const t=n.get_add_result_at(e);o.push({id:t.id,error:{errorCode:t.error.error_code,errorMessage:t.error.error_message}})}for(let e=0;e<u;e++){const t=n.get_update_result_at(e);a.push({id:t.id,error:{errorCode:t.error.error_code,errorMessage:t.error.error_message}})}for(let e=0;e<p;e++){const t=n.get_delete_result_at(e);s.push({id:t.id,error:{errorCode:t.error.error_code,errorMessage:t.error.error_message}})}t.editResults.push({typeName:i,adds:o,updates:a,deletes:s})}return t}})),t.register("3ZQSr",(function(n,r){e(n.exports,"default",(function(){return u}));var i=t("7eJjO"),o=t("jymfC"),a=t("iho5X");t("iJAIC"),t("lNwWH"),t("2VlWd");var s=t("fcwIv");let l=class extends o.default{constructor(e){super(e),this.hasError=null,this.error=null,this.editResults=[]}};(0,i._)([(0,a.property)()],l.prototype,"hasError",void 0),(0,i._)([(0,a.property)()],l.prototype,"error",void 0),(0,i._)([(0,a.property)()],l.prototype,"editResults",void 0),l=(0,i._)([(0,s.subclass)("esri.rest.knowledgeGraph.GraphApplyEdits")],l);const u=l})),t.register("3wwuz",(function(n,r){e(n.exports,"default",(function(){return u}));var i=t("7eJjO"),o=t("iho5X");t("iJAIC"),t("lNwWH"),t("2VlWd");var a=t("fcwIv"),s=t("bW7Z5");let l=class extends s.default{constructor(e){super(e),this.bindParameters=null,this.bindGeometryQuantizationParameters=null,this.outputQuantizationParameters=null}};(0,i._)([(0,o.property)()],l.prototype,"bindParameters",void 0),(0,i._)([(0,o.property)()],l.prototype,"bindGeometryQuantizationParameters",void 0),(0,i._)([(0,o.property)()],l.prototype,"outputQuantizationParameters",void 0),l=(0,i._)([(0,a.subclass)("esri.rest.knowledgeGraph.GraphQueryStreaming")],l);const u=l})),t.register("bW7Z5",(function(n,r){e(n.exports,"default",(function(){return u}));var i=t("7eJjO"),o=t("jymfC"),a=t("iho5X");t("iJAIC"),t("lNwWH"),t("2VlWd");var s=t("fcwIv");let l=class extends o.default{constructor(e){super(e),this.openCypherQuery=""}};(0,i._)([(0,a.property)()],l.prototype,"openCypherQuery",void 0),l=(0,i._)([(0,s.subclass)("esri.rest.knowledgeGraph.GraphQuery")],l);const u=l})),t.register("jUvZS",(function(n,r){e(n.exports,"default",(function(){return D}));var i=t("7eJjO");t("2ILM8");var o=t("3MVX3");t("35mRC"),t("fqK5H"),t("hHJvn"),t("aOUND"),t("g4anJ"),t("7Kl6r"),t("fPYaT"),t("aRUMT");var a=t("lubf9"),s=t("9ulmN");t("gdXB3");var l=t("iho5X");t("iJAIC"),t("lNwWH"),t("2VlWd");var u=t("fcwIv"),p=t("7RvA5"),d=t("eY5Yp"),c=t("4LDxK"),h=t("73BcH"),y=t("f3b5K"),f=t("dxhdj"),m=t("2LhMc"),g=t("k4dnL"),_=t("gIXJ2"),v=t("71Ggg"),I=t("13Qxf"),x=t("3GzOb"),b=t("buMuJ"),w=t("7vTUY"),E=t("f4h86"),T=t("cRlei"),M=t("37qRo"),C=t("341hJ"),N=t("gINRd"),L=t("fTq43"),S=t("95Tg0"),O=t("7LVgC");let G=class extends((0,v.FeatureReductionLayer)((0,g.KnowledgeGraphSublayerBase)((0,_.BlendLayer)((0,x.ScaleRangeLayer)((0,I.RefreshableLayer)(c.default)))))){get defaultPopupTemplate(){return this.createPopupTemplate()}set renderer(e){(0,w.fixRendererFields)(e,this.fieldsIndex),this._set("renderer",e)}createPopupTemplate(e){return(0,M.createPopupTemplate)(this,e)}createQuery(){return new(0,T.default)({where:"1=1",outFields:["*"]})}getField(e){for(let t=0;t<this.fields.length;t++)if(this.fields[t].name===e)return this.fields[t];throw new Error("Field not found")}getFieldDomain(e,t){return null}async queryFeatures(e,t){const{resolvedQuery:n,queryEngine:r}=await this._setupQueryObjects(e),i=E.default.fromJSON(await r.executeQuery(n.toJSON(),null==t?void 0:t.signal));return i.features.forEach((e=>{e.sourceLayer=this})),i}async queryFeaturesJSON(e,t){const{resolvedQuery:n,queryEngine:r}=await this._setupQueryObjects(e);return await r.executeQuery(n.toJSON(),null==t?void 0:t.signal)}async queryFeatureCount(e,t){const{resolvedQuery:n,queryEngine:r}=await this._setupQueryObjects(e);return r.executeQueryForCount(n.toJSON(),null==t?void 0:t.signal)}async queryExtent(e={},t){var n,r,i,o;const a={...e,returnGeometry:!0},{resolvedQuery:s,queryEngine:l}=await this._setupQueryObjects(a),u=await l.executeQueryForExtent(s.toJSON(),null==t?void 0:t.signal);let p;return p=null!=(null===(n=u.extent)||void 0===n?void 0:n.xmin)&&null!=(null===(r=u.extent)||void 0===r?void 0:r.xmax)&&null!=(null===(i=u.extent)||void 0===i?void 0:i.ymin)&&null!=(null===(o=u.extent)||void 0===o?void 0:o.ymax)?new(0,N.default)(u.extent):new(0,N.default),{count:u.count,extent:p}}async queryObjectIds(e,t){const n=T.default.from(e);let r;if("link-chart"===this.parentCompositeLayer.type&&this._cachedQueryEngine)r=this._cachedQueryEngine;else{const e=await this.parentCompositeLayer.dataManager.getData(n,this,t);r=this.loadQueryEngine(e)}return r.executeQueryForIds(n.toJSON(),null==t?void 0:t.signal)}loadQueryEngine(e){const t=new(0,h.default)({geometryType:O.featureGeometryTypeKebabDictionary.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ}),n=new(0,y.QueryEngine)({fields:this.fields.map((e=>e.toJSON())),geometryType:O.featureGeometryTypeKebabDictionary.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:this.spatialReference.toJSON(),timeInfo:null,featureStore:t});return n.featureStore.addMany(e),n}async refreshCachedQueryEngine(){const e=await this.parentCompositeLayer.dataManager.getData(new(0,T.default)({where:"1=1",outFields:[m.MOCK_OID_FIELD_NAME]}),this);this._cachedQueryEngine=this.loadQueryEngine(e)}async _setupQueryObjects(e,t){var n;const r=T.default.from(e),i=r.geometry;let o;if(i&&!(null===(n=i.spatialReference)||void 0===n?void 0:n.isWGS84)&&(await(0,p.initializeProjection)(i.spatialReference,d.WGS84),r.geometry=(0,p.project)(i instanceof L.default||i instanceof S.default?i:i.extent,d.WGS84)),"link-chart"===this.parentCompositeLayer.type&&this._cachedQueryEngine)o=this._cachedQueryEngine;else{const e=await this.parentCompositeLayer.dataManager.getData(r,this,t);o=this.loadQueryEngine(e)}return{resolvedQuery:r,queryEngine:o}}constructor(e){var t,n,r,i;if(super(e),this.capabilities=(0,f.createCapabilities)(!1,!1),this.definitionExpression="",this.displayField="",this.elevationInfo=null,this.geometryType=null,this.geometryFieldName=null,this.graphType=null,this.hasM=!1,this.hasZ=!1,this.labelsVisible=null,this.labelingInfo=null,this.objectIdField=m.MOCK_OID_FIELD_NAME,this.objectType=null,this.parentCompositeLayer=null,this.popupTemplate=null,this.source={openPorts:()=>this.load().then((()=>{const e=new MessageChannel;return new(0,C.default)(e.port1,{channel:e,client:{queryFeatures:(e,t={})=>{const n=T.default.fromJSON(e);return this.queryFeaturesJSON(n,t)}}},(()=>null)),[e.port2]}))},this.type="knowledge-graph-sublayer","link-chart"===e.parentCompositeLayer.type)"relationship"===e.graphType?this.geometryType="polyline":this.geometryType="point",this.geometryFieldName=m.MOCK_LAYOUT_GEOMETRY_FIELD_NAME;else if((null===(t=e.parentCompositeLayer.dataManager.geographicLookup.get(e.objectType.name))||void 0===t?void 0:t.geometryType)&&"esriGeometryNull"!==(null===(n=e.parentCompositeLayer.dataManager.geographicLookup.get(e.objectType.name))||void 0===n?void 0:n.geometryType)){var o;const t=e.parentCompositeLayer.dataManager.geographicLookup.get(e.objectType.name);var s;this.geometryFieldName=null!==(s=null==t?void 0:t.name)&&void 0!==s?s:null,this.geometryType=(null==t?void 0:t.geometryType)?O.featureGeometryTypeKebabDictionary.fromJSON(t.geometryType):null;const n=null==t?void 0:t.name,r=n?null===(o=e.objectType.properties)||void 0===o?void 0:o[n]:null;var l,u;r?(this.hasM=null!==(l=r.hasM)&&void 0!==l&&l,this.hasZ=null!==(u=r.hasZ)&&void 0!==u&&u):(this.hasM=!1,this.hasZ=!1)}else this.geometryType=null;null===(r=e.objectType.properties)||void 0===r||r.forEach((e=>{let t=e.fieldType;"esriFieldTypeOID"===t&&(t="esriFieldTypeInteger"),this.fields.push(b.default.fromJSON({name:e.name,type:t,alias:e.alias,defaultValue:null,editable:e.editable,nullable:e.nullable}))})),this.fields.push(b.default.fromJSON({name:this.objectIdField,type:"esriFieldTypeString",alias:this.objectIdField,editable:!1})),this._set("fields",[...this.fields]),(null===(i=e.parentCompositeLayer.dataManager.knowledgeGraph.dataModel)||void 0===i?void 0:i.spatialReference)&&(this.spatialReference=e.parentCompositeLayer.dataManager.knowledgeGraph.dataModel.spatialReference),"link-chart"===e.parentCompositeLayer.type?"relationship"===e.graphType?this.renderer=(0,a.fromJSON)((0,f.createDrawingInfo)(O.featureGeometryTypeKebabDictionary.toJSON("polyline")).renderer):this.renderer=(0,a.fromJSON)((0,f.createDrawingInfo)(O.featureGeometryTypeKebabDictionary.toJSON("point")).renderer):this.renderer=(0,a.fromJSON)((0,f.createDrawingInfo)(O.featureGeometryTypeKebabDictionary.toJSON(this.geometryType)).renderer)}};(0,i._)([(0,l.property)()],G.prototype,"capabilities",void 0),(0,i._)([(0,l.property)({readOnly:!0})],G.prototype,"defaultPopupTemplate",null),(0,i._)([(0,l.property)()],G.prototype,"definitionExpression",void 0),(0,i._)([(0,l.property)()],G.prototype,"displayField",void 0),(0,i._)([(0,l.property)()],G.prototype,"elevationInfo",void 0),(0,i._)([(0,l.property)()],G.prototype,"geometryType",void 0),(0,i._)([(0,l.property)()],G.prototype,"geometryFieldName",void 0),(0,i._)([(0,l.property)()],G.prototype,"graphType",void 0),(0,i._)([(0,l.property)()],G.prototype,"hasM",void 0),(0,i._)([(0,l.property)()],G.prototype,"hasZ",void 0),(0,i._)([(0,l.property)()],G.prototype,"labelsVisible",void 0),(0,i._)([(0,l.property)()],G.prototype,"labelingInfo",void 0),(0,i._)([(0,l.property)()],G.prototype,"objectIdField",void 0),(0,i._)([(0,l.property)()],G.prototype,"objectType",void 0),(0,i._)([(0,l.property)()],G.prototype,"parentCompositeLayer",void 0),(0,i._)([(0,l.property)({type:o.default,json:{name:"popupInfo",write:!0}})],G.prototype,"popupTemplate",void 0),(0,i._)([(0,l.property)({types:s.rendererTypes,json:{write:{target:"layerDefinition.drawingInfo.renderer"}}})],G.prototype,"renderer",null),(0,i._)([(0,l.property)()],G.prototype,"source",void 0),(0,i._)([(0,l.property)({json:{read:!1}})],G.prototype,"type",void 0),G=(0,i._)([(0,u.subclass)("esri.layers.knowledgeGraph.KnowledgeGraphSublayer")],G);const D=G})),t.register("73BcH",(function(n,r){e(n.exports,"default",(function(){return y}));var i=t("kyj08"),o=t("amfHf"),a=t("jHOLN"),s=t("ayLat"),l=t("8TwEW"),u=t("akQYU"),p=t("1ZPLr"),d=t("1zB3R"),c=t("emniL");const h=(0,s.create)();class y{get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){return this._boundsStore.fullBounds}get storeStatistics(){let e=0;return this._featuresById.forEach((t=>{null!=t.geometry&&t.geometry.coords&&(e+=t.geometry.coords.length)})),{featureCount:this._featuresById.size,vertexCount:e/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}getFullExtent(e){if(null==this.fullBounds)return null;const[t,n,r,i]=this.fullBounds;return{xmin:t,ymin:n,xmax:r,ymax:i,spatialReference:(0,c.cleanFromGeometryEngine)(e)}}add(e){this._add(e),this._emitChanged()}addMany(e){for(const t of e)this._add(t);this._emitChanged()}clear(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged()}removeById(e){const t=this._featuresById.get(e);return t?(this._remove(t),this._emitChanged(),t):null}removeManyById(e){this._boundsStore.invalidateIndex();for(const t of e){const e=this._featuresById.get(t);e&&this._remove(e)}this._emitChanged()}forEachBounds(e,t){for(const n of e){const e=this._boundsStore.get(n.objectId);e&&t((0,s.fromRect)(h,e))}}getFeature(e){return this._featuresById.get(e)}has(e){return this._featuresById.has(e)}forEach(e){this._featuresById.forEach((t=>e(t)))}forEachInBounds(e,t){this._boundsStore.forEachInBounds(e,(e=>{t(this._featuresById.get(e))}))}startMarkingUsedFeatures(){this._boundsStore.invalidateIndex(),this._markedIds.clear()}sweep(){let e=!1;this._featuresById.forEach(((t,n)=>{this._markedIds.has(n)||(e=!0,this._remove(t))})),this._markedIds.clear(),e&&this._emitChanged()}_emitChanged(){this.events.emit("changed",void 0)}_add(e){if(!e)return;const t=e.objectId;if(null==t)return void a.default.getLogger("esri.layers.graphics.data.FeatureStore").error(new(0,i.default)("featurestore:invalid-feature","feature id is missing",{feature:e}));const n=this._featuresById.get(t);let r;if(this._markedIds.add(t),n?(e.displayId=n.displayId,r=this._boundsStore.get(t),this._boundsStore.delete(t)):null!=this.onFeatureAdd&&this.onFeatureAdd(e),null==e.geometry||!e.geometry.coords||!e.geometry.coords.length)return this._boundsStore.set(t,null),void this._featuresById.set(t,e);r=(0,u.getBoundsOptimizedGeometry)(null!=r?r:(0,l.create)(),e.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),null!=r&&this._boundsStore.set(t,r),this._featuresById.set(t,e)}_remove(e){null!=this.onFeatureRemove&&this.onFeatureRemove(e);const t=e.objectId;return this._markedIds.delete(t),this._boundsStore.delete(t),this._featuresById.delete(t),e}constructor(e){this.geometryInfo=e,this._boundsStore=new(0,p.BoundsStore),this._featuresById=new Map,this._markedIds=new Set,this.events=new(0,o.default),this.featureAdapter=d.optimizedFeatureQueryEngineAdapter}}})),t.register("1ZPLr",(function(n,r){e(n.exports,"BoundsStore",(function(){return u}));var i=t("2VlWd"),o=t("bWAZj"),a=t("8TwEW");const s={minX:0,minY:0,maxX:0,maxY:0};function l(e,t,n){(function(e){s.minX=e[0],s.minY=e[1],s.maxX=e[2],s.maxY=e[3]})(t),e.search(s,n)}class u{get fullBounds(){if(!this._boundsById.size)return null;const e=(0,a.empty)();for(const t of this._boundsById.values())t&&(e[0]=Math.min(t[0],e[0]),e[1]=Math.min(t[1],e[1]),e[2]=Math.max(t[2],e[2]),e[3]=Math.max(t[3],e[3]));return e}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(e){const t=this._boundsById.get(e);this._boundsById.delete(e),t&&(this._idByBounds.delete(t),this._indexInvalid||this._index.remove(t))}forEachInBounds(e,t){this._loadIndex(),l(this._index,e,(e=>t(this._idByBounds.get(e))))}get(e){return this._boundsById.get(e)}has(e){return this._boundsById.has(e)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(e,t){if(!this._indexInvalid){const t=this._boundsById.get(e);t&&(this._index.remove(t),this._idByBounds.delete(t))}this._boundsById.set(e,t),t&&(this._idByBounds.set(t,e),this._indexInvalid||(this._boundsToLoad.push(t),this._boundsToLoad.length>5e4&&this._loadIndex()))}constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new(0,o.PooledRBush)(9,(0,i.default)("esri-csp-restrictions")?e=>({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}):["[0]","[1]","[2]","[3]"]),this._loadIndex=()=>{if(this._indexInvalid){const e=new Array(this._idByBounds.size);let t=0;this._idByBounds.forEach(((n,r)=>{e[t++]=r})),this._indexInvalid=!1,this._index.clear(),this._index.load(e)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter((e=>this._idByBounds.has(e)))))),this._boundsToLoad.length=0)}}}})),t.register("bWAZj",(function(n,r){e(n.exports,"PooledRBush",(function(){return l}));var i=t("lNwWH"),o=t("7qybv"),a=t("6v7Z0"),s=t("fcGl2");class l{destroy(){this.clear(),x.prune(),b.prune(),w.prune(),E.prune()}all(e){this._all(this._data,e)}search(e,t){let n=this._data;const r=this._toBBox;if(v(e,n))for(x.clear();n;){for(let i=0,o=n.children.length;i<o;i++){const o=n.children[i],a=n.leaf?r(o):o;v(e,a)&&(n.leaf?t(o):_(e,a)?this._all(o,t):x.push(o))}n=x.pop()}}collides(e){let t=this._data;const n=this._toBBox;if(!v(e,t))return!1;for(x.clear();t;){for(let r=0,i=t.children.length;r<i;r++){const i=t.children[r],o=t.leaf?n(i):i;if(v(e,o)){if(t.leaf||_(e,o))return!0;x.push(i)}}t=x.pop()}return!1}load(e){if(!e.length)return this;if(e.length<this._minEntries){for(let t=0,n=e.length;t<n;t++)this.insert(e[t]);return this}let t=this._build(e.slice(0,e.length),0,e.length-1,0);if(this._data.children.length)if(this._data.height===t.height)this._splitRoot(this._data,t);else{if(this._data.height<t.height){const e=this._data;this._data=t,t=e}this._insert(t,this._data.height-t.height-1,!0)}else this._data=t;return this}insert(e){return e&&this._insert(e,this._data.height-1),this}clear(){return this._data=new C([]),this}remove(e){if(!e)return this;let t,n=this._data,r=null,a=0,s=!1;const l=this._toBBox(e);for(w.clear(),E.clear();n||w.length>0;){var u;if(n||(n=(0,o.assumeNonNull)(w.pop()),r=w.data[w.length-1],a=null!==(u=E.pop())&&void 0!==u?u:0,s=!0),n.leaf&&(t=(0,i.indexOf)(n.children,e,n.children.length,n.indexHint),-1!==t))return n.children.splice(t,1),w.push(n),this._condense(w),this;s||n.leaf||!_(n,l)?r?(a++,n=r.children[a],s=!1):n=null:(w.push(n),E.push(a),a=0,r=n,n=n.children[0])}return this}toJSON(){return this._data}fromJSON(e){return this._data=e,this}_all(e,t){let n=e;for(b.clear();n;){if(!0===n.leaf)for(const e of n.children)t(e);else b.pushArray(n.children);var r;n=null!==(r=b.pop())&&void 0!==r?r:null}}_build(e,t,n,r){const i=n-t+1;let o=this._maxEntries;if(i<=o){const r=new C(e.slice(t,n+1));return u(r,this._toBBox),r}r||(r=Math.ceil(Math.log(i)/Math.log(o)),o=Math.ceil(i/o**(r-1)));const a=new N([]);a.height=r;const s=Math.ceil(i/o),l=s*Math.ceil(Math.sqrt(o));I(e,t,n,l,this._compareMinX);for(let i=t;i<=n;i+=l){const t=Math.min(i+l-1,n);I(e,i,t,s,this._compareMinY);for(let n=i;n<=t;n+=s){const i=Math.min(n+s-1,t);a.children.push(this._build(e,n,i,r-1))}}return u(a,this._toBBox),a}_chooseSubtree(e,t,n,r){for(;r.push(t),!0!==t.leaf&&r.length-1!==n;){let n,r=1/0,i=1/0;for(let o=0,a=t.children.length;o<a;o++){const a=t.children[o],s=y(a),l=m(e,a)-s;l<i?(i=l,r=s<r?s:r,n=a):l===i&&s<r&&(r=s,n=a)}t=n||t.children[0]}return t}_insert(e,t,n){const r=this._toBBox,i=n?e:r(e);w.clear();const o=this._chooseSubtree(i,this._data,t,w);for(o.children.push(e),d(o,i);t>=0&&w.data[t].children.length>this._maxEntries;)this._split(w,t),t--;this._adjustParentBBoxes(i,w,t)}_split(e,t){const n=e.data[t],r=n.children.length,i=this._minEntries;this._chooseSplitAxis(n,i,r);const o=this._chooseSplitIndex(n,i,r);if(!o)return void console.log("  Error: assertion failed at PooledRBush._split: no valid split index");const a=n.children.splice(o,n.children.length-o),s=n.leaf?new C(a):new N(a);s.height=n.height,u(n,this._toBBox),u(s,this._toBBox),t?e.data[t-1].children.push(s):this._splitRoot(n,s)}_splitRoot(e,t){this._data=new N([e,t]),this._data.height=e.height+1,u(this._data,this._toBBox)}_chooseSplitIndex(e,t,n){let r,i,o;r=i=1/0;for(let a=t;a<=n-t;a++){const t=p(e,0,a,this._toBBox),s=p(e,a,n,this._toBBox),l=g(t,s),u=y(t)+y(s);l<r?(r=l,o=a,i=u<i?u:i):l===r&&u<i&&(i=u,o=a)}return o}_chooseSplitAxis(e,t,n){const r=e.leaf?this._compareMinX:c,i=e.leaf?this._compareMinY:h;this._allDistMargin(e,t,n,r)<this._allDistMargin(e,t,n,i)&&e.children.sort(r)}_allDistMargin(e,t,n,r){e.children.sort(r);const i=this._toBBox,o=p(e,0,t,i),a=p(e,n-t,n,i);let s=f(o)+f(a);for(let r=t;r<n-t;r++){const t=e.children[r];d(o,e.leaf?i(t):t),s+=f(o)}for(let r=n-t-1;r>=t;r--){const t=e.children[r];d(a,e.leaf?i(t):t),s+=f(a)}return s}_adjustParentBBoxes(e,t,n){for(let r=n;r>=0;r--)d(t.data[r],e)}_condense(e){for(let t=e.length-1;t>=0;t--){const n=e.data[t];if(0===n.children.length)if(t>0){const r=e.data[t-1],o=r.children;o.splice((0,i.indexOf)(o,n,o.length,r.indexHint),1)}else this.clear();else u(n,this._toBBox)}}_initFormat(e){const t=["return a"," - b",";"];this._compareMinX=new Function("a","b",t.join(e[0])),this._compareMinY=new Function("a","b",t.join(e[1])),this._toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}constructor(e=9,t){this._compareMinX=c,this._compareMinY=h,this._toBBox=e=>e,this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),t&&("function"==typeof t?this._toBBox=t:this._initFormat(t)),this.clear()}}function u(e,t){p(e,0,e.children.length,t,e)}function p(e,t,n,r,i){i||(i=new C([])),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(let o,a=t;a<n;a++)o=e.children[a],d(i,e.leaf?r(o):o);return i}function d(e,t){e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY)}function c(e,t){return e.minX-t.minX}function h(e,t){return e.minY-t.minY}function y(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function f(e){return e.maxX-e.minX+(e.maxY-e.minY)}function m(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function g(e,t){const n=Math.max(e.minX,t.minX),r=Math.max(e.minY,t.minY),i=Math.min(e.maxX,t.maxX),o=Math.min(e.maxY,t.maxY);return Math.max(0,i-n)*Math.max(0,o-r)}function _(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function v(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function I(e,t,n,r,i){const a=[t,n];for(;a.length;){const t=(0,o.assumeNonNull)(a.pop()),n=(0,o.assumeNonNull)(a.pop());if(t-n<=r)continue;const l=n+Math.ceil((t-n)/r/2)*r;(0,s.q)(e,l,n,t,i),a.push(n,l,l,t)}}const x=new(0,a.default),b=new(0,a.default),w=new(0,a.default),E=new(0,a.default)({deallocator:void 0});class T{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}}class M extends T{constructor(){super(...arguments),this.height=1,this.indexHint=new(0,i.PositionHint)}}class C extends M{constructor(e){super(),this.children=e,this.leaf=!0}}class N extends M{constructor(e){super(),this.children=e,this.leaf=!1}}})),t.register("1zB3R",(function(n,r){e(n.exports,"optimizedFeatureQueryEngineAdapter",(function(){return s}));var i=t("8mTF7"),o=t("ft2bT"),a=t("awxBI");const s={getObjectId:e=>e.objectId,getAttributes:e=>e.attributes,getAttribute:(e,t)=>e.attributes[t],cloneWithGeometry:(e,t)=>new(0,o.OptimizedFeature)(t,e.attributes,null,e.objectId),getGeometry:e=>e.geometry,getCentroid:(e,t)=>(null==e.centroid&&(e.centroid=(0,i.getCentroidOptimizedGeometry)(new(0,a.default),e.geometry,t.hasZ,t.hasM)),e.centroid)}})),t.register("8mTF7",(function(t,n){function r(e,t){return e?t?4:3:t?3:2}function i(e,t,n,i,p){if(null==t||!t.lengths.length)return null;const d="upperLeft"===(null==p?void 0:p.originPosition)?-1:1;e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0);const c=e.coords,h=[],y=n?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:f,coords:m}=t,g=r(n,i);let _=0;for(const e of f){const t=o(y,m,_,e,n,i,d);t&&h.push(t),_+=e*g}if(h.sort(((e,t)=>{let r=d*e[2]-d*t[2];return 0===r&&n&&(r=e[4]-t[4]),r})),h.length){let e=6*h[0][2];c[0]=h[0][0]/e,c[1]=h[0][1]/e,n&&(e=6*h[0][4],c[2]=0!==e?h[0][3]/e:0),(c[0]<y[0]||c[0]>y[1]||c[1]<y[2]||c[1]>y[3]||n&&(c[2]<y[4]||c[2]>y[5]))&&(c.length=0)}if(!c.length){const e=t.lengths[0]?function(e,t,n,i,o){const p=r(i,o);let d=t,c=t+p,h=0,y=0,f=0,m=0;for(let t=0,r=n-1;t<r;t++,d+=p,c+=p){const t=e[d],n=e[d+1],r=e[d+2],o=e[c],p=e[c+1],g=e[c+2],_=i?s(t,n,r,o,p,g):a(t,n,o,p);if(_)if(h+=_,i){const e=u(t,n,r,o,p,g);y+=_*e[0],f+=_*e[1],m+=_*e[2]}else{const e=l(t,n,o,p);y+=_*e[0],f+=_*e[1]}}return h>0?i?[y/h,f/h,m/h]:[y/h,f/h]:n>0?i?[e[t],e[t+1],e[t+2]]:[e[t],e[t+1]]:null}(m,0,f[0],n,i):null;if(!e)return null;c[0]=e[0],c[1]=e[1],n&&e.length>2&&(c[2]=e[2])}return e}function o(e,t,n,i,o,a,s=1){const l=r(o,a);let u=n,p=n+l,d=0,c=0,h=0,y=0,f=0;for(let n=0,r=i-1;n<r;n++,u+=l,p+=l){const n=t[u],r=t[u+1],i=t[u+2],a=t[p],s=t[p+1],l=t[p+2];let m=n*s-a*r;y+=m,d+=(n+a)*m,c+=(r+s)*m,o&&(m=n*l-a*i,h+=(i+l)*m,f+=m),n<e[0]&&(e[0]=n),n>e[1]&&(e[1]=n),r<e[2]&&(e[2]=r),r>e[3]&&(e[3]=r),o&&(i<e[4]&&(e[4]=i),i>e[5]&&(e[5]=i))}if(y*s>0&&(y*=-1),f*s>0&&(f*=-1),!y)return null;const m=[d,c,.5*y];return o&&(m[3]=h,m[4]=.5*f),m}function a(e,t,n,r){const i=n-e,o=r-t;return Math.sqrt(i*i+o*o)}function s(e,t,n,r,i,o){const a=r-e,s=i-t,l=o-n;return Math.sqrt(a*a+s*s+l*l)}function l(e,t,n,r){return[e+.5*(n-e),t+.5*(r-t)]}function u(e,t,n,r,i,o){return[e+.5*(r-e),t+.5*(i-t),n+.5*(o-n)]}e(t.exports,"getCentroidOptimizedGeometry",(function(){return i}))})),t.register("emniL",(function(n,r){e(n.exports,"QUERY_ENGINE_EMPTY_RESULT",(function(){return f})),e(n.exports,"transformCentroid",(function(){return I})),e(n.exports,"getGeometry",(function(){return x})),e(n.exports,"normalizeQuery",(function(){return b})),e(n.exports,"normalizeQueryLike",(function(){return w})),e(n.exports,"cleanFromGeometryEngine",(function(){return T}));var i=t("79ASa"),o=t("5vzSQ"),a=t("7RvA5"),s=t("jxYOa"),l=t("79LpT"),u=t("5On35"),p=t("eY5Yp"),d=t("akQYU"),c=t("awxBI"),h=t("fP7bp");const y=new(0,i.JSONMap)({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),f=Object.freeze({}),m=new(0,c.default),g=new(0,c.default),_=new(0,c.default),v={esriGeometryPoint:d.convertToPoint,esriGeometryPolyline:d.convertToPolyline,esriGeometryPolygon:d.convertToPolygon,esriGeometryMultipoint:d.convertToMultipoint};function I(e,t,n,r=e.hasZ,i=e.hasM){if(null==t)return null;const o=e.hasZ&&r,a=e.hasM&&i;if(n){const s=(0,d.quantizeOptimizedGeometry)(_,t,e.hasZ,e.hasM,"esriGeometryPoint",n,r,i);return(0,d.convertToPoint)(s,o,a)}return(0,d.convertToPoint)(t,o,a)}function x(e,t,n,r,i,o,a=t,s=n){var l;const u=t&&a,p=n&&s,c=null!=r?"coords"in r?r:r.geometry:null;if(null==c)return null;if(i){var h;let r=(0,d.generalizeOptimizedGeometry)(g,c,t,n,e,i,a,s);var y;return o&&(r=(0,d.quantizeOptimizedGeometry)(_,r,u,p,e,o)),null!==(y=null===(h=v[e])||void 0===h?void 0:h.call(v,r,u,p))&&void 0!==y?y:null}if(o){var f;const r=(0,d.quantizeOptimizedGeometry)(_,c,t,n,e,o,a,s);var I;return null!==(I=null===(f=v[e])||void 0===f?void 0:f.call(v,r,u,p))&&void 0!==I?I:null}var x;return(0,d.removeZMValues)(m,c,t,n,a,s),null!==(x=null===(l=v[e])||void 0===l?void 0:l.call(v,m,u,p))&&void 0!==x?x:null}async function b(e,t,n){const{outFields:r,orderByFields:i,groupByFieldsForStatistics:o,outStatistics:a}=e;if(r)for(let e=0;e<r.length;e++)r[e]=r[e].trim();if(i)for(let e=0;e<i.length;e++)i[e]=i[e].trim();if(o)for(let e=0;e<o.length;e++)o[e]=o[e].trim();if(a)for(let e=0;e<a.length;e++)a[e].onStatisticField&&(a[e].onStatisticField=a[e].onStatisticField.trim());return e.geometry&&!e.outSR&&(e.outSR=e.geometry.spatialReference),w(e,t,n)}async function w(e,n,r){if(!e)return null;let{where:i}=e;if(e.where=i=i&&i.trim(),(!i||/^1 *= *1$/.test(i)||n&&n===i)&&(e.where=null),!e.geometry)return e;let a=await async function(e){const{distance:n,units:r}=e,i=e.geometry;if(null==n||"vertexAttributes"in i)return i;const a=i.spatialReference,s=r?y.fromJSON(r):(0,o.getUnitString)(a),l=a&&((0,p.isGeographic)(a)||(0,p.isWebMercator)(a))?i:await(0,h.checkProjectionSupport)(a,p.WGS84).then((()=>(0,h.project)(i,p.WGS84)));return(await async function(){return(await t("iqALr")).geodesicBuffer}())(l.spatialReference,l,n,s)}(e);if(e.distance=0,e.units=null,"esriSpatialRelEnvelopeIntersects"===e.spatialRel){const{spatialReference:t}=e.geometry;a=(0,s.getGeometryExtent)(a),a.spatialReference=t}if(a){var d;await(0,h.checkProjectionSupport)(a.spatialReference,r),a=function(e,t){const n=e.spatialReference;return E(e,t)&&(0,l.isExtent)(e)?{spatialReference:n,rings:[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]}:e}(a,r);const t=(await(0,u.normalizeCentralMeridian)((0,l.fromJSON)(a)))[0];if(null==t)throw f;const n="quantizationParameters"in e&&(null===(d=e.quantizationParameters)||void 0===d?void 0:d.tolerance)||"maxAllowableOffset"in e&&e.maxAllowableOffset||0,i=n&&E(a,r)?{densificationStep:8*n}:void 0,o=t.toJSON(),s=await(0,h.project)(o,o.spatialReference,r,i);if(!s)throw f;s.spatialReference=r,e.geometry=s}return e}function E(e,t){if(!e)return!1;const n=e.spatialReference;return((0,l.isExtent)(e)||(0,l.isPolygon)(e)||(0,l.isPolyline)(e))&&!(0,p.equals)(n,t)&&!(0,a.canProjectWithoutEngine)(n,t)}function T(e){return e&&M in e?JSON.parse(JSON.stringify(e,C)):e}const M="_geVersion",C=(e,t)=>e!==M?t:void 0})),t.register("fP7bp",(function(n,r){e(n.exports,"checkProjectionSupport",(function(){return h})),e(n.exports,"project",(function(){return m})),e(n.exports,"projectMany",(function(){return _}));var i=t("lNwWH"),o=t("7RvA5"),a=t("jGyUI"),s=t("eY5Yp"),l=t("eF88h");const u=[0,0];function p(e,t){if(!t)return null;if("x"in t){const n={x:0,y:0};return[n.x,n.y]=e(t.x,t.y,u),null!=t.z&&(n.z=t.z),null!=t.m&&(n.m=t.m),n}if("xmin"in t){const n={xmin:0,ymin:0,xmax:0,ymax:0};return[n.xmin,n.ymin]=e(t.xmin,t.ymin,u),[n.xmax,n.ymax]=e(t.xmax,t.ymax,u),t.hasZ&&(n.zmin=t.zmin,n.zmax=t.zmax,n.hasZ=!0),t.hasM&&(n.mmin=t.mmin,n.mmax=t.mmax,n.hasM=!0),n}return"rings"in t?{rings:d(t.rings,e),hasM:t.hasM,hasZ:t.hasZ}:"paths"in t?{paths:d(t.paths,e),hasM:t.hasM,hasZ:t.hasZ}:"points"in t?{points:c(t.points,e),hasM:t.hasM,hasZ:t.hasZ}:null}function d(e,t){const n=[];for(const r of e)n.push(c(r,t));return n}function c(e,t){const n=[];for(const r of e){const e=t(r[0],r[1],[0,0]);n.push(e),r.length>2&&e.push(r[2]),r.length>3&&e.push(r[3])}return n}async function h(e,t){if(!e||!t)return;const n=Array.isArray(e)?e.map((e=>null!=e.geometry?e.geometry.spatialReference:null)).filter(i.isSome):[e];await(0,o.initializeProjection)(n.map((e=>({source:e,dest:t}))))}const y=p.bind(null,l.lngLatToXY),f=p.bind(null,l.xyToLngLat);function m(e,t,n,r){if(!e)return e;if(n||(n=t,t=e.spatialReference),!(0,s.isValid)(t)||!(0,s.isValid)(n)||(0,s.equals)(t,n))return e;if((0,l.canProject)(t,n)){const t=(0,s.isWebMercator)(n)?y(e):f(e);return t.spatialReference=n,t}return(0,o.projectMany)(a.jsonAdapter,[e],t,n,null,r)[0]}const g=new class{async push(e,t,n){if(!e||!e.length||!t||!n||(0,s.equals)(t,n))return e;const r={geometries:e,inSpatialReference:t,outSpatialReference:n,resolve:null};return this._jobs.push(r),new Promise((e=>{r.resolve=e,null===this._timer&&(this._timer=setTimeout(this._process,10))}))}_process(){this._timer=null;const e=this._jobs.shift();if(!e)return;const{geometries:t,inSpatialReference:n,outSpatialReference:r,resolve:i}=e;(0,l.canProject)(n,r)?(0,s.isWebMercator)(r)?i(t.map(y)):i(t.map(f)):i((0,o.projectMany)(a.jsonAdapter,t,n,r,null,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}constructor(){this._jobs=[],this._timer=null,this._process=this._process.bind(this)}};function _(e,t,n){return g.push(e,t,n)}})),t.register("jGyUI",(function(t,n){e(t.exports,"jsonAdapter",(function(){return r}));const r={convertToGEGeometry:function(e,t){return null==t?null:e.convertJSONToGeometry(t)},exportPoint:function(e,t,n){const r=new i(e.getPointX(t),e.getPointY(t),n),o=e.hasZ(t),a=e.hasM(t);return o&&(r.z=e.getPointZ(t)),a&&(r.m=e.getPointM(t)),r},exportPolygon:function(e,t,n){return new o(e.exportPaths(t),n,e.hasZ(t),e.hasM(t))},exportPolyline:function(e,t,n){return new a(e.exportPaths(t),n,e.hasZ(t),e.hasM(t))},exportMultipoint:function(e,t,n){return new s(e.exportPoints(t),n,e.hasZ(t),e.hasM(t))},exportExtent:function(e,t,n){const r=e.hasZ(t),i=e.hasM(t),o=new l(e.getXMin(t),e.getYMin(t),e.getXMax(t),e.getYMax(t),n);if(r){const n=e.getZExtent(t);o.zmin=n.vmin,o.zmax=n.vmax}if(i){const n=e.getMExtent(t);o.mmin=n.vmin,o.mmax=n.vmax}return o}};class i{constructor(e,t,n){this.x=e,this.y=t,this.spatialReference=n,this.z=void 0,this.m=void 0}}class o{constructor(e,t,n,r){this.rings=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,n&&(this.hasZ=n),r&&(this.hasM=r)}}class a{constructor(e,t,n,r){this.paths=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,n&&(this.hasZ=n),r&&(this.hasM=r)}}class s{constructor(e,t,n,r){this.points=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,n&&(this.hasZ=n),r&&(this.hasM=r)}}class l{constructor(e,t,n,r,i){this.xmin=e,this.ymin=t,this.xmax=n,this.ymax=r,this.spatialReference=i,this.zmin=void 0,this.zmax=void 0,this.mmin=void 0,this.mmax=void 0}}})),t.register("iqALr",(function(e,n){e.exports=Promise.all([t("4WKyX")(t("aNJCr").getBundleURL("ayCdK")+t("iE7OH").resolve("9ESom")),t("4WKyX")(t("aNJCr").getBundleURL("ayCdK")+t("iE7OH").resolve("vg0wl"))]).then((()=>t("1n9JK")))})),t.register("dxhdj",(function(n,r){e(n.exports,"createDrawingInfo",(function(){return l})),e(n.exports,"createDefaultAttributesFunction",(function(){return d})),e(n.exports,"createDefaultTemplate",(function(){return c})),e(n.exports,"createCapabilities",(function(){return h}));var i=t("2VlWd"),o=t("flPLJ"),a=t("aNMpQ"),s=t("2iY9n");function l(e){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===e||"esriGeometryMultipoint"===e?s.defaultPointSymbolJSON:"esriGeometryPolyline"===e?s.defaultPolylineSymbolJSON:s.defaultPolygonSymbolJSON}}}const u=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let p=1;function d(e,t){if((0,i.default)("esri-csp-restrictions"))return()=>({[t]:null,...e});try{let n=`this.${t} = null;`;for(const t in e)n+=`this${u.test(t)?`.${t}`:`["${t}"]`} = ${JSON.stringify(e[t])};`;const r=new Function(`\n      return class AttributesClass$${p++} {\n        constructor() {\n          ${n};\n        }\n      }\n    `)();return()=>new r}catch(n){return()=>({[t]:null,...e})}}function c(e={}){return[{name:"New Feature",description:"",prototype:{attributes:(0,o.clone)(e)}}]}function h(e,t){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:e},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:t,supportsDelete:t,supportsEditing:t,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:t,supportsExceedsLimitStatistics:!0,supportsAsyncConvert3D:!1},query:a.queryCapabilities,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsGeometryUpdate:t,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsAsyncApplyEdits:!1}}}})),t.register("aNMpQ",(function(t,n){e(t.exports,"queryCapabilities",(function(){return r}));const r={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}})),t.register("k4dnL",(function(n,r){e(n.exports,"KnowledgeGraphSublayerBase",(function(){return l}));var i=t("7eJjO"),o=t("iho5X");t("iJAIC"),t("lNwWH"),t("2VlWd");var a=t("fcwIv");const s=(0,t("ko0sb").defineFieldProperties)(),l=e=>{let t=class extends e{constructor(){super(...arguments),this.fields=[],this.fieldsIndex=null}};return(0,i._)([(0,o.property)(s.fields)],t.prototype,"fields",void 0),(0,i._)([(0,o.property)(s.fieldsIndex)],t.prototype,"fieldsIndex",void 0),t=(0,i._)([(0,a.subclass)("esri.layers.knowledgeGraphLayer.KnowledgeGraphSublayerBase")],t),t}})),t.register("2H1WN",(function(n,r){e(n.exports,"load",(function(){return s})),e(n.exports,"NodeFlag",(function(){return l})),e(n.exports,"LCForceDirectedLayout",(function(){return d})),e(n.exports,"LCCommunityLayout",(function(){return c})),e(n.exports,"LCSimpleLayout",(function(){return h})),e(n.exports,"LCHierarchicalLayout",(function(){return y})),e(n.exports,"LCRadialTreeLayout",(function(){return f})),e(n.exports,"LCSmartTreeLayout",(function(){return m}));var i=t("i9j5X");let o,a=null;function s(){return o||(o=t("2RejT").then((e=>e.l)).then((({default:e})=>e({locateFile:e=>(0,i.getAssetUrl)(`esri/libs/linkchartlayout/${e}`)}))).then((e=>{!function(e){a=e}(e)})),o)}var l,u;function p(e,t,n,r,i,o){const s=n.length,l=i.length,u=Float64Array.BYTES_PER_ELEMENT,p=Uint32Array.BYTES_PER_ELEMENT,d=Uint8Array.BYTES_PER_ELEMENT,c=15+s*(d+2*u)+l*(2*p),h=a._malloc(c);try{const d=h+16-h%16,c=d+s*u,y=c+s*u,f=y+l*p,m=f+l*p,g=()=>[a.HEAPF64.subarray(d>>3,(d>>3)+s),a.HEAPF64.subarray(c>>3,(c>>3)+s),a.HEAPU32.subarray(y>>2,(y>>2)+l),a.HEAPU32.subarray(f>>2,(f>>2)+l),a.HEAPU8.subarray(m,m+s)],[_,v,I,x,b]=g();_.set(n),v.set(r),I.set(i),x.set(o),b.set(t);const w=e(s,m,d,c,l,y,f),[E,T,M,C,N]=g();return n.set(E),r.set(T),i.set(M),o.set(C),t.set(N),w}finally{a._free(h)}}(u=l||(l={}))[u.None=0]="None",u[u.IsMovable=1]="IsMovable",u[u.IsGeographic=2]="IsGeographic",u[u.IsRoot=4]="IsRoot";var d,c,h,y,f,m,g,_;!function(e){e.getMinIdealEdgeLength=function(){return a.getMinIdealEdgeLength()},e.apply=function(e,t,n,r,i,o=2,s=1,l=-1){return p(((e,t,n,r,i,u,p)=>a.applyForceDirectedLayout(e,t,n,r,i,u,p,o,s,l)),e,t,n,r,i)}}(d||(d={})),function(e){e.apply=function(e,t,n,r,i,o=2,s=1,l=-1){return p(((e,t,n,r,i,u,p)=>a.applyCommunityLayout(e,t,n,r,i,u,p,o,s,l)),e,t,n,r,i)}}(c||(c={})),function(e){e.apply=function(e,t,n,r,i){return p(a.applySimpleLayout,e,t,n,r,i)}}(h||(h={})),function(e){e.apply=function(e,t,n,r,i){return p(a.applyHierarchicalLayout,e,t,n,r,i)}}(y||(y={})),function(e){e.apply=function(e,t,n,r,i){return p(a.applyRadialTreeLayout,e,t,n,r,i)}}(f||(f={})),function(e){e.apply=function(e,t,n,r,i){return p(a.applySmartTreeLayout,e,t,n,r,i)}}(m||(m={})),function(e){e[e.Undirected=0]="Undirected",e[e.Directed=1]="Directed",e[e.Reversed=2]="Reversed"}(g||(g={})),function(e){e[e.ByCC_Raw=0]="ByCC_Raw",e[e.ByCC_NormalizeGlobally=1]="ByCC_NormalizeGlobally",e[e.ByCC_NormalizeByCC=2]="ByCC_NormalizeByCC"}(_||(_={}))})),t.register("2RejT",(function(e,n){e.exports=t("4WKyX")(t("aNJCr").getBundleURL("ayCdK")+t("iE7OH").resolve("6cP0R")).then((()=>t("gEORe")))})),t.register("ibKgR",(function(n,r){e(n.exports,"toQuantizationTransform",(function(){return l})),e(n.exports,"quantizePoint",(function(){return g})),e(n.exports,"quantizeGeometry",(function(){return I})),e(n.exports,"unquantizeMultipoint",(function(){return x})),e(n.exports,"unquantizePoint",(function(){return b})),e(n.exports,"unquantizePolygon",(function(){return w})),e(n.exports,"unquantizePolyline",(function(){return E}));var i=t("79LpT");const o=(e,t,n)=>[t,n],a=(e,t,n)=>[t,n,e[2]],s=(e,t,n)=>[t,n,e[2],e[3]];function l(e){return e?{originPosition:"upper-left"===e.originPosition?"upperLeft":"lower-left"===e.originPosition?"lowerLeft":e.originPosition,scale:e.tolerance?[e.tolerance,e.tolerance]:[1,1],translate:null!=e.extent?[e.extent.xmin,e.extent.ymax]:[0,0]}:null}function u({scale:e,translate:t},n){return Math.round((n-t[0])/e[0])}function p({scale:e,translate:t},n){return Math.round((t[1]-n)/e[1])}function d(e,t,n){const r=[];let i,o,a,s;for(let l=0;l<n.length;l++){const d=n[l];l>0?(a=u(e,d[0]),s=p(e,d[1]),a===i&&s===o||(r.push(t(d,a-i,s-o)),i=a,o=s)):(i=u(e,d[0]),o=p(e,d[1]),r.push(t(d,i,o)))}return r.length>0?r:null}function c({scale:e,translate:t},n){return n*e[0]+t[0]}function h({scale:e,translate:t},n){return t[1]-n*e[1]}function y(e,t,n){const r=new Array(n.length);if(!n.length)return r;const[i,o]=e.scale;let a=c(e,n[0][0]),s=h(e,n[0][1]);r[0]=t(n[0],a,s);for(let e=1;e<n.length;e++){const l=n[e];a+=l[0]*i,s-=l[1]*o,r[e]=t(l,a,s)}return r}function f(e,t,n){const r=new Array(n.length);for(let i=0;i<n.length;i++)r[i]=y(e,t,n[i]);return r}function m(e,t,n,r,i){var l;return t.points=null!==(l=function(e,t,n,r){return d(e,n?r?s:a:r?a:o,t)}(e,n.points,r,i))&&void 0!==l?l:[],t}function g(e,t,n,r,i){return t.x=u(e,n.x),t.y=p(e,n.y),t!==n&&(r&&(t.z=n.z),i&&(t.m=n.m)),t}function _(e,t,n,r,i){const l=function(e,t,n,r){const i=[],l=n?r?s:a:r?a:o;for(let n=0;n<t.length;n++){const r=d(e,l,t[n]);r&&r.length>=3&&i.push(r)}return i.length?i:null}(e,n.rings,r,i);return l?(t.rings=l,t):null}function v(e,t,n,r,i){const l=function(e,t,n,r){const i=[],l=n?r?s:a:r?a:o;for(let n=0;n<t.length;n++){const r=d(e,l,t[n]);r&&r.length>=2&&i.push(r)}return i.length?i:null}(e,n.paths,r,i);return l?(t.paths=l,t):null}function I(e,t){return e&&t?(0,i.isPoint)(t)?g(e,{},t,!1,!1):(0,i.isPolyline)(t)?v(e,{},t,!1,!1):(0,i.isPolygon)(t)?_(e,{},t,!1,!1):(0,i.isMultipoint)(t)?m(e,{},t,!1,!1):(0,i.isExtent)(t)?(a=!1,s=!1,(r={}).xmin=u(n=e,(o=t).xmin),r.ymin=p(n,o.ymin),r.xmax=u(n,o.xmax),r.ymax=p(n,o.ymax),r!==o&&(a&&(r.zmin=o.zmin,r.zmax=o.zmax),s&&(r.mmin=o.mmin,r.mmax=o.mmax)),r):null:null;var n,r,o,a,s}function x(e,t,n,r,i){return null!=n&&(t.points=function(e,t,n,r){return y(e,n?r?s:a:r?a:o,t)}(e,n.points,r,i)),t}function b(e,t,n,r,i){return null==n||(t.x=c(e,n.x),t.y=h(e,n.y),t!==n&&(r&&(t.z=n.z),i&&(t.m=n.m))),t}function w(e,t,n,r,i){return null!=n&&(t.rings=function(e,t,n,r){return f(e,n?r?s:a:r?a:o,t)}(e,n.rings,r,i)),t}function E(e,t,n,r,i){return null!=n&&(t.paths=function(e,t,n,r){return f(e,n?r?s:a:r?a:o,t)}(e,n.paths,r,i)),t}})),t.register("hbg1x",(function(n,r){e(n.exports,"processNullValue",(function(){return p})),e(n.exports,"isNullCountSupported",(function(){return d})),e(n.exports,"calculateStringStatistics",(function(){return c})),e(n.exports,"calculatePercentile",(function(){return y})),e(n.exports,"calculateStatistics",(function(){return h})),e(n.exports,"getAttributeComparator",(function(){return f})),e(n.exports,"processSummaryStatisticsResult",(function(){return v})),e(n.exports,"calculateUniqueValuesCount",(function(){return I})),e(n.exports,"createUVResult",(function(){return b})),e(n.exports,"getNormalizedValue",(function(){return w})),e(n.exports,"calculateClassBreaks",(function(){return E})),e(n.exports,"resolveCBResult",(function(){return T})),e(n.exports,"calculateHistogram",(function(){return M}));var i=t("59jTx"),o=t("hxmJW");const a="equal-interval",s=/\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi,l=new Set(["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]),u=["min","max","avg","stddev","count","sum","variance","nullcount","median"];function p(e){return null==e||"string"==typeof e&&!e?"<Null>":e}function d(e){const t=null!=e.normalizationField||null!=e.normalizationType,n=null!=e.minValue||null!=e.maxValue,r=!!e.sqlExpression&&e.supportsSQLExpression;return!t&&!n&&!r}function c(e){const t=e.returnDistinct?[...new Set(e.values)]:e.values,n=t.filter((e=>null!=e)).sort(),r=n.length,i={count:r,min:n[0],max:n[r-1]};return e.supportsNullCount&&(i.nullcount=t.length-r),e.percentileParams&&(i.median=y(t,e.percentileParams)),i}function h(e){const{values:t,useSampleStdDev:n,supportsNullCount:r}=e;let i=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,a=null,s=null,l=null,u=null,p=0;const d=null==e.minValue?-1/0:e.minValue,c=null==e.maxValue?1/0:e.maxValue;for(const e of t)Number.isFinite(e)?e>=d&&e<=c&&(a=null===a?e:a+e,i=Math.min(i,e),o=Math.max(o,e),p++):"string"==typeof e&&p++;if(p&&null!=a){s=a/p;let e=0;for(const n of t)Number.isFinite(n)&&n>=d&&n<=c&&(e+=(n-s)**2);u=n?p>1?e/(p-1):0:p>0?e/p:0,l=Math.sqrt(u)}else i=null,o=null;const h={avg:s,count:p,max:o,min:i,stddev:l,sum:a,variance:u};return r&&(h.nullcount=t.length-p),e.percentileParams&&(h.median=y(t,e.percentileParams)),h}function y(e,t){const{fieldType:n,value:r,orderBy:i,isDiscrete:o}=t,a=f(n,"desc"===i);if(0===(e=[...e].filter((e=>null!=e)).sort(((e,t)=>a(e,t)))).length)return null;if(r<=0)return e[0];if(r>=1)return e[e.length-1];const s=(e.length-1)*r,l=Math.floor(s),u=l+1,p=s%1,d=e[l],c=e[u];return u>=e.length||o||"string"==typeof d||"string"==typeof c?d:d*(1-p)+c*p}function f(e,t){const n=t?1:-1,r=function(e){return e?(e,t)=>{const n=m(e,t,!0);return null!=n?n:t-e}:(e,t)=>{const n=m(e,t,!1);return null!=n?n:e-t}}(t),i=g(t);if(!e||!["esriFieldTypeDate","esriFieldTypeString","esriFieldTypeGUID","esriFieldTypeGlobalID",...l].includes(e))return(e,t)=>"number"==typeof e&&"number"==typeof t?r(e,t):"string"==typeof e&&"string"==typeof t?i(e,t):n;if("esriFieldTypeDate"===e)return(e,t)=>{const i=new Date(e).getTime(),o=new Date(t).getTime();return isNaN(i)||isNaN(o)?n:r(i,o)};if(l.has(e))return(e,t)=>r(e,t);if("esriFieldTypeString"===e)return(e,t)=>i(e,t);if("esriFieldTypeGUID"===e||"esriFieldTypeGlobalID"===e){const e=g(t);return(t,n)=>e(_(t),_(n))}return t?(e,t)=>1:(e,t)=>-1}function m(e,t,n){if(n){if(null==e)return null==t?0:1;if(null==t)return-1}else{if(null==e)return null==t?0:-1;if(null==t)return 1}return null}function g(e){return e?(e,t)=>{const n=m(e,t,!0);return null!=n?n:(e=e.toUpperCase())>(t=t.toUpperCase())?-1:e<t?1:0}:(e,t)=>{const n=m(e,t,!1);return null!=n?n:(e=e.toUpperCase())<(t=t.toUpperCase())?-1:e>t?1:0}}function _(e){return e.substr(24,12)+e.substr(19,4)+e.substr(16,2)+e.substr(14,2)+e.substr(11,2)+e.substr(9,2)+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)+e.substr(0,2)}function v(e,t){let n;for(n in e)u.includes(n)&&(Number.isFinite(e[n])||(e[n]=null));return t?(["avg","stddev","variance"].forEach((t=>{var n;null!=e[t]&&(e[t]=Math.ceil(null!==(n=e[t])&&void 0!==n?n:0))})),e):e}function I(e){const t={};for(let n of e)(null==n||"string"==typeof n&&""===n.trim())&&(n=null),null==t[n]?t[n]={count:1,data:n}:t[n].count++;return{count:t}}function x(e){return"coded-value"!==(null==e?void 0:e.type)?[]:e.codedValues.map((e=>e.code))}function b(e,t,n,r){const i=e.count,o=[];if(n&&t){const e=[],n=x(t[0]);for(const i of n)if(t[1]){const n=x(t[1]);for(const o of n)if(t[2]){const n=x(t[2]);for(const t of n)e.push(`${p(i)}${r}${p(o)}${r}${p(t)}`)}else e.push(`${p(i)}${r}${p(o)}`)}else e.push(i);for(const t of e)i.hasOwnProperty(t)||(i[t]={data:t,count:0})}for(const e in i){const t=i[e];o.push({value:t.data,count:t.count,label:t.label})}return{uniqueValueInfos:o}}function w(e,t,n,r){let i=null;switch(t){case"log":0!==e&&(i=Math.log(e)*Math.LOG10E);break;case"percent-of-total":Number.isFinite(r)&&0!==r&&(i=e/r*100);break;case"field":Number.isFinite(n)&&0!==n&&(i=e/n);break;case"natural-log":e>0&&(i=Math.log(e));break;case"square-root":e>0&&(i=e**.5)}return i}function E(e,t){const n=function(e){const{breakCount:t,field:n,normalizationField:r,normalizationType:o}=e,s=e.classificationMethod||a,l="standard-deviation"===s?e.standardDeviationInterval||1:void 0;return new(0,i.default)({breakCount:t,classificationField:n,classificationMethod:s,normalizationField:"field"===o?r:void 0,normalizationType:o,standardDeviationInterval:l})}({field:t.field,normalizationType:t.normalizationType,normalizationField:t.normalizationField,classificationMethod:t.classificationMethod,standardDeviationInterval:t.standardDeviationInterval,breakCount:t.numClasses||5});return e=function(e,t,n){const r=null!=t?t:-1/0,i=null!=n?n:1/0;return e.filter((e=>Number.isFinite(e)&&e>=r&&e<=i))}(e,t.minValue,t.maxValue),(0,o.createGenerateRendererClassBreaks)({definition:n,values:e,normalizationTotal:t.normalizationTotal})}function T(e,t){var n,r;let i=e.classBreaks;const o=i.length,a=null===(n=i[0])||void 0===n?void 0:n.minValue,l=null===(r=i[o-1])||void 0===r?void 0:r.maxValue,u="standard-deviation"===t,p=s;return i=i.map((e=>{const t=e.label,n={minValue:e.minValue,maxValue:e.maxValue,label:t};if(u&&t){var r;const e=t.match(p),i=null!==(r=null==e?void 0:e.map((e=>+e.trim())))&&void 0!==r?r:[];2===i.length?(n.minStdDev=i[0],n.maxStdDev=i[1],i[0]<0&&i[1]>0&&(n.hasAvg=!0)):1===i.length&&(t.includes("<")?(n.minStdDev=null,n.maxStdDev=i[0]):t.includes(">")&&(n.minStdDev=i[0],n.maxStdDev=null))}return n})),{minValue:a,maxValue:l,classBreakInfos:i,normalizationTotal:e.normalizationTotal}}function M(e,t){const n=function(e,t){const{field:n,classificationMethod:r,standardDeviationInterval:i,normalizationType:o,normalizationField:a,normalizationTotal:s,minValue:l,maxValue:u}=t,p=t.numBins||10;let c=null,y=null,f=null;if(r&&"equal-interval"!==r||o){const{classBreaks:t}=E(e,{field:n,normalizationType:o,normalizationField:a,normalizationTotal:s,classificationMethod:r,standardDeviationInterval:i,minValue:l,maxValue:u,numClasses:p});c=t[0].minValue,y=t[t.length-1].maxValue,f=t.map((e=>[e.minValue,e.maxValue]))}else{if(null!=l&&null!=u)c=l,y=u;else{const t=h({values:e,minValue:l,maxValue:u,useSampleStdDev:!o,supportsNullCount:d({normalizationType:o,normalizationField:a,minValue:l,maxValue:u})});var m,g;c=null!==(m=t.min)&&void 0!==m?m:null,y=null!==(g=t.max)&&void 0!==g?g:null}f=function(e,t,n){const r=(t-e)/n,i=[];let o,a=e;for(let e=1;e<=n;e++)o=a+r,o=Number(o.toFixed(16)),i.push([a,e===n?t:o]),a=o;return i}(null!=c?c:0,null!=y?y:0,p)}return{min:c,max:y,intervals:f}}(e,t);if(null==n.min&&null==n.max)return{bins:[],minValue:n.min,maxValue:n.max,normalizationTotal:t.normalizationTotal};var r,i;const o=n.intervals,a=null!==(r=n.min)&&void 0!==r?r:0,s=null!==(i=n.max)&&void 0!==i?i:0,l=o.map(((e,t)=>({minValue:o[t][0],maxValue:o[t][1],count:0})));for(const t of e)if(null!=t&&t>=a&&t<=s){const e=C(o,t);e>-1&&l[e].count++}return{bins:l,minValue:a,maxValue:s,normalizationTotal:t.normalizationTotal}}function C(e,t){let n=-1;for(let r=e.length-1;r>=0;r--)if(t>=e[r][0]){n=r;break}return n}})),t.register("59jTx",(function(n,r){e(n.exports,"default",(function(){return h}));var i=t("7eJjO"),o=t("79ASa"),a=t("1XAcN"),s=t("iho5X");t("iJAIC"),t("lNwWH"),t("2VlWd");var l=t("bSafx"),u=t("fcwIv");const p=new(0,o.JSONMap)({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"}),d=new(0,o.JSONMap)({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});let c=class extends a.JSONSupport{set standardDeviationInterval(e){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",e)}set definedInterval(e){"defined-interval"===this.classificationMethod&&this._set("definedInterval",e)}constructor(e){super(e),this.type="class-breaks-definition",this.breakCount=null,this.classificationField=null,this.classificationMethod=null,this.normalizationField=null,this.normalizationType=null}};(0,i._)([(0,l.enumeration)({classBreaksDef:"class-breaks-definition"})],c.prototype,"type",void 0),(0,i._)([(0,s.property)({json:{write:!0}})],c.prototype,"breakCount",void 0),(0,i._)([(0,s.property)({json:{write:!0}})],c.prototype,"classificationField",void 0),(0,i._)([(0,s.property)({type:String,json:{read:p.read,write:p.write}})],c.prototype,"classificationMethod",void 0),(0,i._)([(0,s.property)({json:{write:!0}})],c.prototype,"normalizationField",void 0),(0,i._)([(0,s.property)({json:{read:d.read,write:d.write}})],c.prototype,"normalizationType",void 0),(0,i._)([(0,s.property)({value:null,json:{write:!0}})],c.prototype,"standardDeviationInterval",null),(0,i._)([(0,s.property)({value:null,json:{write:!0}})],c.prototype,"definedInterval",null),c=(0,i._)([(0,u.subclass)("esri.rest.support.ClassBreaksDefinition")],c);const h=c})),t.register("hxmJW",(function(n,r){e(n.exports,"createGenerateRendererClassBreaks",(function(){return a}));const i=t("jHOLN").default.getLogger("esri.rest.support.generateRendererUtils");function o(e,t){return Number(e.toFixed(t))}function a(e){const{normalizationTotal:t}=e;return{classBreaks:s(e),normalizationTotal:t}}function s(e){var t;const n=e.definition,{classificationMethod:r,normalizationType:i,definedInterval:a}=n,s=null!==(t=n.breakCount)&&void 0!==t?t:1,c=[];let h=e.values;if(0===h.length)return[];h=h.sort(((e,t)=>e-t));const y=h[0],f=h[h.length-1];if("equal-interval"===r)if(h.length>=s){const e=(f-y)/s;let t=y;for(let n=1;n<s;n++){const r=o(y+n*e,6);c.push({minValue:t,maxValue:r,label:l(t,r,i)}),t=r}c.push({minValue:t,maxValue:f,label:l(t,f,i)})}else h.forEach((e=>{c.push({minValue:e,maxValue:e,label:l(e,e,i)})}));else if("natural-breaks"===r){const t=u(h),n=e.valueFrequency||t.valueFrequency,r=function(e,t,n){const r=e.length,i=[];n>r&&(n=r);for(let e=0;e<n;e++)i.push(Math.round(e*r/n-1));i.push(r-1);let o=p(i,e,t,n);return function(e,t,n,r,i,o){let a=0,s=0,l=0,u=0,p=!0;for(let c=0;c<2&&p;c++){0===c&&(p=!1);for(let c=0;c<o-1;c++)for(;n[c+1]+1!==n[c+2];){n[c+1]=n[c+1]+1;const o=d(c,n,r,i);l=o.sbMean,a=o.sbSdcm;const h=d(c+1,n,r,i);if(u=h.sbMean,s=h.sbSdcm,!(a+s<t[c]+t[c+1])){n[c+1]=n[c+1]-1;break}t[c]=a,t[c+1]=s,e[c]=l,e[c+1]=u,p=!0}for(let c=o-1;c>0;c--)for(;n[c]!==n[c-1]+1;){n[c]=n[c]-1;const o=d(c-1,n,r,i);l=o.sbMean,a=o.sbSdcm;const h=d(c,n,r,i);if(u=h.sbMean,s=h.sbSdcm,!(a+s<t[c-1]+t[c])){n[c]=n[c]+1;break}t[c-1]=a,t[c]=s,e[c-1]=l,e[c]=u,p=!0}}return p}(o.mean,o.sdcm,i,e,t,n)&&(o=p(i,e,t,n)),i}(t.uniqueValues,n,s);let a=y;for(let e=1;e<s;e++)if(t.uniqueValues.length>e){const n=o(t.uniqueValues[r[e]],6);c.push({minValue:a,maxValue:n,label:l(a,n,i)}),a=n}c.push({minValue:a,maxValue:f,label:l(a,f,i)})}else if("quantile"===r)if(h.length>=s&&y!==f){let e=y,t=Math.ceil(h.length/s),n=0;for(let r=1;r<s;r++){let o=t+n-1;o>h.length&&(o=h.length-1),o<0&&(o=0),c.push({minValue:e,maxValue:h[o],label:l(e,h[o],i)}),e=h[o],n+=t,t=Math.ceil((h.length-n)/(s-r))}c.push({minValue:e,maxValue:f,label:l(e,f,i)})}else{let e=-1;for(let t=0;t<h.length;t++){const n=h[t];n!==e&&(e=n,c.push({minValue:e,maxValue:n,label:l(e,n,i)}),e=n)}}else if("standard-deviation"===r){const e=function(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n];return t/=e.length,t}(h),t=function(e,t){let n=0;for(let r=0;r<e.length;r++){const i=e[r];n+=(i-t)*(i-t)}return n/=e.length,Math.sqrt(n)}(h,e);if(0===t)c.push({minValue:h[0],maxValue:h[0],label:l(h[0],h[0],i)});else{const n=function(e,t,n,r,i){let o=Math.max(r-e,t-r)/i/n;return o=o>=1?1:o>=.5?.5:.25,o}(y,f,s,e,t)*t;let r=0,a=y;for(let t=s;t>=1;t--){const s=o(e-(t-.5)*n,6);c.push({minValue:a,maxValue:s,label:l(a,s,i)}),a=s,r++}let u=o(e+.5*n,6);c.push({minValue:a,maxValue:u,label:l(a,u,i)}),a=u,r++;for(let t=1;t<=s;t++)u=r===2*s?f:o(e+(t+.5)*n,6),c.push({minValue:a,maxValue:u,label:l(a,u,i)}),a=u,r++}}else if("defined-interval"===r){if(!a)return c;const e=h[0],t=h[h.length-1],n=Math.ceil((t-e)/a);let r=e;for(let t=1;t<n;t++){const n=o(e+t*a,6);c.push({minValue:r,maxValue:n,label:l(r,n,i)}),r=n}c.push({minValue:r,maxValue:t,label:l(r,t,i)})}return c}function l(e,t,n){let r=null;return r=e===t?n&&"percent-of-total"===n?e+"%":e.toString():n&&"percent-of-total"===n?e+"% - "+t+"%":e+" - "+t,r}function u(e){const t=[],n=[];let r=Number.MIN_VALUE,i=1,o=-1;for(let a=0;a<e.length;a++){const s=e[a];s===r?(i++,n[o]=i):null!==s&&(t.push(s),r=s,i=1,n.push(i),o++)}return{uniqueValues:t,valueFrequency:n}}function p(e,t,n,r){let i=[],o=[],a=[],s=0;const l=[],u=[];for(let i=0;i<r;i++){const r=d(i,e,t,n);l.push(r.sbMean),u.push(r.sbSdcm),s+=u[i]}let p,c=s,h=!0;for(;h||s<c;){h=!1,i=[];for(let t=0;t<r;t++)i.push(e[t]);for(let n=0;n<r;n++)for(let i=e[n]+1;i<=e[n+1];i++)if(p=t[i],n>0&&i!==e[n+1]&&Math.abs(p-l[n])>Math.abs(p-l[n-1]))e[n]=i;else if(n<r-1&&e[n]!==i-1&&Math.abs(p-l[n])>Math.abs(p-l[n+1])){e[n+1]=i-1;break}c=s,s=0,o=[],a=[];for(let i=0;i<r;i++){o.push(l[i]),a.push(u[i]);const r=d(i,e,t,n);l[i]=r.sbMean,u[i]=r.sbSdcm,s+=u[i]}}if(s>c){for(let t=0;t<r;t++)e[t]=i[t],l[t]=o[t],u[t]=a[t];s=c}return{mean:l,sdcm:u}}function d(e,t,n,r){let o=0,a=0;for(let i=t[e]+1;i<=t[e+1];i++){const e=r[i];o+=n[i]*e,a+=e}a<=0&&i.warn("Exception in Natural Breaks calculation");const s=o/a;let l=0;for(let i=t[e]+1;i<=t[e+1];i++)l+=r[i]*(n[i]-s)**2;return{sbMean:s,sbSdcm:l}}})),t.register("iNIOS",(function(n,r){e(n.exports,"getSpatialQueryOperator",(function(){return v})),e(n.exports,"checkSpatialQuerySupport",(function(){return I})),e(n.exports,"canQueryWithRBush",(function(){return x}));var i=t("kyj08"),o=t("8Iadx"),a=t("1ILI6"),s=t("79LpT"),l=t("eY5Yp"),u=t("4idof"),p=t("akQYU"),d=t("awxBI"),c=t("fP7bp"),h=t("emniL");const y="feature-store:unsupported-query",f={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},m={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},g={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},_={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};function v(e,n,r,i,l){if((0,s.isPolygon)(n)&&"esriGeometryPoint"===r&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e)){const e=(0,p.convertFromPolygon)(new(0,d.default),n,!1,!1);return Promise.resolve((t=>(0,u.polygonContainsPoint)(e,!1,!1,t)))}if((0,s.isPolygon)(n)&&"esriGeometryMultipoint"===r){const t=(0,p.convertFromPolygon)(new(0,d.default),n,!1,!1);if("esriSpatialRelContains"===e)return Promise.resolve((e=>(0,u.polygonContainsMultipoint)(t,!1,!1,e,i,l)))}if((0,s.isExtent)(n)&&"esriGeometryPoint"===r&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e))return Promise.resolve((e=>(0,o.extentContainsPoint)(n,(0,h.getGeometry)(r,i,l,e))));if((0,s.isExtent)(n)&&"esriGeometryMultipoint"===r&&"esriSpatialRelContains"===e)return Promise.resolve((e=>(0,o.extentContainsMultipoint)(n,(0,h.getGeometry)(r,i,l,e))));if((0,s.isExtent)(n)&&"esriSpatialRelIntersects"===e){const e=(0,a.getExtentIntersector)(r);return Promise.resolve((t=>e(n,(0,h.getGeometry)(r,i,l,t))))}return t("iqALr").then((t=>{const o=t[f[e]].bind(null,n.spatialReference,n);return e=>o((0,h.getGeometry)(r,i,l,e))}))}async function I(e,t,n){const{spatialRel:r,geometry:o}=e;if(o){if(null==(a=r)||!0!==m[a])throw new(0,i.default)(y,"Unsupported query spatial relationship",{query:e});if((0,l.isValid)(o.spatialReference)&&(0,l.isValid)(n)){if(!function(e){return null!=e&&!0===g[(0,s.getJsonType)(e)]}(o))throw new(0,i.default)(y,"Unsupported query geometry type",{query:e});if(!function(e){return null!=e&&!0===_[e]}(t))throw new(0,i.default)(y,"Unsupported layer geometry type",{query:e});if(e.outSR)return(0,c.checkProjectionSupport)(e.geometry&&e.geometry.spatialReference,e.outSR)}}var a}function x(e){if((0,s.isExtent)(e))return!0;if((0,s.isPolygon)(e)){for(const t of e.rings){if(5!==t.length)return!1;if(t[0][0]!==t[1][0]||t[0][0]!==t[4][0]||t[2][0]!==t[3][0]||t[0][1]!==t[3][1]||t[0][1]!==t[4][1]||t[1][1]!==t[2][1])return!1}return!0}return!1}})),t.register("1ILI6",(function(n,r){e(n.exports,"getExtentIntersector",(function(){return o}));var i=t("80GBQ");i=t("80GBQ");function o(e){return"mesh"===e?i.extentIntersectsExtent:(0,i.getFeatureExtentIntersector)(e)}})),t.register("4idof",(function(t,n){function r(e,t){return e?t?4:3:t?3:2}function i(e,t,n,r){return a(e,t,n,r.coords[0],r.coords[1])}function o(e,t,n,i,o,s){const l=r(o,s),{coords:u,lengths:p}=i;if(!p)return!1;for(let r=0,i=0;r<p.length;r++,i+=l)if(!a(e,t,n,u[i],u[i+1]))return!1;return!0}function a(e,t,n,i,o){if(!e)return!1;const a=r(t,n),{coords:l,lengths:u}=e;let p=!1,d=0;for(const e of u)p=s(p,l,a,d,e,i,o),d+=e*a;return p}function s(e,t,n,r,i,o,a){let s=e,l=r;for(let e=r,u=r+i*n;e<u;e+=n){l=e+n,l===u&&(l=r);const i=t[e],p=t[e+1],d=t[l],c=t[l+1];(p<a&&c>=a||c<a&&p>=a)&&i+(a-p)/(c-p)*(d-i)<o&&(s=!s)}return s}e(t.exports,"polygonContainsPoint",(function(){return i})),e(t.exports,"polygonContainsMultipoint",(function(){return o}))})),t.register("17eId",(function(t,n){async function r(e,t){if(!e)return null;const n=t.featureAdapter,{startTimeField:r,endTimeField:i}=e;let o=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY;if(r&&i)await t.forEach((e=>{const t=n.getAttribute(e,r),s=n.getAttribute(e,i);null==t||isNaN(t)||(o=Math.min(o,t)),null==s||isNaN(s)||(a=Math.max(a,s))}));else{const e=r||i;await t.forEach((t=>{const r=n.getAttribute(t,e);null==r||isNaN(r)||(o=Math.min(o,r),a=Math.max(a,r))}))}return{start:o,end:a}}function i(e,t,n){if(!t||!e)return null;const{startTimeField:r,endTimeField:i}=e;if(!r&&!i)return null;const{start:o,end:a}=t;return null===o&&null===a?null:void 0===o&&void 0===a?()=>!1:r&&i?function(e,t,n,r,i){return null!=r&&null!=i?o=>{const a=e.getAttribute(o,t),s=e.getAttribute(o,n);return(null==a||a<=i)&&(null==s||s>=r)}:null!=r?t=>{const i=e.getAttribute(t,n);return null==i||i>=r}:null!=i?n=>{const r=e.getAttribute(n,t);return null==r||r<=i}:void 0}(n,r,i,o,a):function(e,t,n,r){return null!=n&&null!=r&&n===r?r=>e.getAttribute(r,t)===n:null!=n&&null!=r?i=>{const o=e.getAttribute(i,t);return o>=n&&o<=r}:null!=n?r=>e.getAttribute(r,t)>=n:null!=r?n=>e.getAttribute(n,t)<=r:void 0}(n,r||i,o,a)}e(t.exports,"getTimeExtent",(function(){return r})),e(t.exports,"getTimeOperator",(function(){return i}))}))}();
//# sourceMappingURL=LinkChartLayer.819903c4.js.map
