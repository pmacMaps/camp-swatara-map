function e(e,t,r,s){Object.defineProperty(e,t,{get:r,set:s,enumerable:!0,configurable:!0})}var t=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire594f;t.register("2WFES",(function(r,s){var o;o=r.exports,Object.defineProperty(o,"__esModule",{value:!0,configurable:!0}),e(r.exports,"default",(function(){return u}));var i=t("j6uz9");t("6TszD"),t("gHCNy"),t("aX9sh"),t("5HTPH"),t("bXKTN");var a=t("qA6zg"),n=t("7K6so"),l=t("5vbdy");let p=class extends l.default{solve(e,t){return(0,n.solve)(this.url,e,t)}constructor(e){super(e)}};p=(0,i._)([(0,a.subclass)("esri.tasks.RouteTask")],p);const u=p})),t.register("7K6so",(function(r,s){e(r.exports,"solve",(function(){return f}));var o=t("bYA0c"),i=t("1CpCt"),a=t("iABKu"),n=t("hq5aB"),l=t("fll9c"),p=t("dgLSf"),u=t("9aPyL");const c=(0,a.createQueryParamsHelper)({accumulateAttributes:{name:"accumulateAttributeNames"},attributeParameterValues:!0,directionsTimeAttribute:{name:"directionsTimeAttributeName"},impedanceAttribute:{name:"impedanceAttributeName"},outSpatialReference:{name:"outSR",getter:e=>e.outSpatialReference.wkid},pointBarriers:{name:"barriers"},polylineBarriers:!0,polygonBarriers:!0,restrictionAttributes:{name:"restrictionAttributeNames"},stops:!0,travelMode:!0});function y(e){return"esri.rest.support.FeatureSet"===(null==e?void 0:e.declaredClass)}async function f(e,t,r){const s=[],a=[],f={},d={},g=(0,p.parseUrl)(e),{path:m}=g;y(t.stops)&&(0,l.collectGeometries)(t.stops.features,a,"stops.features",f),y(t.pointBarriers)&&(0,l.collectGeometries)(t.pointBarriers.features,a,"pointBarriers.features",f),y(t.polylineBarriers)&&(0,l.collectGeometries)(t.polylineBarriers.features,a,"polylineBarriers.features",f),y(t.polygonBarriers)&&(0,l.collectGeometries)(t.polygonBarriers.features,a,"polygonBarriers.features",f);const h=await(0,n.normalizeCentralMeridian)(a);for(const e in f){const t=f[e];s.push(e),d[e]=h.slice(t[0],t[1])}if((0,l.isInputGeometryZAware)(d,s)){let e=null;try{e=await(0,l.fetchServiceDescription)(m,t.apiKey,r)}catch{}e&&!e.hasZ&&(0,l.dropZValuesOffInputGeometry)(d,s)}for(const e in d)d[e].forEach(((r,s)=>{t.get(e)[s].geometry=r}));const v={...r,query:{...g.query,...c.toQueryParams(t),f:"json"}},b=m.endsWith("/solve")?m:`${m}/solve`,{data:T}=await(0,o.default)(b,v);return function(e){var t,r,s,o,a;const n=new Map,{directionLines:l,directionPoints:p,directions:c,routes:y,stops:f,barriers:d,polygonBarriers:g,polylineBarriers:m,messages:h}=e,v=null!=(t=null!=(r=null!=(s=null!=(o=null==y?void 0:y.spatialReference)?o:null==f?void 0:f.spatialReference)?s:null==d?void 0:d.spatialReference)?r:null==g?void 0:g.spatialReference)?t:null==m?void 0:m.spatialReference;null==y||y.features.forEach((e=>{const t=e.attributes.Name,r=e.attributes.ObjectID;n.has(t)?(n.get(t).route=e,n.get(t).routeId=r):n.set(t,{route:e,routeId:r,routeName:t}),(0,i.isSome)(e.geometry)&&(e.geometry.spatialReference=v)})),null==c||c.forEach((e=>{const t=e.routeName;n.has(t)?n.get(t).directions=e:n.set(t,{routeName:t,directions:e})})),null==f||f.features.forEach((e=>{var t;const r=null!=(t=e.attributes.RouteName)?t:null;n.has(r)?n.get(r).stops?n.get(r).stops.push(e):n.get(r).stops=[e]:n.set(r,{stops:[e],routeName:r}),(0,i.isSome)(e.geometry)&&(e.geometry.spatialReference=v)}));const b=null==(a=null==f?void 0:f.features.every((e=>null==e.attributes.RouteName)))||a;if((null==f?void 0:f.features.length)>0&&b){const e=Array.from(n.keys())[0];n.get(e).stops=n.get(null).stops,n.delete(null)}null==l||l.features.forEach((e=>{var t;const r=e.attributes.RouteID,s=null==(t=Array.from(n.values()).find((e=>e.routeId===r)))?void 0:t.routeName;if(s)if(n.has(s))if(n.get(s).directionLines)n.get(s).directionLines.features.push(e);else{const{fieldAliases:t,geometryType:r,spatialReference:o}=l;n.get(s).directionLines={features:[e],fieldAliases:t,geometryType:r,spatialReference:o}}else{const{fieldAliases:t,geometryType:r,spatialReference:o}=l;n.set(s,{routeName:s,directionLines:{features:[e],fieldAliases:t,geometryType:r,spatialReference:o}})}})),null==p||p.features.forEach((e=>{var t;const r=e.attributes.RouteID,s=null==(t=Array.from(n.values()).find((e=>e.routeId===r)))?void 0:t.routeName;if(s)if(n.has(s))if(n.get(s).directionPoints)n.get(s).directionPoints.features.push(e);else{const{fieldAliases:t,geometryType:r,spatialReference:o}=p;n.get(s).directionPoints={features:[e],fieldAliases:t,geometryType:r,spatialReference:o}}else{const{fieldAliases:t,geometryType:r,spatialReference:o}=p;n.set(s,{routeName:s,directionPoints:{features:[e],fieldAliases:t,geometryType:r,spatialReference:o}})}}));const T=Array.from(n.values());return u.default.fromJSON({routeResults:T,barriers:d,polygonBarriers:g,polylineBarriers:m,messages:h})}(T)}})),t.register("9aPyL",(function(r,s){e(r.exports,"default",(function(){return g}));var o=t("j6uz9"),i=t("EvxpF"),a=t("hO0an"),n=t("hTI69");t("aX9sh"),t("5HTPH"),t("gHCNy");var l=t("bzBbJ"),p=t("qA6zg"),u=t("gEU1A"),c=t("49m8k"),y=t("jP6rT");function f(e){return e&&u.default.fromJSON(e).features.map((e=>e))}let d=class extends a.JSONSupport{readPointBarriers(e,t){return f(t.barriers)}readPolylineBarriers(e){return f(e)}readPolygonBarriers(e){return f(e)}constructor(e){super(e),this.messages=null,this.pointBarriers=null,this.polylineBarriers=null,this.polygonBarriers=null,this.routeResults=null}};(0,o._)([(0,n.property)({type:[c.default]})],d.prototype,"messages",void 0),(0,o._)([(0,n.property)({type:[i.default]})],d.prototype,"pointBarriers",void 0),(0,o._)([(0,l.reader)("pointBarriers",["barriers"])],d.prototype,"readPointBarriers",null),(0,o._)([(0,n.property)({type:[i.default]})],d.prototype,"polylineBarriers",void 0),(0,o._)([(0,l.reader)("polylineBarriers")],d.prototype,"readPolylineBarriers",null),(0,o._)([(0,n.property)({type:[i.default]})],d.prototype,"polygonBarriers",void 0),(0,o._)([(0,l.reader)("polygonBarriers")],d.prototype,"readPolygonBarriers",null),(0,o._)([(0,n.property)({type:[y.default]})],d.prototype,"routeResults",void 0),d=(0,o._)([(0,p.subclass)("esri.rest.support.RouteSolveResult")],d);const g=d})),t.register("jP6rT",(function(r,s){e(r.exports,"default",(function(){return y}));var o=t("j6uz9"),i=t("EvxpF"),a=t("hO0an"),n=t("hTI69");t("aX9sh"),t("5HTPH"),t("gHCNy");var l=t("qA6zg"),p=t("6gwJM"),u=t("gEU1A");let c=class extends a.JSONSupport{constructor(e){super(e),this.directionLines=null,this.directionPoints=null,this.directions=null,this.route=null,this.routeName=null,this.stops=null}};(0,o._)([(0,n.property)({type:u.default,json:{write:!0}})],c.prototype,"directionLines",void 0),(0,o._)([(0,n.property)({type:u.default,json:{write:!0}})],c.prototype,"directionPoints",void 0),(0,o._)([(0,n.property)({type:p.default,json:{write:!0}})],c.prototype,"directions",void 0),(0,o._)([(0,n.property)({type:i.default,json:{write:!0}})],c.prototype,"route",void 0),(0,o._)([(0,n.property)({type:String,json:{write:!0}})],c.prototype,"routeName",void 0),(0,o._)([(0,n.property)({type:[i.default],json:{write:!0}})],c.prototype,"stops",void 0),c=(0,o._)([(0,l.subclass)("esri.rest.support.RouteResult")],c);const y=c})),t.register("6gwJM",(function(r,s){e(r.exports,"default",(function(){return m}));var o=t("j6uz9");t("ixrNB");var i=t("1CpCt"),a=t("hTI69");t("aX9sh"),t("5HTPH"),t("gHCNy");var n=t("bzBbJ"),l=t("qA6zg"),p=t("2iIEs"),u=t("gEU1A"),c=t("2WnyR"),y=t("jaaCV"),f=t("7blCc"),d=t("dZxPT");let g=class extends u.default{readFeatures(e,t){var r;if(!e)return[];const s=null!=(r=t.summary.envelope.spatialReference)?r:t.spatialReference,o=s&&y.default.fromJSON(s);return e.map((e=>{var t,r;const s=this._decompressGeometry(e.compressedGeometry),i=new(0,f.default)({...s,spatialReference:o}),a=null!=(t=null==(r=e.events)?void 0:r.map((e=>{const{arriveTimeUTC:t,ETA:r,point:{x:s,y:i,z:a},strings:n}=e;return new(0,p.default)({geometry:new(0,d.default)({x:s,y:i,z:a,hasZ:void 0!==a,spatialReference:o}),attributes:{ETA:r,arriveTimeUTC:t},strings:n})})))?t:[];return new(0,p.default)({attributes:e.attributes,events:a,geometry:i,strings:e.strings})}))}get mergedGeometry(){if(!this.features)return null;const e=this.features.map((({geometry:e})=>(0,i.unwrap)(e))),t=this.get("extent.spatialReference");return this._mergePolylinesToSinglePath(e,t)}get strings(){return this.features.map((({strings:e})=>e))}_decompressGeometry(e){let t=0,r=0,s=0,o=0;const i=[];let a,n,l,p,u,c,y,f,d=0,g=0,m=0;if(u=e.match(/((\+|\-)[^\+\-\|]+|\|)/g),u||(u=[]),0===parseInt(u[d],32)){d=2;const e=parseInt(u[d],32);d++,c=parseInt(u[d],32),d++,1&e&&(g=u.indexOf("|")+1,y=parseInt(u[g],32),g++),2&e&&(m=u.indexOf("|",g)+1,f=parseInt(u[m],32),m++)}else c=parseInt(u[d],32),d++;for(;d<u.length&&"|"!==u[d];){a=parseInt(u[d],32)+t,d++,t=a,n=parseInt(u[d],32)+r,d++,r=n;const e=[a/c,n/c];g&&(p=parseInt(u[g],32)+s,g++,s=p,e.push(p/y)),m&&(l=parseInt(u[m],32)+o,m++,o=l,e.push(l/f)),i.push(e)}return{paths:[i],hasZ:g>0,hasM:m>0}}_mergePolylinesToSinglePath(e,t){if(0===e.length)return new(0,f.default)({spatialReference:t});const r=[];for(const t of e)for(const e of t.paths)r.push(...e);const s=[];r.forEach(((e,t)=>{0!==t&&e[0]===r[t-1][0]&&e[1]===r[t-1][1]||s.push(e)}));const{hasM:o,hasZ:i}=e[0];return new(0,f.default)({hasM:o,hasZ:i,paths:[s],spatialReference:t})}constructor(e){super(e),this.extent=null,this.features=null,this.geometryType="polyline",this.routeId=null,this.routeName=null,this.totalDriveTime=null,this.totalLength=null,this.totalTime=null}};(0,o._)([(0,a.property)({type:c.default,json:{read:{source:"summary.envelope"}}})],g.prototype,"extent",void 0),(0,o._)([(0,a.property)()],g.prototype,"features",void 0),(0,o._)([(0,n.reader)("features")],g.prototype,"readFeatures",null),(0,o._)([(0,a.property)()],g.prototype,"geometryType",void 0),(0,o._)([(0,a.property)({readOnly:!0})],g.prototype,"mergedGeometry",null),(0,o._)([(0,a.property)()],g.prototype,"routeId",void 0),(0,o._)([(0,a.property)()],g.prototype,"routeName",void 0),(0,o._)([(0,a.property)({value:null,readOnly:!0})],g.prototype,"strings",null),(0,o._)([(0,a.property)({json:{read:{source:"summary.totalDriveTime"}}})],g.prototype,"totalDriveTime",void 0),(0,o._)([(0,a.property)({json:{read:{source:"summary.totalLength"}}})],g.prototype,"totalLength",void 0),(0,o._)([(0,a.property)({json:{read:{source:"summary.totalTime"}}})],g.prototype,"totalTime",void 0),g=(0,o._)([(0,l.subclass)("esri.rest.support.DirectionsFeatureSet")],g);const m=g})),t.register("2iIEs",(function(r,s){e(r.exports,"default",(function(){return p}));var o=t("j6uz9"),i=t("EvxpF"),a=t("hTI69");t("aX9sh"),t("5HTPH"),t("gHCNy");var n=t("qA6zg");let l=class extends i.default{};(0,o._)([(0,a.property)()],l.prototype,"events",void 0),(0,o._)([(0,a.property)()],l.prototype,"strings",void 0),l=(0,o._)([(0,n.subclass)("esri.rest.support.DirectionsFeature")],l);const p=l})),t.register("bXHv4",(function(r,s){e(r.exports,"default",(function(){return c}));var o=t("j6uz9"),i=t("4jlRt"),a=t("hO0an"),n=t("hTI69");t("aX9sh"),t("5HTPH"),t("gHCNy");var l=t("qA6zg");const p=new(0,i.JSONMap)({esriJobMessageTypeInformative:"informative",esriJobMessageTypeProcessDefinition:"process-definition",esriJobMessageTypeProcessStart:"process-start",esriJobMessageTypeProcessStop:"process-stop",esriJobMessageTypeWarning:"warning",esriJobMessageTypeError:"error",esriJobMessageTypeEmpty:"empty",esriJobMessageTypeAbort:"abort"});let u=class extends a.JSONSupport{constructor(e){super(e),this.description=null,this.type=null}};(0,o._)([(0,n.property)({type:String,json:{write:!0}})],u.prototype,"description",void 0),(0,o._)([(0,n.property)({type:String,json:{read:p.read,write:p.write}})],u.prototype,"type",void 0),u=(0,o._)([(0,l.subclass)("esri.rest.support.GPMessage")],u);const c=u}));
//# sourceMappingURL=RouteTask.7e60aec1.js.map
