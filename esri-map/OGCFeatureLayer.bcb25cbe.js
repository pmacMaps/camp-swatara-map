!function(){function e(e){return e&&e.__esModule?e.default:e}function t(e,t,r,o){Object.defineProperty(e,t,{get:r,set:o,enumerable:!0,configurable:!0})}var r=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire594f;r.register("eyh26",(function(o,n){var i;i=o.exports,Object.defineProperty(i,"__esModule",{value:!0,configurable:!0}),t(o.exports,"default",(function(){return J}));var s=r("8TSCy"),a=r("2TvXO"),p=r("7eJjO");r("2ILM8");var u=r("3MVX3");r("35mRC"),r("fqK5H"),r("hHJvn"),r("aOUND"),r("7Kl6r"),r("fPYaT"),r("aRUMT"),r("lubf9");var l=r("9ulmN"),c=r("8NioF"),d=r("iho5X");r("lNwWH"),r("2VlWd"),r("iJAIC");var y=r("fcwIv"),f=r("7LVgC"),v=r("4LDxK"),g=r("f0EIx"),m=r("jy0BF"),h=r("gIXJ2"),S=r("cv2jJ"),b=r("6bOVn"),x=r("5N5S1"),R=r("gkEnw"),C=r("9bAYR"),O=r("13Qxf"),_=r("3GzOb"),I=r("2t08e"),w=r("gRgX5"),T=r("bkDoB"),F=r("hRnYX"),k=r("buMuJ"),D=r("ko0sb"),P=r("7vTUY"),j=r("aYrEX"),E=r("gtLRH"),A=r("cRlei"),M=r("37qRo"),G=r("gINRd"),q=r("j40xv"),L=(0,D.defineFieldProperties)(),N=function(t){"use strict";s.inherits(o,t);var r=s.createSuper(o);function o(e){var t;return s.classCallCheck(this,o),(t=r.call(this,e)).collectionId=null,t.copyright=null,t.definitionExpression=null,t.description=null,t.displayField=null,t.elevationInfo=null,t.featureReduction=null,t.fields=null,t.fieldsIndex=null,t.fullExtent=null,t.geometryType=null,t.hasZ=void 0,t.labelingInfo=null,t.labelsVisible=!0,t.legendEnabled=!0,t.objectIdField=null,t.operationalLayerType="OGCFeatureLayer",t.popupEnabled=!0,t.popupTemplate=null,t.screenSizePerspectiveEnabled=!0,t.source=new(0,g.default)({layer:s.assertThisInitialized(t)}),t.spatialReference=null,t.title=null,t.type="ogc-feature",t.typeIdField=null,t.types=null,t.url=null,s.possibleConstructorReturn(t)}return s.createClass(o,[{key:"destroy",value:function(){var e;null==(e=this.source)||e.destroy()}},{key:"load",value:function(e){var t=this;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["OGCFeatureServer"]},e).then((function(){return t._fetchService(e)}))),this.when()}},{key:"defaultPopupTemplate",get:function(){return this.createPopupTemplate()}},{key:"isTable",get:function(){return this.loaded&&null==this.geometryType}},{key:"renderer",set:function(e){(0,P.fixRendererFields)(e,this.fieldsIndex),this._set("renderer",e)}},{key:"on",value:function(e,t){return s.get(s.getPrototypeOf(o.prototype),"on",this).call(this,e,t)}},{key:"createPopupTemplate",value:function(e){return(0,M.createPopupTemplate)(this,e)}},{key:"createQuery",value:function(){return new(0,A.default)}},{key:"getField",value:function(e){return this.fieldsIndex.get(e)}},{key:"getFieldDomain",value:function(e,t){var r,o,n=this,i=!1,s=null==t||null==(r=t.feature)?void 0:r.attributes,a=this.typeIdField&&(null==s?void 0:s[this.typeIdField]);return null!=a&&this.types&&(i=this.types.some((function(t){var r,i;return t.id==a&&("inherited"===(null==(i=o=null==(r=t.domains)?void 0:r[e])?void 0:i.type)&&(o=n._getLayerDomain(e)),!0)}))),i||o||(o=this._getLayerDomain(e)),o}},{key:"queryFeatures",value:function(e,t){var r=this;return this.load().then((function(){return r.source.queryFeatures(A.default.from(e)||r.createQuery(),t)})).then((function(e){var t,o=r;return null==e||null==(t=e.features)||t.forEach((function(e){e.layer=e.sourceLayer=o})),e}))}},{key:"serviceSupportsSpatialReference",value:function(e){var t,r;return null!=(t=null==(r=this.source)?void 0:r.serviceSupportsSpatialReference(e))&&t}},{key:"_fetchService",value:function(t){var r=this;return s.asyncToGenerator(e(a).mark((function o(){return e(a).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.source.load(t);case 2:r.read(r.source.featureDefinition,{origin:"service"}),(0,P.fixRendererFields)(r.renderer,r.fieldsIndex),(0,P.fixTimeInfoFields)(r.timeInfo,r.fieldsIndex);case 5:case"end":return e.stop()}}),o)})))()}},{key:"_getLayerDomain",value:function(e){if(!this.fields)return null;var t=!0,r=!1,o=void 0;try{for(var n,i=this.fields[Symbol.iterator]();!(t=(n=i.next()).done);t=!0){var s=n.value;if(s.name===e&&s.domain)return s.domain}}catch(e){r=!0,o=e}finally{try{t||null==i.return||i.return()}finally{if(r)throw o}}return null}}]),o}((0,m.APIKeyMixin)((0,S.CustomParametersMixin)((0,b.FeatureEffectLayer)((0,h.BlendLayer)((0,R.OrderedLayer)((0,I.TemporalLayer)((0,_.ScaleRangeLayer)((0,x.OperationalLayer)((0,C.PortalLayer)((0,O.RefreshableLayer)((0,c.MultiOriginJSONMixin)(v.default))))))))))));(0,p._)([(0,d.property)({readOnly:!0,json:{origins:{service:{read:!0}}}})],N.prototype,"capabilities",void 0),(0,p._)([(0,d.property)({type:String,json:{write:!0}})],N.prototype,"collectionId",void 0),(0,p._)([(0,d.property)({type:String})],N.prototype,"copyright",void 0),(0,p._)([(0,d.property)({readOnly:!0})],N.prototype,"defaultPopupTemplate",null),(0,p._)([(0,d.property)({type:String})],N.prototype,"definitionExpression",void 0),(0,p._)([(0,d.property)({readOnly:!0,type:String,json:{origins:{service:{name:"collection.description"}}}})],N.prototype,"description",void 0),(0,p._)([(0,d.property)({type:String})],N.prototype,"displayField",void 0),(0,p._)([(0,d.property)(w.elevationInfo)],N.prototype,"elevationInfo",void 0),(0,p._)([(0,d.property)(T.featureReductionProperty)],N.prototype,"featureReduction",void 0),(0,p._)([(0,d.property)({type:[k.default],json:{origins:{service:{name:"layerDefinition.fields"}}}})],N.prototype,"fields",void 0),(0,p._)([(0,d.property)(L.fieldsIndex)],N.prototype,"fieldsIndex",void 0),(0,p._)([(0,d.property)({readOnly:!0,type:G.default,json:{origins:{service:{name:"layerDefinition.extent"}}}})],N.prototype,"fullExtent",void 0),(0,p._)([(0,d.property)({type:f.featureGeometryTypeKebabDictionary.apiValues,json:{origins:{service:{name:"layerDefinition.geometryType",read:{reader:f.featureGeometryTypeKebabDictionary.read}}}}})],N.prototype,"geometryType",void 0),(0,p._)([(0,d.property)({type:Boolean,json:{origins:{service:{name:"layerDefinition.hasZ"}}}})],N.prototype,"hasZ",void 0),(0,p._)([(0,d.property)({type:Boolean,readOnly:!0})],N.prototype,"isTable",null),(0,p._)([(0,d.property)({type:[j.default],json:{origins:{"web-document":{name:"layerDefinition.drawingInfo.labelingInfo",read:{reader:E.reader},write:!0}}}})],N.prototype,"labelingInfo",void 0),(0,p._)([(0,d.property)(w.labelsVisible)],N.prototype,"labelsVisible",void 0),(0,p._)([(0,d.property)(w.legendEnabled)],N.prototype,"legendEnabled",void 0),(0,p._)([(0,d.property)({type:String,json:{origins:{service:{name:"layerDefinition.objectIdField"}}}})],N.prototype,"objectIdField",void 0),(0,p._)([(0,d.property)({type:["OGCFeatureLayer"]})],N.prototype,"operationalLayerType",void 0),(0,p._)([(0,d.property)(w.popupEnabled)],N.prototype,"popupEnabled",void 0),(0,p._)([(0,d.property)({type:u.default,json:{name:"popupInfo",write:!0}})],N.prototype,"popupTemplate",void 0),(0,p._)([(0,d.property)({types:l.rendererTypes,json:{origins:{service:{name:"layerDefinition.drawingInfo.renderer",write:!1},"web-scene":{types:l.webSceneRendererTypes,name:"layerDefinition.drawingInfo.renderer",write:!0}},name:"layerDefinition.drawingInfo.renderer",write:!0}})],N.prototype,"renderer",null),(0,p._)([(0,d.property)(w.screenSizePerspectiveEnabled)],N.prototype,"screenSizePerspectiveEnabled",void 0),(0,p._)([(0,d.property)({readOnly:!0})],N.prototype,"source",void 0),(0,p._)([(0,d.property)({readOnly:!0,type:q.default,json:{origins:{service:{read:!0}}}})],N.prototype,"spatialReference",void 0),(0,p._)([(0,d.property)({type:String,json:{write:{enabled:!0,ignoreOrigin:!0,isRequired:!0},origins:{service:{name:"collection.title"}}}})],N.prototype,"title",void 0),(0,p._)([(0,d.property)({readOnly:!0,json:{read:!1}})],N.prototype,"type",void 0),(0,p._)([(0,d.property)({type:String,readOnly:!0})],N.prototype,"typeIdField",void 0),(0,p._)([(0,d.property)({type:[F.default]})],N.prototype,"types",void 0),(0,p._)([(0,d.property)(w.url)],N.prototype,"url",void 0);var J=N=(0,p._)([(0,y.subclass)("esri.layers.OGCFeatureLayer")],N)})),r.register("f0EIx",(function(o,n){t(o.exports,"default",(function(){return h}));var i=r("8TSCy"),s=r("2TvXO"),a=r("7eJjO");r("2ILM8");var p=r("kyj08"),u=r("bQCqB"),l=r("7qybv"),c=r("iho5X");r("lNwWH"),r("2VlWd"),r("iJAIC");var d=r("fcwIv"),y=r("1xeva"),f=r("f4h86"),v=r("j40xv"),g=r("7LVgC"),m=function(t){"use strict";i.inherits(o,t);var r=i.createSuper(o);function o(){var e;return i.classCallCheck(this,o),(e=r.call.apply(r,[this].concat(Array.prototype.slice.call(arguments)))).featureDefinition=null,e.type="ogc-feature",i.possibleConstructorReturn(e)}return i.createClass(o,[{key:"load",value:function(e){return this.addResolvingPromise(this._loadOGCServices(this.layer,e)),this.when()}},{key:"getFeatureDefinition",value:function(){var e=this.featureDefinition,t=e.collection,r=e.layerDefinition,o=e.spatialReference,n=e.supportedCrs,i=this.layer,s=i.apiKey;return{capabilities:i.capabilities,collection:t,layerDefinition:r,queryParameters:{apiKey:s,customParameters:i.customParameters},spatialReference:o,supportedCrs:n}}},{key:"queryExtent",value:function(e){return null}},{key:"queryFeatureCount",value:function(e){return null}},{key:"queryFeatures",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.queryFeaturesJSON(e,t).then((function(e){return f.default.fromJSON(e)}))}},{key:"queryFeaturesJSON",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.getFeatureDefinition();return this.load(t).then((function(){return(0,y.queryFeatureSetJSON)(r,e,t)}))}},{key:"queryObjectIds",value:function(e){return null}},{key:"serviceSupportsSpatialReference",value:function(e){return!(!e.isWGS84&&!e.isWebMercator&&!this.featureDefinition.supportedCrs[e.wkid])}},{key:"_conformsToType",value:function(e,t){var r,o=new RegExp("^".concat(t,"$"),"i");return null!=(r=e.conformsTo.some((function(e){return o.test(e)})))&&r}},{key:"_getCapabilities",value:function(e,t){var r,o,n,i,s,a,p,u=(0,l.isSome)(t)?null==(r=t.components)?void 0:r.parameters:null;return{attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:e},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:!1,supportsDelete:!1,supportsEditing:!1,supportsChangeTracking:!1,supportsQuery:!1,supportsQueryAttachments:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:!1,supportsExceedsLimitStatistics:!1},query:{maxRecordCount:null!=(o=null!=(n=null==u||null==(i=u.limit)||null==(s=i.schema)?void 0:s.maximum)?n:null==u||null==(a=u.limitFeatures)||null==(p=a.schema)?void 0:p.maximum)?o:5e3,maxRecordCountFactor:void 0,standardMaxRecordCount:void 0,supportsCacheHint:!1,supportsCentroid:!1,supportsDisjointSpatialRelationship:!1,supportsDistance:!1,supportsDistinct:!1,supportsExtent:!1,supportsFormatPBF:!1,supportsGeometryProperties:!1,supportsHavingClause:!1,supportsHistoricMoment:!1,supportsMaxRecordCountFactor:!1,supportsOrderBy:!1,supportsPagination:!1,supportsPercentileStatistics:!1,supportsQuantization:!1,supportsQuantizationEditMode:!1,supportsQueryByOthers:!1,supportsQueryGeometry:!1,supportsResultType:!1,supportsStandardizedQueriesOnly:!1,supportsTopFeaturesQuery:!1,supportsStatistics:!1,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsDefaultSpatialReference:!1,supportsCompactGeometry:!1,supportsSqlExpression:!1,tileMaxRecordCount:void 0},queryRelated:{supportsCount:!1,supportsOrderBy:!1,supportsPagination:!1},editing:{supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsGeometryUpdate:!1,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsUploadWithItemId:!1,supportsUpdateWithoutM:!1}}}},{key:"_getExtent",value:function(e){var t,r=null==(t=e.extent)?void 0:t.spatial;if(!r)return null;var o=r.bbox[0],n=4===o.length,i=o[0],s=o[1],a=n?void 0:o[2];return{xmin:i,ymin:s,xmax:n?o[2]:o[3],ymax:n?o[3]:o[4],zmin:a,zmax:n?void 0:o[5],spatialReference:v.default.WGS84.toJSON()}}},{key:"_getStorageSpatialReference",value:function(e){var t,r=null!=(t=e.storageCrs)?t:y.crsDefault,o=(0,y.getSpatialReferenceWkid)(r);return(0,l.isNone)(o)?v.default.WGS84:new(0,v.default)({wkid:o})}},{key:"_getSupportedSpatialReferences",value:function(e,t){var r,o="#/crs",n=null!=(r=e.crs)?r:[y.crsDefault],i=n.includes(o)?n.filter((function(e){return e!==o})).concat(t.crs):n,s=/^http:\/\/www\.opengis.net\/def\/crs\/epsg\/.*\/3785$/i;return i.filter((function(e){return!s.test(e)}))}},{key:"_loadOGCServices",value:function(t,r){var o=this;return i.asyncToGenerator(e(s).mark((function n(){var a,u,c,d,f,v,m,h,S,b,x,R,C,O,_,I,w,T,F,k,D,P,j,E,A,M,G,q,L,N,J,B;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(0,l.isSome)(r)?r.signal:null,u=t.apiKey,c=t.collectionId,d=t.customParameters,f=t.fields,v=t.geometryType,m=t.hasZ,h=t.objectIdField,S=t.timeInfo,b=t.url,x={fields:null==f?void 0:f.map((function(e){return e.toJSON()})),geometryType:g.typeKebabDictionary.toJSON(v),hasZ:m,objectIdField:h,timeInfo:null==S?void 0:S.toJSON()},R={apiKey:u,customParameters:d,signal:a},e.next=14,(0,y.getServerLandingPage)(b,R);case 14:return C=e.sent,e.t0=i,e.next=18,Promise.all([(0,y.getServerConformance)(C,R),(0,y.getServerCollections)(C,R)]);case 18:if(e.t1=e.sent,O=e.t0.slicedToArray.call(e.t0,e.t1,2),_=O[0],I=O[1],o._conformsToType(_,"http://www.opengis.net/spec/ogcapi-features-1/1.0/conf/geojson")){e.next=24;break}throw new(0,p.default)("ogc-feature-layer:no-geojson-support","Server does not support geojson");case 24:if(w=I.collections.find((function(e){return e.id===c}))){e.next=27;break}throw new(0,p.default)("ogc-feature-layer:collection-not-found","Server does not contain the named collection");case 27:if(!o._conformsToType(_,"http://www.opengis.net/spec/ogcapi-features-1/1.0/conf/oas30")){e.next=33;break}return e.next=30,(0,y.getServerOpenApi)(C,R);case 30:e.t2=e.sent,e.next=34;break;case 33:e.t2=null;case 34:return T=e.t2,e.next=37,(0,y.getCollectionDefinition)(w,x,R);case 37:for(F=e.sent,k=o._getCapabilities(F.hasZ,T),D=o._getExtent(w),P=o._getStorageSpatialReference(w).toJSON(),j=o._getSupportedSpatialReferences(w,I),E=new RegExp("^".concat(y.crsPrefix),"i"),A={},M=!0,G=!1,q=void 0,e.prev=45,L=j[Symbol.iterator]();!(M=(N=L.next()).done);M=!0)J=N.value,B=(0,y.getSpatialReferenceWkid)(J),(0,l.isSome)(B)&&(A[B]||(A[B]=J.replace(E,"")));e.next=53;break;case 49:e.prev=49,e.t3=e.catch(45),G=!0,q=e.t3;case 53:e.prev=53,e.prev=54,M||null==L.return||L.return();case 56:if(e.prev=56,!G){e.next=59;break}throw q;case 59:return e.finish(56);case 60:return e.finish(53);case 61:F.extent=D,o.featureDefinition={capabilities:k,collection:w,layerDefinition:F,queryParameters:{},spatialReference:P,supportedCrs:A};case 62:case"end":return e.stop()}}),n,null,[[45,49,53,61],[54,,56,60]])})))()}}]),o}(u.default);(0,a._)([(0,c.property)()],m.prototype,"featureDefinition",void 0),(0,a._)([(0,c.property)({constructOnly:!0})],m.prototype,"layer",void 0),(0,a._)([(0,c.property)()],m.prototype,"type",void 0);var h=m=(0,a._)([(0,d.subclass)("esri.layers.graphics.sources.OGCFeatureSource")],m)})),r.register("aNMpQ",(function(e,r){t(e.exports,"queryCapabilities",(function(){return o}));var o={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}})),r.register("dxhdj",(function(e,o){t(e.exports,"createDrawingInfo",(function(){return u})),t(e.exports,"createDefaultAttributesFunction",(function(){return d})),t(e.exports,"createDefaultTemplate",(function(){return y})),t(e.exports,"createCapabilities",(function(){return f}));var n=r("8TSCy"),i=r("2VlWd"),s=r("flPLJ"),a=r("aNMpQ"),p=r("2iY9n");function u(e){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===e||"esriGeometryMultipoint"===e?p.defaultPointSymbolJSON:"esriGeometryPolyline"===e?p.defaultPolylineSymbolJSON:p.defaultPolygonSymbolJSON}}}var l=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/,c=1;function d(e,t){if((0,i.default)("esri-csp-restrictions"))return function(){return n.objectSpread(n.defineProperty({},t,null),e)};try{var r="this.".concat(t," = null;");for(var o in e)r+="this".concat(l.test(o)?".".concat(o):'["'.concat(o,'"]')," = ").concat(JSON.stringify(e[o]),";");var s=new Function("\n      return class AttributesClass$".concat(c++," {\n        constructor() {\n          ").concat(r,";\n        }\n      }\n    "))();return function(){return new s}}catch(r){return function(){return n.objectSpread(n.defineProperty({},t,null),e)}}}function y(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[{name:"New Feature",description:"",prototype:{attributes:(0,s.clone)(e)}}]}function f(e,t){return{attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:e},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:t,supportsDelete:t,supportsEditing:t,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAttachments:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:t,supportsExceedsLimitStatistics:!0},query:a.queryCapabilities,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0},editing:{supportsGeometryUpdate:t,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1}}}}))}();
//# sourceMappingURL=OGCFeatureLayer.bcb25cbe.js.map
