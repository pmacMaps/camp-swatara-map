!function(){function e(e){return e&&e.__esModule?e.default:e}function t(e,t,n,r){Object.defineProperty(e,t,{get:n,set:r,enumerable:!0,configurable:!0})}var n=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire594f;n.register("lS8og",(function(r,a){var i;i=r.exports,Object.defineProperty(i,"__esModule",{value:!0,configurable:!0}),t(r.exports,"default",(function(){return V})),t(r.exports,"inferLocationInfo",(function(){return Y})),t(r.exports,"inferFields",(function(){return D})),t(r.exports,"inferFieldType",(function(){return q}));var o=n("8TSCy"),u=n("2TvXO");n("2ILM8");var s=n("9pNSx"),l=n("kyj08"),c=n("jHOLN"),f=n("3MoeD"),d=n("10vEZ"),h=n("kYueh"),v=n("7RvA5"),m=n("jGyUI"),p=n("eY5Yp"),y=n("eF88h"),x=n("ft2bT"),g=n("awxBI"),b=n("73BcH"),_=n("fP7bp"),I=n("f3b5K"),k=n("JpcDD"),w=n("dxhdj"),T=n("4nMX7"),S=n("7vTUY"),M=n("j40xv"),N=(0,w.createDrawingInfo)("esriGeometryPoint"),F=["csv"],C=[0,0],B=function e(t,n){"use strict";o.classCallCheck(this,e),this.x=t,this.y=n},V=function(){"use strict";function t(){o.classCallCheck(this,t);var n,r=this;this._queryEngine=null,this._snapshotFeatures=(n=o.asyncToGenerator(e(u).mark((function t(n){var a;return e(u).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r._fetch(n);case 2:return a=e.sent,e.abrupt("return",r._createFeatures(a));case 4:case"end":return e.stop()}}),t)}))),function(e){return n.apply(this,arguments)})}return o.createClass(t,[{key:"destroy",value:function(){var e;null==(e=this._queryEngine)||e.destroy(),this._queryEngine=null}},{key:"load",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this;return o.asyncToGenerator(e(u).mark((function a(){var i,s,l,c,f,d,h,v;return e(u).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.loadOptions=t,e.t0=o,e.next=5,Promise.all([r._fetch(n.signal),r._checkProjection(null==t||null==(i=t.parsingOptions)?void 0:i.spatialReference)]);case 5:return e.t1=e.sent,s=e.t0.slicedToArray.call(e.t0,e.t1,1),l=s[0],c=E(l,t),r.locationInfo=c.locationInfo,r.delimiter=c.delimiter,r._queryEngine=r._createQueryEngine(c),e.next=12,r._createFeatures(l);case 12:return f=e.sent,r._queryEngine.featureStore.addMany(f),c.layerDefinition.extent=r._queryEngine.fullExtent,c.layerDefinition.timeInfo&&(d=r._queryEngine.timeExtent,h=d.start,v=d.end,c.layerDefinition.timeInfo.timeExtent=[h,v]),e.abrupt("return",c);case 15:case"end":return e.stop()}}),a)})))()}},{key:"applyEdits",value:function(){return o.asyncToGenerator(e(u).mark((function t(){return e(u).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new(0,l.default)("csv-layer:editing-not-supported","applyEdits() is not supported on CSVLayer");case 1:case"end":return e.stop()}}),t)})))()}},{key:"queryFeatures",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this;return o.asyncToGenerator(e(u).mark((function a(){return e(u).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r._waitSnapshotComplete();case 2:return e.abrupt("return",(e.sent,r._queryEngine.executeQuery(t,n.signal)));case 3:case"end":return e.stop()}}),a)})))()}},{key:"queryFeatureCount",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this;return o.asyncToGenerator(e(u).mark((function a(){return e(u).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r._waitSnapshotComplete();case 2:return e.abrupt("return",(e.sent,r._queryEngine.executeQueryForCount(t,n.signal)));case 3:case"end":return e.stop()}}),a)})))()}},{key:"queryObjectIds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this;return o.asyncToGenerator(e(u).mark((function a(){return e(u).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r._waitSnapshotComplete();case 2:return e.abrupt("return",(e.sent,r._queryEngine.executeQueryForIds(t,n.signal)));case 3:case"end":return e.stop()}}),a)})))()}},{key:"queryExtent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this;return o.asyncToGenerator(e(u).mark((function a(){return e(u).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r._waitSnapshotComplete();case 2:return e.abrupt("return",(e.sent,r._queryEngine.executeQueryForExtent(t,n.signal)));case 3:case"end":return e.stop()}}),a)})))()}},{key:"querySnapping",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this;return o.asyncToGenerator(e(u).mark((function a(){return e(u).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r._waitSnapshotComplete();case 2:return e.abrupt("return",(e.sent,r._queryEngine.executeQueryForSnapping(t,n.signal)));case 3:case"end":return e.stop()}}),a)})))()}},{key:"refresh",value:function(t){var n=this;return o.asyncToGenerator(e(u).mark((function r(){var a;return e(u).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.loadOptions.customParameters=t,null==(a=n._snapshotTask)||a.abort(),n._snapshotTask=(0,d.createTask)(n._snapshotFeatures),n._snapshotTask.promise.then((function(e){n._queryEngine.featureStore.clear(),e&&n._queryEngine.featureStore.addMany(e)}),(function(e){n._queryEngine.featureStore.clear(),(0,d.isAbortError)(e)||c.default.getLogger("esri.layers.CSVLayer").error(new(0,l.default)("csv-layer:refresh","An error occurred during refresh",{error:e}))})),e.next=7,n._waitSnapshotComplete();case 7:return e.abrupt("return",(e.sent,{extent:n._queryEngine.fullExtent,timeExtent:n._queryEngine.timeExtent}));case 8:case"end":return e.stop()}}),r)})))()}},{key:"_waitSnapshotComplete",value:function(){var t=this;return o.asyncToGenerator(e(u).mark((function n(){return e(u).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t._snapshotTask||t._snapshotTask.finished){e.next=9;break}return e.prev=1,e.next=4,t._snapshotTask.promise;case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:return e.abrupt("return",t._waitSnapshotComplete());case 9:case"end":return e.stop()}}),n,null,[[1,6]])})))()}},{key:"_fetch",value:function(t){var n=this;return o.asyncToGenerator(e(u).mark((function r(){var a,i,c,f;return e(u).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.loadOptions,i=a.url,c=a.customParameters,i){e.next=3;break}throw new(0,l.default)("csv-layer:invalid-source","url not defined");case 3:return f=(0,h.urlToObject)(i),e.next=6,(0,s.default)(f.path,{query:o.objectSpread({},f.query,c),responseType:"text",signal:t});case 6:return e.abrupt("return",e.sent.data);case 7:case"end":return e.stop()}}),r)})))()}},{key:"_createQueryEngine",value:function(e){var t=e.layerDefinition,n=t.objectIdField,r=t.fields,a=t.extent,i=t.timeInfo,o=new(0,b.default)({geometryType:"esriGeometryPoint",hasM:!1,hasZ:!1});return new(0,I.default)({fields:r,geometryType:"esriGeometryPoint",hasM:!1,hasZ:!1,timeInfo:i,objectIdField:n,spatialReference:a.spatialReference||{wkid:4326},cacheSpatialQueries:!0,featureStore:o})}},{key:"_createFeatures",value:function(t){var n=this;return o.asyncToGenerator(e(u).mark((function r(){var a,i,s,l,c,f,d,h,b,_,I,T,N,F,V,E,j,z,Y,D,q,P,O,X,R,G,Z,J,W,U,Q,H,$,K,ee,te,ne,re,ae,ie,oe,ue,se,le,ce;return e(u).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=n.locationInfo,i=a.latitudeFieldName,s=a.longitudeFieldName,l=n._queryEngine,c=l.objectIdField,f=l.fieldsIndex,d=l.spatialReference,h=[],b=[],_=f.fields.filter((function(e){return e.name!==c})).map((function(e){return e.name})),I=0,(T=(0,k.readRows)(t)).next(),N={},F=!0,V=!1,E=void 0,e.prev=8,j=f.fields[Symbol.iterator]();!(F=(z=j.next()).done);F=!0)"esriFieldTypeOID"!==(Y=z.value).type&&"esriFieldTypeGlobalID"!==Y.type&&void 0!==(D=(0,S.getFieldDefaultValue)(Y))&&(N[Y.name]=D);e.next=16;break;case 12:e.prev=12,e.t0=e.catch(8),V=!0,E=e.t0;case 16:e.prev=16,e.prev=17,F||null==j.return||j.return();case 19:if(e.prev=19,!V){e.next=22;break}throw E;case 22:return e.finish(19);case 23:return e.finish(16);case 24:for(q=(0,k.parseRows)(T,_,n.delimiter,(0,w.createDefaultAttributesFunction)(N,c)),P=!0,O=!1,X=void 0,e.prev=26,R=q[Symbol.iterator]();!(P=(G=R.next()).done);P=!0)if(Z=G.value,J=n._parseCoordinateValue(Z[i]),null!=(W=n._parseCoordinateValue(Z[s]))&&null!=J&&!isNaN(J)&&!isNaN(W)){for(U in Z[i]=J,Z[s]=W,Z)U!==i&&U!==s&&(f.isDateField(U)?(Q=new Date(Z[U]),Z[U]=A(Q,Z[U])?Q.getTime():null):f.isNumericField(U)&&(H=L(Z[U]),isNaN(H)?Z[U]=null:Z[U]=H));Z[c]=I,I++,h.push(new B(W,J)),b.push(Z)}e.next=34;break;case 30:e.prev=30,e.t1=e.catch(26),O=!0,X=e.t1;case 34:e.prev=34,e.prev=35,P||null==R.return||R.return();case 37:if(e.prev=37,!O){e.next=40;break}throw X;case 40:return e.finish(37);case 41:return e.finish(34);case 42:if((0,p.equals)({wkid:4326},d)){e.next=64;break}if($=!0,K=!1,ee=void 0,!(0,p.isWebMercator)(d)){e.next=63;break}for(e.prev=45,te=h[Symbol.iterator]();!($=(ne=te.next()).done);$=!0)re=ne.value,ae=o.slicedToArray((0,y.lngLatToXY)(re.x,re.y,C),2),re.x=ae[0],re.y=ae[1];e.next=53;break;case 49:e.prev=49,e.t2=e.catch(45),K=!0,ee=e.t2;case 53:e.prev=53,e.prev=54,$||null==te.return||te.return();case 56:if(e.prev=56,!K){e.next=59;break}throw ee;case 59:return e.finish(56);case 60:return e.finish(53);case 61:e.next=64;break;case 63:h=(0,v.projectMany)(m.jsonAdapter,h,M.default.WGS84,d,null);case 64:for(ie=[],oe=0;oe<h.length;oe++)ue=h[oe],se=ue.x,le=ue.y,(ce=b[oe])[c]=oe+1,ie.push(new(0,x.OptimizedFeature)(new(0,g.default)([],[se,le]),ce,null,ce[c]));return e.abrupt("return",ie);case 67:case"end":return e.stop()}}),r,null,[[8,12,16,24],[17,,19,23],[26,30,34,42],[35,,37,41],[45,49,53,61],[54,,56,60]])})))()}},{key:"_parseCoordinateValue",value:function(e){if(null==e||""===e)return null;var t=L(e);return(isNaN(t)||Math.abs(t)>181)&&(t=parseFloat(e)),t}},{key:"_checkProjection",value:function(t){return o.asyncToGenerator(e(u).mark((function n(){return e(u).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,_.checkProjectionSupport)(p.WGS84,t);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),new(0,l.default)("csv-layer:projection-not-supported","Projection not supported");case 8:case"end":return e.stop()}}),n,null,[[0,5]])})))()}}]),t}();function E(e,t){var n=t.parsingOptions||{},r={delimiter:n.delimiter,layerDefinition:null,locationInfo:{latitudeFieldName:n.latitudeField,longitudeFieldName:n.longitudeField}},a=(0,k.readRows)(e),i=a.next().value;if(!i)throw new(0,l.default)("csv-layer:empty-csv","CSV is empty",{csv:e});if(i=i.trim(),!n.delimiter){var o=(0,k.inferDelimiter)(i);if(!o)throw new(0,l.default)("csv-layer:invalid-delimiter","Unable to detect the delimiter from CSV");r.delimiter=o}var u=i.split(r.delimiter).filter((function(e){return!!e})),s=r.layerDefinition={name:(0,h.getFilename)(t.url,F)||"csv",drawingInfo:N,geometryType:"esriGeometryPoint",objectIdField:null,fields:[],timeInfo:n.timeInfo,extent:{xmin:Number.POSITIVE_INFINITY,ymin:Number.POSITIVE_INFINITY,xmax:Number.NEGATIVE_INFINITY,ymax:Number.NEGATIVE_INFINITY,spatialReference:n.spatialReference||{wkid:102100}}};if(!n.latitudeField||!n.longitudeField){var c=Y(u);if(!n.longitudeField&&!c.longitudeFieldName||!n.latitudeField&&!c.latitudeFieldName)throw new(0,l.default)("csv-layer:location-fields-not-found","Unable to identify latitude and longitude fields from the CSV file");r.locationInfo={longitudeFieldName:n.longitudeField||c.longitudeFieldName,latitudeFieldName:n.latitudeField||c.latitudeFieldName}}var f=D(a,r.delimiter,u,r.locationInfo);if(n.fields&&n.fields.length){var d=new Map,v=!0,m=!1,p=void 0;try{for(var y,x=n.fields[Symbol.iterator]();!(v=(y=x.next()).done);v=!0){var g=y.value;d.set(g.name.toLowerCase(),g)}}catch(e){m=!0,p=e}finally{try{v||null==x.return||x.return()}finally{if(m)throw p}}var b=!0,_=!1,I=void 0;try{for(var w,S=f[Symbol.iterator]();!(b=(w=S.next()).done);b=!0){var M=w.value,C=d.get(M.name.toLowerCase());if(C){var B=M.name;Object.assign(M,C),M.name=B}}}catch(e){_=!0,I=e}finally{try{b||null==S.return||S.return()}finally{if(_)throw I}}}if(s.fields=f,!s.fields.some((function(e){return"esriFieldTypeOID"===e.type&&(s.objectIdField=e.name,!0)}))){var V={name:"__OBJECTID",alias:"__OBJECTID",type:"esriFieldTypeOID",editable:!1,nullable:!1};s.objectIdField=V.name,s.fields.unshift(V)}if(s.timeInfo){var E=new(0,T.default)(s.fields),j=s.timeInfo;if(j.startTimeField){var z=E.get(j.startTimeField);z?(j.startTimeField=z.name,z.type="esriFieldTypeDate"):j.startTimeField=null}if(j.endTimeField){var q=E.get(j.endTimeField);q?(j.endTimeField=q.name,q.type="esriFieldTypeDate"):j.endTimeField=null}if(j.trackIdField){var P=E.get(j.trackIdField);j.trackIdField=P?P.name:null}j.startTimeField||j.endTimeField||(s.timeInfo=null)}return r}var j=["lat","latitude","latitude83","latdecdeg","lat_dd","y","ycenter","point-y"],z=["lon","lng","long","longitude","longitude83","longdecdeg","long_dd","x","xcenter","point-x"];function Y(e){var t=e.map((function(e){return e.toLowerCase()}));return{longitudeFieldName:e[t.indexOf(z.find((function(e){return t.includes(e)})))],latitudeFieldName:e[t.indexOf(j.find((function(e){return t.includes(e)})))]}}function D(e,t,n,r){var a=[],i=(0,k.parseRows)(e,n,t),o=[],u=!0,s=!1,l=void 0;try{for(var c,f=i[Symbol.iterator]();!(u=(c=f.next()).done);u=!0){var d=c.value;if(10===o.length)break;o.push(d)}}catch(e){s=!0,l=e}finally{try{u||null==f.return||f.return()}finally{if(s)throw l}}var h=!0,v=!1,m=void 0;try{for(var p,y=function(e,t){var n=t.value;if(n===r.longitudeFieldName||n===r.latitudeFieldName)a.push({name:n,type:"esriFieldTypeDouble",alias:n});else{var i=q(o.map((function(e){return e[n]}))),u={name:n,type:null,alias:n};switch(i){case"integer":u.type="esriFieldTypeInteger";break;case"double":u.type="esriFieldTypeDouble";break;case"date":u.type="esriFieldTypeDate",u.length=36;break;default:u.type="esriFieldTypeString",u.length=255}a.push(u)}},x=n[Symbol.iterator]();!(h=(p=x.next()).done);h=!0)y(0,p)}catch(e){v=!0,m=e}finally{try{h||null==x.return||x.return()}finally{if(v)throw m}}return a}function q(e){if(!e.length)return"string";var t=/[^+-.,0-9]/;return e.map((function(e){var n=!1;if(""!==e){if(t.test(e))n=!0;else{var r=L(e);if(!isNaN(r))return/[.,]/.test(e)||!Number.isInteger(r)||r>214783647||r<-214783648?"double":"integer";if(-1===e.indexOf("E"))n=!0;else{if(r=Number(e),!isNaN(r))return"double";if(-1===e.indexOf(","))n=!0;else{if(e=e.replace(",","."),r=Number(e),!isNaN(r))return"double";n=!0}}}return n?/^[-]?\d*[.,]?\d*$/.test(e)?"string":A(new Date(e),e)?"date":"string":"string"}})).reduce((function(e,t){return void 0===e||e===t?t:"string"===e||"string"===t?"string":"double"===e||"double"===t?"double":void 0}))}var P=/^((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(tember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?)|(am)|(pm)|(gmt)|(utc))$/i,O=Number.isNaN(new Date("technology 10").getTime());function A(e,t){if(!e||"[object Date]"!==Object.prototype.toString.call(e)||isNaN(e.getTime()))return!1;var n=!0;if(!O&&/\d+\W*$/.test(t)){var r=t.match(/[a-zA-Z]{2,}/);if(r){for(var a=!1,i=0;!a&&i<=r.length;)a=!P.test(r[i]),i++;n=!a}}return n}var X,R,G,Z,L=(X=(0,f._parseInfo)(),R=new RegExp("^"+X.regexp+"$"),G=new RegExp("["+X.group+"\\s\\xa0]","g"),Z=X.factor,function(e){var t=R.exec(e);if(X.factor=Z,!t)return NaN;var n=t[1];if(!t[1]){if(!t[2])return NaN;n=t[2],X.factor*=-1}return+(n=n.replace(G,"").replace(X.decimal,"."))*X.factor})})),n.register("jGyUI",(function(e,r){t(e.exports,"jsonAdapter",(function(){return i}));var a=n("8TSCy"),i={convertToGEGeometry:function(e,t){return null==t?null:e.convertJSONToGeometry(t)},exportPoint:function(e,t,n){var r=new o(e.getPointX(t),e.getPointY(t),n),a=e.hasZ(t),i=e.hasM(t);return a&&(r.z=e.getPointZ(t)),i&&(r.m=e.getPointM(t)),r},exportPolygon:function(e,t,n){return new u(e.exportPaths(t),n,e.hasZ(t),e.hasM(t))},exportPolyline:function(e,t,n){return new s(e.exportPaths(t),n,e.hasZ(t),e.hasM(t))},exportMultipoint:function(e,t,n){return new l(e.exportPoints(t),n,e.hasZ(t),e.hasM(t))},exportExtent:function(e,t,n){var r=e.hasZ(t),a=e.hasM(t),i=new c(e.getXMin(t),e.getYMin(t),e.getXMax(t),e.getYMax(t),n);if(r){var o=e.getZExtent(t);i.zmin=o.vmin,i.zmax=o.vmax}if(a){var u=e.getMExtent(t);i.mmin=u.vmin,i.mmax=u.vmax}return i}};var o=function e(t,n,r){"use strict";a.classCallCheck(this,e),this.x=t,this.y=n,this.spatialReference=r,this.z=void 0,this.m=void 0};var u=function e(t,n,r,i){"use strict";a.classCallCheck(this,e),this.rings=t,this.spatialReference=n,this.hasZ=void 0,this.hasM=void 0,r&&(this.hasZ=r),i&&(this.hasM=i)};var s=function e(t,n,r,i){"use strict";a.classCallCheck(this,e),this.paths=t,this.spatialReference=n,this.hasZ=void 0,this.hasM=void 0,r&&(this.hasZ=r),i&&(this.hasM=i)};var l=function e(t,n,r,i){"use strict";a.classCallCheck(this,e),this.points=t,this.spatialReference=n,this.hasZ=void 0,this.hasM=void 0,r&&(this.hasZ=r),i&&(this.hasM=i)};var c=function e(t,n,r,i,o){"use strict";a.classCallCheck(this,e),this.xmin=t,this.ymin=n,this.xmax=r,this.ymax=i,this.spatialReference=o,this.zmin=void 0,this.zmax=void 0,this.mmin=void 0,this.mmax=void 0}})),n.register("73BcH",(function(e,r){t(e.exports,"default",(function(){return v}));var a=n("8TSCy"),i=n("kyj08"),o=n("amfHf"),u=n("jHOLN"),s=n("7qybv"),l=n("ayLat"),c=n("8TwEW"),f=n("akQYU"),d=n("1ZPLr"),h=n("1zB3R"),v=function(){"use strict";function e(t){a.classCallCheck(this,e),this.geometryInfo=t,this._boundsStore=new(0,d.BoundsStore),this._featuresById=new Map,this._markedIds=new Set,this.events=new(0,o.default),this.featureAdapter=h.optimizedFeatureQueryEngineAdapter}return a.createClass(e,[{key:"geometryType",get:function(){return this.geometryInfo.geometryType}},{key:"hasM",get:function(){return this.geometryInfo.hasM}},{key:"hasZ",get:function(){return this.geometryInfo.hasZ}},{key:"numFeatures",get:function(){return this._featuresById.size}},{key:"fullBounds",get:function(){var e=this;if(!this.numFeatures)return null;var t=(0,c.create)(c.NEGATIVE_INFINITY);return this._featuresById.forEach((function(n){var r=e._boundsStore.get(n.objectId);r&&(t[0]=Math.min(r[0],t[0]),t[1]=Math.min(r[1],t[1]),t[2]=Math.max(r[2],t[2]),t[3]=Math.max(r[3],t[3]))})),t}},{key:"storeStatistics",get:function(){var e=0;return this._featuresById.forEach((function(t){(0,s.isSome)(t.geometry)&&t.geometry.coords&&(e+=t.geometry.coords.length)})),{featureCount:this._featuresById.size,vertexCount:e/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}},{key:"add",value:function(e){this._add(e),this._emitChanged()}},{key:"addMany",value:function(e){var t=!0,n=!1,r=void 0;try{for(var a,i=e[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var o=a.value;this._add(o)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}this._emitChanged()}},{key:"clear",value:function(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged()}},{key:"removeById",value:function(e){var t=this._featuresById.get(e);return t?(this._remove(t),this._emitChanged(),t):null}},{key:"removeManyById",value:function(e){this._boundsStore.invalidateIndex();var t=!0,n=!1,r=void 0;try{for(var a,i=e[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var o=a.value,u=this._featuresById.get(o);u&&this._remove(u)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}this._emitChanged()}},{key:"forEachBounds",value:function(e,t,n){var r=!0,a=!1,i=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value,c=this._boundsStore.get(s.objectId);c&&t((0,l.fromRect)(n,c))}}catch(e){a=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}}},{key:"getFeature",value:function(e){return this._featuresById.get(e)}},{key:"has",value:function(e){return this._featuresById.has(e)}},{key:"forEach",value:function(e){this._featuresById.forEach((function(t){return e(t)}))}},{key:"forEachInBounds",value:function(e,t){var n=this;this._boundsStore.forEachInBounds(e,(function(e){t(n._featuresById.get(e))}))}},{key:"startMarkingUsedFeatures",value:function(){this._boundsStore.invalidateIndex(),this._markedIds.clear()}},{key:"sweep",value:function(){var e=this,t=!1;this._featuresById.forEach((function(n,r){e._markedIds.has(r)||(t=!0,e._remove(n))})),this._markedIds.clear(),t&&this._emitChanged()}},{key:"_emitChanged",value:function(){this.events.emit("changed",void 0)}},{key:"_add",value:function(e){if(e){var t=e.objectId;if(null!=t){var n,r=this._featuresById.get(t);if(this._markedIds.add(t),r?(e.displayId=r.displayId,n=this._boundsStore.get(t),this._boundsStore.delete(t)):(0,s.isSome)(this.onFeatureAdd)&&this.onFeatureAdd(e),(0,s.isNone)(e.geometry)||!e.geometry.coords||!e.geometry.coords.length)return this._boundsStore.set(t,null),void this._featuresById.set(t,e);n=(0,f.getBoundsOptimizedGeometry)((0,s.isSome)(n)?n:(0,c.create)(),e.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),(0,s.isSome)(n)&&this._boundsStore.set(t,n),this._featuresById.set(t,e)}else u.default.getLogger("esri.layers.graphics.data.FeatureStore").error(new(0,i.default)("featurestore:invalid-feature","feature id is missing",{feature:e}))}}},{key:"_remove",value:function(e){return(0,s.isSome)(this.onFeatureRemove)&&this.onFeatureRemove(e),this._markedIds.delete(e.objectId),this._boundsStore.delete(e.objectId),this._featuresById.delete(e.objectId),e}}]),e}()})),n.register("1ZPLr",(function(e,r){t(e.exports,"BoundsStore",(function(){return s}));var a=n("8TSCy"),i=n("2VlWd"),o=n("bWAZj"),u={minX:0,minY:0,maxX:0,maxY:0};var s=function(){"use strict";function e(){var t=this;a.classCallCheck(this,e),this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new(0,o.PooledRBush)(9,(0,i.default)("esri-csp-restrictions")?function(e){return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}}:["[0]","[1]","[2]","[3]"]),this._loadIndex=function(){var e=t;if(t._indexInvalid){var n=new Array(t._idByBounds.size),r=0;t._idByBounds.forEach((function(e,t){n[r++]=t})),t._indexInvalid=!1,t._index.clear(),t._index.load(n)}else t._boundsToLoad.length&&(t._index.load(t._boundsToLoad.filter((function(t){return e._idByBounds.has(t)}))),t._boundsToLoad.length=0)}}return a.createClass(e,[{key:"clear",value:function(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}},{key:"delete",value:function(e){var t=this._boundsById.get(e);this._boundsById.delete(e),t&&(this._idByBounds.delete(t),this._indexInvalid||this._index.remove(t))}},{key:"forEachInBounds",value:function(e,t){var n,r,a,i=this;this._loadIndex(),n=this._index,r=e,a=function(e){return t(i._idByBounds.get(e))},u.minX=r[0],u.minY=r[1],u.maxX=r[2],u.maxY=r[3],n.search(u,a)}},{key:"get",value:function(e){return this._boundsById.get(e)}},{key:"has",value:function(e){return this._boundsById.has(e)}},{key:"invalidateIndex",value:function(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}},{key:"set",value:function(e,t){if(!this._indexInvalid){var n=this._boundsById.get(e);n&&(this._index.remove(n),this._idByBounds.delete(n))}this._boundsById.set(e,t),t&&(this._idByBounds.set(t,e),this._indexInvalid||(this._boundsToLoad.push(t),this._boundsToLoad.length>5e4&&this._loadIndex()))}}]),e}()})),n.register("bWAZj",(function(e,r){t(e.exports,"PooledRBush",(function(){return l}));var a=n("8TSCy"),i=n("lNwWH"),o=n("7qybv"),u=n("6v7Z0"),s=n("fcGl2"),l=function(){"use strict";function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:9,n=arguments.length>1?arguments[1]:void 0;a.classCallCheck(this,e),this.compareMinX=h,this.compareMinY=v,this._toBBox=function(e){return e},this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),n&&("function"==typeof n?this._toBBox=n:this._initFormat(n)),this.clear()}return a.createClass(e,[{key:"destroy",value:function(){this.clear(),_.prune(),I.prune(),k.prune(),w.prune()}},{key:"all",value:function(e){this._all(this.data,e)}},{key:"search",value:function(e,t){var n=this.data,r=this._toBBox;if(g(e,n))for(_.clear();n;){for(var a=0,i=n.children.length;a<i;a++){var o=n.children[a],u=n.leaf?r(o):o;g(e,u)&&(n.leaf?t(o):x(e,u)?this._all(o,t):_.push(o))}n=_.pop()}}},{key:"collides",value:function(e){var t=this.data,n=this._toBBox;if(!g(e,t))return!1;for(_.clear();t;){for(var r=0,a=t.children.length;r<a;r++){var i=t.children[r],o=t.leaf?n(i):i;if(g(e,o)){if(t.leaf||x(e,o))return!0;_.push(i)}}t=_.pop()}return!1}},{key:"load",value:function(e){if(!e.length)return this;if(e.length<this._minEntries){for(var t=0,n=e.length;t<n;t++)this.insert(e[t]);return this}var r=this._build(e.slice(0,e.length),0,e.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var a=this.data;this.data=r,r=a}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this}},{key:"insert",value:function(e){return e&&this._insert(e,this.data.height-1),this}},{key:"clear",value:function(){return this.data=new S([]),this}},{key:"remove",value:function(e){if(!e)return this;var t,n=this.data,r=null,a=0,u=!1,s=this._toBBox(e);for(k.clear(),w.clear();n||k.length>0;){var l;if(n||(n=(0,o.assumeNonNull)(k.pop()),r=k.data[k.length-1],a=null!=(l=w.pop())?l:0,u=!0),n.leaf&&-1!==(t=(0,i.indexOf)(n.children,e,n.children.length,n.indexHint)))return n.children.splice(t,1),k.push(n),this._condense(k),this;u||n.leaf||!x(n,s)?r?(a++,n=r.children[a],u=!1):n=null:(k.push(n),w.push(a),a=0,r=n,n=n.children[0])}return this}},{key:"toJSON",value:function(){return this.data}},{key:"fromJSON",value:function(e){return this.data=e,this}},{key:"_all",value:function(e,t){var n=e;for(I.clear();n;){var r,a=!0,i=!1,o=void 0;if(!0===n.leaf)try{for(var u,s=n.children[Symbol.iterator]();!(a=(u=s.next()).done);a=!0){t(u.value)}}catch(e){i=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(i)throw o}}else I.pushArray(n.children);n=null!=(r=I.pop())?r:null}}},{key:"_build",value:function(e,t,n,r){var a=n-t+1,i=this._maxEntries;if(a<=i){var o=new S(e.slice(t,n+1));return c(o,this._toBBox),o}r||(r=Math.ceil(Math.log(a)/Math.log(i)),i=Math.ceil(a/Math.pow(i,r-1)));var u=new M([]);u.height=r;var s=Math.ceil(a/i),l=s*Math.ceil(Math.sqrt(i));b(e,t,n,l,this.compareMinX);for(var f=t;f<=n;f+=l){var d=Math.min(f+l-1,n);b(e,f,d,s,this.compareMinY);for(var h=f;h<=d;h+=s){var v=Math.min(h+s-1,d);u.children.push(this._build(e,h,v,r-1))}}return c(u,this._toBBox),u}},{key:"_chooseSubtree",value:function(e,t,n,r){for(;r.push(t),!0!==t.leaf&&r.length-1!==n;){for(var a=void 0,i=1/0,o=1/0,u=0,s=t.children.length;u<s;u++){var l=t.children[u],c=m(l),f=(d=e,h=l,(Math.max(h.maxX,d.maxX)-Math.min(h.minX,d.minX))*(Math.max(h.maxY,d.maxY)-Math.min(h.minY,d.minY))-c);f<o?(o=f,i=c<i?c:i,a=l):f===o&&c<i&&(i=c,a=l)}t=a||t.children[0]}var d,h;return t}},{key:"_insert",value:function(e,t,n){var r=this._toBBox,a=n?e:r(e);k.clear();var i=this._chooseSubtree(a,this.data,t,k);for(i.children.push(e),d(i,a);t>=0&&k.data[t].children.length>this._maxEntries;)this._split(k,t),t--;this._adjustParentBBoxes(a,k,t)}},{key:"_split",value:function(e,t){var n=e.data[t],r=n.children.length,a=this._minEntries;this._chooseSplitAxis(n,a,r);var i=this._chooseSplitIndex(n,a,r);if(i){var o=n.children.splice(i,n.children.length-i),u=n.leaf?new S(o):new M(o);u.height=n.height,c(n,this._toBBox),c(u,this._toBBox),t?e.data[t-1].children.push(u):this._splitRoot(n,u)}else console.log("  Error: assertion failed at PooledRBush._split: no valid split index")}},{key:"_splitRoot",value:function(e,t){this.data=new M([e,t]),this.data.height=e.height+1,c(this.data,this._toBBox)}},{key:"_chooseSplitIndex",value:function(e,t,n){var r,a,i;r=a=1/0;for(var o=t;o<=n-t;o++){var u=f(e,0,o,this._toBBox),s=f(e,o,n,this._toBBox),l=y(u,s),c=m(u)+m(s);l<r?(r=l,i=o,a=c<a?c:a):l===r&&c<a&&(a=c,i=o)}return i}},{key:"_chooseSplitAxis",value:function(e,t,n){var r=e.leaf?this.compareMinX:h,a=e.leaf?this.compareMinY:v;this._allDistMargin(e,t,n,r)<this._allDistMargin(e,t,n,a)&&e.children.sort(r)}},{key:"_allDistMargin",value:function(e,t,n,r){e.children.sort(r);for(var a=this._toBBox,i=f(e,0,t,a),o=f(e,n-t,n,a),u=p(i)+p(o),s=t;s<n-t;s++){var l=e.children[s];d(i,e.leaf?a(l):l),u+=p(i)}for(var c=n-t-1;c>=t;c--){var h=e.children[c];d(o,e.leaf?a(h):h),u+=p(o)}return u}},{key:"_adjustParentBBoxes",value:function(e,t,n){for(var r=n;r>=0;r--)d(t.data[r],e)}},{key:"_condense",value:function(e){for(var t=e.length-1;t>=0;t--){var n=e.data[t];if(0===n.children.length)if(t>0){var r=e.data[t-1],a=r.children;a.splice((0,i.indexOf)(a,n,a.length,r.indexHint),1)}else this.clear();else c(n,this._toBBox)}}},{key:"_initFormat",value:function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0])),this.compareMinY=new Function("a","b",t.join(e[1])),this._toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}}]),e}();function c(e,t){f(e,0,e.children.length,t,e)}function f(e,t,n,r,a){a||(a=new S([])),a.minX=1/0,a.minY=1/0,a.maxX=-1/0,a.maxY=-1/0;for(var i,o=t;o<n;o++)i=e.children[o],d(a,e.leaf?r(i):i);return a}function d(e,t){e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY)}function h(e,t){return e.minX-t.minX}function v(e,t){return e.minY-t.minY}function m(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function p(e){return e.maxX-e.minX+(e.maxY-e.minY)}function y(e,t){var n=Math.max(e.minX,t.minX),r=Math.max(e.minY,t.minY),a=Math.min(e.maxX,t.maxX),i=Math.min(e.maxY,t.maxY);return Math.max(0,a-n)*Math.max(0,i-r)}function x(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function g(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function b(e,t,n,r,a){for(var i=[t,n];i.length;){var u=(0,o.assumeNonNull)(i.pop()),l=(0,o.assumeNonNull)(i.pop());if(!(u-l<=r)){var c=l+Math.ceil((u-l)/r/2)*r;(0,s.q)(e,c,l,u,a),i.push(l,c,c,u)}}}var _=new(0,u.default),I=new(0,u.default),k=new(0,u.default),w=new(0,u.default)({deallocator:void 0}),T=function(e){"use strict";a.inherits(n,e);var t=a.createSuper(n);function n(){var e;return a.classCallCheck(this,n),(e=t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments)))).height=1,e.indexHint=new(0,i.PositionHint),a.possibleConstructorReturn(e)}return n}((function e(){"use strict";a.classCallCheck(this,e),this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0})),S=function(e){"use strict";a.inherits(n,e);var t=a.createSuper(n);function n(e){var r;return a.classCallCheck(this,n),(r=t.call(this)).children=e,r.leaf=!0,a.possibleConstructorReturn(r)}return n}(T),M=function(e){"use strict";a.inherits(n,e);var t=a.createSuper(n);function n(e){var r;return a.classCallCheck(this,n),(r=t.call(this)).children=e,r.leaf=!1,a.possibleConstructorReturn(r)}return n}(T)})),n.register("1zB3R",(function(e,r){t(e.exports,"optimizedFeatureQueryEngineAdapter",(function(){return s}));var a=n("7qybv"),i=n("8mTF7"),o=n("ft2bT"),u=n("awxBI"),s={getObjectId:function(e){return e.objectId},getAttributes:function(e){return e.attributes},getAttribute:function(e,t){return e.attributes[t]},cloneWithGeometry:function(e,t){return new(0,o.OptimizedFeature)(t,e.attributes,null,e.objectId)},getGeometry:function(e){return e.geometry},getCentroid:function(e,t){return(0,a.isNone)(e.centroid)&&(e.centroid=(0,i.getCentroidOptimizedGeometry)(new(0,u.default),e.geometry,t.hasZ,t.hasM)),e.centroid}}})),n.register("8mTF7",(function(e,r){t(e.exports,"getCentroidOptimizedGeometry",(function(){return o}));var a=n("7qybv");function i(e,t){return e?t?4:3:t?3:2}function o(e,t,n,r,o){if((0,a.isNone)(t)||!t.lengths.length)return null;var d="upperLeft"===(null==o?void 0:o.originPosition)?-1:1;e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0);var h=e.coords,v=[],m=n?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],p=t.lengths,y=t.coords,x=i(n,r),g=0,b=!0,_=!1,I=void 0;try{for(var k,w=p[Symbol.iterator]();!(b=(k=w.next()).done);b=!0){var T=k.value,S=u(m,y,g,T,n,r,d);S&&v.push(S),g+=T*x}}catch(e){_=!0,I=e}finally{try{b||null==w.return||w.return()}finally{if(_)throw I}}if(v.sort((function(e,t){var r=d*e[2]-d*t[2];return 0===r&&n&&(r=e[4]-t[4]),r})),v.length){var M=6*v[0][2];h[0]=v[0][0]/M,h[1]=v[0][1]/M,n&&(M=6*v[0][4],h[2]=0!==M?v[0][3]/M:0),(h[0]<m[0]||h[0]>m[1]||h[1]<m[2]||h[1]>m[3]||n&&(h[2]<m[4]||h[2]>m[5]))&&(h.length=0)}if(!h.length){var N=t.lengths[0]?function(e,t,n,r,a){for(var o=i(r,a),u=t,d=t+o,h=0,v=0,m=0,p=0,y=0,x=n-1;y<x;y++,u+=o,d+=o){var g=e[u],b=e[u+1],_=e[u+2],I=e[d],k=e[d+1],w=e[d+2],T=r?l(g,b,_,I,k,w):s(g,b,I,k);if(T)if(h+=T,r){var S=f(g,b,_,I,k,w);v+=T*S[0],m+=T*S[1],p+=T*S[2]}else{var M=c(g,b,I,k);v+=T*M[0],m+=T*M[1]}}return h>0?r?[v/h,m/h,p/h]:[v/h,m/h]:n>0?r?[e[t],e[t+1],e[t+2]]:[e[t],e[t+1]]:null}(y,0,p[0],n,r):null;if(!N)return null;h[0]=N[0],h[1]=N[1],n&&N.length>2&&(h[2]=N[2])}return e}function u(e,t,n,r,a,o){for(var u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,s=i(a,o),l=n,c=n+s,f=0,d=0,h=0,v=0,m=0,p=0,y=r-1;p<y;p++,l+=s,c+=s){var x=t[l],g=t[l+1],b=t[l+2],_=t[c],I=t[c+1],k=t[c+2],w=x*I-_*g;v+=w,f+=(x+_)*w,d+=(g+I)*w,a&&(h+=(b+k)*(w=x*k-_*b),m+=w),x<e[0]&&(e[0]=x),x>e[1]&&(e[1]=x),g<e[2]&&(e[2]=g),g>e[3]&&(e[3]=g),a&&(b<e[4]&&(e[4]=b),b>e[5]&&(e[5]=b))}if(v*u>0&&(v*=-1),m*u>0&&(m*=-1),!v)return null;var T=[f,d,.5*v];return a&&(T[3]=h,T[4]=.5*m),T}function s(e,t,n,r){var a=n-e,i=r-t;return Math.sqrt(a*a+i*i)}function l(e,t,n,r,a,i){var o=r-e,u=a-t,s=i-n;return Math.sqrt(o*o+u*u+s*s)}function c(e,t,n,r){return[e+.5*(n-e),t+.5*(r-t)]}function f(e,t,n,r,a,i){return[e+.5*(r-e),t+.5*(a-t),n+.5*(i-n)]}})),n.register("fP7bp",(function(r,a){t(r.exports,"checkProjectionSupport",(function(){return p})),t(r.exports,"project",(function(){return b})),t(r.exports,"projectMany",(function(){return I}));var i=n("8TSCy"),o=n("2TvXO"),u=n("7qybv"),s=n("7RvA5"),l=n("jGyUI"),c=n("eY5Yp"),f=n("eF88h"),d=[0,0];function h(e,t){if(!t)return null;if("x"in t){var n,r={x:0,y:0};return n=i.slicedToArray(e(t.x,t.y,d),2),r.x=n[0],r.y=n[1],null!=t.z&&(r.z=t.z),null!=t.m&&(r.m=t.m),r}if("xmin"in t){var a,o,u={xmin:0,ymin:0,xmax:0,ymax:0};return a=i.slicedToArray(e(t.xmin,t.ymin,d),2),u.xmin=a[0],u.ymin=a[1],o=i.slicedToArray(e(t.xmax,t.ymax,d),2),u.xmax=o[0],u.ymax=o[1],t.hasZ&&(u.zmin=t.zmin,u.zmax=t.zmax,u.hasZ=!0),t.hasM&&(u.mmin=t.mmin,u.mmax=t.mmax,u.hasM=!0),u}return"rings"in t?{rings:v(t.rings,e),hasM:t.hasM,hasZ:t.hasZ}:"paths"in t?{paths:v(t.paths,e),hasM:t.hasM,hasZ:t.hasZ}:"points"in t?{points:m(t.points,e),hasM:t.hasM,hasZ:t.hasZ}:void 0}function v(e,t){var n=[],r=!0,a=!1,i=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;n.push(m(s,t))}}catch(e){a=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}return n}function m(e,t){var n=[],r=!0,a=!1,i=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value,l=t(s[0],s[1],[0,0]);n.push(l),s.length>2&&l.push(s[2]),s.length>3&&l.push(s[3])}}catch(e){a=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}return n}function p(e,t){return y.apply(this,arguments)}function y(){return(y=i.asyncToGenerator(e(o).mark((function t(n,r){var a;return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return a=Array.isArray(n)?n.map((function(e){return(0,u.isSome)(e.geometry)&&e.geometry.spatialReference})):[n],e.next=5,(0,s.initializeProjection)(a.map((function(e){return{source:e,dest:r}})));case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}var x=h.bind(null,f.lngLatToXY),g=h.bind(null,f.xyToLngLat);function b(e,t,n){if(!e)return e;if(n||(n=t,t=e.spatialReference),!(0,c.isValid)(t)||!(0,c.isValid)(n)||(0,c.equals)(t,n))return e;if((0,f.canProject)(t,n)){var r=(0,c.isWebMercator)(n)?x(e):g(e);return r.spatialReference=n,r}return(0,s.projectMany)(l.jsonAdapter,[e],t,n,null)[0]}var _=new(function(){"use strict";function t(){i.classCallCheck(this,t),this._jobs=[],this._timer=null,this._process=this._process.bind(this)}return i.createClass(t,[{key:"push",value:function(t,n,r){var a=this;return i.asyncToGenerator(e(o).mark((function i(){var u;return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.length&&n&&r&&!(0,c.equals)(n,r)){e.next=2;break}return e.abrupt("return",t);case 2:return u={geometries:t,inSpatialReference:n,outSpatialReference:r,resolve:null},e.abrupt("return",(a._jobs.push(u),new Promise((function(e){u.resolve=e,null===a._timer&&(a._timer=setTimeout(a._process,10))}))));case 4:case"end":return e.stop()}}),i)})))()}},{key:"_process",value:function(){this._timer=null;var e=this._jobs.shift();if(e){var t=e.geometries,n=e.inSpatialReference,r=e.outSpatialReference,a=e.resolve;(0,f.canProject)(n,r)?(0,c.isWebMercator)(r)?a(t.map(x)):a(t.map(g)):a((0,s.projectMany)(l.jsonAdapter,t,n,r,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}}}]),t}());function I(e,t,n){return _.push(e,t,n)}})),n.register("JpcDD",(function(r,a){t(r.exports,"parseRows",(function(){return m})),t(r.exports,"readRows",(function(){return d})),t(r.exports,"inferDelimiter",(function(){return v}));var i=n("2TvXO"),o=e(i).mark(m),u=e(i).mark(f),s=/^\s*"([\S\s]*)"\s*$/,l=/""/g,c=[","," ",";","|","\t"];function f(t,n,r){var a,o,s;return e(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=0;case 1:if(!(a<=t.length)){e.next=10;break}if(o=t.indexOf(n,a),s=t.substring(a,o>-1?o:void 0),a+=s.length+n.length,e.t0=r&&!s.trim(),e.t0){e.next=8;break}return e.next=8,s;case 8:e.next=1;break;case 10:case"end":return e.stop()}}),u)}function d(e){var t=e.includes("\r\n")?"\r\n":"\n";return f(e,t,!0)}function h(e,t){return f(e,t,!1)}function v(e){var t=e.trim(),n=0,r="",a=!0,i=!1,o=void 0;try{for(var u,s=c[Symbol.iterator]();!(a=(u=s.next()).done);a=!0){var l=u.value,f=t.split(l).length;f>n&&(n=f,r=l)}}catch(e){i=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(i)throw o}}return""===r?null:r}function m(t,n,r){var a,u,c,f,d,v,m,y,x,g,b,_,I,k,w,T,S,M,N,F,C=arguments;return e(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=C.length>3&&void 0!==C[3]?C[3]:function(){return Object.create(null)},u="",c="",f=0,d=a(),v=0,m=!0,y=!1,x=void 0,e.prev=3,g=t[Symbol.iterator]();case 5:if(m=(b=g.next()).done){e.next=55;break}_=b.value,I=h(_,r),k=!0,w=!1,T=void 0,e.prev=9,S=I[Symbol.iterator]();case 11:if(k=(M=S.next()).done){e.next=30;break}if(N=M.value,u+=c+N,c="",(f+=p(N))%2!=0){e.next=26;break}if(!(f>0)){e.next=22;break}if(F=s.exec(u)){e.next=19;break}return d=a(),v=0,u="",f=0,e.abrupt("continue",52);case 19:d[n[v]]=F[1].replace(l,'"'),v++,e.next=23;break;case 22:d[n[v]]=u,v++;case 23:u="",f=0,e.next=27;break;case 26:c=r;case 27:k=!0,e.next=11;break;case 30:e.next=36;break;case 32:e.prev=32,e.t0=e.catch(9),w=!0,T=e.t0;case 36:e.prev=36,e.prev=37,k||null==S.return||S.return();case 39:if(e.prev=39,!w){e.next=42;break}throw T;case 42:return e.finish(39);case 43:return e.finish(36);case 44:if(0!==f){e.next=51;break}return e.next=47,d;case 47:d=a(),v=0,e.next=52;break;case 51:c="\n";case 52:m=!0,e.next=5;break;case 55:e.next=61;break;case 57:e.prev=57,e.t1=e.catch(3),y=!0,x=e.t1;case 61:e.prev=61,e.prev=62,m||null==g.return||g.return();case 64:if(e.prev=64,!y){e.next=67;break}throw x;case 67:return e.finish(64);case 68:return e.finish(61);case 69:case"end":return e.stop()}}),o,null,[[3,57,61,69],[9,32,36,44],[37,,39,43],[62,,64,68]])}function p(e){var t=0,n=0;for(n=e.indexOf('"',n);n>=0;)t++,n=e.indexOf('"',n+1);return t}})),n.register("hbg1x",(function(e,r){t(e.exports,"isNullCountSupported",(function(){return f})),t(e.exports,"calculateStringStatistics",(function(){return d})),t(e.exports,"calculatePercentile",(function(){return v})),t(e.exports,"calculateStatistics",(function(){return h})),t(e.exports,"getAttributeComparator",(function(){return m})),t(e.exports,"processSummaryStatisticsResult",(function(){return x})),t(e.exports,"calculateUniqueValuesCount",(function(){return g})),t(e.exports,"createUVResult",(function(){return b})),t(e.exports,"getNormalizedValue",(function(){return _})),t(e.exports,"calculateClassBreaks",(function(){return I})),t(e.exports,"resolveCBResult",(function(){return k})),t(e.exports,"calculateHistogram",(function(){return w}));var a=n("8TSCy"),i=n("59jTx"),o=n("hxmJW"),u="equal-interval",s=/\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi,l=new Set(["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]),c=["min","max","avg","stddev","count","sum","variance","nullcount","median"];function f(e){var t=null!=e.normalizationField||null!=e.normalizationType,n=null!=e.minValue||null!=e.maxValue,r=!!e.sqlExpression&&e.supportsSQLExpression;return!t&&!n&&!r}function d(e){var t=e.returnDistinct?a.toConsumableArray(new Set(e.values)):e.values,n=t.filter((function(e){return null!=e})).length,r={count:n};return e.supportsNullCount&&(r.nullcount=t.length-n),e.percentileParams&&(r.median=v(t,e.percentileParams)),r}function h(e){var t=e.values,n=e.useSampleStdDev,r=e.supportsNullCount,a=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,o=null,u=null,s=null,l=null,c=0,f=null==e.minValue?-1/0:e.minValue,d=null==e.maxValue?1/0:e.maxValue,h=!0,m=!1,p=void 0;try{for(var y,x=t[Symbol.iterator]();!(h=(y=x.next()).done);h=!0){var g=y.value;Number.isFinite(g)?g>=f&&g<=d&&(o+=g,a=Math.min(a,g),i=Math.max(i,g),c++):"string"==typeof g&&c++}}catch(e){m=!0,p=e}finally{try{h||null==x.return||x.return()}finally{if(m)throw p}}if(c&&null!=o){u=o/c;var b=0,_=!0,I=!1,k=void 0;try{for(var w,T=t[Symbol.iterator]();!(_=(w=T.next()).done);_=!0){var S=w.value;Number.isFinite(S)&&S>=f&&S<=d&&(b+=Math.pow(S-u,2))}}catch(e){I=!0,k=e}finally{try{_||null==T.return||T.return()}finally{if(I)throw k}}l=n?c>1?b/(c-1):0:c>0?b/c:0,s=Math.sqrt(l)}else a=null,i=null;var M={avg:u,count:c,max:i,min:a,stddev:s,sum:o,variance:l};return r&&(M.nullcount=t.length-c),e.percentileParams&&(M.median=v(t,e.percentileParams)),M}function v(e,t){var n=t.fieldType,r=t.value,i=t.orderBy,o=t.isDiscrete,u=m(n,"desc"===i);if(0===(e=a.toConsumableArray(e).filter((function(e){return null!=e})).sort((function(e,t){return u(e,t)}))).length)return null;if(r<=0)return e[0];if(r>=1)return e[e.length-1];var s=(e.length-1)*r,l=Math.floor(s),c=l+1,f=s%1,d=e[l],h=e[c];return c>=e.length||o||"string"==typeof d||"string"==typeof h?d:d*(1-f)+h*f}function m(e,t){var n=t?1:-1,r=t?function(e,t){return t-e}:function(e,t){return e-t},i=p(t);if(!e||!["esriFieldTypeDate","esriFieldTypeString","esriFieldTypeGUID","esriFieldTypeGlobalID"].concat(a.toConsumableArray(l)).includes(e))return function(e,t){return"number"==typeof e&&"number"==typeof t?r(e,t):"string"==typeof e&&"string"==typeof t?i(e,t):n};if("esriFieldTypeDate"===e)return function(e,t){var a=new Date(e).getTime(),i=new Date(t).getTime();return isNaN(a)||isNaN(i)?n:r(a,i)};if(l.has(e))return function(e,t){return r(e,t)};if("esriFieldTypeString"===e)return function(e,t){return i(e,t)};if("esriFieldTypeGUID"===e||"esriFieldTypeGlobalID"===e){var o=p(t);return function(e,t){return o(y(e),y(t))}}return t?function(e,t){return 1}:function(e,t){return-1}}function p(e){return e?function(e,t){var n,r;return(e=null==(n=e)?void 0:n.toUpperCase())>(t=null==(r=t)?void 0:r.toUpperCase())?-1:e<t?1:0}:function(e,t){var n,r;return(e=null==(n=e)?void 0:n.toUpperCase())<(t=null==(r=t)?void 0:r.toUpperCase())?-1:e>t?1:0}}function y(e){return e.substr(24,12)+e.substr(19,4)+e.substr(16,2)+e.substr(14,2)+e.substr(11,2)+e.substr(9,2)+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)+e.substr(0,2)}function x(e,t){var n;for(n in e)c.indexOf(n)>-1&&(Number.isFinite(e[n])||(e[n]=null));return t?(["avg","stddev","variance"].forEach((function(t){null!=e[t]&&(e[t]=Math.ceil(e[t]))})),e):e}function g(e){var t={},n=!0,r=!1,a=void 0;try{for(var i,o=e[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var u=i.value;(null==u||"string"==typeof u&&""===u.trim())&&(u=null),null==t[u]?t[u]={count:1,data:u}:t[u].count++}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}return{count:t}}function b(e,t,n){var r=e.count,a=[];for(var i in n&&t&&"coded-value"===t.type&&t.codedValues.forEach((function(e){var t=e.code;r.hasOwnProperty(t)||(r[t]={data:t,count:0})})),r){var o=r[i];a.push({value:o.data,count:o.count,label:o.label})}return{uniqueValueInfos:a}}function _(e,t,n,r){var a=null;switch(t){case"log":0!==e&&(a=Math.log(e)*Math.LOG10E);break;case"percent-of-total":Number.isFinite(r)&&0!==r&&(a=e/r*100);break;case"field":Number.isFinite(n)&&0!==n&&(a=e/n);break;case"natural-log":e>0&&(a=Math.log(e));break;case"square-root":e>0&&(a=Math.pow(e,.5))}return a}function I(e,t){var n,r,a,s,l,c,f,d,h,v=(n={field:t.field,normalizationType:t.normalizationType,normalizationField:t.normalizationField,classificationMethod:t.classificationMethod,standardDeviationInterval:t.standardDeviationInterval,breakCount:t.numClasses||5},r=n.field,a=n.classificationMethod||u,s=n.normalizationType,l=n.normalizationField,(c=new(0,i.default)).classificationField=r,c.breakCount=n.breakCount,c.classificationMethod=a,c.standardDeviationInterval="standard-deviation"===a?n.standardDeviationInterval||1:void 0,c.normalizationType=s,c.normalizationField="field"===s?l:void 0,c);return f=e,d=t.minValue,h=t.maxValue,d=null==d?-1/0:d,h=null==h?1/0:h,e=f.filter((function(e){return Number.isFinite(e)&&e>=d&&e<=h})),(0,o.createGenerateRendererClassBreaks)({definition:v,values:e,normalizationTotal:t.normalizationTotal})}function k(e,t){var n=e.classBreaks,r=n.length,a=n[0].minValue,i=n[r-1].maxValue,o="standard-deviation"===t,u=s;return{minValue:a,maxValue:i,classBreakInfos:n=n.map((function(e){var t=e.label,n={minValue:e.minValue,maxValue:e.maxValue,label:t};if(o&&t){var r=t.match(u).map((function(e){return+e.trim()}));2===r.length?(n.minStdDev=r[0],n.maxStdDev=r[1],r[0]<0&&r[1]>0&&(n.hasAvg=!0)):1===r.length&&(t.includes("<")?(n.minStdDev=null,n.maxStdDev=r[0]):t.includes(">")&&(n.minStdDev=r[0],n.maxStdDev=null))}return n})),normalizationTotal:e.normalizationTotal}}function w(e,t){var n=function(e,t){var n=t.field,r=t.classificationMethod,a=t.standardDeviationInterval,i=t.normalizationType,o=t.normalizationField,u=t.normalizationTotal,s=t.minValue,l=t.maxValue,c=t.numBins||10,d=null,v=null,m=null;if(r&&"equal-interval"!==r||i){var p=I(e,{field:n,normalizationType:i,normalizationField:o,normalizationTotal:u,classificationMethod:r,standardDeviationInterval:a,minValue:s,maxValue:l,numClasses:c}).classBreaks;d=p[0].minValue,v=p[p.length-1].maxValue,m=p.map((function(e){return[e.minValue,e.maxValue]}))}else{if(null!=s&&null!=l)d=s,v=l;else{var y=h({values:e,minValue:s,maxValue:l,useSampleStdDev:!i,supportsNullCount:f({normalizationType:i,normalizationField:o,minValue:s,maxValue:l})});d=y.min,v=y.max}m=function(e,t,n){for(var r,a=(t-e)/n,i=[],o=e,u=1;u<=n;u++)r=o+a,r=Number(r.toFixed(16)),i.push([o,u===n?t:r]),o=r;return i}(d,v,c)}return{min:d,max:v,intervals:m}}(e,t),r=n.min,a=n.max,i=n.intervals,o=i.map((function(e,t){return{minValue:i[t][0],maxValue:i[t][1],count:0}})),u=!0,s=!1,l=void 0;try{for(var c,d=e[Symbol.iterator]();!(u=(c=d.next()).done);u=!0){var v=c.value;if(null!=v&&v>=r&&v<=a){var m=T(i,v);m>-1&&o[m].count++}}}catch(e){s=!0,l=e}finally{try{u||null==d.return||d.return()}finally{if(s)throw l}}return{bins:o,minValue:r,maxValue:a,normalizationTotal:t.normalizationTotal}}function T(e,t){for(var n=-1,r=e.length-1;r>=0;r--)if(t>=e[r][0]){n=r;break}return n}})),n.register("59jTx",(function(e,r){t(e.exports,"default",(function(){return h}));var a=n("8TSCy"),i=n("7eJjO"),o=n("79ASa"),u=n("iho5X");n("lNwWH"),n("2VlWd"),n("iJAIC");var s=n("fcwIv"),l=n("kt6hM"),c=new(0,o.JSONMap)({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"}),f=new(0,o.JSONMap)({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"}),d=function(e){"use strict";a.inherits(n,e);var t=a.createSuper(n);function n(){var e;return a.classCallCheck(this,n),(e=t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments)))).breakCount=null,e.classificationField=null,e.classificationMethod=null,e.normalizationField=null,e.normalizationType=null,e.type="class-breaks-definition",a.possibleConstructorReturn(e)}return a.createClass(n,[{key:"standardDeviationInterval",set:function(e){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",e)}},{key:"definedInterval",set:function(e){"defined-interval"===this.classificationMethod&&this._set("definedInterval",e)}}]),n}(l.default);(0,i._)([(0,u.property)({json:{write:!0}})],d.prototype,"breakCount",void 0),(0,i._)([(0,u.property)({json:{write:!0}})],d.prototype,"classificationField",void 0),(0,i._)([(0,u.property)({type:String,json:{read:c.read,write:c.write}})],d.prototype,"classificationMethod",void 0),(0,i._)([(0,u.property)({json:{write:!0}})],d.prototype,"normalizationField",void 0),(0,i._)([(0,u.property)({json:{read:f.read,write:f.write}})],d.prototype,"normalizationType",void 0),(0,i._)([(0,u.property)({value:null,json:{write:!0}})],d.prototype,"standardDeviationInterval",null),(0,i._)([(0,u.property)({value:null,json:{write:!0}})],d.prototype,"definedInterval",null),(0,i._)([(0,u.property)()],d.prototype,"type",void 0);var h=d=(0,i._)([(0,s.subclass)("esri.rest.support.ClassBreaksDefinition")],d)})),n.register("kt6hM",(function(e,r){t(e.exports,"default",(function(){return v}));var a=n("8TSCy"),i=n("7eJjO"),o=n("79ASa"),u=n("1XAcN"),s=n("iho5X");n("lNwWH"),n("2VlWd"),n("iJAIC");var l=n("fcwIv"),c=n("1DHtQ"),f=n("j9ZJv"),d=new(0,o.JSONMap)({classBreaksDef:"class-breaks-definition",uniqueValueDef:"unique-value-definition"}),h=function(e){"use strict";a.inherits(n,e);var t=a.createSuper(n);function n(){var e;return a.classCallCheck(this,n),(e=t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments)))).baseSymbol=null,e.colorRamp=null,e.type=null,a.possibleConstructorReturn(e)}return n}(u.JSONSupport);(0,i._)([(0,s.property)({type:f.default,json:{write:!0}})],h.prototype,"baseSymbol",void 0),(0,i._)([(0,s.property)({types:c.types,json:{read:{reader:c.fromJSON},write:!0}})],h.prototype,"colorRamp",void 0),(0,i._)([(0,s.property)({json:{read:d.read,write:d.write}})],h.prototype,"type",void 0);var v=h=(0,i._)([(0,l.subclass)("esri.rest.support.ClassificationDefinition")],h)})),n.register("hxmJW",(function(e,n){function r(e,t){return Number(e.toFixed(t))}function a(e){var t=e.normalizationTotal;return{classBreaks:i(e),normalizationTotal:t}}function i(e){var t=e.definition,n=t.classificationMethod,a=t.breakCount,i=t.normalizationType,c=t.definedInterval,f=[],d=e.values;if(0===d.length)return[];var h,v,m,p,y,x,g=(d=d.sort((function(e,t){return e-t})))[0],b=d[d.length-1];if("equal-interval"===n)if(d.length>=a){for(var _=(b-g)/a,I=g,k=1;k<a;k++){var w=r(g+k*_,6);f.push({minValue:I,maxValue:w,label:o(I,w,i)}),I=w}f.push({minValue:I,maxValue:b,label:o(I,b,i)})}else d.forEach((function(e){f.push({minValue:e,maxValue:e,label:o(e,e,i)})}));else if("natural-breaks"===n){for(var T=u(d),S=e.valueFrequency||T.valueFrequency,M=function(e,t,n){var r=e.length,a=[];n>r&&(n=r);for(var i=0;i<n;i++)a.push(Math.round(i*r/n-1));a.push(r-1);var o=s(a,e,t,n);return function(e,t,n,r,a,i){for(var o=0,u=0,s=0,c=0,f=!0,d=0;d<2&&f;d++){0===d&&(f=!1);for(var h=0;h<i-1;h++)for(;n[h+1]+1!==n[h+2];){n[h+1]=n[h+1]+1;var v=l(h,n,r,a);s=v.sbMean,o=v.sbSdcm;var m=l(h+1,n,r,a);if(c=m.sbMean,!(o+(u=m.sbSdcm)<t[h]+t[h+1])){n[h+1]=n[h+1]-1;break}t[h]=o,t[h+1]=u,e[h]=s,e[h+1]=c,f=!0}for(var p=i-1;p>0;p--)for(;n[p]!==n[p-1]+1;){n[p]=n[p]-1;var y=l(p-1,n,r,a);s=y.sbMean,o=y.sbSdcm;var x=l(p,n,r,a);if(c=x.sbMean,!(o+(u=x.sbSdcm)<t[p-1]+t[p])){n[p]=n[p]+1;break}t[p-1]=o,t[p]=u,e[p-1]=s,e[p]=c,f=!0}}return f}(o.mean,o.sdcm,a,e,t,n)&&(o=s(a,e,t,n)),a}(T.uniqueValues,S,a),N=g,F=1;F<a;F++)if(T.uniqueValues.length>F){var C=r(T.uniqueValues[M[F]],6);f.push({minValue:N,maxValue:C,label:o(N,C,i)}),N=C}f.push({minValue:N,maxValue:b,label:o(N,b,i)})}else if("quantile"===n)if(d.length>=a&&g!==b){for(var B=g,V=Math.ceil(d.length/a),E=0,j=1;j<a;j++){var z=V+E-1;z>d.length&&(z=d.length-1),z<0&&(z=0),f.push({minValue:B,maxValue:d[z],label:o(B,d[z],i)}),B=d[z],E+=V,V=Math.ceil((d.length-E)/(a-j))}f.push({minValue:B,maxValue:b,label:o(B,b,i)})}else for(var Y=-1,D=0;D<d.length;D++){var q=d[D];q!==Y&&(Y=q,f.push({minValue:Y,maxValue:q,label:o(Y,q,i)}),Y=q)}else if("standard-deviation"===n){var P=function(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t/e.length}(d),O=function(e,t){for(var n=0,r=0;r<e.length;r++){var a=e[r];n+=(a-t)*(a-t)}return n/=e.length,Math.sqrt(n)}(d,P);if(0===O)f.push({minValue:d[0],maxValue:d[0],label:o(d[0],d[0],i)});else{for(var A=(h=g,v=b,m=a,p=P,y=O,((x=Math.max(p-h,v-p)/y/m)>=1?1:x>=.5?.5:.25)*O),X=0,R=g,G=a;G>=1;G--){var Z=r(P-(G-.5)*A,6);f.push({minValue:R,maxValue:Z,label:o(R,Z,i)}),R=Z,X++}var L=r(P+.5*A,6);f.push({minValue:R,maxValue:L,label:o(R,L,i)}),R=L,X++;for(var J=1;J<=a;J++)L=X===2*a?b:r(P+(J+.5)*A,6),f.push({minValue:R,maxValue:L,label:o(R,L,i)}),R=L,X++}}else if("defined-interval"===n){if(!c)return f;for(var W=d[0],U=d[d.length-1],Q=Math.ceil((U-W)/c),H=W,$=1;$<Q;$++){var K=r(W+$*c,6);f.push({minValue:H,maxValue:K,label:o(H,K,i)}),H=K}f.push({minValue:H,maxValue:U,label:o(H,U,i)})}return f}function o(e,t,n){return e===t?n&&"percent-of-total"===n?e+"%":e.toString():n&&"percent-of-total"===n?e+"% - "+t+"%":e+" - "+t}function u(e){for(var t=[],n=[],r=Number.MIN_VALUE,a=1,i=-1,o=0;o<e.length;o++){var u=e[o];u===r?(a++,n[i]=a):null!==u&&(t.push(u),r=u,a=1,n.push(a),i++)}return{uniqueValues:t,valueFrequency:n}}function s(e,t,n,r){for(var a=[],i=[],o=[],u=0,s=[],c=[],f=0;f<r;f++){var d=l(f,e,t,n);s.push(d.sbMean),c.push(d.sbSdcm),u+=c[f]}for(var h,v=u,m=!0;m||u<v;){m=!1,a=[];for(var p=0;p<r;p++)a.push(e[p]);for(var y=0;y<r;y++)for(var x=e[y]+1;x<=e[y+1];x++)if(h=t[x],y>0&&x!==e[y+1]&&Math.abs(h-s[y])>Math.abs(h-s[y-1]))e[y]=x;else if(y<r-1&&e[y]!==x-1&&Math.abs(h-s[y])>Math.abs(h-s[y+1])){e[y+1]=x-1;break}v=u,u=0,i=[],o=[];for(var g=0;g<r;g++){i.push(s[g]),o.push(c[g]);var b=l(g,e,t,n);s[g]=b.sbMean,c[g]=b.sbSdcm,u+=c[g]}}if(u>v){for(var _=0;_<r;_++)e[_]=a[_],s[_]=i[_],c[_]=o[_];u=v}return{mean:s,sdcm:c}}function l(e,t,n,r){for(var a=0,i=0,o=t[e]+1;o<=t[e+1];o++){var u=r[o];a+=n[o]*u,i+=u}i<=0&&console.log("Exception in Natural Breaks calculation");for(var s=a/i,l=0,c=t[e]+1;c<=t[e+1];c++)l+=r[c]*Math.pow(n[c]-s,2);return{sbMean:s,sbSdcm:l}}t(e.exports,"createGenerateRendererClassBreaks",(function(){return a}))})),n.register("ibKgR",(function(e,r){t(e.exports,"toQuantizationTransform",(function(){return c})),t(e.exports,"quantizePoint",(function(){return g})),t(e.exports,"quantizeGeometry",(function(){return I})),t(e.exports,"unquantizeMultipoint",(function(){return k})),t(e.exports,"unquantizePoint",(function(){return w})),t(e.exports,"unquantizePolygon",(function(){return T})),t(e.exports,"unquantizePolyline",(function(){return S}));var a=n("8TSCy"),i=n("7qybv"),o=n("79LpT");var u=function(e,t,n){return[t,n]},s=function(e,t,n){return[t,n,e[2]]},l=function(e,t,n){return[t,n,e[2],e[3]]};function c(e){return e?{originPosition:"upper-left"===e.originPosition?"upperLeft":"lower-left"===e.originPosition?"lowerLeft":e.originPosition,scale:e.tolerance?[e.tolerance,e.tolerance]:[1,1],translate:(0,i.isSome)(e.extent)?[e.extent.xmin,e.extent.ymax]:[0,0]}:null}function f(e,t){var n=e.scale,r=e.translate;return Math.round((t-r[0])/n[0])}function d(e,t){var n=e.scale,r=e.translate;return Math.round((r[1]-t)/n[1])}function h(e,t,n){for(var r,a,i,o,u=[],s=0;s<n.length;s++){var l=n[s];s>0?(i=f(e,l[0]),o=d(e,l[1]),i===r&&o===a||(u.push(t(l,i-r,o-a)),r=i,a=o)):(r=f(e,l[0]),a=d(e,l[1]),u.push(t(l,r,a)))}return u.length>0?u:null}function v(e,t){var n=e.scale,r=e.translate;return t*n[0]+r[0]}function m(e,t){var n=e.scale;return e.translate[1]-t*n[1]}function p(e,t,n){var r=new Array(n.length);if(!n.length)return r;var i=a.slicedToArray(e.scale,2),o=i[0],u=i[1],s=v(e,n[0][0]),l=m(e,n[0][1]);r[0]=t(n[0],s,l);for(var c=1;c<n.length;c++){var f=n[c];s+=f[0]*o,l-=f[1]*u,r[c]=t(f,s,l)}return r}function y(e,t,n){for(var r=new Array(n.length),a=0;a<n.length;a++)r[a]=p(e,t,n[a]);return r}function x(e,t,n,r,a){return t.points=(i=e,o=n.points,c=a,h(i,r?c?l:s:c?s:u,o)),t;var i,o,c}function g(e,t,n,r,a){return t.x=f(e,n.x),t.y=d(e,n.y),t!==n&&(r&&(t.z=n.z),a&&(t.m=n.m)),t}function b(e,t,n,r,a){var i=function(e,t,n,r){for(var a=[],i=n?r?l:s:r?s:u,o=0;o<t.length;o++){var c=h(e,i,t[o]);c&&c.length>=3&&a.push(c)}return a.length?a:null}(e,n.rings,r,a);return i?(t.rings=i,t):null}function _(e,t,n,r,a){var i=function(e,t,n,r){for(var a=[],i=n?r?l:s:r?s:u,o=0;o<t.length;o++){var c=h(e,i,t[o]);c&&c.length>=2&&a.push(c)}return a.length?a:null}(e,n.paths,r,a);return i?(t.paths=i,t):null}function I(e,t){return e&&t?(0,o.isPoint)(t)?g(e,{},t,!1,!1):(0,o.isPolyline)(t)?_(e,{},t,!1,!1):(0,o.isPolygon)(t)?b(e,{},t,!1,!1):(0,o.isMultipoint)(t)?x(e,{},t,!1,!1):(0,o.isExtent)(t)?(i=!1,u=!1,(r={}).xmin=f(n=e,(a=t).xmin),r.ymin=d(n,a.ymin),r.xmax=f(n,a.xmax),r.ymax=d(n,a.ymax),r!==a&&(i&&(r.zmin=a.zmin,r.zmax=a.zmax),u&&(r.mmin=a.mmin,r.mmax=a.mmax)),r):null:null;var n,r,a,i,u}function k(e,t,n,r,a){return(0,i.isSome)(n)&&(t.points=(o=e,c=n.points,f=a,p(o,r?f?l:s:f?s:u,c))),t;var o,c,f}function w(e,t,n,r,a){return(0,i.isNone)(n)||(t.x=v(e,n.x),t.y=m(e,n.y),t!==n&&(r&&(t.z=n.z),a&&(t.m=n.m))),t}function T(e,t,n,r,a){return(0,i.isSome)(n)&&(t.rings=(o=e,c=n.rings,f=a,y(o,r?f?l:s:f?s:u,c))),t;var o,c,f}function S(e,t,n,r,a){return(0,i.isSome)(n)&&(t.paths=(o=e,c=n.paths,f=a,y(o,r?f?l:s:f?s:u,c))),t;var o,c,f}}))}();
//# sourceMappingURL=CSVSourceWorker.874771f8.js.map
