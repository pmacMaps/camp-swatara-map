!function(){function e(e){return e&&e.__esModule?e.default:e}function t(e,t,r,n){Object.defineProperty(e,t,{get:r,set:n,enumerable:!0,configurable:!0})}var r=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire594f;r.register("cVss7",(function(n,i){var a;a=n.exports,Object.defineProperty(a,"__esModule",{value:!0,configurable:!0}),t(n.exports,"default",(function(){return T}));var s=r("8TSCy"),o=r("2TvXO"),u=r("7eJjO"),l=r("bsvXr"),c=r("d2yMj"),h=r("lKPaD"),f=r("iho5X");r("lNwWH"),r("2VlWd"),r("iJAIC");var p=r("fcwIv"),d=r("iWNhG"),v=r("bmS2f"),y=r("dIFqf"),x=r("3RWte"),m=r("i90HN"),g=r("csASp"),b=r("dw9r5"),w=r("iBY1U"),_=r("30vBn"),k=r("hfthk"),S=function(t){"use strict";s.inherits(n,t);var r=s.createSuper(n);function n(){var e;return s.classCallCheck(this,n),(e=r.call.apply(r,[this].concat(Array.prototype.slice.call(arguments))))._exportImageVersion=-1,e._highlightGraphics=new(0,d.GraphicsCollection),e.subview=null,s.possibleConstructorReturn(e)}return s.createClass(n,[{key:"pixelData",get:function(){return this.updating?null:"getPixelData"in this.subview?this.subview.getPixelData():null}},{key:"updating",get:function(){return!!(!this.subview||"updating"in this.subview&&this.subview.updating)}},{key:"hitTest",value:function(t,r){var n=this;return s.asyncToGenerator(e(o).mark((function r(){return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.subview?[n.subview.hitTest(t)]:null);case 1:case"end":return e.stop()}}),r)})))()}},{key:"update",value:function(e){var t;null==(t=this.subview)||t.update(e)}},{key:"attach",value:function(){var e=this;this.layer.increaseRasterJobHandlerUsage(),this._setSubView(),this.view&&(this._highlightView=new(0,x.default)({view:this.view,graphics:this._highlightGraphics,requestUpdateCallback:function(){return e.requestUpdate()},container:new(0,m.default)(this.view.featuresTilingScheme)}),this.container.addChild(this._highlightView.container)),this.handles.add([(0,h.watch)((function(){var t;return null!=(t=e.layer.blendMode)?t:"normal"}),(function(t){return e.subview.container.blendMode=t}),h.syncAndInitial),(0,h.watch)((function(){var t;return null!=(t=e.layer.effect)?t:null}),(function(t){return e.subview.container.effect=t}),h.syncAndInitial),(0,h.watch)((function(){return e.layer.exportImageServiceParameters.version}),(function(t){t&&e._exportImageVersion!==t&&(e._exportImageVersion=t,e.requestUpdate())}),h.sync),(0,h.watch)((function(){return e.timeExtent}),(function(t){e.subview.timeExtent=t,"redraw"in e.subview?e.requestUpdate():e.subview.redrawOrRefetch()}),h.sync),this.layer.on("redraw",(function(){"redraw"in e.subview?e.subview.redraw():e.subview.redrawOrRefetch()})),(0,h.watch)((function(){return e.layer.renderer}),(function(){return e._setSubView()}))],"imagerylayerview-update")}},{key:"detach",value:function(){var e,t;this.layer.decreaseRasterJobHandlerUsage(),this.container.removeAllChildren(),this._detachSubview(this.subview),null==(e=this.subview)||e.destroy(),this.handles.remove("imagerylayerview-update"),this.subview=null,null==(t=this._highlightView)||t.destroy(),this._exportImageVersion=-1}},{key:"moveStart",value:function(){}},{key:"viewChange",value:function(){}},{key:"moveEnd",value:function(){this.requestUpdate()}},{key:"highlight",value:function(e,t){var r=this;if(!((Array.isArray(e)?e[0]:c.default.isCollection(e)?e.getItemAt(0):e)instanceof l.default))return{remove:function(){}};var n=[];return Array.isArray(e)||c.default.isCollection(e)?n=e.map((function(e){return e.clone()})):e instanceof l.default&&(n=[e.clone()]),this._highlightGraphics.addMany(n),{remove:function(){r._highlightGraphics.removeMany(n)}}}},{key:"doRefresh",value:function(){var t=this;return s.asyncToGenerator(e(o).mark((function r(){return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.requestUpdate();case 1:case"end":return e.stop()}}),r)})))()}},{key:"isUpdating",value:function(){return!this.subview||this.subview.updating}},{key:"_setSubView",value:function(){var e;if(this.view){var t=null==(e=this.layer.renderer)?void 0:e.type,r="imagery";if("vector-field"===t&&"lerc"===this.layer.format?r="imageryVF":"flow"===t&&(r="flow"),this.subview){var n;if(this.subview.type===r)return this._attachSubview(this.subview),void("flow"===this.subview.type&&this.subview.redrawOrRefetch());this._detachSubview(this.subview),null==(n=this.subview)||n.destroy()}this.subview="imagery"===r?new(0,g.default)({layer:this.layer,view:this.view,timeExtent:this.timeExtent}):"imageryVF"===r?new(0,b.default)({layer:this.layer,view:this.view,timeExtent:this.timeExtent}):new(0,v.default)({layer:this.layer,layerView:this}),this._attachSubview(this.subview),this.requestUpdate()}}},{key:"_attachSubview",value:function(e){e&&!e.attached&&(e.attach(),e.attached=!0,this.container.addChildAt(e.container,0),e.container.blendMode=this.layer.blendMode,e.container.effect=this.layer.effect)}},{key:"_detachSubview",value:function(e){null!=e&&e.attached&&(this.container.removeChild(e.container),e.detach(),e.attached=!1)}}]),n}((0,w.ImageryLayerView)((0,k.RefreshableLayerView)((0,y.LayerView2DMixin)(_.default))));(0,u._)([(0,f.property)()],S.prototype,"pixelData",null),(0,u._)([(0,f.property)({readOnly:!0})],S.prototype,"updating",null),(0,u._)([(0,f.property)()],S.prototype,"subview",void 0);var T=S=(0,u._)([(0,p.subclass)("esri.views.2d.layers.ImageryLayerView2D")],S)})),r.register("i90HN",(function(e,n){t(e.exports,"default",(function(){return h}));var i=r("8TSCy"),a=r("7eJjO");r("jHOLN"),r("iJAIC"),r("lNwWH"),r("2VlWd"),r("62edV");var s=r("fcwIv"),o=r("66IJZ"),u=r("kL0tX"),l=r("8JzMA"),c=function(e){"use strict";i.inherits(r,e);var t=i.createSuper(r);function r(){return i.classCallCheck(this,r),t.apply(this,arguments)}return i.createClass(r,[{key:"renderChildren",value:function(e){if(e.drawPhase===o.WGLDrawPhase.HIGHLIGHT&&(this.attributeView.bindTextures(e.context),this.children.some((function(e){return e.hasData})))){i.get(i.getPrototypeOf(r.prototype),"renderChildren",this).call(this,e);var t=e.painter.effects.highlight;t.bind(e),e.context.setColorMask(!0,!0,!0,!0),e.context.clear(l.ClearBufferBit.COLOR_BUFFER_BIT),this._renderChildren(e,t.defines.concat(["highlightAll"])),t.draw(e),t.unbind()}}}]),r}(u.default),h=c=(0,a._)([(0,s.subclass)("esri.views.2d.layers.support.HighlightGraphicContainer")],c)})),r.register("csASp",(function(e,n){t(e.exports,"default",(function(){return b}));var i=r("8TSCy"),a=r("7eJjO"),s=r("bsvXr"),o=r("jymfC"),u=r("jHOLN"),l=r("7qybv"),c=r("10vEZ"),h=r("iho5X");r("lNwWH"),r("2VlWd"),r("iJAIC");var f=r("fcwIv"),p=r("alctY"),d=r("1UuUA"),v=r("cOrC4"),y=r("9rklz"),x=r("3UAL3"),m=u.default.getLogger("esri.views.2d.layers.imagery.ImageryView2D"),g=function(e){"use strict";i.inherits(r,e);var t=i.createSuper(r);function r(){var e;return i.classCallCheck(this,r),(e=t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments)))).attached=!1,e.container=new(0,v.Container),e.updateRequested=!1,e.type="imagery",e._bitmapView=new(0,d.BitmapContainer),i.possibleConstructorReturn(e)}return i.createClass(r,[{key:"destroy",value:function(){this.attached&&(this.detach(),this.attached=!1),this.updateRequested=!1}},{key:"updating",get:function(){return!this.attached||this.isUpdating()}},{key:"update",value:function(e){this.strategy.update(e).catch((function(e){(0,c.isAbortError)(e)||m.error(e)}))}},{key:"hitTest",value:function(e){return new(0,s.default)({attributes:{},geometry:e.clone(),layer:this.layer})}},{key:"attach",value:function(){var e=this;this.container.addChild(this._bitmapView);var t=this.layer.version>=10,r=this.layer.version>=10.1?this.layer.imageMaxHeight:2048,n=this.layer.version>=10.1?this.layer.imageMaxWidth:2048;this.strategy=new(0,x.default)({container:this._bitmapView,imageNormalizationSupported:t,imageMaxHeight:r,imageMaxWidth:n,fetchSource:this._fetchImage.bind(this),requestUpdate:function(){return e.requestUpdate()}})}},{key:"detach",value:function(){this.strategy.destroy(),this._bitmapView.removeAllChildren(),this.container.removeAllChildren(),this.updateRequested=!1}},{key:"redraw",value:function(){var e=this;this.strategy.updateExports((function(t){var r=e;t.source instanceof HTMLImageElement?t.requestRender():e.layer.applyRenderer({pixelBlock:t.source.pixelBlock}).then((function(e){var n=r,i=t.source;i.pixelBlock=e.pixelBlock,i.filter=function(e){return n.layer.applyFilter(e)},r.container.requestRender()}))}))}},{key:"requestUpdate",value:function(){this.updateRequested||(this.updateRequested=!0,this.view.requestUpdate())}},{key:"isUpdating",value:function(){return this.strategy.updating||this.updateRequested}},{key:"getPixelData",value:function(){if(this.updating)return null;var e=this.strategy.bitmaps;if(1===e.length&&e[0].source)return{extent:e[0].source.extent,pixelBlock:e[0].source.originalPixelBlock};if(e.length>1){var t=this.view.extent,r=e.map((function(e){return e.source})).filter((function(e){return e.extent&&e.extent.intersects(t)})).map((function(e){return{extent:e.extent,pixelBlock:e.originalPixelBlock}})),n=(0,p.mosaicPixelData)(r,t);return(0,l.isSome)(n)?{extent:n.extent,pixelBlock:n.pixelBlock}:null}return null}},{key:"_fetchImage",value:function(e,t,r,n){var i=this;return(n=n||{}).timeExtent=this.timeExtent,n.requestAsImageElement=!0,this.layer.fetchImage(e,t,r,n).then((function(e){return e.imageElement?e.imageElement:i.layer.applyRenderer(e.pixelData,{signal:n.signal}).then((function(t){var r=i,n=new(0,y.default)(t.pixelBlock,t.extent.clone(),e.pixelData.pixelBlock);return n.filter=function(e){return r.layer.applyFilter(e)},n}))}))}}]),r}(o.default);(0,a._)([(0,h.property)()],g.prototype,"attached",void 0),(0,a._)([(0,h.property)()],g.prototype,"container",void 0),(0,a._)([(0,h.property)()],g.prototype,"layer",void 0),(0,a._)([(0,h.property)()],g.prototype,"strategy",void 0),(0,a._)([(0,h.property)()],g.prototype,"timeExtent",void 0),(0,a._)([(0,h.property)()],g.prototype,"view",void 0),(0,a._)([(0,h.property)()],g.prototype,"updateRequested",void 0),(0,a._)([(0,h.property)()],g.prototype,"updating",null),(0,a._)([(0,h.property)()],g.prototype,"type",void 0);var b=g=(0,a._)([(0,f.subclass)("esri.views.2d.layers.imagery.ImageryView2D")],g)})),r.register("1UuUA",(function(e,n){t(e.exports,"BitmapContainer",(function(){return o}));var i=r("8TSCy"),a=r("jhrt5"),s=r("66IJZ"),o=function(e){"use strict";i.inherits(r,e);var t=i.createSuper(r);function r(){return i.classCallCheck(this,r),t.apply(this,arguments)}return i.createClass(r,[{key:"requiresDedicatedFBO",get:function(){return this.children.some((function(e){return"additive"===e.blendFunction}))}},{key:"prepareRenderPasses",value:function(e){var t=this,n=e.registerRenderPass({name:"bitmap",brushes:[a.brushes.bitmap],target:function(){return t.children},drawPhase:s.WGLDrawPhase.MAP});return i.toConsumableArray(i.get(i.getPrototypeOf(r.prototype),"prepareRenderPasses",this).call(this,e)).concat([n])}}]),r}(r("3FBIK").default)})),r.register("cOrC4",(function(e,n){t(e.exports,"Container",(function(){return o}));var i=r("8TSCy"),a=r("eYrMi"),s=r("a4nX6"),o=function(e){"use strict";i.inherits(r,e);var t=i.createSuper(r);function r(){var e;return i.classCallCheck(this,r),(e=t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments))))._childrenSet=new Set,e._needsSort=!1,e.children=[],e._effectView=null,i.possibleConstructorReturn(e)}return i.createClass(r,[{key:"blendMode",get:function(){return this._blendMode},set:function(e){this._blendMode=e,this.requestRender()}},{key:"clips",get:function(){return this._clips},set:function(e){this._clips=e,this.children.forEach((function(t){return t.clips=e}))}},{key:"computedEffects",get:function(){var e,t;return null!=(e=null==(t=this._effectView)?void 0:t.effects)?e:null}},{key:"effect",get:function(){var e,t;return null!=(e=null==(t=this._effectView)?void 0:t.effect)?e:""},set:function(e){(this._effectView||e)&&(this._effectView||(this._effectView=new(0,s.EffectView)),this._effectView.effect=e,this.requestRender())}},{key:"updateTransitionProperties",value:function(e,t){i.get(i.getPrototypeOf(r.prototype),"updateTransitionProperties",this).call(this,e,t),this._effectView&&(this._effectView.transitionStep(e,t),this._effectView.transitioning&&this.requestRender())}},{key:"doRender",value:function(e){var t=this.createRenderParams(e);this.renderChildren(t)}},{key:"addChild",value:function(e){return this.addChildAt(e,this.children.length)}},{key:"addChildAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.children.length;if(!e)return e;if(this.contains(e))return e;this._needsSort=!0;var r=e.parent;return r&&r!==this&&r.removeChild(e),t>=this.children.length?this.children.push(e):this.children.splice(t,0,e),this._childrenSet.add(e),e.parent=this,e.stage=this.stage,this!==this.stage&&(e.clips=this.clips),this.requestRender(),e}},{key:"contains",value:function(e){return this._childrenSet.has(e)}},{key:"removeAllChildren",value:function(){this._childrenSet.clear(),this._needsSort=!0;var e=!0,t=!1,r=void 0;try{for(var n,i=this.children[Symbol.iterator]();!(e=(n=i.next()).done);e=!0){var a=n.value;this!==this.stage&&(a.clips=null),a.stage=null,a.parent=null}}catch(e){t=!0,r=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw r}}this.children.length=0}},{key:"removeChild",value:function(e){return this.contains(e)?this.removeChildAt(this.children.indexOf(e)):e}},{key:"removeChildAt",value:function(e){if(e<0||e>=this.children.length)return null;this._needsSort=!0;var t=this.children.splice(e,1)[0];return this._childrenSet.delete(t),this!==this.stage&&(t.clips=null),t.stage=null,t.parent=null,t}},{key:"sortChildren",value:function(e){this._needsSort&&(this.children.sort(e),this._needsSort=!1)}},{key:"_createTransforms",value:function(){return{dvs:(0,a.c)()}}},{key:"onAttach",value:function(){i.get(i.getPrototypeOf(r.prototype),"onAttach",this).call(this);var e=this.stage,t=!0,n=!1,a=void 0;try{for(var s,o=this.children[Symbol.iterator]();!(t=(s=o.next()).done);t=!0){s.value.stage=e}}catch(e){n=!0,a=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw a}}}},{key:"onDetach",value:function(){i.get(i.getPrototypeOf(r.prototype),"onDetach",this).call(this);var e=!0,t=!1,n=void 0;try{for(var a,s=this.children[Symbol.iterator]();!(e=(a=s.next()).done);e=!0){a.value.stage=null}}catch(e){t=!0,n=e}finally{try{e||null==s.return||s.return()}finally{if(t)throw n}}}},{key:"renderChildren",value:function(e){var t=!0,r=!1,n=void 0;try{for(var i,a=this.children[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){i.value.beforeRender(e)}}catch(e){r=!0,n=e}finally{try{t||null==a.return||a.return()}finally{if(r)throw n}}var s=!0,o=!1,u=void 0;try{for(var l,c=this.children[Symbol.iterator]();!(s=(l=c.next()).done);s=!0){l.value.processRender(e)}}catch(e){o=!0,u=e}finally{try{s||null==c.return||c.return()}finally{if(o)throw u}}var h=!0,f=!1,p=void 0;try{for(var d,v=this.children[Symbol.iterator]();!(h=(d=v.next()).done);h=!0){d.value.afterRender(e)}}catch(e){f=!0,p=e}finally{try{h||null==v.return||v.return()}finally{if(f)throw p}}}},{key:"createRenderParams",value:function(e){return i.objectSpread({},e,{blendMode:this.blendMode,effects:this.computedEffects,globalOpacity:e.globalOpacity*this.computedOpacity,inFadeTransition:this.inFadeTransition})}}]),r}(r("2qlsz").DisplayObject)})),r.register("2qlsz",(function(e,n){t(e.exports,"DisplayObject",(function(){return c}));var i=r("8TSCy"),a=r("amfHf"),s=r("2VlWd"),o=r("7qybv"),u=r("10vEZ"),l=1/(0,s.default)("mapview-transitions-duration"),c=function(e){"use strict";i.inherits(r,e);var t=i.createSuper(r);function r(){var e;return i.classCallCheck(this,r),(e=t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments))))._fadeOutResolver=null,e._fadeInResolver=null,e._clips=null,e.computedVisible=!0,e.computedOpacity=1,e.fadeTransitionEnabled=!1,e.inFadeTransition=!1,e._isReady=!1,e._opacity=1,e._stage=null,e._visible=!0,i.possibleConstructorReturn(e)}return i.createClass(r,[{key:"clips",get:function(){return this._clips},set:function(e){this._clips=e,this.requestRender()}},{key:"isReady",get:function(){return this._isReady}},{key:"opacity",get:function(){return this._opacity},set:function(e){this._opacity!==e&&(this._opacity=Math.min(1,Math.max(e,0)),this.requestRender())}},{key:"stage",get:function(){return this._stage},set:function(e){if(this._stage!==e){var t=this._stage;this._stage=e,e?this._stage.untrashDisplayObject(this)||(this.onAttach(),this.emit("attach")):t.trashDisplayObject(this)}}},{key:"transforms",get:function(){return this._getTransforms()}},{key:"_getTransforms",value:function(){return(0,o.isNone)(this._transforms)&&(this._transforms=this._createTransforms()),this._transforms}},{key:"visible",get:function(){return this._visible},set:function(e){this._visible!==e&&(this._visible=e,this.requestRender())}},{key:"fadeIn",value:function(){return this._fadeInResolver||(this._fadeOutResolver&&(this._fadeOutResolver(),this._fadeOutResolver=null),this.computedOpacity=0,this.fadeTransitionEnabled=!0,this._fadeInResolver=(0,u.createResolver)(),this.requestRender()),this._fadeInResolver.promise}},{key:"fadeOut",value:function(){return this._fadeOutResolver||(this._fadeInResolver&&(this._fadeInResolver(),this._fadeInResolver=null),this.fadeTransitionEnabled=!0,this._fadeOutResolver=(0,u.createResolver)(),this.requestRender()),this._fadeOutResolver.promise}},{key:"beforeRender",value:function(e){this.updateTransitionProperties(e.deltaTime,e.state.scale)}},{key:"afterRender",value:function(e){this._fadeInResolver&&this.computedOpacity===this.opacity?(this._fadeInResolver(),this._fadeInResolver=null):this._fadeOutResolver&&0===this.computedOpacity&&(this._fadeOutResolver(),this._fadeOutResolver=null)}},{key:"remove",value:function(){var e;null==(e=this.parent)||e.removeChild(this)}},{key:"setTransform",value:function(e){}},{key:"processRender",value:function(e){this.stage&&this.computedVisible&&this.doRender(e)}},{key:"requestRender",value:function(){this.stage&&this.stage.requestRender()}},{key:"processDetach",value:function(){this._fadeInResolver&&(this._fadeInResolver(),this._fadeInResolver=null),this._fadeOutResolver&&(this._fadeOutResolver(),this._fadeOutResolver=null),this.onDetach(),this.emit("detach")}},{key:"updateTransitionProperties",value:function(e,t){if(this.fadeTransitionEnabled){var r=this._fadeOutResolver||!this.visible?0:this.opacity,n=this.computedOpacity;if(n===r)this.computedVisible=this.visible;else{var i=e*l;this.computedOpacity=n>r?Math.max(r,n-i):Math.min(r,n+i),this.computedVisible=this.computedOpacity>0;var a=r===this.computedOpacity;this.inFadeTransition=!a,a||this.requestRender()}}else this.computedOpacity=this.opacity,this.computedVisible=this.visible}},{key:"onAttach",value:function(){}},{key:"onDetach",value:function(){}},{key:"doRender",value:function(e){}},{key:"ready",value:function(){this._isReady||(this._isReady=!0,this.emit("isReady"),this.requestRender())}}]),r}(a.default)})),r.register("9rklz",(function(e,n){t(e.exports,"default",(function(){return s}));var i=r("8TSCy"),a=r("7qybv"),s=function(){"use strict";function e(t,r,n){i.classCallCheck(this,e),this.pixelBlock=t,this.extent=r,this.originalPixelBlock=n}return i.createClass(e,[{key:"width",get:function(){return(0,a.isSome)(this.pixelBlock)?this.pixelBlock.width:0}},{key:"height",get:function(){return(0,a.isSome)(this.pixelBlock)?this.pixelBlock.height:0}},{key:"render",value:function(e){var t=this.pixelBlock;if(!(0,a.isNone)(t)){var r=this.filter({pixelBlock:t});if(!(0,a.isNone)(r.pixelBlock)){var n=r.pixelBlock.getAsRGBA(),i=e.createImageData(r.pixelBlock.width,r.pixelBlock.height);i.data.set(n),e.putImageData(i,0,0)}}}},{key:"getRenderedRasterPixels",value:function(){var e=this.filter({pixelBlock:this.pixelBlock});return(0,a.isNone)(e.pixelBlock)?null:{width:e.pixelBlock.width,height:e.pixelBlock.height,renderedRasterPixels:new Uint8Array(e.pixelBlock.getAsRGBA().buffer)}}}]),e}()})),r.register("dw9r5",(function(n,i){t(n.exports,"default",(function(){return w}));var a=r("8TSCy"),s=r("2TvXO"),o=r("7eJjO"),u=r("bsvXr"),l=r("9pNSx"),c=r("6dXDO"),h=r("7qybv"),f=r("lKPaD"),p=r("iho5X");r("lNwWH"),r("2VlWd"),r("iJAIC");var d=r("fcwIv"),v=r("gINRd"),y=r("jxAFe"),x=r("2hwKJ"),m=r("1rhe8"),g=r("ckl1y"),b=function(t){"use strict";a.inherits(n,t);var r=a.createSuper(n);function n(){var t;a.classCallCheck(this,n);var i,o=a.assertThisInitialized(t);return(t=r.call.apply(r,[this].concat(Array.prototype.slice.call(arguments)))).attached=!1,t.container=new(0,m.RasterVFContainer),t.type="imageryVF",t._dataParameters={exportParametersVersion:0,bbox:"",symbolTileSize:0,time:""},t._fetchpixels=(i=a.asyncToGenerator(e(s).mark((function t(r,n,i,a){var u,l,c,f,p,d,v,y,m,g,b;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o._projectFullExtentPromise;case 2:if(u=e.sent,l=o.layer.renderer,c=l.symbolTileSize,f=(0,x.snapImageToSymbolTile)(r,n,i,c,u),p=f.extent,d=f.width,v=f.height,!(0,h.isSome)(u)||u.intersects(r)){e.next=11;break}return e.abrupt("return",{extent:p,pixelBlock:null});case 11:if(y={bbox:"".concat(p.xmin,", ").concat(p.ymin,", ").concat(p.xmax,", ").concat(p.ymax),exportParametersVersion:o.layer.exportImageServiceParameters.version,symbolTileSize:c,time:JSON.stringify(o.timeExtent||"")},!o._canReuseVectorFieldData(y)){e.next=17;break}if(m=o.getPixelData(),!(0,h.isSome)(m)){e.next=17;break}if("".concat(m.extent.xmin,", ").concat(m.extent.ymin,", ").concat(m.extent.xmax,", ").concat(m.extent.ymax)!==y.bbox){e.next=17;break}return e.abrupt("return",m);case 17:return e.next=19,o.layer.fetchImage(p,d,v,{timeExtent:o.timeExtent,requestAsImageElement:!1,signal:a});case 19:if(g=e.sent,b=g.pixelData,o._dataParameters=y,!(0,h.isNone)(b.pixelBlock)){e.next=23;break}return e.abrupt("return",{extent:p,pixelBlock:null});case 23:return e.abrupt("return",{extent:p,pixelBlock:"vector-uv"===o.layer.rasterInfo.dataType?(0,h.unwrap)((0,x.convertVectorFieldData)(b.pixelBlock,"vector-uv")):b.pixelBlock});case 24:case"end":return e.stop()}}),t)}))),function(e,t,r,n){return i.apply(this,arguments)}),a.possibleConstructorReturn(t)}return a.createClass(n,[{key:"updating",get:function(){return!this.attached||this._strategy.updating}},{key:"attach",value:function(){var e=this;this._projectFullExtentPromise=this._getProjectedFullExtent(this.view.spatialReference),this._strategy=new(0,g.default)({container:this.container,fetchPixels:this._fetchpixels}),this.handles.add((0,f.watch)((function(){return e.layer.renderer}),(function(t){return e._updateSymbolizerParams(t)}),f.syncAndInitial),"vector-field-view-update")}},{key:"detach",value:function(){this._strategy.destroy(),this.container.children.forEach((function(e){return e.destroy()})),this.container.removeAllChildren(),this.handles.remove("vector-field-view-update"),this._strategy=this.container=this._projectFullExtentPromise=null}},{key:"getPixelData",value:function(){if(this.updating||!this.container.children.length)return null;var e=this.container.children[0].rawPixelData;return{extent:e.extent,pixelBlock:e.pixelBlock}}},{key:"hitTest",value:function(e){return new(0,u.default)({attributes:{},geometry:e.clone(),layer:this.layer})}},{key:"update",value:function(e){this._strategy.update(e,this._symbolizerParams)}},{key:"redraw",value:function(){this._updateSymbolizerParams(this.layer.renderer),this._strategy.redraw(this._symbolizerParams)}},{key:"_canReuseVectorFieldData",value:function(e){var t=this._dataParameters.exportParametersVersion===e.exportParametersVersion,r=this._dataParameters.time===e.time,n=this._dataParameters.symbolTileSize===e.symbolTileSize,i=this._dataParameters.bbox===e.bbox;return t&&r&&n&&i}},{key:"_getProjectedFullExtent",value:function(t){var r=this;return a.asyncToGenerator(e(s).mark((function n(){var i;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,y.projectExtent)(r.layer.fullExtent,t);case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),e.prev=8,e.next=11,(0,l.default)(r.layer.url,{query:{option:"footprints",outSR:t.wkid||JSON.stringify(t.toJSON()),f:"json"}});case 11:return i=e.sent.data.featureCollection.layers[0].layerDefinition.extent,e.abrupt("return",i?v.default.fromJSON(i):null);case 15:return e.prev=15,e.t1=e.catch(8),e.abrupt("return",null);case 18:case"end":return e.stop()}}),n,null,[[0,6],[8,15]])})))()}},{key:"_updateSymbolizerParams",value:function(e){"vector-field"===e.type&&(this._symbolizerParams=this.layer.symbolizer.generateWebGLParameters({pixelBlock:null}))}}]),n}(c.HandleOwner);(0,o._)([(0,p.property)()],b.prototype,"attached",void 0),(0,o._)([(0,p.property)()],b.prototype,"container",void 0),(0,o._)([(0,p.property)()],b.prototype,"layer",void 0),(0,o._)([(0,p.property)()],b.prototype,"timeExtent",void 0),(0,o._)([(0,p.property)()],b.prototype,"type",void 0),(0,o._)([(0,p.property)()],b.prototype,"view",void 0),(0,o._)([(0,p.property)()],b.prototype,"updating",null);var w=b=(0,o._)([(0,d.subclass)("esri.views.2d.layers.imagery.VectorFieldView2D")],b)})),r.register("1rhe8",(function(e,n){t(e.exports,"RasterVFContainer",(function(){return o}));var i=r("8TSCy"),a=r("lysbb"),s=r("66IJZ"),o=function(e){"use strict";i.inherits(r,e);var t=i.createSuper(r);function r(){var e;return i.classCallCheck(this,r),(e=t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments)))).symbolTypes=["triangle"],i.possibleConstructorReturn(e)}return i.createClass(r,[{key:"requiresDedicatedFBO",get:function(){return!1}},{key:"prepareRenderPasses",value:function(e){var t=this,n=e.registerRenderPass({name:"imagery (vf)",brushes:[a.default],target:function(){return t.children},drawPhase:s.WGLDrawPhase.MAP});return i.toConsumableArray(i.get(i.getPrototypeOf(r.prototype),"prepareRenderPasses",this).call(this,e)).concat([n])}},{key:"doRender",value:function(e){var t=this;this.visible&&e.drawPhase===s.WGLDrawPhase.MAP&&this.symbolTypes.forEach((function(n){e.renderPass=n,i.get(i.getPrototypeOf(r.prototype),"doRender",t).call(t,e)}))}}]),r}(r("3FBIK").default)})),r.register("ckl1y",(function(n,i){t(n.exports,"default",(function(){return m}));var a=r("8TSCy"),s=r("2TvXO"),o=r("7eJjO"),u=r("jymfC"),l=r("jHOLN"),c=r("7qybv"),h=r("10vEZ"),f=r("iho5X");r("lNwWH"),r("2VlWd"),r("iJAIC");var p=r("fcwIv"),d=r("gINRd"),v=r("9q7kD"),y=l.default.getLogger("esri.views.2d.layers.imagery.VectorFieldView2D"),x=function(t){"use strict";a.inherits(n,t);var r=a.createSuper(n);function n(e){var t;return a.classCallCheck(this,n),(t=r.call(this,e)).update=(0,h.debounce)((function(e,r){return t._update(e,r).catch((function(e){(0,h.isAbortError)(e)||y.error(e)}))})),a.possibleConstructorReturn(t)}return a.createClass(n,[{key:"updating",get:function(){return!!this._loading}},{key:"redraw",value:function(e){if(this.container.children.length){var t=this.container.children[0];t.symbolizerParameters=e,t.invalidateVAO(),this.container.symbolTypes="wind_speed"===e.style?["scalar","triangle"]:"simple_scalar"===e.style?["scalar"]:["triangle"],this.container.requestRender()}}},{key:"_update",value:function(t,r,n){var i=this;return a.asyncToGenerator(e(s).mark((function o(){var u,l,c,h,f,p,v,y;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.stationary){e.next=2;break}return e.abrupt("return");case 2:return u=t.state,l=u.extent,c=u.spatialReference,h=new(0,d.default)({xmin:l.xmin,ymin:l.ymin,xmax:l.xmax,ymax:l.ymax,spatialReference:c}),f=a.slicedToArray(t.state.size,2),p=f[0],v=f[1],i._loading=i.fetchPixels(h,p,v,n),e.next=6,i._loading;case 6:y=e.sent,i._addToDisplay(y,r,t.state),i._loading=null;case 8:case"end":return e.stop()}}),o)})))()}},{key:"_addToDisplay",value:function(e,t,r){if((0,c.isNone)(e.pixelBlock))return this.container.children.forEach((function(e){return e.destroy()})),void this.container.removeAllChildren();var n=e.extent,i=e.pixelBlock,a=new(0,v.RasterVFDisplayObject)(i);a.offset=[0,0],a.symbolizerParameters=t,a.rawPixelData=e,a.invalidateVAO(),a.x=n.xmin,a.y=n.ymax,a.pixelRatio=r.pixelRatio,a.rotation=r.rotation,a.resolution=r.resolution,a.width=i.width*t.symbolTileSize,a.height=i.height*t.symbolTileSize,this.container.children.forEach((function(e){return e.destroy()})),this.container.removeAllChildren(),this.container.symbolTypes="wind_speed"===t.style?["scalar","triangle"]:"simple_scalar"===t.style?["scalar"]:["triangle"],this.container.addChild(a)}}]),n}(u.default);(0,o._)([(0,f.property)()],x.prototype,"fetchPixels",void 0),(0,o._)([(0,f.property)()],x.prototype,"container",void 0),(0,o._)([(0,f.property)()],x.prototype,"_loading",void 0),(0,o._)([(0,f.property)()],x.prototype,"updating",null);var m=x=(0,o._)([(0,p.subclass)("esri.views.2d.layers.imagery.ImageryVFStrategy")],x)})),r.register("iBY1U",(function(n,i){t(n.exports,"ImageryLayerView",(function(){return y}));var a=r("8TSCy"),s=r("2TvXO"),o=r("7eJjO"),u=r("kyj08"),l=r("7qybv"),c=r("iho5X");r("lNwWH"),r("2VlWd"),r("iJAIC");var h=r("fcwIv"),f=r("d1Fqh"),p=r("gRgX5"),d=r("cRlei"),v=r("dB39e"),y=function(t){var r=function(t){"use strict";a.inherits(n,t);var r=a.createSuper(n);function n(){var e;return a.classCallCheck(this,n),(e=r.call.apply(r,[this].concat(Array.prototype.slice.call(arguments)))).view=null,a.possibleConstructorReturn(e)}return a.createClass(n,[{key:"fetchPopupFeatures",value:function(t,r){var n=this;return a.asyncToGenerator(e(s).mark((function i(){var a,o,c,h,p,y,x,m,g,b,w;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.layer,t){e.next=3;break}throw new(0,u.default)("imagerylayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:a});case 3:if(o=a.popupEnabled,c=(0,v.getFetchPopupTemplate)(a,r),o&&(0,l.isSome)(c)){e.next=6;break}throw new(0,u.default)("imagerylayerview:fetchPopupFeatures","Missing required popupTemplate or popupEnabled",{popupEnabled:o,popupTemplate:c});case 6:return e.next=8,c.getRequiredFields();case 8:return h=e.sent,(p=new(0,d.default)).timeExtent=n.timeExtent,p.geometry=t,p.outFields=h,p.outSpatialReference=t.spatialReference,y=n.view.resolution,x="2d"===n.view.type?new(0,f.default)(y,y,n.view.spatialReference):new(0,f.default)(.5*y,.5*y,n.view.spatialReference),m=c.layerOptions||{returnTopmostRaster:!0,showNoDataRecords:!1},g=m.returnTopmostRaster,b=m.showNoDataRecords,w={returnDomainValues:!0,returnTopmostRaster:g,pixelSize:x,showNoDataRecords:b,signal:(0,l.isSome)(r)?r.signal:null},e.abrupt("return",a.queryVisibleRasters(p,w).then((function(e){return e})));case 13:case"end":return e.stop()}}),i)})))()}},{key:"canResume",value:function(){var e;return!(!a.get(a.getPrototypeOf(n.prototype),"canResume",this).call(this)||null!=(e=this.timeExtent)&&e.isEmpty)}}]),n}(t);return(0,o._)([(0,c.property)()],r.prototype,"layer",void 0),(0,o._)([(0,c.property)()],r.prototype,"suspended",void 0),(0,o._)([(0,c.property)(p.combinedViewLayerTimeExtentProperty)],r.prototype,"timeExtent",void 0),(0,o._)([(0,c.property)()],r.prototype,"view",void 0),r=(0,o._)([(0,h.subclass)("esri.views.layers.ImageryLayerView")],r)}})),r.register("dB39e",(function(n,i){t(n.exports,"getRequiredFields",(function(){return l})),t(n.exports,"getFetchPopupTemplate",(function(){return h}));var a=r("8TSCy"),s=r("2TvXO"),o=r("7qybv"),u=r("7vTUY");function l(e){return c.apply(this,arguments)}function c(){return c=a.asyncToGenerator(e(s).mark((function t(r){var n,i,l,c,h,f,p,d,v,y=arguments;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=y.length>1&&void 0!==y[1]?y[1]:r.popupTemplate,(0,o.isSome)(n)){e.next=3;break}return e.abrupt("return",[]);case 3:return e.next=5,n.getRequiredFields(r.fieldsIndex);case 5:if(i=e.sent,l=n.lastEditInfoEnabled,c=r.objectIdField,h=r.typeIdField,f=r.globalIdField,p=r.relationships,!i.includes("*")){e.next=13;break}return e.abrupt("return",["*"]);case 13:if(!l){e.next=19;break}return e.next=16,(0,u.getFeatureEditFields)(r);case 16:e.t0=e.sent,e.next=20;break;case 19:e.t0=[];case 20:return d=e.t0,v=(0,u.fixFields)(r.fieldsIndex,a.toConsumableArray(i).concat(a.toConsumableArray(d))),e.abrupt("return",(h&&v.push(h),v&&c&&r.fieldsIndex.has(c)&&-1===v.indexOf(c)&&v.push(c),v&&f&&r.fieldsIndex.has(f)&&-1===v.indexOf(f)&&v.push(f),p&&p.forEach((function(e){var t=e.keyField;v&&t&&r.fieldsIndex.has(t)&&-1===v.indexOf(t)&&v.push(t)})),v));case 23:case"end":return e.stop()}}),t)}))),c.apply(this,arguments)}function h(e,t){return e.popupTemplate?e.popupTemplate:(0,o.isSome)(t)&&t.defaultPopupTemplateEnabled&&(0,o.isSome)(e.defaultPopupTemplate)?e.defaultPopupTemplate:null}})),r.register("hfthk",(function(e,n){t(e.exports,"RefreshableLayerView",(function(){return h}));var i=r("8TSCy"),a=r("7eJjO"),s=r("jHOLN"),o=r("10vEZ"),u=r("lKPaD"),l=r("iho5X");r("lNwWH"),r("2VlWd"),r("iJAIC");var c=r("fcwIv"),h=function(e){var t=function(e){"use strict";i.inherits(r,e);var t=i.createSuper(r);function r(){return i.classCallCheck(this,r),t.apply(this,arguments)}return i.createClass(r,[{key:"initialize",value:function(){var e=this;this.handles.add((0,u.on)((function(){return e.layer}),"refresh",(function(t){var r=e;e.doRefresh(t.dataChanged).catch((function(e){(0,o.isAbortError)(e)||s.default.getLogger(r.declaredClass).error(e)}))})),"RefreshableLayerView")}}]),r}(e);return(0,a._)([(0,l.property)()],t.prototype,"layer",void 0),t=(0,a._)([(0,c.subclass)("esri.layers.mixins.RefreshableLayerView")],t)}})),r.register("jGyUI",(function(e,n){t(e.exports,"jsonAdapter",(function(){return a}));var i=r("8TSCy"),a={convertToGEGeometry:function(e,t){return null==t?null:e.convertJSONToGeometry(t)},exportPoint:function(e,t,r){var n=new s(e.getPointX(t),e.getPointY(t),r),i=e.hasZ(t),a=e.hasM(t);return i&&(n.z=e.getPointZ(t)),a&&(n.m=e.getPointM(t)),n},exportPolygon:function(e,t,r){return new o(e.exportPaths(t),r,e.hasZ(t),e.hasM(t))},exportPolyline:function(e,t,r){return new u(e.exportPaths(t),r,e.hasZ(t),e.hasM(t))},exportMultipoint:function(e,t,r){return new l(e.exportPoints(t),r,e.hasZ(t),e.hasM(t))},exportExtent:function(e,t,r){var n=e.hasZ(t),i=e.hasM(t),a=new c(e.getXMin(t),e.getYMin(t),e.getXMax(t),e.getYMax(t),r);if(n){var s=e.getZExtent(t);a.zmin=s.vmin,a.zmax=s.vmax}if(i){var o=e.getMExtent(t);a.mmin=o.vmin,a.mmax=o.vmax}return a}};var s=function e(t,r,n){"use strict";i.classCallCheck(this,e),this.x=t,this.y=r,this.spatialReference=n,this.z=void 0,this.m=void 0};var o=function e(t,r,n,a){"use strict";i.classCallCheck(this,e),this.rings=t,this.spatialReference=r,this.hasZ=void 0,this.hasM=void 0,n&&(this.hasZ=n),a&&(this.hasM=a)};var u=function e(t,r,n,a){"use strict";i.classCallCheck(this,e),this.paths=t,this.spatialReference=r,this.hasZ=void 0,this.hasM=void 0,n&&(this.hasZ=n),a&&(this.hasM=a)};var l=function e(t,r,n,a){"use strict";i.classCallCheck(this,e),this.points=t,this.spatialReference=r,this.hasZ=void 0,this.hasM=void 0,n&&(this.hasZ=n),a&&(this.hasM=a)};var c=function e(t,r,n,a,s){"use strict";i.classCallCheck(this,e),this.xmin=t,this.ymin=r,this.xmax=n,this.ymax=a,this.spatialReference=s,this.zmin=void 0,this.zmax=void 0,this.mmin=void 0,this.mmax=void 0}})),r.register("8mTF7",(function(e,n){t(e.exports,"getCentroidOptimizedGeometry",(function(){return s}));var i=r("7qybv");function a(e,t){return e?t?4:3:t?3:2}function s(e,t,r,n,s){if((0,i.isNone)(t)||!t.lengths.length)return null;var f="upperLeft"===(null==s?void 0:s.originPosition)?-1:1;e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0);var p=e.coords,d=[],v=r?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],y=t.lengths,x=t.coords,m=a(r,n),g=0,b=!0,w=!1,_=void 0;try{for(var k,S=y[Symbol.iterator]();!(b=(k=S.next()).done);b=!0){var T=k.value,R=o(v,x,g,T,r,n,f);R&&d.push(R),g+=T*m}}catch(e){w=!0,_=e}finally{try{b||null==S.return||S.return()}finally{if(w)throw _}}if(d.sort((function(e,t){var n=f*e[2]-f*t[2];return 0===n&&r&&(n=e[4]-t[4]),n})),d.length){var C=6*d[0][2];p[0]=d[0][0]/C,p[1]=d[0][1]/C,r&&(C=6*d[0][4],p[2]=0!==C?d[0][3]/C:0),(p[0]<v[0]||p[0]>v[1]||p[1]<v[2]||p[1]>v[3]||r&&(p[2]<v[4]||p[2]>v[5]))&&(p.length=0)}if(!p.length){var I=t.lengths[0]?function(e,t,r,n,i){for(var s=a(n,i),o=t,f=t+s,p=0,d=0,v=0,y=0,x=0,m=r-1;x<m;x++,o+=s,f+=s){var g=e[o],b=e[o+1],w=e[o+2],_=e[f],k=e[f+1],S=e[f+2],T=n?l(g,b,w,_,k,S):u(g,b,_,k);if(T)if(p+=T,n){var R=h(g,b,w,_,k,S);d+=T*R[0],v+=T*R[1],y+=T*R[2]}else{var C=c(g,b,_,k);d+=T*C[0],v+=T*C[1]}}return p>0?n?[d/p,v/p,y/p]:[d/p,v/p]:r>0?n?[e[t],e[t+1],e[t+2]]:[e[t],e[t+1]]:null}(x,0,y[0],r,n):null;if(!I)return null;p[0]=I[0],p[1]=I[1],r&&I.length>2&&(p[2]=I[2])}return e}function o(e,t,r,n,i,s){for(var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,u=a(i,s),l=r,c=r+u,h=0,f=0,p=0,d=0,v=0,y=0,x=n-1;y<x;y++,l+=u,c+=u){var m=t[l],g=t[l+1],b=t[l+2],w=t[c],_=t[c+1],k=t[c+2],S=m*_-w*g;d+=S,h+=(m+w)*S,f+=(g+_)*S,i&&(p+=(b+k)*(S=m*k-w*b),v+=S),m<e[0]&&(e[0]=m),m>e[1]&&(e[1]=m),g<e[2]&&(e[2]=g),g>e[3]&&(e[3]=g),i&&(b<e[4]&&(e[4]=b),b>e[5]&&(e[5]=b))}if(d*o>0&&(d*=-1),v*o>0&&(v*=-1),!d)return null;var T=[h,f,.5*d];return i&&(T[3]=p,T[4]=.5*v),T}function u(e,t,r,n){var i=r-e,a=n-t;return Math.sqrt(i*i+a*a)}function l(e,t,r,n,i,a){var s=n-e,o=i-t,u=a-r;return Math.sqrt(s*s+o*o+u*u)}function c(e,t,r,n){return[e+.5*(r-e),t+.5*(n-t)]}function h(e,t,r,n,i,a){return[e+.5*(n-e),t+.5*(i-t),r+.5*(a-r)]}})),r.register("fP7bp",(function(n,i){t(n.exports,"checkProjectionSupport",(function(){return y})),t(n.exports,"project",(function(){return b})),t(n.exports,"projectMany",(function(){return _}));var a=r("8TSCy"),s=r("2TvXO"),o=r("7qybv"),u=r("7RvA5"),l=r("jGyUI"),c=r("eY5Yp"),h=r("eF88h"),f=[0,0];function p(e,t){if(!t)return null;if("x"in t){var r,n={x:0,y:0};return r=a.slicedToArray(e(t.x,t.y,f),2),n.x=r[0],n.y=r[1],null!=t.z&&(n.z=t.z),null!=t.m&&(n.m=t.m),n}if("xmin"in t){var i,s,o={xmin:0,ymin:0,xmax:0,ymax:0};return i=a.slicedToArray(e(t.xmin,t.ymin,f),2),o.xmin=i[0],o.ymin=i[1],s=a.slicedToArray(e(t.xmax,t.ymax,f),2),o.xmax=s[0],o.ymax=s[1],t.hasZ&&(o.zmin=t.zmin,o.zmax=t.zmax,o.hasZ=!0),t.hasM&&(o.mmin=t.mmin,o.mmax=t.mmax,o.hasM=!0),o}return"rings"in t?{rings:d(t.rings,e),hasM:t.hasM,hasZ:t.hasZ}:"paths"in t?{paths:d(t.paths,e),hasM:t.hasM,hasZ:t.hasZ}:"points"in t?{points:v(t.points,e),hasM:t.hasM,hasZ:t.hasZ}:void 0}function d(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var u=s.value;r.push(v(u,t))}}catch(e){i=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(i)throw a}}return r}function v(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var u=s.value,l=t(u[0],u[1],[0,0]);r.push(l),u.length>2&&l.push(u[2]),u.length>3&&l.push(u[3])}}catch(e){i=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(i)throw a}}return r}function y(e,t){return x.apply(this,arguments)}function x(){return(x=a.asyncToGenerator(e(s).mark((function t(r,n){var i;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:return i=Array.isArray(r)?r.map((function(e){return(0,o.isSome)(e.geometry)&&e.geometry.spatialReference})):[r],e.next=5,(0,u.initializeProjection)(i.map((function(e){return{source:e,dest:n}})));case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}var m=p.bind(null,h.lngLatToXY),g=p.bind(null,h.xyToLngLat);function b(e,t,r){if(!e)return e;if(r||(r=t,t=e.spatialReference),!(0,c.isValid)(t)||!(0,c.isValid)(r)||(0,c.equals)(t,r))return e;if((0,h.canProject)(t,r)){var n=(0,c.isWebMercator)(r)?m(e):g(e);return n.spatialReference=r,n}return(0,u.projectMany)(l.jsonAdapter,[e],t,r,null)[0]}var w=new(function(){"use strict";function t(){a.classCallCheck(this,t),this._jobs=[],this._timer=null,this._process=this._process.bind(this)}return a.createClass(t,[{key:"push",value:function(t,r,n){var i=this;return a.asyncToGenerator(e(s).mark((function a(){var o;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.length&&r&&n&&!(0,c.equals)(r,n)){e.next=2;break}return e.abrupt("return",t);case 2:return o={geometries:t,inSpatialReference:r,outSpatialReference:n,resolve:null},e.abrupt("return",(i._jobs.push(o),new Promise((function(e){o.resolve=e,null===i._timer&&(i._timer=setTimeout(i._process,10))}))));case 4:case"end":return e.stop()}}),a)})))()}},{key:"_process",value:function(){this._timer=null;var e=this._jobs.shift();if(e){var t=e.geometries,r=e.inSpatialReference,n=e.outSpatialReference,i=e.resolve;(0,h.canProject)(r,n)?(0,c.isWebMercator)(n)?i(t.map(m)):i(t.map(g)):i((0,u.projectMany)(l.jsonAdapter,t,r,n,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}}}]),t}());function _(e,t,r){return w.push(e,t,r)}})),r.register("ibKgR",(function(e,n){t(e.exports,"toQuantizationTransform",(function(){return c})),t(e.exports,"quantizePoint",(function(){return g})),t(e.exports,"quantizeGeometry",(function(){return _})),t(e.exports,"unquantizeMultipoint",(function(){return k})),t(e.exports,"unquantizePoint",(function(){return S})),t(e.exports,"unquantizePolygon",(function(){return T})),t(e.exports,"unquantizePolyline",(function(){return R}));var i=r("8TSCy"),a=r("7qybv"),s=r("79LpT");var o=function(e,t,r){return[t,r]},u=function(e,t,r){return[t,r,e[2]]},l=function(e,t,r){return[t,r,e[2],e[3]]};function c(e){return e?{originPosition:"upper-left"===e.originPosition?"upperLeft":"lower-left"===e.originPosition?"lowerLeft":e.originPosition,scale:e.tolerance?[e.tolerance,e.tolerance]:[1,1],translate:(0,a.isSome)(e.extent)?[e.extent.xmin,e.extent.ymax]:[0,0]}:null}function h(e,t){var r=e.scale,n=e.translate;return Math.round((t-n[0])/r[0])}function f(e,t){var r=e.scale,n=e.translate;return Math.round((n[1]-t)/r[1])}function p(e,t,r){for(var n,i,a,s,o=[],u=0;u<r.length;u++){var l=r[u];u>0?(a=h(e,l[0]),s=f(e,l[1]),a===n&&s===i||(o.push(t(l,a-n,s-i)),n=a,i=s)):(n=h(e,l[0]),i=f(e,l[1]),o.push(t(l,n,i)))}return o.length>0?o:null}function d(e,t){var r=e.scale,n=e.translate;return t*r[0]+n[0]}function v(e,t){var r=e.scale;return e.translate[1]-t*r[1]}function y(e,t,r){var n=new Array(r.length);if(!r.length)return n;var a=i.slicedToArray(e.scale,2),s=a[0],o=a[1],u=d(e,r[0][0]),l=v(e,r[0][1]);n[0]=t(r[0],u,l);for(var c=1;c<r.length;c++){var h=r[c];u+=h[0]*s,l-=h[1]*o,n[c]=t(h,u,l)}return n}function x(e,t,r){for(var n=new Array(r.length),i=0;i<r.length;i++)n[i]=y(e,t,r[i]);return n}function m(e,t,r,n,i){return t.points=(a=e,s=r.points,c=i,p(a,n?c?l:u:c?u:o,s)),t;var a,s,c}function g(e,t,r,n,i){return t.x=h(e,r.x),t.y=f(e,r.y),t!==r&&(n&&(t.z=r.z),i&&(t.m=r.m)),t}function b(e,t,r,n,i){var a=function(e,t,r,n){for(var i=[],a=r?n?l:u:n?u:o,s=0;s<t.length;s++){var c=p(e,a,t[s]);c&&c.length>=3&&i.push(c)}return i.length?i:null}(e,r.rings,n,i);return a?(t.rings=a,t):null}function w(e,t,r,n,i){var a=function(e,t,r,n){for(var i=[],a=r?n?l:u:n?u:o,s=0;s<t.length;s++){var c=p(e,a,t[s]);c&&c.length>=2&&i.push(c)}return i.length?i:null}(e,r.paths,n,i);return a?(t.paths=a,t):null}function _(e,t){return e&&t?(0,s.isPoint)(t)?g(e,{},t,!1,!1):(0,s.isPolyline)(t)?w(e,{},t,!1,!1):(0,s.isPolygon)(t)?b(e,{},t,!1,!1):(0,s.isMultipoint)(t)?m(e,{},t,!1,!1):(0,s.isExtent)(t)?(a=!1,o=!1,(n={}).xmin=h(r=e,(i=t).xmin),n.ymin=f(r,i.ymin),n.xmax=h(r,i.xmax),n.ymax=f(r,i.ymax),n!==i&&(a&&(n.zmin=i.zmin,n.zmax=i.zmax),o&&(n.mmin=i.mmin,n.mmax=i.mmax)),n):null:null;var r,n,i,a,o}function k(e,t,r,n,i){return(0,a.isSome)(r)&&(t.points=(s=e,c=r.points,h=i,y(s,n?h?l:u:h?u:o,c))),t;var s,c,h}function S(e,t,r,n,i){return(0,a.isNone)(r)||(t.x=d(e,r.x),t.y=v(e,r.y),t!==r&&(n&&(t.z=r.z),i&&(t.m=r.m))),t}function T(e,t,r,n,i){return(0,a.isSome)(r)&&(t.rings=(s=e,c=r.rings,h=i,x(s,n?h?l:u:h?u:o,c))),t;var s,c,h}function R(e,t,r,n,i){return(0,a.isSome)(r)&&(t.paths=(s=e,c=r.paths,h=i,x(s,n?h?l:u:h?u:o,c))),t;var s,c,h}})),r.register("6r3ht",(function(e,n){t(e.exports,"getPow2NeighborKey",(function(){return i}));r("2Z8dq");function i(e,t,r,n){var i=e.clone(),a=1<<i.level,s=i.col+t,o=i.row+r;return n&&s<0?(i.col=s+a,i.world-=1):s>=a?(i.col=s-a,i.world+=1):i.col=s,i.row=o,i}})),r.register("ieqnL",(function(e,r){t(e.exports,"DISPLAY_ID_TEXEL_MASK",(function(){return n})),t(e.exports,"DISPLAY_ID_TYPE_FEATURE",(function(){return a})),t(e.exports,"DISPLAY_ID_TYPE_AGGREGATE",(function(){return s})),t(e.exports,"getDisplayIdType",(function(){return o})),t(e.exports,"getDisplayIdTexel",(function(){return u})),t(e.exports,"getDisplayIdFilterMask",(function(){return l})),t(e.exports,"isAggregateId",(function(){return c})),t(e.exports,"createDisplayId",(function(){return h}));var n=8388607,i=8388608,a=0,s=1,o=function(e){return(e&i)>>>23},u=function(e){return e&n},l=function(e){return o(e)===s?254:255};function c(e){return o(e)===s}function h(e,t){return((t?i:0)|e)>>>0}})),r.register("6Gukk",(function(e,n){t(e.exports,"createDebugLogger",(function(){return s})),t(e.exports,"DEBUG_ATTR_UPDATES",(function(){return o}));var i,a=r("8TSCy"),s=function(e,t){return e&&function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(i=t).warn.apply(i,["DEBUG:"].concat(a.toConsumableArray(r)))}||function(){return null}},o=!1})),r.register("1Fs6Q",(function(e,n){t(e.exports,"getVisualVariableSizeValueRepresentationRatio",(function(){return h})),t(e.exports,"convertVisualVariables",(function(){return v}));var i=r("8TSCy"),a=r("7qybv"),s=r("iXlXu"),o=r("hUDEJ"),u=r("4WoSm"),l=r("66IJZ"),c=r("2VOK9");function h(e,t){if(!e||!t)return e;switch(t){case"radius":case"distance":return 2*e;case"diameter":case"width":return e;case"area":return Math.sqrt(e)}return e}function f(e){return e.map((function(e){return{value:(t=e).value,size:(0,s.toPt)(t.size)};var t}))}function p(e){if("string"==typeof e||"number"==typeof e)return(0,s.toPt)(e);var t=e;return{type:"size",expression:t.expression,stops:f(t.stops)}}var d=function(e){for(var t=[],r=[],n=f(e),i=n.length,a=0;a<6;a++){var o=n[Math.min(a,i-1)];t.push(o.value),r.push(null==o.size?u.NAN_MAGIC_NUMBER:(0,s.pt2px)(o.size))}return{values:new Float32Array(t),sizes:new Float32Array(r)}};function v(e){var t=e&&e.length>0?{}:null,r=t?{}:null;if(!t)return{vvFields:t,vvRanges:r};var n=!0,a=!1,s=void 0;try{for(var o,u=e[Symbol.iterator]();!(n=(o=u.next()).done);n=!0){var h=o.value;if(h.field&&(t[h.type]=h.field),"size"===h.type){r.size||(r.size={});var v=h;switch((0,c.getTypeOfSizeVisualVariable)(v)){case l.WGLVVFlag.SIZE_MINMAX_VALUE:r.size.minMaxValue={minDataValue:v.minDataValue,maxDataValue:v.maxDataValue,minSize:p(v.minSize),maxSize:p(v.maxSize)};break;case l.WGLVVFlag.SIZE_SCALE_STOPS:r.size.scaleStops={stops:f(v.stops)};break;case l.WGLVVFlag.SIZE_FIELD_STOPS:if(v.levels){var x={};for(var g in v.levels)x[g]=d(v.levels[g]);r.size.fieldStops={type:"level-dependent",levels:x}}else r.size.fieldStops=i.objectSpread({type:"static"},d(v.stops));break;case l.WGLVVFlag.SIZE_UNIT_VALUE:r.size.unitValue={unit:v.valueUnit,valueRepresentation:v.valueRepresentation}}}else if("color"===h.type)r.color=m(h);else if("opacity"===h.type)r.opacity=y(h);else if("rotation"===h.type){var b=h;r.rotation={type:b.rotationType}}}}catch(e){a=!0,s=e}finally{try{n||null==u.return||u.return()}finally{if(a)throw s}}return{vvFields:t,vvRanges:r}}function y(e){var t={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if("string"==typeof e.field){if(!e.stops)return null;if(e.stops.length>8)return null;for(var r=e.stops,n=0;n<8;++n){var i=r[Math.min(n,r.length-1)];t.values[n]=i.value,t.opacities[n]=i.opacity}}else{if(!(e.stops&&e.stops.length>=0))return null;for(var a=e.stops&&e.stops.length>=0&&e.stops[0].opacity,s=0;s<8;s++)t.values[s]=1/0,t.opacities[s]=a}return t}function x(e,t,r){e[4*t+0]=r.r/255,e[4*t+1]=r.g/255,e[4*t+2]=r.b/255,e[4*t+3]=r.a}function m(e){if((0,a.isNone)(e))return null;if(e.normalizationField)return null;var t={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};if("string"==typeof e.field){if(!e.stops)return null;if(e.stops.length>8)return null;t.field=e.field;for(var r=e.stops,n=0;n<8;++n){var i=r[Math.min(n,r.length-1)];t.values[n]=i.value,x(t.colors,n,i.color)}}else{if(!(e.stops&&e.stops.length>=0))return null;for(var s=e.stops&&e.stops.length>=0&&e.stops[0].color,u=0;u<8;u++)t.values[u]=1/0,x(t.colors,u,s)}for(var l=0;l<32;l+=4)(0,o.premultiplyAlpha)(t.colors,l,!0);return t}})),r.register("2VOK9",(function(e,n){t(e.exports,"getTypeOfSizeVisualVariable",(function(){return l}));var i=r("kyj08"),a=r("jHOLN"),s=r("66IJZ"),o=r("5WctK"),u=a.default.getLogger("esri.views.2d.engine.webgl");function l(e){return(0,o.isNumber)(e.minDataValue)&&(0,o.isNumber)(e.maxDataValue)&&null!=e.minSize&&null!=e.maxSize?s.WGLVVFlag.SIZE_MINMAX_VALUE:(e.expression&&"view.scale"===e.expression||e.valueExpression&&"$view.scale"===e.valueExpression)&&Array.isArray(e.stops)?s.WGLVVFlag.SIZE_SCALE_STOPS:(null!=e.field||e.expression&&"view.scale"!==e.expression||e.valueExpression&&"$view.scale"!==e.valueExpression)&&(Array.isArray(e.stops)||"levels"in e&&e.levels)?s.WGLVVFlag.SIZE_FIELD_STOPS:(null!=e.field||e.expression&&"view.scale"!==e.expression||e.valueExpression&&"$view.scale"!==e.valueExpression)&&null!=e.valueUnit?s.WGLVVFlag.SIZE_UNIT_VALUE:(u.error(new(0,i.default)("mapview-bad-type","Found invalid size VisualVariable",e)),s.WGLVVFlag.NONE)}})),r.register("8lbQw",(function(e,r){t(e.exports,"u32to4Xu8",(function(){return i})),t(e.exports,"i1616to32",(function(){return a})),t(e.exports,"i8888to32",(function(){return s}));var n=new Float32Array(1);new Uint32Array(n.buffer);function i(e){return[255&e,(65280&e)>>>8,(16711680&e)>>>16,(4278190080&e)>>>24]}function a(e,t){return 65535&e|t<<16}function s(e,t,r,n){return 255&e|(255&t)<<8|(255&r)<<16|n<<24}})),r.register("6S0qa",(function(e,r){var n,i,a,s;function o(e){switch(e){case"left":return n.Left;case"right":return n.Right;case"center":case"justify":return n.Center}}function u(e){switch(e){case"top":return i.Top;case"middle":return i.Center;case"baseline":return i.Baseline;case"bottom":return i.Bottom}}function l(e){switch(e){case"above-left":case"esriServerPointLabelPlacementAboveLeft":return[n.Right,i.Bottom];case"above-center":case"above-along":case"esriServerPointLabelPlacementAboveCenter":case"esriServerLinePlacementAboveAlong":return[n.Center,i.Bottom];case"above-right":case"esriServerPointLabelPlacementAboveRight":return[n.Left,i.Bottom];case"center-left":case"esriServerPointLabelPlacementCenterLeft":return[n.Right,i.Center];case"center-center":case"center-along":case"esriServerPointLabelPlacementCenterCenter":case"esriServerLinePlacementCenterAlong":case"always-horizontal":case"esriServerPolygonPlacementAlwaysHorizontal":return[n.Center,i.Center];case"center-right":case"esriServerPointLabelPlacementCenterRight":return[n.Left,i.Center];case"below-left":case"esriServerPointLabelPlacementBelowLeft":return[n.Right,i.Top];case"below-center":case"below-along":case"esriServerPointLabelPlacementBelowCenter":case"esriServerLinePlacementBelowAlong":return[n.Center,i.Top];case"below-right":case"esriServerPointLabelPlacementBelowRight":return[n.Left,i.Top];default:return console.debug("Found invalid placement type ".concat(e)),[n.Center,i.Center]}}function c(e){switch(e){case n.Right:return-1;case n.Center:return 0;case n.Left:return 1;default:return console.debug("Found invalid horizontal alignment ".concat(e)),0}}function h(e){switch(e){case i.Top:return 1;case i.Center:return 0;case i.Bottom:case i.Baseline:return-1;default:return console.debug("Found invalid vertical alignment ".concat(e)),0}}function f(e){switch(e){case"left":return n.Left;case"right":return n.Right;case"center":case"justify":return n.Center}}function p(e){switch(e){case"above-along":case"below-along":case"center-along":case"esriServerLinePlacementAboveAlong":case"esriServerLinePlacementBelowAlong":case"esriServerLinePlacementCenterAlong":return!0;default:return!1}}t(e.exports,"HAlign",(function(){return n})),t(e.exports,"VAlign",(function(){return i})),t(e.exports,"getXAnchorDirection",(function(){return o})),t(e.exports,"getYAnchorDirection",(function(){return u})),t(e.exports,"getAlignmentFromPlacement",(function(){return l})),t(e.exports,"getXDirection",(function(){return c})),t(e.exports,"getYDirection",(function(){return h})),t(e.exports,"getJustification",(function(){return f})),t(e.exports,"isMapAligned",(function(){return p})),(s=n||(n={}))[s.Left=-1]="Left",s[s.Center=0]="Center",s[s.Right=1]="Right",(a=i||(i={}))[a.Top=1]="Top",a[a.Center=0]="Center",a[a.Bottom=-1]="Bottom",a[a.Baseline=2]="Baseline"})),r.register("iTfMY",(function(e,r){t(e.exports,"radToByte",(function(){return o})),t(e.exports,"degToByte",(function(){return u})),t(e.exports,"log2",(function(){return l})),t(e.exports,"between",(function(){return c}));Number.POSITIVE_INFINITY;var n=Math.PI,i=128/n,a=1/Math.LN2;function s(e,t){return(e%=t)>=0?e:e+t}function o(e){return s(e*i,256)}function u(e){return s(.7111111111111111*e,256)}function l(e){return Math.log(e)*a}function c(e,t,r){return e>=t&&e<=r||e>=r&&e<=t}})),r.register("2ndsO",(function(e,r){t(e.exports,"e",(function(){return s}));var n,i,a={exports:{}};n=a,void 0!==(i=function(){function e(e,i,a){a=a||2;var s,o,l,h,f,d,v,y=i&&i.length,x=y?i[0]*a:e.length,m=t(e,0,x,a,!0),g=[];if(!m||m.next===m.prev)return g;if(y&&(m=function(e,n,i,a){var s,o,l,h=[];for(s=0,o=n.length;s<o;s++)(l=t(e,n[s]*a,s<o-1?n[s+1]*a:e.length,a,!1))===l.next&&(l.steiner=!0),h.push(p(l));for(h.sort(u),s=0;s<h.length;s++)i=r(i=c(h[s],i),i.next);return i}(e,i,m,a)),e.length>80*a){s=l=e[0],o=h=e[1];for(var b=a;b<x;b+=a)(f=e[b])<s&&(s=f),(d=e[b+1])<o&&(o=d),f>l&&(l=f),d>h&&(h=d);v=0!==(v=Math.max(l-s,h-o))?1/v:0}return n(m,g,a,s,o,v),g}function t(e,t,r,n,i){var a,s;if(i===R(e,t,r,n)>0)for(a=t;a<r;a+=n)s=k(a,e[a],e[a+1],s);else for(a=r-n;a>=t;a-=n)s=k(a,e[a],e[a+1],s);if(s&&x(s,s.next)){var o=s.next;S(s),s=o}return s}function r(e,t){if(!e)return e;t||(t=e);var r,n=e;do{if(r=!1,n.steiner||!x(n,n.next)&&0!==y(n.prev,n,n.next))n=n.next;else{var i=n.prev;if(S(n),(n=t=i)===n.next)break;r=!0}}while(r||n!==t);return t}function n(e,t,u,l,c,h,p){if(e){!p&&h&&function(e,t,r,n){var i=e;do{null===i.z&&(i.z=f(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,r,n,i,a,s,o,u,l=1;do{for(r=e,e=null,a=null,s=0;r;){for(s++,n=r,o=0,t=0;t<l&&(o++,n=n.nextZ);t++);for(u=l;o>0||u>0&&n;)0!==o&&(0===u||!n||r.z<=n.z)?(i=r,r=r.nextZ,o--):(i=n,n=n.nextZ,u--),a?a.nextZ=i:e=i,i.prevZ=a,a=i;r=n}a.nextZ=null,l*=2}while(s>1)}(i)}(e,l,c,h);for(var d,v,y=e;e.prev!==e.next;)if(d=e.prev,v=e.next,h?a(e,l,c,h):i(e))t.push(d.i/u),t.push(e.i/u),t.push(v.i/u),S(e),e=v.next,y=v.next;else if((e=v)===y){p?1===p?n(e=s(r(e),t,u),t,u,l,c,h,2):2===p&&o(e,t,u,l,c,h):n(r(e),t,u,l,c,h,1);break}}}function i(e){var t=e.prev,r=e,n=e.next;if(y(t,r,n)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(d(t.x,t.y,r.x,r.y,n.x,n.y,i.x,i.y)&&y(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function a(e,t,r,n){var i=e.prev,a=e,s=e.next;if(y(i,a,s)>=0)return!1;for(var o=i.x<a.x?i.x<s.x?i.x:s.x:a.x<s.x?a.x:s.x,u=i.y<a.y?i.y<s.y?i.y:s.y:a.y<s.y?a.y:s.y,l=i.x>a.x?i.x>s.x?i.x:s.x:a.x>s.x?a.x:s.x,c=i.y>a.y?i.y>s.y?i.y:s.y:a.y>s.y?a.y:s.y,h=f(o,u,t,r,n),p=f(l,c,t,r,n),v=e.prevZ,x=e.nextZ;v&&v.z>=h&&x&&x.z<=p;){if(v!==e.prev&&v!==e.next&&d(i.x,i.y,a.x,a.y,s.x,s.y,v.x,v.y)&&y(v.prev,v,v.next)>=0)return!1;if(v=v.prevZ,x!==e.prev&&x!==e.next&&d(i.x,i.y,a.x,a.y,s.x,s.y,x.x,x.y)&&y(x.prev,x,x.next)>=0)return!1;x=x.nextZ}for(;v&&v.z>=h;){if(v!==e.prev&&v!==e.next&&d(i.x,i.y,a.x,a.y,s.x,s.y,v.x,v.y)&&y(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;x&&x.z<=p;){if(x!==e.prev&&x!==e.next&&d(i.x,i.y,a.x,a.y,s.x,s.y,x.x,x.y)&&y(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function s(e,t,n){var i=e;do{var a=i.prev,s=i.next.next;!x(a,s)&&m(a,i,i.next,s)&&w(a,s)&&w(s,a)&&(t.push(a.i/n),t.push(i.i/n),t.push(s.i/n),S(i),S(i.next),i=e=s),i=i.next}while(i!==e);return r(i)}function o(e,t,i,a,s,o){var u=e;do{for(var l=u.next.next;l!==u.prev;){if(u.i!==l.i&&v(u,l)){var c=_(u,l);return u=r(u,u.next),c=r(c,c.next),n(u,t,i,a,s,o),void n(c,t,i,a,s,o)}l=l.next}u=u.next}while(u!==e)}function u(e,t){return e.x-t.x}function l(e){if(e.next.prev===e)return e;for(var t=e;;){var r=t.next;if(r.prev===t||r===t||r===e)break;t=r}return t}function c(e,t){var n=function(e,t){var r,n=t,i=e.x,a=e.y,s=-1/0;do{if(a<=n.y&&a>=n.next.y&&n.next.y!==n.y){var o=n.x+(a-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(o<=i&&o>s){if(s=o,o===i){if(a===n.y)return n;if(a===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!r)return null;if(i===s)return r;var u,l=r,c=r.x,f=r.y,p=1/0;n=r;do{i>=n.x&&n.x>=c&&i!==n.x&&d(a<f?i:s,a,c,f,a<f?s:i,a,n.x,n.y)&&(u=Math.abs(a-n.y)/(i-n.x),w(n,e)&&(u<p||u===p&&(n.x>r.x||n.x===r.x&&h(r,n)))&&(r=n,p=u)),n=n.next}while(n!==l);return r}(e,t);if(!n)return t;var i=_(n,e),a=r(n,n.next),s=l(i);return r(s,s.next),a=l(a),l(t===n?a:t)}function h(e,t){return y(e.prev,e,t.prev)<0&&y(t.next,e,e.next)<0}function f(e,t,r,n,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function p(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function d(e,t,r,n,i,a,s,o){return(i-s)*(t-o)-(e-s)*(a-o)>=0&&(e-s)*(n-o)-(r-s)*(t-o)>=0&&(r-s)*(a-o)-(i-s)*(n-o)>=0}function v(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&m(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&(w(e,t)&&w(t,e)&&function(e,t){var r=e,n=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do{r.y>a!=r.next.y>a&&r.next.y!==r.y&&i<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}(e,t)&&(y(e.prev,e,t.prev)||y(e,t.prev,t))||x(e,t)&&y(e.prev,e,e.next)>0&&y(t.prev,t,t.next)>0)}function y(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function x(e,t){return e.x===t.x&&e.y===t.y}function m(e,t,r,n){var i=b(y(e,t,r)),a=b(y(e,t,n)),s=b(y(r,n,e)),o=b(y(r,n,t));return i!==a&&s!==o||!(0!==i||!g(e,r,t))||!(0!==a||!g(e,n,t))||!(0!==s||!g(r,e,n))||!(0!==o||!g(r,t,n))}function g(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function b(e){return e>0?1:e<0?-1:0}function w(e,t){return y(e.prev,e,e.next)<0?y(e,t,e.next)>=0&&y(e,e.prev,t)>=0:y(e,t,e.prev)<0||y(e,e.next,t)<0}function _(e,t){var r=new T(e.i,e.x,e.y),n=new T(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,a.next=n,n.prev=a,n}function k(e,t,r,n){var i=new T(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function S(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function T(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function R(e,t,r,n){for(var i=0,a=t,s=r-n;a<r;a+=n)i+=(e[s]-e[a])*(e[a+1]+e[s+1]),s=a;return i}return e.deviation=function(e,t,r,n){var i=t&&t.length,a=i?t[0]*r:e.length,s=Math.abs(R(e,0,a,r));if(i)for(var o=0,u=t.length;o<u;o++){var l=t[o]*r,c=o<u-1?t[o+1]*r:e.length;s-=Math.abs(R(e,l,c,r))}var h=0;for(o=0;o<n.length;o+=3){var f=n[o]*r,p=n[o+1]*r,d=n[o+2]*r;h+=Math.abs((e[f]-e[d])*(e[p+1]-e[f+1])-(e[f]-e[p])*(e[d+1]-e[f+1]))}return 0===s&&0===h?0:Math.abs((h-s)/s)},e.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},n=0,i=0;i<e.length;i++){for(var a=0;a<e[i].length;a++)for(var s=0;s<t;s++)r.vertices.push(e[i][a][s]);i>0&&(n+=e[i-1].length,r.holes.push(n))}return r},e}())&&(n.exports=i);var s=a.exports})),r.register("2rjRQ",(function(n,i){t(n.exports,"expandSymbol",(function(){return f})),t(n.exports,"cimLayerToRasterizationInfo",(function(){return p}));var a,s=r("8TSCy"),o=r("2TvXO"),u=r("aNOUb"),l=r("f7bFM"),c=r("jfLVm"),h=(a=s.asyncToGenerator(e(o).mark((function t(r,n,i,a){return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all(r.map((function(e){return f(e,n,i,a)}))));case 1:case"end":return e.stop()}}),t)}))),function(){var t=s.asyncToGenerator(e(o).mark((function t(r,n,i){return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=l.ExpandedCIM,e.next=3,(0,u.analyzeCIMSymbol)(r.data,n,i);case 3:return e.t1=e.sent,e.t2=r.data,e.t3=r.rendererKey,e.t4=r.maxVVSize,e.abrupt("return",new e.t0(e.t1,e.t2,e.t3,e.t4));case 8:case"end":return e.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}()),f=function(){var t=s.asyncToGenerator(e(o).mark((function t(r,n,i,a){var s;return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return",null);case 2:if("cim"!==r.type){e.next=4;break}return e.abrupt("return",h(r,n,i));case 4:if("web-style"!==r.type){e.next=12;break}return e.next=7,(0,c.fetchCIMSymbolReference)(r,null,a);case 7:return e.t0=e.sent,e.t1=r.rendererKey,e.t2=r.maxVVSize,s={type:"cim",data:e.t0,rendererKey:e.t1,maxVVSize:e.t2},e.abrupt("return",h(s,n,i));case 12:return e.abrupt("return",r);case 13:case"end":return e.stop()}}),t)})));return function(e,r,n,i){return t.apply(this,arguments)}}();function p(e){if(!e)return null;var t=e.type,r=e.cim,n=e.url,i={cim:r,type:t,mosaicHash:e.materialHash,url:n,size:null,dashTemplate:null,path:null,text:null,fontName:null};switch(t){case"marker":i.size=e.size,i.path=e.path;break;case"line":i.dashTemplate=e.dashTemplate;break;case"text":i.text=e.text,i.fontName=e.fontName}return i}})),r.register("f7bFM",(function(e,n){t(e.exports,"ExpandedCIM",(function(){return u}));var i=r("8TSCy"),a=r("66IJZ"),s=r("ktHf8"),o={marker:a.WGLGeometryType.MARKER,fill:a.WGLGeometryType.FILL,line:a.WGLGeometryType.LINE,text:a.WGLGeometryType.TEXT},u=function(){"use strict";function e(t,r,n,a){i.classCallCheck(this,e);var u,l={minScale:null==r?void 0:r.minScale,maxScale:null==r?void 0:r.maxScale},c=(u=l).minScale||u.maxScale?u.minScale+"-"+u.maxScale:"";this.layers=t,this.data=r,this.hash=this._createHash()+c,this.rendererKey=n;var h={isOutline:!1,isOutlinedFill:!1,placement:null,stride:{fill:"default"},vvFlags:n},f=!0,p=!1,d=void 0;try{for(var v,y=t[Symbol.iterator]();!(f=(v=y.next()).done);f=!0){var x=v.value,m=o[x.type];x.materialKey=(0,s.createMaterialKey)(m,h),x.maxVVSize=a,x.scaleInfo=l,x.templateHash+=c}}catch(e){p=!0,d=e}finally{try{f||null==y.return||y.return()}finally{if(p)throw d}}}return i.createClass(e,[{key:"type",get:function(){return"expanded-cim"}},{key:"_createHash",value:function(){var e="",t=!0,r=!1,n=void 0;try{for(var i,a=this.layers[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){e+=i.value.templateHash}}catch(e){r=!0,n=e}finally{try{t||null==a.return||a.return()}finally{if(r)throw n}}return e}}]),e}()})),r.register("jfLVm",(function(n,i){t(n.exports,"fetchCIMSymbolReference",(function(){return d}));var a=r("8TSCy"),s=r("2TvXO"),o=r("3gVHR"),u=r("kyj08"),l=r("10vEZ"),c=r("kYueh"),h=r("ajJOT"),f=r("9ELaA"),p=r("dmPQi");function d(e,t,r){return v.apply(this,arguments)}function v(){return(v=a.asyncToGenerator(e(s).mark((function t(r,n,i){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.name){e.next=2;break}return e.abrupt("return",Promise.reject(new(0,u.default)("style-symbol-reference-name-missing","Missing name in style symbol reference")));case 2:if(!r.styleName||"Esri2DPointSymbolsStyle"!==r.styleName){e.next=4;break}return e.abrupt("return",y(r,i));case 4:return e.prev=4,e.t0=m,e.next=8,(0,p.fetchStyle)(r,n,i);case 8:return e.t1=e.sent,e.t2=r.name,e.t3=n,e.t4=i,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3,e.t4));case 15:return e.prev=15,e.t5=e.catch(4),e.abrupt("return",((0,l.throwIfAborted)(e.t5),null));case 18:case"end":return e.stop()}}),t,null,[[4,15]])})))).apply(this,arguments)}function y(e,t){return x.apply(this,arguments)}function x(){return(x=a.asyncToGenerator(e(s).mark((function t(r,n){var i,a;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=p.Style2DUrlTemplate.replace(/\{SymbolName\}/gi,r.name),e.prev=1,e.next=4,(0,p.requestJSON)(i,n);case 4:return a=e.sent,e.abrupt("return",(0,p.makeCIMSymbolRef)(a.data));case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",((0,l.throwIfAborted)(e.t0),null));case 11:case"end":return e.stop()}}),t,null,[[1,8]])})))).apply(this,arguments)}function m(e,t,r,n){return g.apply(this,arguments)}function g(){return(g=a.asyncToGenerator(e(s).mark((function t(r,n,i,a){var d,v,y,x,m;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d=r.data,v={portal:i&&i.portal||h.default.getDefault(),url:(0,c.urlToObject)(r.baseUrl),origin:"portal-item"},y=d.items.find((function(e){return e.name===n}))){e.next=3;break}throw new(0,u.default)("symbolstyleutils:symbol-name-not-found","The symbol name '".concat(n,"' could not be found"),{symbolName:n});case 3:return x=(0,f.f)((0,p.symbolUrlFromStyleItem)(y,"cimRef"),v),(0,o.isDevEnvironment)()&&(x=(0,o.adjustStaticAGOUrl)(x)),e.prev=5,e.next=8,(0,p.requestJSON)(x,a);case 8:return m=e.sent,e.abrupt("return",(0,p.makeCIMSymbolRef)(m.data));case 12:return e.prev=12,e.t0=e.catch(5),e.abrupt("return",((0,l.throwIfAborted)(e.t0),null));case 15:case"end":return e.stop()}}),t,null,[[5,12]])})))).apply(this,arguments)}})),r.register("8tU7Q",(function(e,r){function n(){return new Float32Array(3)}function i(e,t,r){var n=new Float32Array(3);return n[0]=e,n[1]=t,n[2]=r,n}function a(){return n()}function s(){return i(1,1,1)}function o(){return i(1,0,0)}function u(){return i(0,1,0)}function l(){return i(0,0,1)}t(e.exports,"c",(function(){return n})),t(e.exports,"f",(function(){return i}));var c=a(),h=s(),f=o(),p=u(),d=l();Object.freeze({__proto__:null,create:n,clone:function(e){var t=new Float32Array(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},fromValues:i,createView:function(e,t){return new Float32Array(e,t,3)},zeros:a,ones:s,unitX:o,unitY:u,unitZ:l,ZEROS:c,ONES:h,UNIT_X:f,UNIT_Y:p,UNIT_Z:d})})),r.register("ebEEs",(function(e,r){t(e.exports,"DECLUTTER_TILES",(function(){return n})),t(e.exports,"COLLISION_GRID_CELL_SIZE",(function(){return i})),t(e.exports,"DECLUTTER_BUDGET",(function(){return a})),t(e.exports,"FADE_DURATION",(function(){return s}));var n=!0,i=32,a=1.5,s=200})),r.register("fsJts",(function(e,r){t(e.exports,"outputTypes",(function(){return n})),t(e.exports,"createMD5Hash",(function(){return v}));var n={Base64:0,Hex:1,String:2,Raw:3};function i(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function a(e){for(var t=[],r=0,n=8*e.length;r<n;r+=8)t[r>>5]|=(255&e.charCodeAt(r/8))<<r%32;return t}function s(e){for(var t=[],r=0,n=32*e.length;r<n;r+=8)t.push(String.fromCharCode(e[r>>5]>>>r%32&255));return t.join("")}function o(e){for(var t="0123456789abcdef",r=[],n=0,i=4*e.length;n<i;n++)r.push(t.charAt(e[n>>2]>>n%4*8+4&15)+t.charAt(e[n>>2]>>n%4*8&15));return r.join("")}function u(e){for(var t=[],r=0,n=4*e.length;r<n;r+=3)for(var i=(e[r>>2]>>r%4*8&255)<<16|(e[r+1>>2]>>(r+1)%4*8&255)<<8|e[r+2>>2]>>(r+2)%4*8&255,a=0;a<4;a++)8*r+6*a>32*e.length?t.push("="):t.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(i>>6*(3-a)&63));return t.join("")}function l(e,t,r,n,a,s){return i((o=i(i(t,e),i(n,s)))<<(u=a)|o>>>32-u,r);var o,u}function c(e,t,r,n,i,a,s){return l(t&r|~t&n,e,t,i,a,s)}function h(e,t,r,n,i,a,s){return l(t&n|r&~n,e,t,i,a,s)}function f(e,t,r,n,i,a,s){return l(t^r^n,e,t,i,a,s)}function p(e,t,r,n,i,a,s){return l(r^(t|~n),e,t,i,a,s)}function d(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var r=1732584193,n=-271733879,a=-1732584194,s=271733878,o=0;o<e.length;o+=16){var u=r,l=n,d=a,v=s;r=c(r,n,a,s,e[o+0],7,-680876936),s=c(s,r,n,a,e[o+1],12,-389564586),a=c(a,s,r,n,e[o+2],17,606105819),n=c(n,a,s,r,e[o+3],22,-1044525330),r=c(r,n,a,s,e[o+4],7,-176418897),s=c(s,r,n,a,e[o+5],12,1200080426),a=c(a,s,r,n,e[o+6],17,-1473231341),n=c(n,a,s,r,e[o+7],22,-45705983),r=c(r,n,a,s,e[o+8],7,1770035416),s=c(s,r,n,a,e[o+9],12,-1958414417),a=c(a,s,r,n,e[o+10],17,-42063),n=c(n,a,s,r,e[o+11],22,-1990404162),r=c(r,n,a,s,e[o+12],7,1804603682),s=c(s,r,n,a,e[o+13],12,-40341101),a=c(a,s,r,n,e[o+14],17,-1502002290),r=h(r,n=c(n,a,s,r,e[o+15],22,1236535329),a,s,e[o+1],5,-165796510),s=h(s,r,n,a,e[o+6],9,-1069501632),a=h(a,s,r,n,e[o+11],14,643717713),n=h(n,a,s,r,e[o+0],20,-373897302),r=h(r,n,a,s,e[o+5],5,-701558691),s=h(s,r,n,a,e[o+10],9,38016083),a=h(a,s,r,n,e[o+15],14,-660478335),n=h(n,a,s,r,e[o+4],20,-405537848),r=h(r,n,a,s,e[o+9],5,568446438),s=h(s,r,n,a,e[o+14],9,-1019803690),a=h(a,s,r,n,e[o+3],14,-187363961),n=h(n,a,s,r,e[o+8],20,1163531501),r=h(r,n,a,s,e[o+13],5,-1444681467),s=h(s,r,n,a,e[o+2],9,-51403784),a=h(a,s,r,n,e[o+7],14,1735328473),r=f(r,n=h(n,a,s,r,e[o+12],20,-1926607734),a,s,e[o+5],4,-378558),s=f(s,r,n,a,e[o+8],11,-2022574463),a=f(a,s,r,n,e[o+11],16,1839030562),n=f(n,a,s,r,e[o+14],23,-35309556),r=f(r,n,a,s,e[o+1],4,-1530992060),s=f(s,r,n,a,e[o+4],11,1272893353),a=f(a,s,r,n,e[o+7],16,-155497632),n=f(n,a,s,r,e[o+10],23,-1094730640),r=f(r,n,a,s,e[o+13],4,681279174),s=f(s,r,n,a,e[o+0],11,-358537222),a=f(a,s,r,n,e[o+3],16,-722521979),n=f(n,a,s,r,e[o+6],23,76029189),r=f(r,n,a,s,e[o+9],4,-640364487),s=f(s,r,n,a,e[o+12],11,-421815835),a=f(a,s,r,n,e[o+15],16,530742520),r=p(r,n=f(n,a,s,r,e[o+2],23,-995338651),a,s,e[o+0],6,-198630844),s=p(s,r,n,a,e[o+7],10,1126891415),a=p(a,s,r,n,e[o+14],15,-1416354905),n=p(n,a,s,r,e[o+5],21,-57434055),r=p(r,n,a,s,e[o+12],6,1700485571),s=p(s,r,n,a,e[o+3],10,-1894986606),a=p(a,s,r,n,e[o+10],15,-1051523),n=p(n,a,s,r,e[o+1],21,-2054922799),r=p(r,n,a,s,e[o+8],6,1873313359),s=p(s,r,n,a,e[o+15],10,-30611744),a=p(a,s,r,n,e[o+6],15,-1560198380),n=p(n,a,s,r,e[o+13],21,1309151649),r=p(r,n,a,s,e[o+4],6,-145523070),s=p(s,r,n,a,e[o+11],10,-1120210379),a=p(a,s,r,n,e[o+2],15,718787259),n=p(n,a,s,r,e[o+9],21,-343485551),r=i(r,u),n=i(n,l),a=i(a,d),s=i(s,v)}return[r,n,a,s]}function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.Hex,r=t||n.Base64,i=d(a(e),8*e.length);switch(r){case n.Raw:return i;case n.Hex:return o(i);case n.String:return s(i);case n.Base64:return u(i)}}})),r.register("8eM7H",(function(e,n){t(e.exports,"TiledDisplayObject",(function(){return u}));var i=r("8TSCy"),a=r("j3x2p"),s=r("2qlsz"),o=r("i90gL"),u=function(e){"use strict";i.inherits(r,e);var t=i.createSuper(r);function r(e,n,a,s,u){var l,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:s,h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:u;return i.classCallCheck(this,r),(l=t.call(this)).triangleCountReportedInDebug=0,l.triangleCount=0,l.texture=null,l.key=new(0,o.default)(e),l.x=n,l.y=a,l.width=s,l.height=u,l.rangeX=c,l.rangeY=h,i.possibleConstructorReturn(l)}return i.createClass(r,[{key:"destroy",value:function(){this.texture&&(this.texture.dispose(),this.texture=null)}},{key:"setTransform",value:function(e,t){var r=t/(e.resolution*e.pixelRatio),n=this.transforms.tileMat3,s=i.slicedToArray(e.toScreenNoRotation([0,0],[this.x,this.y]),2),o=s[0],u=s[1],l=this.width/this.rangeX*r,c=this.height/this.rangeY*r;(0,a.s)(n,l,0,0,0,c,0,o,u,1),(0,a.m)(this.transforms.dvs,e.displayViewMat3,n)}}]),r}(s.DisplayObject)})),r.register("3v0eQ",(function(e,n){t(e.exports,"default",(function(){return h}));var i=r("8TSCy"),a=r("2VlWd"),s=r("66IJZ"),o=r("3FBIK"),u=r("cq8Fg"),l=r("ht01f"),c=function(e,t){return e.key.level-t.key.level!=0?e.key.level-t.key.level:e.key.row-t.key.row!=0?e.key.row-t.key.row:e.key.col-t.key.col},h=function(e){"use strict";i.inherits(r,e);var t=i.createSuper(r);function r(e){var n;return i.classCallCheck(this,r),(n=t.call(this))._tileInfoView=e,i.possibleConstructorReturn(n)}return i.createClass(r,[{key:"requiresDedicatedFBO",get:function(){return!1}},{key:"renderChildren",value:function(e){this.sortChildren(c),this.setStencilReference(e),i.get(i.getPrototypeOf(r.prototype),"renderChildren",this).call(this,e)}},{key:"createRenderParams",value:function(e){var t=e.state,n=i.get(i.getPrototypeOf(r.prototype),"createRenderParams",this).call(this,e);return n.requiredLevel=this._tileInfoView.getClosestInfoForScale(t.scale).level,n.displayLevel=this._tileInfoView.tileInfo.scaleToZoom(t.scale),n}},{key:"prepareRenderPasses",value:function(e){var t=this,n=i.get(i.getPrototypeOf(r.prototype),"prepareRenderPasses",this).call(this,e);return n.push(e.registerRenderPass({name:"stencil",brushes:[l.default],drawPhase:s.WGLDrawPhase.DEBUG|s.WGLDrawPhase.MAP|s.WGLDrawPhase.HIGHLIGHT,target:function(){return t.getStencilTarget()}})),(0,a.default)("esri-tiles-debug")&&n.push(e.registerRenderPass({name:"tileInfo",brushes:[u.default],drawPhase:s.WGLDrawPhase.DEBUG,target:function(){return t.children}})),n}},{key:"getStencilTarget",value:function(){return this.children}},{key:"updateTransforms",value:function(e){var t=!0,r=!1,n=void 0;try{for(var i,a=this.children[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value,o=this._tileInfoView.getTileResolution(s.key);s.setTransform(e,o)}}catch(e){r=!0,n=e}finally{try{t||null==a.return||a.return()}finally{if(r)throw n}}}},{key:"setStencilReference",value:function(e){var t=1,r=!0,n=!1,i=void 0;try{for(var a,s=this.children[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){a.value.stencilRef=t++}}catch(e){n=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(n)throw i}}}}]),r}(o.default)})),r.register("9M3e1",(function(e,n){t(e.exports,"toJSONGeometryType",(function(){return a})),t(e.exports,"canUseMajorityInterpolationOnDataSource",(function(){return s}));var i=new(0,r("79ASa").JSONMap)({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});function a(e){return i.toJSON(e)}function s(e){var t=e.rasterInfo,r=t.bandCount,n=t.attributeTable,i=t.colormap,a=t.pixelType;return 1===r&&(null!=n||null!=i||"u8"===a||"s8"===a)}})),r.register("1ScYs",(function(e,n){t(e.exports,"Bitmap",(function(){return d}));var i=r("8TSCy"),a=r("7qybv"),s=r("j3x2p"),o=r("eYrMi"),u=r("0P8XU"),l=r("2qlsz"),c=r("9rklz"),h=r("8JzMA"),f=r("8aBT4");function p(e,t,r){var n={target:h.TextureType.TEXTURE_2D,pixelFormat:h.PixelFormat.RGBA,internalFormat:h.PixelFormat.RGBA,dataType:h.PixelType.UNSIGNED_BYTE,wrapMode:h.TextureWrapMode.CLAMP_TO_EDGE};return t&&r&&(n.width=t,n.height=r),new(0,f.Texture)(e,n)}var d=function(e){"use strict";i.inherits(r,e);var t=i.createSuper(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1?arguments[1]:void 0,s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return i.classCallCheck(this,r),(e=t.call(this)).requestRenderOnSourceChangedEnabled=s,e._textureInvalidated=!0,e.stencilRef=0,e.coordScale=[1,1],e._height=void 0,e.pixelRatio=1,e.resolution=0,e.rotation=0,e._source=null,e._width=void 0,e.x=0,e.y=0,e.blendFunction=a,e.source=n,e.requestRender=e.requestRender.bind(i.assertThisInitialized(e)),i.possibleConstructorReturn(e)}return i.createClass(r,[{key:"destroy",value:function(){this._texture&&(this._texture.dispose(),this._texture=null)}},{key:"isSourceScaled",get:function(){return this.width!==this.sourceWidth||this.height!==this.sourceHeight}},{key:"height",get:function(){return void 0!==this._height?this._height:this.sourceHeight},set:function(e){this._height=e}},{key:"source",get:function(){return this._source},set:function(e){this._source=e,this.invalidateTexture()}},{key:"sourceHeight",get:function(){return this._source instanceof HTMLImageElement?this._source.naturalHeight:this._source.height}},{key:"sourceWidth",get:function(){return this._source instanceof HTMLImageElement?this._source.naturalWidth:this._source.width}},{key:"width",get:function(){return void 0!==this._width?this._width:this.sourceWidth},set:function(e){this._width=e}},{key:"beforeRender",value:function(e){i.get(i.getPrototypeOf(r.prototype),"beforeRender",this).call(this,e),this.updateTexture(e.context)}},{key:"invalidateTexture",value:function(){this._textureInvalidated||(this._textureInvalidated=!0,this.requestRenderOnSourceChangedEnabled&&this.requestRender())}},{key:"_createTransforms",value:function(){return{dvs:(0,o.c)()}}},{key:"setTransform",value:function(e){var t=(0,s.b)(this.transforms.dvs),r=i.slicedToArray(e.toScreenNoRotation([0,0],[this.x,this.y]),2),n=r[0],a=r[1],o=this.resolution/this.pixelRatio/e.resolution,l=o*this.width,c=o*this.height,h=Math.PI*this.rotation/180;(0,s.c)(t,t,(0,u.f)(n,a)),(0,s.c)(t,t,(0,u.f)(l/2,c/2)),(0,s.r)(t,t,-h),(0,s.c)(t,t,(0,u.f)(-l/2,-c/2)),(0,s.j)(t,t,(0,u.f)(l,c)),(0,s.m)(this.transforms.dvs,e.displayViewMat3,t)}},{key:"setSamplingProfile",value:function(e){this._texture&&(e.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(e.samplingMode))}},{key:"bind",value:function(e,t){this._texture&&e.bindTexture(this._texture,t)}},{key:"updateTexture",value:function(e){var t;if(!this.stage)return null==(t=this._texture)||t.dispose(),void(this._texture=null);if(this._textureInvalidated){this._textureInvalidated=!1,this._texture||(this.source?this._texture=p(e,this.sourceWidth,this.sourceHeight):this._texture=p(e));var r,n,i,s,o=this.source;if(o){if(this._texture.resize(this.sourceWidth,this.sourceHeight),(s=o)&&"render"in s)if(o instanceof c.default){var u=o.getRenderedRasterPixels();this._texture.setData((0,a.isSome)(u)?u.renderedRasterPixels:null)}else this._texture.setData((n=o,(i=document.createElement("canvas")).width=n.width,i.height=n.height,n.render(i.getContext("2d")),i));else(r=o)&&!("render"in r)&&this._texture.setData(o);this.ready()}else this._texture.setData(null)}}},{key:"onAttach",value:function(){this.invalidateTexture()}},{key:"onDetach",value:function(){this.invalidateTexture()}}]),r}(l.DisplayObject)}))}();
//# sourceMappingURL=ImageryLayerView2D.505f77be.js.map
