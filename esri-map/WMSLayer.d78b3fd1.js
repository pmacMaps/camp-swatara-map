!function(){function e(e){return e&&e.__esModule?e.default:e}function t(e,t,r,n){Object.defineProperty(e,t,{get:r,set:n,enumerable:!0,configurable:!0})}var r=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire594f;r.register("bZ38t",(function(n,a){var i;i=n.exports,Object.defineProperty(i,"__esModule",{value:!0,configurable:!0}),t(n.exports,"default",(function(){return z}));var o=r("8TSCy"),l=r("2TvXO"),s=r("7eJjO"),u=r("cu9iz"),p=r("bsvXr"),y=r("3MVX3"),f=r("9pNSx"),d=r("d2yMj"),c=r("7FmYA"),m=r("6dXDO"),h=r("79ASa"),v=r("flPLJ"),g=r("7qybv"),b=r("8NioF"),x=r("10vEZ"),w=r("kYueh"),S=r("iho5X"),_=r("iJAIC"),E=r("eB8sj"),O=r("fcwIv"),I=r("kced1"),N=r("3L2OJ"),R=r("gINRd"),k=r("j40xv"),L=r("k0Vu4"),A=r("eY5Yp"),F=r("4LDxK"),P=r("gIXJ2"),j=r("5N5S1"),M=r("9bAYR"),U=r("13Qxf"),T=r("3GzOb"),C=r("2t08e"),q=r("jXsED"),W=r("lmu5w"),V=r("gRgX5"),B=r("8gDfE"),D=r("8xB1B"),X=r("4ukwo"),J=new(0,h.JSONMap)({bmp:"image/bmp",gif:"image/gif",jpg:"image/jpeg",png:"image/png",svg:"image/svg+xml"},{ignoreUnknown:!1}),G=function(t){"use strict";o.inherits(n,t);var r=o.createSuper(n);function n(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];var i;return o.classCallCheck(this,n),(i=r.call.apply(r,[this].concat(o.toConsumableArray(t)))).allSublayers=new(0,c.default)({getCollections:function(){return[i.sublayers]},getChildrenFunction:function(e){return e.sublayers}}),i.customParameters=null,i.customLayerParameters=null,i.copyright=null,i.description=null,i.dimensions=null,i.fullExtent=null,i.fullExtents=null,i.featureInfoFormat=null,i.featureInfoUrl=null,i.imageFormat=null,i.imageMaxHeight=2048,i.imageMaxWidth=2048,i.imageTransparency=!0,i.legendEnabled=!0,i.mapUrl=null,i.isReference=null,i.operationalLayerType="WMS",i.spatialReference=null,i.spatialReferences=null,i.sublayers=null,i.type="wms",i.url=null,i.version=null,i.watch("sublayers",(function(e,t){if(t){var r=!0,n=!1,a=void 0;try{for(var l,s=t[Symbol.iterator]();!(r=(l=s.next()).done);r=!0){l.value.layer=null}}catch(e){n=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(n)throw a}}i.handles.remove("wms-sublayer")}if(e){var u=!0,p=!1,y=void 0;try{for(var f,d=e[Symbol.iterator]();!(u=(f=d.next()).done);u=!0){var c=f.value;c.parent=o.assertThisInitialized(i),c.layer=o.assertThisInitialized(i)}}catch(e){p=!0,y=e}finally{try{u||null==d.return||d.return()}finally{if(p)throw y}}i.handles.add([e.on("after-add",(function(e){var t=e.item;t.parent=o.assertThisInitialized(i),t.layer=o.assertThisInitialized(i)})),e.on("after-remove",(function(e){var t=e.item;t.parent=null,t.layer=null}))],"wms-sublayer")}}),!0),o.possibleConstructorReturn(i)}return o.createClass(n,[{key:"normalizeCtorArgs",value:function(e,t){return"string"==typeof e?o.objectSpread({url:e},t):e}},{key:"load",value:function(e){var t=this,r=(0,g.isSome)(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["WMS"]},e).catch(x.throwIfAbortError).then((function(){return t._fetchService(r)}))),Promise.resolve(this)}},{key:"readFullExtentFromItemOrMap",value:function(e,t){var r=t.extent;return new(0,R.default)({xmin:r[0][0],ymin:r[0][1],xmax:r[1][0],ymax:r[1][1]})}},{key:"writeFullExtent",value:function(e,t){t.extent=[[e.xmin,e.ymin],[e.xmax,e.ymax]]}},{key:"readImageFormat",value:function(e,t){var r=t.supportedImageFormatTypes;return r&&r.indexOf("image/png")>-1?"image/png":r&&r[0]}},{key:"readSpatialReferenceFromItemOrDocument",value:function(e,t){return new(0,k.default)(t.spatialReferences[0])}},{key:"writeSpatialReferences",value:function(e,t){var r=this.spatialReference&&this.spatialReference.wkid;e&&r?(t.spatialReferences=e.filter((function(e){return e!==r})),t.spatialReferences.unshift(r)):t.spatialReferences=e}},{key:"readSublayersFromItemOrMap",value:function(e,t,r){return H(t.layers,r,t.visibleLayers)}},{key:"readSublayers",value:function(e,t,r){return H(t.layers,r)}},{key:"writeSublayers",value:function(e,t,r,n){t.layers=[];var a=new Map,i=e.flatten((function(e){var t=e.sublayers;return t&&t.toArray()})).toArray();i.forEach((function(e){"number"==typeof e.parent.id&&(a.has(e.parent.id)?a.get(e.parent.id).push(e.id):a.set(e.parent.id,[e.id]))})),i.forEach((function(e){var r=o.objectSpread({sublayer:e},n),i=e.write({parentLayerId:"number"==typeof e.parent.id?e.parent.id:-1},r);if(a.has(e.id)&&(i.sublayerIds=a.get(e.id)),!e.sublayers&&e.name){var l=e.write({},r);delete l.id,t.layers.push(l)}})),t.visibleLayers=i.filter((function(e){return e.visible&&!e.sublayers})).map((function(e){return e.name}))}},{key:"createExportImageParameters",value:function(e,t,r,n){var a=n&&n.pixelRatio||1,i=(0,L.getScale)({extent:e,width:t})*a,l=new(0,B.ExportWMSImageParameters)({layer:this,scale:i}),s=e.xmin,u=e.ymin,p=e.xmax,y=e.ymax,f=e.spatialReference,d=(0,X.normalizeWKID)(f,this.spatialReferences),c="1.3.0"===this.version&&(0,q.isAxesOrderReversedForWkid)(d)?"".concat(u,",").concat(s,",").concat(y,",").concat(p):"".concat(s,",").concat(u,",").concat(p,",").concat(y),m=l.toJSON();return o.objectSpread(o.defineProperty({bbox:c},"1.3.0"===this.version?"crs":"srs",isNaN(d)?void 0:"EPSG:"+d),m)}},{key:"fetchImage",value:function(t,r,n,a){var i=this;return o.asyncToGenerator(e(l).mark((function s(){var u,p,y,d,c,m,h,v,b;return e(l).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(y=i.mapUrl,(d=i.createExportImageParameters(t,r,n,a)).layers){e.next=5;break}return c=document.createElement("canvas"),e.abrupt("return",(c.width=r,c.height=n,c));case 5:return m=null==a||null==(u=a.timeExtent)?void 0:u.start,h=null==a||null==(p=a.timeExtent)?void 0:p.end,v=(0,g.isSome)(m)&&(0,g.isSome)(h)?m.getTime()===h.getTime()?(0,X.toISOString)(m):"".concat((0,X.toISOString)(m),"/").concat((0,X.toISOString)(h)):void 0,b={responseType:"image",query:i._mixCustomParameters(o.objectSpread({width:r,height:n},d,{time:v},i.refreshParameters)),signal:null==a?void 0:a.signal},e.abrupt("return",(0,f.default)(y,b).then((function(e){return e.data})));case 7:case"end":return e.stop()}}),s)})))()}},{key:"fetchFeatureInfo",value:function(e,t,r,n,a){var i=(0,L.getScale)({extent:e,width:t}),l=new(0,B.ExportWMSImageParameters)({layer:this,scale:i}),s=(0,X.getPopupLayers)(l.visibleSublayers);if(!this.featureInfoUrl||!s)return null;var u="1.3.0"===this.version?{I:n,J:a}:{x:n,y:a},f=o.objectSpread({query_layers:s,request:"GetFeatureInfo",info_format:this.featureInfoFormat,feature_count:25,width:t,height:r},u),d=o.objectSpread({},this.createExportImageParameters(e,t,r),f),c=this._mixCustomParameters(d),m=(0,w.addQueryParameters)(this.featureInfoUrl,c),h=document.createElement("iframe");h.src=m,h.style.border="none",h.style.margin="0",h.style.width="100%",h.setAttribute("sandbox","");var v=new(0,y.default)({title:this.title,content:h});return new(0,p.default)({sourceLayer:this,popupTemplate:v})}},{key:"findSublayerById",value:function(e){return this.allSublayers.find((function(t){return t.id===e}))}},{key:"findSublayerByName",value:function(e){return this.allSublayers.find((function(t){return t.name===e}))}},{key:"serviceSupportsSpatialReference",value:function(e){return(0,W.isWmsServer)(this.url)||this.spatialReferences.some((function(t){var r=900913===t?k.default.WebMercator:new(0,k.default)({wkid:t});return(0,A.equals)(r,e)}))}},{key:"_fetchService",value:function(t){var r=this;return o.asyncToGenerator(e(l).mark((function n(){var a,i;return e(l).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.resourceInfo){e.next=6;break}return r.parsedUrl.query&&r.parsedUrl.query.service&&(r.parsedUrl.query.SERVICE=r.parsedUrl.query.service,delete r.parsedUrl.query.service),r.parsedUrl.query&&r.parsedUrl.query.request&&(r.parsedUrl.query.REQUEST=r.parsedUrl.query.request,delete r.parsedUrl.query.request),e.next=4,(0,f.default)(r.parsedUrl.path,{query:o.objectSpread({SERVICE:"WMS",REQUEST:"GetCapabilities"},r.parsedUrl.query,r.customParameters),responseType:"xml",signal:t});case 4:a=e.sent,r.resourceInfo=(0,X.parseCapabilities)(a.data);case 6:r.parsedUrl&&("https"!==(i=new(0,w.Url)(r.parsedUrl.path)).scheme||i.port&&"443"!==i.port||-1!==u.default.request.httpsDomains.indexOf(i.host)||u.default.request.httpsDomains.push(i.host)),r.read(r.resourceInfo,{origin:"service"});case 8:case"end":return e.stop()}}),n)})))()}},{key:"_mixCustomParameters",value:function(e){if(!this.customLayerParameters&&!this.customParameters)return e;var t=o.objectSpread({},this.customParameters,this.customLayerParameters);for(var r in t)e[r.toLowerCase()]=t[r];return e}}]),n}((0,m.HandleOwnerMixin)((0,P.BlendLayer)((0,C.TemporalLayer)((0,U.RefreshableLayer)((0,T.ScaleRangeLayer)((0,j.OperationalLayer)((0,M.PortalLayer)((0,b.MultiOriginJSONMixin)(F.default)))))))));function H(e,t,r){var n=new Map;e.every((function(e){return null==e.id}))&&(e=(0,v.clone)(e)).forEach((function(e,t){return e.id=t}));var a=!0,i=!1,o=void 0;try{for(var l,s=e[Symbol.iterator]();!(a=(l=s.next()).done);a=!0){var u=l.value,p=new(0,D.default);p.read(u,t),-1===(null==r?void 0:r.indexOf(p.name))&&(p.visible=!1),n.set(p.id,p)}}catch(e){i=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(i)throw o}}var y=[],f=!0,c=!1,m=void 0;try{for(var h,g=e[Symbol.iterator]();!(f=(h=g.next()).done);f=!0){var b=h.value,x=n.get(b.id);if(null!=b.parentLayerId&&b.parentLayerId>=0){var w=n.get(b.parentLayerId);w.sublayers||(w.sublayers=new(0,d.default)),w.sublayers.unshift(x)}else y.unshift(x)}}catch(e){c=!0,m=e}finally{try{f||null==g.return||g.return()}finally{if(c)throw m}}return y}(0,s._)([(0,S.property)({readOnly:!0})],G.prototype,"allSublayers",void 0),(0,s._)([(0,S.property)({json:{type:Object,write:!0}})],G.prototype,"customParameters",void 0),(0,s._)([(0,S.property)({json:{type:Object,write:!0}})],G.prototype,"customLayerParameters",void 0),(0,s._)([(0,S.property)({type:String,json:{write:!0}})],G.prototype,"copyright",void 0),(0,s._)([(0,S.property)()],G.prototype,"description",void 0),(0,s._)([(0,S.property)({readOnly:!0})],G.prototype,"dimensions",void 0),(0,s._)([(0,S.property)({json:{type:[[Number]],read:{source:"extent"},write:{target:"extent"},origins:{"web-document":{write:{ignoreOrigin:!0}},"portal-item":{write:{ignoreOrigin:!0}}}}})],G.prototype,"fullExtent",void 0),(0,s._)([(0,E.reader)(["web-document","portal-item"],"fullExtent",["extent"])],G.prototype,"readFullExtentFromItemOrMap",null),(0,s._)([(0,I.writer)(["web-document","portal-item"],"fullExtent",{extent:{type:[[Number]]}})],G.prototype,"writeFullExtent",null),(0,s._)([(0,S.property)()],G.prototype,"fullExtents",void 0),(0,s._)([(0,S.property)({type:String,json:{write:{ignoreOrigin:!0}}})],G.prototype,"featureInfoFormat",void 0),(0,s._)([(0,S.property)({type:String,json:{write:{ignoreOrigin:!0}}})],G.prototype,"featureInfoUrl",void 0),(0,s._)([(0,S.property)({type:String,json:{origins:{"web-document":{default:"image/png",type:J.jsonValues,read:{reader:J.read,source:"format"},write:{writer:J.write,target:"format"}}}}})],G.prototype,"imageFormat",void 0),(0,s._)([(0,E.reader)("imageFormat",["supportedImageFormatTypes"])],G.prototype,"readImageFormat",null),(0,s._)([(0,S.property)({type:Number,json:{read:{source:"maxHeight"},write:{target:"maxHeight"}}})],G.prototype,"imageMaxHeight",void 0),(0,s._)([(0,S.property)({type:Number,json:{read:{source:"maxWidth"},write:{target:"maxWidth"}}})],G.prototype,"imageMaxWidth",void 0),(0,s._)([(0,S.property)()],G.prototype,"imageTransparency",void 0),(0,s._)([(0,S.property)(V.legendEnabled)],G.prototype,"legendEnabled",void 0),(0,s._)([(0,S.property)({type:["show","hide","hide-children"]})],G.prototype,"listMode",void 0),(0,s._)([(0,S.property)({type:String,json:{write:{ignoreOrigin:!0}}})],G.prototype,"mapUrl",void 0),(0,s._)([(0,S.property)({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:function(){return{enabled:!1}}}}})],G.prototype,"isReference",void 0),(0,s._)([(0,S.property)({type:["WMS"]})],G.prototype,"operationalLayerType",void 0),(0,s._)([(0,S.property)()],G.prototype,"resourceInfo",void 0),(0,s._)([(0,S.property)({type:k.default,json:{origins:{service:{read:{source:"extent.spatialReference"}}},write:!1}})],G.prototype,"spatialReference",void 0),(0,s._)([(0,E.reader)(["web-document","portal-item"],"spatialReference",["spatialReferences"])],G.prototype,"readSpatialReferenceFromItemOrDocument",null),(0,s._)([(0,S.property)({type:[_.Integer],json:{read:!1,origins:{service:{read:!0},"web-document":{read:!1,write:{ignoreOrigin:!0}},"portal-item":{read:!1,write:{ignoreOrigin:!0}}}}})],G.prototype,"spatialReferences",void 0),(0,s._)([(0,I.writer)(["web-document","portal-item"],"spatialReferences")],G.prototype,"writeSpatialReferences",null),(0,s._)([(0,S.property)({type:d.default.ofType(D.default),json:{write:{target:"layers",overridePolicy:function(e,t,r){if(n=this.allSublayers,a=r,n.some((function(e){for(var t in e)if((0,N.willPropertyWrite)(e,t,null,a))return!0;return!1})))return{ignoreOrigin:!0};var n,a}}}})],G.prototype,"sublayers",void 0),(0,s._)([(0,E.reader)(["web-document","portal-item"],"sublayers",["layers","visibleLayers"])],G.prototype,"readSublayersFromItemOrMap",null),(0,s._)([(0,E.reader)("service","sublayers",["layers"])],G.prototype,"readSublayers",null),(0,s._)([(0,I.writer)("sublayers",{layers:{type:[D.default]},visibleLayers:{type:[String]}})],G.prototype,"writeSublayers",null),(0,s._)([(0,S.property)({json:{read:!1},readOnly:!0,value:"wms"})],G.prototype,"type",void 0),(0,s._)([(0,S.property)(V.url)],G.prototype,"url",void 0),(0,s._)([(0,S.property)({type:String,json:{write:{ignoreOrigin:!0}}})],G.prototype,"version",void 0);var z=G=(0,s._)([(0,O.subclass)("esri.layers.WMSLayer")],G)})),r.register("jXsED",(function(e,n){t(e.exports,"isAxesOrderReversedForWkid",(function(){return o}));var a=r("8TSCy"),i=[[3819,3819],[3821,3824],[3889,3889],[3906,3906],[4001,4025],[4027,4036],[4039,4047],[4052,4055],[4074,4075],[4080,4081],[4120,4176],[4178,4185],[4188,4216],[4218,4289],[4291,4304],[4306,4319],[4322,4326],[4463,4463],[4470,4470],[4475,4475],[4483,4483],[4490,4490],[4555,4558],[4600,4646],[4657,4765],[4801,4811],[4813,4821],[4823,4824],[4901,4904],[5013,5013],[5132,5132],[5228,5229],[5233,5233],[5246,5246],[5252,5252],[5264,5264],[5324,5340],[5354,5354],[5360,5360],[5365,5365],[5370,5373],[5381,5381],[5393,5393],[5451,5451],[5464,5464],[5467,5467],[5489,5489],[5524,5524],[5527,5527],[5546,5546],[2044,2045],[2081,2083],[2085,2086],[2093,2093],[2096,2098],[2105,2132],[2169,2170],[2176,2180],[2193,2193],[2200,2200],[2206,2212],[2319,2319],[2320,2462],[2523,2549],[2551,2735],[2738,2758],[2935,2941],[2953,2953],[3006,3030],[3034,3035],[3038,3051],[3058,3059],[3068,3068],[3114,3118],[3126,3138],[3150,3151],[3300,3301],[3328,3335],[3346,3346],[3350,3352],[3366,3366],[3389,3390],[3416,3417],[3833,3841],[3844,3850],[3854,3854],[3873,3885],[3907,3910],[4026,4026],[4037,4038],[4417,4417],[4434,4434],[4491,4554],[4839,4839],[5048,5048],[5105,5130],[5253,5259],[5269,5275],[5343,5349],[5479,5482],[5518,5519],[5520,5520],[20004,20032],[20064,20092],[21413,21423],[21473,21483],[21896,21899],[22171,22177],[22181,22187],[22191,22197],[25884,25884],[27205,27232],[27391,27398],[27492,27492],[28402,28432],[28462,28492],[30161,30179],[30800,30800],[31251,31259],[31275,31279],[31281,31290],[31466,31700]];function o(e){return i.some((function(t){var r=a.slicedToArray(t,2),n=r[0],i=r[1];return e>=n&&e<=i}))}})),r.register("8gDfE",(function(e,n){t(e.exports,"ExportWMSImageParameters",(function(){return y}));var a=r("8TSCy"),i=r("7eJjO"),o=r("jymfC"),l=r("6dXDO"),s=r("iho5X");r("lNwWH"),r("2VlWd"),r("iJAIC");var u=r("fcwIv"),p={visible:"visibleSublayers"},y=function(e){"use strict";a.inherits(r,e);var t=a.createSuper(r);function r(e){var n;return a.classCallCheck(this,r),(n=t.call(this,e)).scale=0,a.possibleConstructorReturn(n)}return a.createClass(r,[{key:"layer",set:function(e){var t=this;this._get("layer")!==e&&(this._set("layer",e),this.handles.remove("layer"),e&&this.handles.add([e.sublayers.on("change",(function(){return t.notifyChange("visibleSublayers")})),e.on("wms-sublayer-update",(function(e){return t.notifyChange(p[e.propertyName])}))],"layer"))}},{key:"layers",get:function(){return this.visibleSublayers.filter((function(e){return e.name})).map((function(e){return e.name})).join(",")}},{key:"version",get:function(){this.commitProperty("layers");var e=this.layer;return e&&e.commitProperty("imageTransparency"),(this._get("version")||0)+1}},{key:"visibleSublayers",get:function(){var e=this.layer,t=this.scale,r=null==e?void 0:e.sublayers,n=[],a=function(e){var r=e.minScale,i=e.maxScale,o=e.sublayers;e.visible&&(0===t||(0===r||t<=r)&&(0===i||t>=i))&&(o?o.forEach(a):n.unshift(e))};return null==r||r.forEach(a),n}},{key:"toJSON",value:function(){var e=this.layer,t=this.layers;return{format:e.imageFormat,request:"GetMap",service:"WMS",styles:"",transparent:e.imageTransparency?"TRUE":"FALSE",version:e.version,layers:t}}}]),r}((0,l.HandleOwnerMixin)(o.default));(0,i._)([(0,s.property)()],y.prototype,"layer",null),(0,i._)([(0,s.property)({readOnly:!0})],y.prototype,"layers",null),(0,i._)([(0,s.property)({type:Number})],y.prototype,"scale",void 0),(0,i._)([(0,s.property)({readOnly:!0})],y.prototype,"version",null),(0,i._)([(0,s.property)({readOnly:!0})],y.prototype,"visibleSublayers",null),y=(0,i._)([(0,u.subclass)("esri.layers.support.ExportWMSImageParameters")],y)})),r.register("8xB1B",(function(e,n){t(e.exports,"default",(function(){return g}));var a=r("8TSCy"),i=r("7eJjO"),o=r("d2yMj"),l=r("qhgF7"),s=r("8NioF"),u=r("iho5X");r("lNwWH"),r("2VlWd");var p,y=r("ba18L"),f=r("eB8sj"),d=r("fcwIv"),c=r("iJAIC"),m=r("gINRd"),h=0,v=p=function(e){"use strict";a.inherits(r,e);var t=a.createSuper(r);function r(e){var n;return a.classCallCheck(this,r),(n=t.call(this,e))._sublayersHandles=new(0,l.default),n.dimensions=null,n.fullExtents=null,n.featureInfoFormat=null,n.featureInfoUrl=null,n.legendUrl=null,n.legendEnabled=!0,n.maxScale=0,n.minScale=0,n.popupEnabled=!1,n.queryable=!1,n.spatialReferences=null,a.possibleConstructorReturn(n)}return a.createClass(r,[{key:"description",get:function(){return this._get("description")},set:function(e){this._set("description",e)}},{key:"fullExtent",get:function(){return this._get("fullExtent")},set:function(e){this._set("fullExtent",e)}},{key:"readExtent",value:function(e,t){return(e=t.extent)?m.default.fromJSON(e):null}},{key:"id",get:function(){var e=this._get("id");return null==e?h++:e},set:function(e){this._set("id",e)}},{key:"readLegendUrl",value:function(e,t){return t?t.legendUrl||t.legendURL:null}},{key:"layer",set:function(e){this._set("layer",e),this.sublayers&&this.sublayers.forEach((function(t){return t.layer=e}))}},{key:"effectiveScaleRange",get:function(){return{minScale:this.minScale,maxScale:this.maxScale}}},{key:"name",get:function(){return this._get("name")},set:function(e){this._set("name",e)}},{key:"sublayers",set:function(e){var t=this,r=this._get("sublayers");r&&(r.forEach((function(e){e.layer=null})),this._sublayersHandles.removeAll(),this._sublayersHandles=null),e&&(e.forEach((function(e){e.parent=t,e.layer=t.layer})),this._sublayersHandles.add([e.on("after-add",(function(e){var r=e.item;r.parent=t,r.layer=t.layer})),e.on("after-remove",(function(e){var t=e.item;t.parent=null,t.layer=null}))])),this._set("sublayers",e)}},{key:"castSublayers",value:function(e){return(0,c.ensureType)(o.default.ofType(p),e)}},{key:"title",get:function(){return this._get("title")},set:function(e){this._set("title",e)}},{key:"visible",get:function(){return this._get("visible")},set:function(e){this._setAndNotifyLayer("visible",e)}},{key:"clone",value:function(){var e=new p;return this.hasOwnProperty("description")&&(e.description=this.description),this.hasOwnProperty("fullExtent")&&(e.fullExtent=this.fullExtent.clone()),this.hasOwnProperty("fullExtents")&&(e.fullExtents=this.fullExtents.map((function(e){return e.clone()}))),this.hasOwnProperty("featureInfoFormat")&&(e.featureInfoFormat=this.featureInfoFormat),this.hasOwnProperty("featureInfoUrl")&&(e.featureInfoUrl=this.featureInfoUrl),this.hasOwnProperty("legendUrl")&&(e.legendUrl=this.legendUrl),this.hasOwnProperty("legendEnabled")&&(e.legendEnabled=this.legendEnabled),this.hasOwnProperty("layer")&&(e.layer=this.layer),this.hasOwnProperty("name")&&(e.name=this.name),this.hasOwnProperty("parent")&&(e.parent=this.parent),this.hasOwnProperty("queryable")&&(e.queryable=this.queryable),this.hasOwnProperty("sublayers")&&(e.sublayers=this.sublayers&&this.sublayers.map((function(e){return e.clone()}))),this.hasOwnProperty("spatialReferences")&&(e.spatialReferences=this.spatialReferences.map((function(e){return e}))),this.hasOwnProperty("visible")&&(e.visible=this.visible),this.hasOwnProperty("title")&&(e.title=this.title),e}},{key:"_setAndNotifyLayer",value:function(e,t){var r=this.layer;this._get(e)!==t&&(this._set(e,t),r&&r.emit("wms-sublayer-update",{propertyName:e,id:this.id}))}}]),r}(s.MultiOriginJSONSupport);(0,i._)([(0,u.property)()],v.prototype,"description",null),(0,i._)([(0,u.property)({readOnly:!0})],v.prototype,"dimensions",void 0),(0,i._)([(0,u.property)({value:null})],v.prototype,"fullExtent",null),(0,i._)([(0,f.reader)("fullExtent",["extent"])],v.prototype,"readExtent",null),(0,i._)([(0,u.property)()],v.prototype,"fullExtents",void 0),(0,i._)([(0,u.property)()],v.prototype,"featureInfoFormat",void 0),(0,i._)([(0,u.property)()],v.prototype,"featureInfoUrl",void 0),(0,i._)([(0,u.property)({type:Number,json:{write:{enabled:!1,overridePolicy:function(){return{ignoreOrigin:!0,enabled:!0}}}}})],v.prototype,"id",null),(0,i._)([(0,u.property)({type:String,json:{origins:{"web-document":{read:{source:["legendUrl","legendURL"]},write:{target:"legendUrl",ignoreOrigin:!0}}},read:{source:"legendURL"},write:{ignoreOrigin:!0}}})],v.prototype,"legendUrl",void 0),(0,i._)([(0,f.reader)(["web-document"],"legendUrl")],v.prototype,"readLegendUrl",null),(0,i._)([(0,u.property)({value:!0,type:Boolean,json:{read:{source:"showLegend"},write:{target:"showLegend"},origins:{"web-map":{read:!1,write:!1},"web-scene":{read:!1,write:!1}}}})],v.prototype,"legendEnabled",void 0),(0,i._)([(0,u.property)({value:null})],v.prototype,"layer",null),(0,i._)([(0,u.property)()],v.prototype,"maxScale",void 0),(0,i._)([(0,u.property)()],v.prototype,"minScale",void 0),(0,i._)([(0,u.property)({readOnly:!0})],v.prototype,"effectiveScaleRange",null),(0,i._)([(0,u.property)({type:String,value:null,json:{read:{source:"name"},write:{ignoreOrigin:!0}}})],v.prototype,"name",null),(0,i._)([(0,u.property)()],v.prototype,"parent",void 0),(0,i._)([(0,u.property)({type:Boolean,json:{read:{source:"showPopup"},write:{ignoreOrigin:!0,target:"showPopup"}}})],v.prototype,"popupEnabled",void 0),(0,i._)([(0,u.property)({type:Boolean,json:{write:{ignoreOrigin:!0}}})],v.prototype,"queryable",void 0),(0,i._)([(0,u.property)()],v.prototype,"sublayers",null),(0,i._)([(0,y.cast)("sublayers")],v.prototype,"castSublayers",null),(0,i._)([(0,u.property)({type:[Number],json:{read:{source:"spatialReferences"}}})],v.prototype,"spatialReferences",void 0),(0,i._)([(0,u.property)({type:String,value:null,json:{write:{ignoreOrigin:!0}}})],v.prototype,"title",null),(0,i._)([(0,u.property)({type:Boolean,value:!0,json:{read:{source:"defaultVisibility"}}})],v.prototype,"visible",null);var g=v=p=(0,i._)([(0,d.subclass)("esri.layers.support.WMSSublayer")],v)})),r.register("4ukwo",(function(e,n){t(e.exports,"parseCapabilities",(function(){return y})),t(e.exports,"getPopupLayers",(function(){return f})),t(e.exports,"toISOString",(function(){return F})),t(e.exports,"normalizeWKID",(function(){return M}));var a=r("kyj08"),i=r("7qybv"),o=r("kYueh"),l=r("gINRd"),s=r("j40xv"),u=r("jXsED"),p={84:4326,83:4269,27:4267};function y(e){if(!e)return null;var t={idCounter:-1};"string"==typeof e&&(e=(new DOMParser).parseFromString(e,"text/xml"));var r=e.documentElement;if("ServiceExceptionReport"===r.nodeName){var n=Array.prototype.slice.call(r.childNodes).map((function(e){return e.textContent})).join("\r\n");throw new(0,a.default)("wmslayer:wms-capabilities-xml-is-not-valid","The server returned errors when the WMS capabilities were requested.",n)}var i=h("Capability",r),o=h("Service",r),s=h("Request",i);if(!i||!o||!s)return null;var u=h("Layer",i);if(!u)return null;var p,y,f,m="WMS_Capabilities"===r.nodeName||"WMT_MS_Capabilities"===r.nodeName?r.getAttribute("version"):"1.3.0",v=g("Title",o,"")||g("Name",o,""),b=g("AccessConstraints",o,""),S=g("Abstract",o,""),E=parseInt(g("MaxWidth",o,"5000"),10),O=parseInt(g("MaxHeight",o,"5000"),10),N=w(s,"GetMap"),R=x(s,"GetMap"),k=_(u,m,t),L=0;if(Array.prototype.slice.call(i.childNodes).forEach((function(e){"Layer"===e.nodeName&&(0===L?p=e:1===L?(k.name&&(k.name="",k.sublayers.push(_(p,m,t))),k.sublayers.push(_(e,m,t))):k.sublayers.push(_(e,m,t)),L++)})),!k)return null;var A=k.fullExtents;if((y=k.sublayers)||(y=[]),0===y.length&&y.push(k),!(f=k.extent)){var F=new(0,l.default)(y[0].extent);k.extent=F.toJSON(),f=k.extent}var P,j=k.spatialReferences.length>0?k.spatialReferences:d(k),M=x(s,"GetFeatureInfo");if(M){var U=w(s,"GetFeatureInfo");U.indexOf("text/html")>-1?P="text/html":U.indexOf("text/plain")>-1&&(P="text/plain")}if(!P){var T=function(e){e&&(e.queryable=!1,e.sublayers&&e.sublayers.forEach((function(e){T(e)})))};T(k)}var C=c(y),q=k.minScale||0,W=k.maxScale||0,V=k.dimensions,B=C.reduce((function(e,t){return e.concat(t.dimensions)}),[]),D=V.concat(B).filter(I),X=null;if(D.length>0){var J=Number.POSITIVE_INFINITY,G=Number.NEGATIVE_INFINITY;D.forEach((function(e){var t,r=e.extent;t=r,Array.isArray(t)&&t.length>0&&t[0]instanceof Date?r.forEach((function(e){J=Math.min(J,e.getTime()),G=Math.max(G,e.getTime())})):r.forEach((function(e){J=Math.min(J,e.min.getTime()),G=Math.max(G,e.max.getTime())}))})),X={startTimeField:null,endTimeField:null,trackIdField:null,timeExtent:[J,G]}}return{copyright:b,description:S,dimensions:V,extent:f,fullExtents:A,featureInfoFormat:P,featureInfoUrl:M,mapUrl:R,maxWidth:E,maxHeight:O,maxScale:W,minScale:q,layers:C,spatialReferences:j,supportedImageFormatTypes:N,timeInfo:X,title:v,version:m}}function f(e){return e.length?e.filter((function(e){return e.popupEnabled&&e.name&&e.queryable})).map((function(e){return e.name})).join(","):""}function d(e){if(e.spatialReferences.length>0)return e.spatialReferences;var t=!0,r=!1,n=void 0;if(e.sublayers)try{for(var a,i=e.sublayers[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var o=d(a.value);if(o.length>0)return o}}catch(e){r=!0,n=e}finally{try{t||null==i.return||i.return()}finally{if(r)throw n}}return[]}function c(e){var t=[];return e.forEach((function(e){t.push(e),e.sublayers&&e.sublayers.length&&(t=t.concat(c(e.sublayers)),delete e.sublayers)})),t}function m(e,t,r){var n;return null!=(n=t.getAttribute(e))?n:r}function h(e,t){for(var r=0;r<t.childNodes.length;r++){var n=t.childNodes[r];if(E(n)&&n.nodeName===e)return n}return null}function v(e,t){for(var r=[],n=0;n<t.childNodes.length;n++){var a=t.childNodes[n];E(a)&&a.nodeName===e&&r.push(a)}return r}function g(e,t,r){var n=h(e,t);return n?n.textContent:r}function b(e,t,r){if(!e)return null;var n,a,i,o,u=parseFloat(e.getAttribute("minx")),p=parseFloat(e.getAttribute("miny")),y=parseFloat(e.getAttribute("maxx")),f=parseFloat(e.getAttribute("maxy"));r?(n=isNaN(p)?-Number.MAX_VALUE:p,a=isNaN(u)?-Number.MAX_VALUE:u,i=isNaN(f)?Number.MAX_VALUE:f,o=isNaN(y)?Number.MAX_VALUE:y):(n=isNaN(u)?-Number.MAX_VALUE:u,a=isNaN(p)?-Number.MAX_VALUE:p,i=isNaN(y)?Number.MAX_VALUE:y,o=isNaN(f)?Number.MAX_VALUE:f);var d=new(0,s.default)({wkid:t});return new(0,l.default)({xmin:n,ymin:a,xmax:i,ymax:o,spatialReference:d})}function x(e,t){var r,n,a,i=h(t,e);if(i){var l=h("DCPType",i);if(l){var s=h("HTTP",l);if(s){var u=h("Get",s);if(u){var p=(r="xlink:href",n=null,(a=h("OnlineResource",u))?m(r,a,n):n);if(p)return p.indexOf("&")===p.length-1&&(p=p.substring(0,p.length-1)),function(e,t){var r=[],n=(0,o.urlToObject)(e);for(var a in n.query)n.query.hasOwnProperty(a)&&-1===t.indexOf(a.toLowerCase())&&r.push(a+"="+n.query[a]);return n.path+(r.length?"?"+r.join("&"):"")}(p,["service","request"])}}}}return null}function w(e,t){var r=v("Operation",e);if(0===r.length)return v("Format",h(t,e)).map((function(e){return e.textContent}));var n=[];return r.forEach((function(e){e.getAttribute("name")===t&&v("Format",e).forEach((function(e){n.push(e.textContent)}))})),n}function S(e,t,r){var n=h(t,e);if(!n)return r;var a=n.textContent;if(null==a||""===a)return r;var i=Number(a);return isNaN(i)?r:i}function _(e,t,r){var n;if(!e)return null;var a={id:r.idCounter++,fullExtents:[],parentLayerId:null,queryable:"1"===e.getAttribute("queryable"),spatialReferences:[],sublayers:null},i=h("LatLonBoundingBox",e),o=h("EX_GeographicBoundingBox",e),y=null;i&&(y=b(i,4326)),o&&((y=new(0,l.default)(0,0,0,0,new(0,s.default)({wkid:4326}))).xmin=parseFloat(g("westBoundLongitude",o,"0")),y.ymin=parseFloat(g("southBoundLatitude",o,"0")),y.xmax=parseFloat(g("eastBoundLongitude",o,"0")),y.ymax=parseFloat(g("northBoundLatitude",o,"0"))),i||o||(y=new(0,l.default)(-180,-90,180,90,new(0,s.default)({wkid:4326}))),a.minScale=S(e,"MaxScaleDenominator",0),a.maxScale=S(e,"MinScaleDenominator",0);var f=["1.0.0","1.1.0","1.1.1"].indexOf(t)>-1?"SRS":"CRS";return Array.prototype.slice.call(e.childNodes).forEach((function(e){if("Name"===e.nodeName)a.name=e.textContent||"";else if("Title"===e.nodeName)a.title=e.textContent||"";else if("Abstract"===e.nodeName)a.description=e.textContent||"";else if("BoundingBox"===e.nodeName){var n=e.getAttribute(f);if(n&&0===n.indexOf("EPSG:")){var i=parseInt(n.substring(5),10);0===i||isNaN(i)||y||(y="1.3.0"===t?b(e,i,(0,u.isAxesOrderReversedForWkid)(i)):b(e,i))}var o=n&&n.indexOf(":");if(o&&o>-1){var l=parseInt(n.substring(o+1,n.length),10);0===l||isNaN(l)||(l=p[l]?p[l]:l);var s="1.3.0"===t?b(e,l,(0,u.isAxesOrderReversedForWkid)(l)):b(e,l);a.fullExtents.push(s)}}else if(e.nodeName===f)e.textContent.split(" ").forEach((function(e){var t=e.includes(":")?parseInt(e.split(":")[1],10):parseInt(e,10);if(0!==t&&!isNaN(t)){var r=p[t]?p[t]:t;a.spatialReferences.includes(r)||a.spatialReferences.push(r)}}));else if("Style"!==e.nodeName||a.legendURL){if("Layer"===e.nodeName){var d=_(e,t,r);d&&(d.parentLayerId=a.id,a.sublayers||(a.sublayers=[]),a.sublayers.push(d))}}else{var c=h("LegendURL",e);if(c){var m=h("OnlineResource",c);m&&(a.legendURL=m.getAttribute("xlink:href"))}}})),a.extent=null==(n=y)?void 0:n.toJSON(),a.dimensions=v("Dimension",e).filter((function(e){return e.getAttribute("name")&&e.getAttribute("units")&&e.textContent})).map((function(e){var t=e.getAttribute("name"),r=e.getAttribute("units"),n=e.textContent,a=e.getAttribute("unitSymbol"),i=e.getAttribute("default"),o="0"!==m("default",e,"0"),l="0"!==m("nearestValue",e,"0"),s="0"!==m("current",e,"0");return I({name:t,units:r})?{name:"time",units:"ISO8601",extent:k(n),default:k(i),multipleValues:o,nearestValue:l,current:s}:O({name:t,units:r})?{name:"elevation",units:r,extent:N(n),unitSymbol:a,default:N(i),multipleValues:o,nearestValue:l}:{name:t,units:r,extent:R(n),unitSymbol:a,default:R(i),multipleValues:o,nearestValue:l}})),a}function E(e){return e.nodeType===Node.ELEMENT_NODE}function O(e){return/^elevation$/i.test(e.name)&&/^(epsg|crs):\d+$/i.test(e.units)}function I(e){return/^time$/i.test(e.name)&&/^iso8601$/i.test(e.units)}function N(e){if(!e)return null;var t=-1!==e.indexOf("/"),r=e.split(",");return t?r.map((function(e){var t=e.split("/");return t.length<2?null:{min:parseFloat(t[0]),max:parseFloat(t[1]),resolution:t.length>=3&&"0"!==t[2]?parseFloat(t[2]):void 0}})).filter((function(e){return e})):r.map((function(e){return parseFloat(e)}))}function R(e){if(!e)return null;var t=-1!==e.indexOf("/"),r=e.split(",");return t?r.map((function(e){var t=e.split("/");return t.length<2?null:{min:t[0],max:t[1],resolution:t.length>=3&&"0"!==t[2]?t[2]:void 0}})).filter((function(e){return e})):r}function k(e){if(!e)return null;var t=-1!==e.indexOf("/"),r=e.split(",");return t?r.map((function(e){var t=e.split("/");return t.length<2?null:{min:new Date(t[0]),max:new Date(t[1]),resolution:t.length>=3&&"0"!==t[2]?L(t[2]):void 0}})).filter((function(e){return e})):r.map((function(e){return new Date(e)}))}function L(e){var t=e.match(/(?:p(\d+y|\d+(?:.|,)\d+y)?(\d+m|\d+(?:.|,)\d+m)?(\d+d|\d+(?:.|,)\d+d)?)?(?:t(\d+h|\d+(?:.|,)\d+h)?(\d+m|\d+(?:.|,)\d+m)?(\d+s|\d+(?:.|,)\d+s)?)?/i);return t?{years:A(t[1]),months:A(t[2]),days:A(t[3]),hours:A(t[4]),minutes:A(t[5]),seconds:A(t[6])}:null}function A(e){if(!e)return 0;var t=e.match(/(?:\d+(?:.|,)\d+|\d+)/);if(!t)return 0;var r=t[0].replace(",",".");return Number(r)}function F(e){return e.toISOString().replace(/\.[0-9]{3}/,"")}var P=new Set([102100,3857,102113,900913]),j=new Set([3395,54004]);function M(e,t){var r=e.wkid;return(0,i.isNone)(t)?r:(!t.includes(r)&&e.latestWkid&&(r=e.latestWkid),P.has(r)?t.find((function(e){return P.has(e)}))||t.find((function(e){return j.has(e)}))||102100:r)}}))}();
//# sourceMappingURL=WMSLayer.d78b3fd1.js.map
