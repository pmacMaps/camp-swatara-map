!function(){function e(e,t,r,s){Object.defineProperty(e,t,{get:r,set:s,enumerable:!0,configurable:!0})}var t=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire594f;t.register("hn7H0",(function(r,s){var n;n=r.exports,Object.defineProperty(n,"__esModule",{value:!0,configurable:!0}),e(r.exports,"default",(function(){return v}));var i=t("7eJjO"),o=t("kyj08"),a=t("6ah52"),l=t("lKPaD"),u=t("iho5X");t("iJAIC"),t("lNwWH"),t("2VlWd");var d=t("fcwIv"),p=t("f4h86"),c=t("9QPTU"),y=t("9M3e1"),h=t("lIBVg");function f(e,t){if(null==e&&null==t)return null;const r={};return null!=t&&(r.geometry=t.toJSON()),null!=e&&(r.where=e),r}let m=class extends((0,h.default)(c.default)){initialize(){this.addHandles([(0,l.watch)((()=>this.layer.customParameters),(e=>this._proxy.updateCustomParameters(e))),this.layer.on("send-message-to-socket",(e=>this._proxy.sendMessageToSocket(e))),this.layer.on("send-message-to-client",(e=>this._proxy.sendMessageToClient(e))),(0,l.watch)((()=>this.layer.purgeOptions),(()=>this._update())),(0,l.watch)((()=>this.suspended),this._onSuspendedChange.bind(this))],"constructor")}get connectionError(){return this.pipelineErrorString?new(0,o.default)("stream-controller",this.pipelineErrorString):null}on(e,t){if(Array.isArray(e))return(0,a.handlesGroup)(e.map((e=>this.on(e,t))));const r=["data-received","message-received"].includes(e);r&&(this._enabledEventTypes.add(e),this._proxy.enableEvent(e,!0));const s=super.on(e,t),n=this;return{remove(){s.remove(),r&&(n._proxy.closed||n.hasEventListener(e)||n._proxy.enableEvent(e,!1))}}}queryLatestObservations(e,t){var r,s,n;if(!((null===(r=this.layer.timeInfo)||void 0===r?void 0:r.endField)||(null===(s=this.layer.timeInfo)||void 0===s?void 0:s.startField)||(null===(n=this.layer.timeInfo)||void 0===n?void 0:n.trackIdField)))throw new(0,o.default)("streamlayer-no-timeField","queryLatestObservation can only be used with services that define a TrackIdField");return this._proxy.queryLatestObservations(this._cleanUpQuery(e),t).then((e=>{const t=p.default.fromJSON(e);return t.features.forEach((e=>{e.layer=this.layer,e.sourceLayer=this.layer})),t}))}detach(){super.detach(),this.pipelineConnectionStatus="disconnected"}get _streamConnectionStatus(){return this.pipelineConnectionStatus}_doPause(){var e;null===(e=this._proxy)||void 0===e||e.pauseStream()}_doResume(){var e;null===(e=this._proxy)||void 0===e||e.resumeStream()}_createClientOptions(){return{...super._createClientOptions(),setProperty:e=>{this.set(e.propertyName,e.value)}}}_createTileRendererHash(e){const t=`${JSON.stringify(this.layer.purgeOptions)}.${JSON.stringify(f(this.layer.definitionExpression,this.layer.geometryDefinition))})`;return super._createTileRendererHash(e)+t}async _createServiceOptions(){const e=this.layer,{objectIdField:t}=e,r=e.fields.map((e=>e.toJSON())),s=(0,y.toJSONGeometryType)(e.geometryType),n=e.timeInfo&&e.timeInfo.toJSON()||null,i=e.spatialReference?e.spatialReference.toJSON():null;return{type:"stream",isPaused:this._isUserPaused,fields:r,geometryType:s,objectIdField:t,timeInfo:n,source:this.layer.parsedUrl,serviceFilter:f(this.layer.definitionExpression,this.layer.geometryDefinition),purgeOptions:this.layer.purgeOptions.toJSON(),enabledEventTypes:Array.from(this._enabledEventTypes.values()),spatialReference:i,maxReconnectionAttempts:this.layer.maxReconnectionAttempts,maxReconnectionInterval:this.layer.maxReconnectionInterval,updateInterval:this.layer.updateInterval,customParameters:e.customParameters}}constructor(){super(...arguments),this.pipelineConnectionStatus="disconnected",this.pipelineErrorString=null,this._enabledEventTypes=new Set}};(0,i._)([(0,u.property)()],m.prototype,"pipelineConnectionStatus",void 0),(0,i._)([(0,u.property)()],m.prototype,"pipelineErrorString",void 0),(0,i._)([(0,u.property)({readOnly:!0})],m.prototype,"connectionError",null),(0,i._)([(0,u.property)({readOnly:!0})],m.prototype,"_streamConnectionStatus",null),m=(0,i._)([(0,d.subclass)("esri.views.2d.layers.StreamLayerView2D")],m);const v=m})),t.register("lIBVg",(function(r,s){e(r.exports,"default",(function(){return l}));var n=t("7eJjO"),i=t("iho5X");t("iJAIC"),t("lNwWH"),t("2VlWd");var o=t("fcwIv"),a=t("krMu9");const l=e=>{let t=class extends e{resume(){this._isUserPaused=!1,this.suspended||this._doResume()}pause(){this._isUserPaused=!0,this.suspended||this._doPause()}get connectionStatus(){return this._isUserPaused?"paused":this._streamConnectionStatus}_onSuspendedChange(e){e?this._doPause():this._isUserPaused||this._doResume()}constructor(...e){super(...e),this._isUserPaused=!1,this.filter=null}};return(0,n._)([(0,i.property)()],t.prototype,"_isUserPaused",void 0),(0,n._)([(0,i.property)({readOnly:!0})],t.prototype,"connectionStatus",null),(0,n._)([(0,i.property)({type:a.default})],t.prototype,"filter",void 0),t=(0,n._)([(0,o.subclass)("esri.layers.mixins.StreamLayerView")],t),t}}))}();
//# sourceMappingURL=StreamLayerView2D.a229abe9.js.map
