!function(){function e(e,t,r,n){Object.defineProperty(e,t,{get:r,set:n,enumerable:!0,configurable:!0})}function t(e){return e&&e.__esModule?e.default:e}var r=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire594f;r.register("lXwvk",(function(t,r){e(t.exports,"zeroCapabilities",(function(){return n}));var n={attachment:{supportsContentType:!1,supportsExifInfo:!1,supportsKeywords:!1,supportsName:!1,supportsSize:!1},data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:!1},editing:{supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsGeometryUpdate:!1,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:!1,supportsDelete:!1,supportsEditing:!1,supportsChangeTracking:!1,supportsQuery:!1,supportsQueryAttachments:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:!1,supportsExceedsLimitStatistics:!1},queryRelated:{supportsCount:!1,supportsOrderBy:!1,supportsPagination:!1},query:{maxRecordCount:0,maxRecordCountFactor:0,standardMaxRecordCount:0,supportsCacheHint:!1,supportsCentroid:!1,supportsCompactGeometry:!1,supportsDefaultSpatialReference:!1,supportsDisjointSpatialRelationship:!1,supportsDistance:!1,supportsDistinct:!1,supportsExtent:!1,supportsFormatPBF:!1,supportsGeometryProperties:!1,supportsHavingClause:!1,supportsHistoricMoment:!1,supportsMaxRecordCountFactor:!1,supportsOrderBy:!1,supportsPagination:!1,supportsPercentileStatistics:!1,supportsQuantization:!1,supportsQuantizationEditMode:!1,supportsQueryByOthers:!1,supportsQueryGeometry:!1,supportsResultType:!1,supportsSqlExpression:!1,supportsStandardizedQueriesOnly:!1,supportsTopFeaturesQuery:!1,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsStatistics:!1,tileMaxRecordCount:0}}})),r.register("aKPZL",(function(n,a){e(n.exports,"FetchAssociatedFeatureLayer",(function(){return y}));var s=r("8TSCy"),o=r("2TvXO"),u=r("dLARP"),p=r("9pNSx"),i=r("7qybv"),c=r("10vEZ"),l=r("g15Jq"),d=r("ajJOT"),f=r("iYaGG"),y=function(){"use strict";function e(t,r,n,a){s.classCallCheck(this,e),this.parsedUrl=t,this.portalItem=r,this.apiKey=n,this.signal=a,this.rootDocument=null;var o=this.parsedUrl.path.match(/^(.*)\/SceneServer\/layers\/([\d]*)\/?$/i);o&&(this.urlParts={root:o[1],layerId:parseInt(o[2],10)})}return s.createClass(e,[{key:"fetch",value:function(){var e=this;return s.asyncToGenerator(t(o).mark((function r(){var n,a,s;return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.urlParts){t.next=3;break}return t.abrupt("return",null);case 3:if(null==(n=e.portalItem)){t.next=7;break}t.t0=n,t.next=10;break;case 7:return t.next=9,e._portalItemFromServiceItemId();case 9:t.t0=t.sent;case 10:if(a=t.t0,!(0,i.isNone)(a)){t.next=13;break}return t.abrupt("return",e._loadFromUrl());case 13:return t.next=15,e._findAndLoadRelatedPortalItem(a);case 15:return s=t.sent,t.abrupt("return",(0,i.isNone)(s)?null:e._loadFeatureLayerFromPortalItem(s));case 17:case"end":return t.stop()}}),r)})))()}},{key:"fetchPortalItem",value:function(){var e=this;return s.asyncToGenerator(t(o).mark((function r(){var n,a;return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.urlParts){t.next=3;break}return t.abrupt("return",null);case 3:if(null==(n=e.portalItem)){t.next=7;break}t.t0=n,t.next=10;break;case 7:return t.next=9,e._portalItemFromServiceItemId();case 9:t.t0=t.sent;case 10:return a=t.t0,t.abrupt("return",(0,i.isNone)(a)?null:e._findAndLoadRelatedPortalItem(a));case 12:case"end":return t.stop()}}),r)})))()}},{key:"_fetchRootDocument",value:function(){var e=this;return s.asyncToGenerator(t(o).mark((function r(){var n,a,s;return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(0,i.isSome)(e.rootDocument)){t.next=2;break}return t.abrupt("return",e.rootDocument);case 2:if(!(0,i.isNone)(e.urlParts)){t.next=4;break}return t.abrupt("return",(e.rootDocument={},{}));case 4:return n={query:{f:"json",token:e.apiKey},responseType:"json",signal:e.signal},a="".concat(e.urlParts.root,"/SceneServer"),t.prev=5,t.next=8,(0,p.default)(a,n);case 8:s=t.sent,e.rootDocument=s.data,t.next=15;break;case 12:t.prev=12,t.t0=t.catch(5),e.rootDocument={};case 15:return t.abrupt("return",e.rootDocument);case 16:case"end":return t.stop()}}),r,null,[[5,12]])})))()}},{key:"_fetchServiceOwningPortalUrl",value:function(){var e=this;return s.asyncToGenerator(t(o).mark((function r(){var n,a,s,i;return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null==(a=null==(n=u.id)?void 0:n.findServerInfo(e.parsedUrl.path))||!a.owningSystemUrl){t.next=4;break}return t.abrupt("return",a.owningSystemUrl);case 4:return s=e.parsedUrl.path.replace(/(.*\/rest)\/.*/i,"$1")+"/info",t.prev=5,t.next=8,(0,p.default)(s,{query:{f:"json"},responseType:"json",signal:e.signal});case 8:if(!(i=t.sent.data.owningSystemUrl)){t.next=11;break}return t.abrupt("return",i);case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(5),(0,c.throwIfAbortError)(t.t0);case 16:return t.abrupt("return",null);case 17:case"end":return t.stop()}}),r,null,[[5,13]])})))()}},{key:"_findAndLoadRelatedPortalItem",value:function(e){var r=this;return s.asyncToGenerator(t(o).mark((function n(){return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.fetchRelatedItems({relationshipType:"Service2Service",direction:"reverse"},{signal:r.signal});case 3:if(t.t0=t.sent.find((function(e){return"Feature Service"===e.type})),t.t0){t.next=6;break}t.t0=null;case 6:return t.abrupt("return",t.t0);case 9:return t.prev=9,t.t1=t.catch(0),t.abrupt("return",((0,c.throwIfAbortError)(t.t1),null));case 12:case"end":return t.stop()}}),n,null,[[0,9]])})))()}},{key:"_loadFeatureLayerFromPortalItem",value:function(e){var r=this;return s.asyncToGenerator(t(o).mark((function n(){var a;return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.load({signal:r.signal});case 2:return t.next=4,r._findMatchingAssociatedSublayerUrl(e.url);case 4:return a=t.sent,t.abrupt("return",new(0,l.default)({url:a,portalItem:e}).load({signal:r.signal}));case 6:case"end":return t.stop()}}),n)})))()}},{key:"_loadFromUrl",value:function(){var e=this;return s.asyncToGenerator(t(o).mark((function r(){var n;return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._findMatchingAssociatedSublayerUrl("".concat(e.urlParts.root,"/FeatureServer"));case 2:return n=t.sent,t.abrupt("return",new(0,l.default)({url:n}).load({signal:e.signal}));case 4:case"end":return t.stop()}}),r)})))()}},{key:"_findMatchingAssociatedSublayerUrl",value:function(e){var r=this;return s.asyncToGenerator(t(o).mark((function n(){var a,u,i,c,l,d,f,y,m,h,v;return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.replace(/^(.*FeatureServer)(\/[\d]*\/?)?$/i,"$1"),u={query:{f:"json"},responseType:"json",authMode:"no-prompt",signal:r.signal},i=r.urlParts.layerId,c=r._fetchRootDocument(),l=(0,p.default)(a,u),t.t0=s,t.next=8,Promise.all([l,c]);case 8:if(t.t1=t.sent,d=t.t0.slicedToArray.call(t.t0,t.t1,2),f=d[0],y=d[1],m=y&&y.layers,h=f.data&&f.data.layers,Array.isArray(h)){t.next=16;break}throw new Error("expected layers array");case 16:if(!Array.isArray(m)){t.next=26;break}v=0;case 18:if(!(v<Math.min(m.length,h.length))){t.next=24;break}if(m[v].id!==i){t.next=21;break}return t.abrupt("return","".concat(a,"/").concat(h[v].id));case 21:v++,t.next=18;break;case 24:t.next=28;break;case 26:if(!(i<h.length)){t.next=28;break}return t.abrupt("return","".concat(a,"/").concat(h[i].id));case 28:throw new Error("could not find matching associated sublayer");case 29:case"end":return t.stop()}}),n)})))()}},{key:"_portalItemFromServiceItemId",value:function(){var e=this;return s.asyncToGenerator(t(o).mark((function r(){var n,a,s;return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._fetchRootDocument();case 2:if(n=t.sent.serviceItemId){t.next=5;break}return t.abrupt("return",null);case 5:return a=new(0,f.default)({id:n,apiKey:e.apiKey}),t.next=8,e._fetchServiceOwningPortalUrl();case 8:return s=t.sent,(0,i.isSome)(s)&&(a.portal=new(0,d.default)({url:s})),t.prev=10,t.abrupt("return",a.load({signal:e.signal}));case 14:return t.prev=14,t.t0=t.catch(10),t.abrupt("return",((0,c.throwIfAbortError)(t.t0),null));case 17:case"end":return t.stop()}}),r,null,[[10,14]])})))()}}]),e}()}))}();
//# sourceMappingURL=BuildingSceneLayer.3e8f900f.js.map
