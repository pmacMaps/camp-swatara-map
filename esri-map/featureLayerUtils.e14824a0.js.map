{"mappings":"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","sources":["node_modules/@arcgis/core/layers/save/featureLayerUtils.js","node_modules/@arcgis/core/core/accessorSupport/originUtils.js","node_modules/@arcgis/core/core/multiOriginJSONSupportUtils.js","node_modules/@arcgis/core/portal/support/portalItemUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{difference as e}from\"../../core/arrayUtils.js\";import t from\"../../core/Error.js\";import a from\"../../core/Logger.js\";import{isNone as r,isSome as o}from\"../../core/maybe.js\";import{debounce as s,eachAlways as l}from\"../../core/promiseUtils.js\";import{updateOrigins as i}from\"../../core/accessorSupport/originUtils.js\";import n from\"../FeatureLayer.js\";import{fetchFeatureService as u}from\"../support/arcgisLayers.js\";import{parse as p}from\"../support/arcgisLayerUrl.js\";import{isFeatureCollectionLayer as c,isFeatureServiceLayer as y}from\"../support/layerUtils.js\";import d from\"../../portal/Portal.js\";import m from\"../../portal/PortalItem.js\";import{createForItemWrite as f}from\"../../portal/support/jsonContext.js\";import{addTypeKeyword as w,TypeKeyword as h,getWGS84ExtentForItem as v,removeTypeKeyword as b}from\"../../portal/support/portalItemUtils.js\";const I=a.getLogger(\"esri.layers.FeatureLayer\"),S=\"Feature Service\";function g(e,t){return`Layer (title: ${e.title}, id: ${e.id}) of type '${e.declaredClass}' ${t}`}function j(e,a){if(a.type!==S)throw new t(\"feature-layer:portal-item-wrong-type\",g(e,`should have portal item of type \"${S}\"`))}async function L(e){if(await e.load(),c(e))throw new t(\"feature-layer:save\",g(e,\"using an in-memory source cannot be saved to a portal item\"))}function P(e,a){let r=e.messages.filter((({type:e})=>\"error\"===e)).map((({name:e,message:a,details:r})=>new t(e,a,r)));if(a?.ignoreUnsupported&&(r=r.filter((({name:e})=>\"layer:unsupported\"!==e&&\"symbol:unsupported\"!==e&&\"symbol-layer:unsupported\"!==e&&\"property:unsupported\"!==e&&\"url:unsupported\"!==e))),r.length>0)throw new t(\"feature-layer:save\",\"Failed to save feature layer due to unsupported or invalid content. See 'details.errors' for more detailed information\",{errors:r})}async function J(e,t,a){\"beforeSave\"in e&&\"function\"==typeof e.beforeSave&&await e.beforeSave();const r=e.write({},t);return P(t,a),r}function N(e){const{layer:t,layerJSON:a}=e;return t.isTable?{layers:[],tables:[a]}:{layers:[a],tables:[]}}function O(e){w(e,h.JSAPI),e.typeKeywords&&(e.typeKeywords=e.typeKeywords.filter(((e,t,a)=>a.indexOf(e)===t)))}function E(e){const a=e.portalItem;if(!a)throw I.error(\"save: requires the portalItem property to be set\"),new t(\"feature-layer:portal-item-not-set\",g(e,\"requires the portalItem property to be set\"));if(!a.loaded)throw new t(\"feature-layer:portal-item-not-loaded\",g(e,\"cannot be saved to a portal item that does not exist or is inaccessible\"));j(e,a)}async function T(e,t){return/\\/\\d+\\/?$/.test(e.url)?N(t[0]):$(e,t)}async function $(e,t){const{layer:{url:a,customParameters:r,apiKey:o}}=t[0];let s=await e.fetchData(\"json\");s&&null!=s.layers&&null!=s.tables||(s=await x(s,{url:a,customParameters:r,apiKey:o},t.map((e=>e.layer.layerId))));for(const l of t)K(l.layer,l.layerJSON,s);return s}async function x(e,t,a){var r,o;e||(e={}),(r=e).layers||(r.layers=[]),(o=e).tables||(o.tables=[]);const{url:s,customParameters:l,apiKey:i}=t,{serviceJSON:n,layersJSON:p}=await u(s,{customParameters:l,apiKey:i}),c=A(e.layers,n.layers,a),y=A(e.tables,n.tables,a);e.layers=c.itemResources,e.tables=y.itemResources;const d=[...c.added,...y.added],m=p?[...p.layers,...p.tables]:[];return await U(e,d,s,m),e}function A(t,a,r){const o=e(t,a,((e,t)=>e.id===t.id));t=t.filter((e=>!o.removed.some((t=>t.id===e.id))));const s=o.added.map((({id:e})=>({id:e})));return s.forEach((({id:e})=>{t.push({id:e})})),{itemResources:t,added:s.filter((({id:e})=>!r.includes(e)))}}async function U(e,t,a,o){const s=t.map((({id:e})=>new n({url:a,layerId:e,sourceJSON:o.find((({id:t})=>t===e))})));await l(s.map((e=>e.load()))),s.forEach((t=>{const{layerId:a,loaded:o,defaultPopupTemplate:s}=t;if(!o||r(s))return;K(t,{id:a,popupInfo:s.toJSON()},e)}))}function K(e,t,a){e.isTable?F(a.tables,t):F(a.layers,t)}function F(e,t){const a=e.findIndex((({id:e})=>e===t.id));-1===a?e.push(t):e[a]=t}function R(e){const{portalItem:t}=e;return y(e)&&!e.dynamicDataSource&&!!t?.loaded&&t.type===S}async function D(e){if(!e?.length)throw new t(\"feature-layer-utils-saveall:missing-parameters\",\"'layers' array should contain at least one feature layer\");await Promise.all(e.map((e=>e.load())));for(const o of e)if(!R(o))throw new t(\"feature-layer-utils-saveall:invalid-parameters\",`'layers' array should only contain layers or tables in a feature service loaded from 'Feature Service' item. ${g(o,\"does not conform\")}`,{layer:o});const a=e.map((e=>e.portalItem.id));if(new Set(a).size>1)throw new t(\"feature-layer-utils-saveall:invalid-parameters\",\"All layers in the 'layers' array should be loaded from the same portal item\");const r=e.map((e=>e.layerId));if(new Set(r).size!==r.length)throw new t(\"feature-layer-utils-saveall:invalid-parameters\",\"'layers' array should contain only one instance each of layer or table in a feature service\")}function _(e,t){var a,r;let o=m.from(t);return o.id&&(o=o.clone(),o.id=null),(a=o).type??(a.type=S),(r=o).portal??(r.portal=d.getDefault()),j(e,o),o}async function q(e,t){const{url:a,layerId:r,title:s,fullExtent:l,isTable:i}=e,n=p(a),u=o(n)&&\"FeatureServer\"===n.serverType;t.url=u?a:`${a}/${r}`,t.title||(t.title=s),t.extent=null,!i&&o(l)&&(t.extent=await v(l)),b(t,h.METADATA),b(t,h.MULTI_LAYER),w(t,h.SINGLE_LAYER),i&&w(t,h.TABLE),O(t)}async function z(e,t,a){const r=e.portal;await r._signIn(),await r.user.addItem({item:e,data:t,folder:a?.folder})}const C=s(M);async function M(e,t){await L(e),E(e);const a=e.portalItem,r=f(a),o=await J(e,r,t),s=await T(a,[{layer:e,layerJSON:o}]);return O(a),await a.update({data:s}),i(r),a}const Y=s((async(e,t)=>{await D(e);const a=e[0].portalItem,r=f(a),o=await Promise.all(e.map((e=>J(e,r,t)))),s=await T(a,e.map(((e,t)=>({layer:e,layerJSON:o[t]}))));return O(a),await a.update({data:s}),await Promise.all(e.slice(1).map((e=>e.portalItem.reload()))),i(r),a.clone()})),B=s(G);async function G(e,t,a){await L(e);const r=_(e,t),o=f(r),s=N({layer:e,layerJSON:await J(e,o,a)});return await q(e,r),await z(r,s,a),e.portalItem=r,i(o),r}export{C as save,Y as saveAll,B as saveAs};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{isMultiOriginJSONMixin as r}from\"../multiOriginJSONSupportUtils.js\";function i(i){i&&i.writtenProperties&&i.writtenProperties.forEach((({target:i,propName:t,newOrigin:e})=>{r(i)&&e&&i.originOf(t)!==e&&i.updateOrigin(t,e)}))}export{i as updateOrigins};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nfunction i(i){return i&&\"getAtOrigin\"in i&&\"originOf\"in i}export{i as isMultiOriginJSONMixin};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{initializeProjection as e,project as t}from\"../../geometry/projection.js\";import r from\"../../geometry/SpatialReference.js\";import{webMercatorToGeographic as o}from\"../../geometry/support/webMercatorUtils.js\";async function n(n){const i=n.spatialReference;if(i.isWGS84)return n.clone();if(i.isWebMercator)return o(n);const s=r.WGS84;return await e(i,s),t(n,s)}function i(e,t){if(!s(e,t)){const r=e.typeKeywords;r?r.push(t):e.typeKeywords=[t]}}function s(e,t){return!!e.typeKeywords?.includes(t)}function c(e,t){const r=e.typeKeywords;if(r){const e=r.indexOf(t);e>-1&&r.splice(e,1)}}async function a(e){const t=e.clone().normalize();let r;if(t.length>1)for(const o of t)r?o.width>r.width&&(r=o):r=o;else r=t[0];return n(r)}const f={DEVELOPER_BASEMAP:\"DeveloperBasemap\",JSAPI:\"ArcGIS API for JavaScript\",METADATA:\"Metadata\",MULTI_LAYER:\"Multilayer\",SINGLE_LAYER:\"Singlelayer\",TABLE:\"Table\"};export{f as TypeKeyword,i as addTypeKeyword,a as getWGS84ExtentForItem,s as hasTypeKeyword,c as removeTypeKeyword};\n"],"names":["$lNwWH","parcelRequire","$c60bdef17c1d33f1$var$I","$jHOLN","default","getLogger","$c60bdef17c1d33f1$var$S","$c60bdef17c1d33f1$var$g","e","t","title","id","declaredClass","$c60bdef17c1d33f1$var$j","a","type","$kyj08","async","$c60bdef17c1d33f1$var$L","load","$d1ImW","isFeatureCollectionLayer","$c60bdef17c1d33f1$var$J","beforeSave","r","write","messages","filter","map","name","message","details","ignoreUnsupported","length","errors","$c60bdef17c1d33f1$var$P","$c60bdef17c1d33f1$var$N","layer","layerJSON","isTable","layers","tables","$c60bdef17c1d33f1$var$O","$7Kuhs","addTypeKeyword","TypeKeyword","JSAPI","typeKeywords","indexOf","$c60bdef17c1d33f1$var$T","test","url","customParameters","apiKey","o","s","fetchData","l","i","serviceJSON","n","layersJSON","p","$1VmFB","fetchFeatureService","c","$c60bdef17c1d33f1$var$A","y","itemResources","d","added","m","$g15Jq","layerId","sourceJSON","find","$10vEZ","eachAlways","forEach","loaded","defaultPopupTemplate","$7qybv","isNone","$c60bdef17c1d33f1$var$K","popupInfo","toJSON","$c60bdef17c1d33f1$var$U","$c60bdef17c1d33f1$var$x","$c60bdef17c1d33f1$var$$","difference","removed","some","push","includes","$c60bdef17c1d33f1$var$F","findIndex","$c60bdef17c1d33f1$var$R","portalItem","isFeatureServiceLayer","dynamicDataSource","$c60bdef17c1d33f1$export$a1544dad697b423d","debounce","error","$c60bdef17c1d33f1$var$E","$UdTKD","createForItemWrite","update","data","$amEsL","updateOrigins","$c60bdef17c1d33f1$export$722a3828c3d5dbae","Promise","all","Set","size","$c60bdef17c1d33f1$var$D","slice","reload","clone","$c60bdef17c1d33f1$export$2bc2a80e311129ac","$iYaGG","from","_type","_portal","portal","$ajJOT","getDefault","$c60bdef17c1d33f1$var$_","fullExtent","$lmu5w","parse","u","isSome","serverType","extent","getWGS84ExtentForItem","removeTypeKeyword","METADATA","MULTI_LAYER","SINGLE_LAYER","TABLE","$c60bdef17c1d33f1$var$q","_signIn","user","addItem","item","folder","$c60bdef17c1d33f1$var$z","$arTQ0","$78bb5893f129cf8f$export$3437e8e38d02a5f0","writtenProperties","target","propName","newOrigin","isMultiOriginJSONMixin","originOf","updateOrigin","$79b7bd3a8b7f701b$export$3872c8e43f6916e8","$7RvA5","$5a44515cfcb51fa9$export$ebb62008aa4e5eb4","$5a44515cfcb51fa9$export$2d83a77b8ca81ab7","ref","$5a44515cfcb51fa9$export$fa34c6de0d54b038","e1","splice","$5a44515cfcb51fa9$export$326e08b953787a51","normalize","width","spatialReference","isWGS84","isWebMercator","$eF88h","webMercatorToGeographic","$j40xv","WGS84","initializeProjection","project","$5a44515cfcb51fa9$var$n","$5a44515cfcb51fa9$export$4e4f481ef4678880","DEVELOPER_BASEMAP"],"version":3,"file":"featureLayerUtils.e14824a0.js.map"}