function e(e,t,r,s){Object.defineProperty(e,t,{get:r,set:s,enumerable:!0,configurable:!0})}var t=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire594f;t.register("fHReO",(function(r,s){var i;i=r.exports,Object.defineProperty(i,"__esModule",{value:!0,configurable:!0}),e(r.exports,"default",(function(){return x}));var n=t("j6uz9"),a=t("5HTPH"),o=t("lHg4e");t("6TszD"),t("gHCNy"),t("aX9sh"),t("bXKTN");var u=t("qA6zg"),h=t("19dbe"),f=t("g3Kzh"),l=t("lJNHt"),d=t("iuimx"),c=t("7lvxD"),p=t("9C7Je");let _=class extends d.default{install(e){const t=new(0,p.WGLFeatureView)(this.tileInfoView,this.layerView,this.layer,(()=>this.notifyChange("updating")));this.featuresView=t,e.addChild(t)}uninstall(e){e.removeChild(this.featuresView),this.featuresView.destroy(),this.featuresView=null}fetchResource(e,t){const{url:r}=e,s=this.featuresView.stage;try{return s.resourceManager.fetchResource(r,{signal:t.signal})}catch(e){return(0,o.isAbortError)(e)?Promise.resolve({width:0,height:0}):Promise.reject(e)}}isUpdating(){const e=super.isUpdating(),t=!this.featuresView||this.featuresView.isUpdating(),r=this.featuresView?.hasEmptyAttributeView(),s=e||t||e&&r;return(0,a.default)("esri-2d-log-updating")&&console.log(`Updating SymbolTileRenderer ${s}\n  -> updatingTiles ${e}\n  -> hasFeaturesView ${!!this.featuresView}\n  -> updatingFeaturesView ${t}`),s}hitTest(e){return this.featuresView.hitTest(e)}supportsRenderer(e){return null!=e&&["simple","class-breaks","unique-value","dot-density","dictionary","heatmap","pie-chart"].includes(e.type)}onConfigUpdate(e){let t=null;if("visualVariables"in e){const r=((0,l.simplifyVVRenderer)(e).visualVariables||[]).map((e=>{const t=e.clone();return"normalizationField"in e&&(t.normalizationField=null),e.valueExpression&&"$view.scale"!==e.valueExpression&&(t.valueExpression=null,t.field="nop"),t}));t=(0,c.convertVisualVariables)(r)}this.featuresView.setRendererInfo(e,t,this.layerView.featureEffect)}onTileData(e){const t=this.tiles.get(e.tileKey);t&&e.data&&this.featuresView.onTileData(t,e.data),this.layerView.view.labelManager.requestUpdate()}onTileError(e){const t=this.tiles.get(e.tileKey);t&&this.featuresView.onTileError(t)}forceAttributeTextureUpload(){this.featuresView.attributeView.forceTextureUpload()}lockGPUUploads(){this.featuresView.attributeView.lockTextureUpload(),this.tiles.forEach((e=>e.lock()))}unlockGPUUploads(){this.featuresView.attributeView.unlockTextureUpload(),this.tiles.forEach((e=>e.unlock()))}async getMaterialItems(e){return this.featuresView.getMaterialItems(e)}invalidateLabels(){this.featuresView.hasLabels&&this.layerView.view.labelManager.requestUpdate()}createTile(e){const t=this.tileInfoView.getTileBounds((0,h.create)(),e);return new(0,f.FeatureTile)(e,t[0],t[3],this.featuresView.attributeView,(()=>this.layerView.view.labelManager.requestUpdate()))}disposeTile(e){this.featuresView.removeChild(e),e.destroy(),this.layerView.view.labelManager.requestUpdate()}constructor(){super(...arguments),this.type="symbol"}};_=(0,n._)([(0,u.subclass)("esri.views.2d.layers.features.tileRenderers.SymbolTileRenderer")],_);const x=_})),t.register("g3Kzh",(function(r,s){e(r.exports,"FeatureTile",(function(){return y}));var i=t("cxEdX"),n=t("5HTPH"),a=t("1CpCt"),o=t("54M7g"),u=t("elw4w"),h=t("17nYB"),f=t("gLni9"),l=t("eyQUy"),d=t("cPgEa"),c=t("8n4SS"),p=t("2aRFD"),_=t("2oYYI");let x=0;class y extends c.WGLTile{destroy(){super.destroy(),this._renderState.current.geometry.forEach((e=>e.destroy()))}get labelMetrics(){return this._renderState.current.metrics}get hasData(){return!!this._renderState.current.geometry.size}getGeometry(e){return this._renderState.current.geometry.get(e)}setTransform(e,t){super.setTransform(e,t);const r=this.transforms.labelMat2d,s=e.getScreenTransform(r,t),i=(0,f.c)();(0,h.t)(i,[this.x,this.y],s),(0,o.a)(r,i),(0,o.m)(r,e.viewMat2d,r)}patch(e,t){this.patchCount++,(0,n.default)("esri-2d-update-debug")&&!0===e.clear&&console.debug(this.key.id,"FeatureTile:patch:clear",e.clear),e.clear&&this._patches.size>=50&&this._dropPatches();const r=e,s=r.addOrUpdate&&this.key.id!==r.addOrUpdate.tileKeyOrigin;t&&s?this._bufferPatches.enqueue(r):(r.sort=r.sort&&!t,this._patches.enqueue(r)),this.requestRender()}commit(e){if(this._lastCommitTime!==e.time){this._lastCommitTime=e.time;for(let e=0;e<4;e++)this._updateMesh(),this.isReady&&this._updateBufferMesh();this._renderState.swap&&(this._swapRenderStates(),this.requestRender())}}lock(){this._renderState.locked=!0}unlock(){this._renderState.locked=!1,this._flushUpdates(),this._swap()}_swapRenderStates(){if(this._renderState.next){if(this._renderState.locked)return this._renderState.swap=!0,void this.requestRender();this._renderState.swap=!0,this._swap()}}_swap(){this._renderState.swap&&(this._renderState.swap=!1,(0,a.isSome)(this._renderState.next)&&(this._renderState.current.geometry.forEach((e=>e.destroy())),this._renderState.current=this._renderState.next,this._renderState.next=null,this._requestLabelUpdate()))}_flushUpdates(){let e=this._patches.maxSize;for(;this._patches.size&&e--;)this._updateMesh(),this._swap()}_updateBufferMesh(){const e=this._bufferPatches.peek();if(!(0,a.isSome)(e)||!e.clear||null===this._renderState.next)for(;this._bufferPatches.size;){const e=this._bufferPatches.dequeue();(0,a.isSome)(e)&&this._patchBuffer(e)}}_updateMesh(){const e=this._patches.dequeue();(0,a.isSome)(e)&&(!0===e.clear&&((0,a.isSome)(this._renderState.next)&&(this._renderState.next.geometry.forEach((e=>e.destroy())),this._renderState.next=null),this._renderState.next={geometry:new Map,metrics:null},(0,n.default)("esri-2d-update-debug")&&console.debug(this.key.id,"FeatureTile:_updateMesh - Creating new renderState")),this.requestRender(),this._patch(e),e.end&&((0,n.default)("esri-2d-update-debug")&&console.debug(this.key.id,"FeatureTile:_updateMesh - Encountered end message"),this.ready(),this._swapRenderStates()))}_patch(e){(0,d.forEachGeometryType)((t=>{this._remove(t,e.remove),this._insert(t,e,!1)}))}_patchBuffer(e){(0,d.forEachGeometryType)((t=>{this._insert(t,e,!0)}))}_insert(e,t,r){try{const s=(0,a.unwrapOr)(this._renderState.next,this._renderState.current),i=t.addOrUpdate?.data[e],o=s.geometry;if((0,a.isNone)(i))return;o.has(e)||((0,n.default)("esri-2d-update-debug")&&console.debug(this.key.id,`FeatureTile:_insert - Creating geometry buffer ${e}`),o.set(e,new(0,_.Geometry)(e,this.stage))),(0,n.default)("esri-2d-update-debug")&&console.debug(this.key.id,`FeatureTile:_insert - Inserting into ${e}, version=${t.addOrUpdate.version} stride=${i.stride}`),o.get(e).insert(i,t.sort,r),e===l.WGLGeometryType.LABEL&&this._insertLabelMetrics(t.type,i.metrics,t.clear)}catch(e){}}_insertLabelMetrics(e,t,r){const s=(0,a.unwrapOr)(this._renderState.next,this._renderState.current);if((0,a.isNone)(t))return;const i=p.MetricReader.from(t);if((0,a.isNone)(s.metrics))s.metrics=i;else{if("update"===e){const e=i.getCursor();for(;e.next();)s.metrics.delete(e.id)}s.metrics.link(i)}}_remove(e,t){const r=(0,a.unwrapOr)(this._renderState.next,this._renderState.current).geometry.get(e);t&&t.length&&r&&(r.remove(t),this._removeLabelMetrics(t))}_removeLabelMetrics(e){const{metrics:t}=(0,a.unwrapOr)(this._renderState.next,this._renderState.current);if(!(0,a.isNone)(t)&&e.length)for(const r of e)for(;t.delete(r););}_dropPatches(){const e=new Array;let t=!1;for(;this._patches.size;){const r=this._patches.dequeue();if((0,a.isNone)(r))break;if(r.clear){if(t)break;t=!0}e.push(r)}this._patches.clear(),e.forEach((e=>this._patches.enqueue(e)))}constructor(e,t,r,s,n){super(e,t,r),this.instanceId=x++,this.patchCount=0,this._renderState={current:{geometry:new Map,metrics:null},next:null,swap:!1,swapFrames:0,locked:!1},this._patches=new(0,i.default)(100),this._bufferPatches=new(0,i.default)(100),this._lastCommitTime=0,this.transforms.labelMat2d=(0,u.c)(),this._store=s,this._requestLabelUpdate=n}}})),t.register("cxEdX",(function(r,s){e(r.exports,"default",(function(){return n}));var i=t("1CpCt");class n{get entries(){return this._buffer}enqueue(e){if(this.size===this.maxSize){const t=this._buffer[this._start];return this._buffer[this._start]=e,this._start=(this._start+1)%this.maxSize,t}return this._buffer[(this._start+this.size++)%this.maxSize]=e,null}dequeue(){if(0===this.size)return null;const e=this._buffer[this._start];return this._buffer[this._start]=null,this.size--,this._start=(this._start+1)%this.maxSize,e}peek(){return 0===this.size?null:this._buffer[this._start]}find(e){if(0===this.size)return null;for(const t of this._buffer)if((0,i.isSome)(t)&&e(t))return t;return null}clear(e){let t=this.dequeue();for(;(0,i.isSome)(t);)e&&e(t),t=this.dequeue()}constructor(e){this.size=0,this._start=0,this.maxSize=e,this._buffer=new Array(e)}}})),t.register("2aRFD",(function(r,s){e(r.exports,"MetricReader",(function(){return a}));var i=t("1CpCt");const n=4294967296;class a{static from(e){const t=o.from(new Float32Array(e));return new a(t)}get id(){return this._cursor.id}get baseZoom(){return this._cursor.baseZoom}get anchorX(){return this._cursor.anchorX}get anchorY(){return this._cursor.anchorY}get directionX(){return this._cursor.directionX}get directionY(){return this._cursor.directionY}get size(){return this._cursor.size}get materialKey(){return this._cursor.materialKey}get boundsCount(){return this._cursor.boundsCount}computedMinZoom(){return this._cursor.computedMinZoom()}setComputedMinZoom(e){return this._cursor.setComputedMinZoom(e)}boundsComputedAnchorX(e){return this._cursor.boundsComputedAnchorX(e)}boundsComputedAnchorY(e){return this._cursor.boundsComputedAnchorY(e)}setBoundsComputedAnchorX(e,t){return this._cursor.setBoundsComputedAnchorX(e,t)}setBoundsComputedAnchorY(e,t){return this._cursor.setBoundsComputedAnchorY(e,t)}boundsX(e){return this._cursor.boundsX(e)}boundsY(e){return this._cursor.boundsY(e)}boundsWidth(e){return this._cursor.boundsWidth(e)}boundsHeight(e){return this._cursor.boundsHeight(e)}link(e){if((0,i.isSome)(e._head))return this._cursor.link(e._head)}getCursor(){return this.copy()}copy(){const e=new a(this._head?.copy());if(!e._head)return e;let t=e._head,r=e._head._link;for(;r;)t._link=r.copy(),t=r,r=t._link;return e}peekId(){return this._cursor.peekId()??this._cursor._link.peekId()}nextId(){const e=this.id;for(;e===this.id;)if(!this.next())return!1;return!0}save(){this._savedCursor=this._cursor,this._savedOffset=this._cursor._offset}restore(){this._cursor=this._savedCursor,this._cursor._offset=this._savedOffset}next(){if(!this._cursor)return!1;if(!this._cursor.next()){if(!this._cursor._link)return!1;this._cursor=this._cursor._link,this._cursor._offset=0}return!0}lookup(e){for(this._cursor=this._head;this._cursor&&!this._cursor.lookup(e);){if(!this._cursor._link)return!1;this._cursor=this._cursor._link}return!!this._cursor}delete(e){let t=this._head,r=null;for(;t;){if(t.delete(e))return t.isEmpty()&&(0,i.isSome)(r)&&(r._link=t._link),!0;r=t,t=t._link}return!1}constructor(e){this._head=e,this._cursor=e}}class o{static from(e){return new o(new Float32Array(e))}isEmpty(){return this._deletedCount===this.count}get count(){return this._count||(this._count=this._computeCount()),this._count}get id(){return this._buffer[this._offset+0]}set id(e){this._buffer[this._offset+0]=e}get baseZoom(){return this._buffer[this._offset+1]}get anchorX(){return this._buffer[this._offset+2]}get anchorY(){return this._buffer[this._offset+3]}get directionX(){return this._buffer[this._offset+4]}get directionY(){return this._buffer[this._offset+5]}get size(){return this._buffer[this._offset+6]}get materialKey(){return this._buffer[this._offset+7]}computedMinZoom(){return this._buffer[this._offset+8]}setComputedMinZoom(e){this._buffer[this._offset+8]=e}get boundsCount(){return this._buffer[this._offset+9]}boundsComputedAnchorX(e){return this._buffer[this._offset+10+6*e+0]}boundsComputedAnchorY(e){return this._buffer[this._offset+10+6*e+1]}setBoundsComputedAnchorX(e,t){this._buffer[this._offset+10+6*e+0]=t}setBoundsComputedAnchorY(e,t){this._buffer[this._offset+10+6*e+1]=t}boundsX(e){return this._buffer[this._offset+10+6*e+2]}boundsY(e){return this._buffer[this._offset+10+6*e+3]}boundsWidth(e){return this._buffer[this._offset+10+6*e+4]}boundsHeight(e){return this._buffer[this._offset+10+6*e+5]}link(e){let t=this;for(;t._link;)t=t._link;t._link=e}getCursor(){return this.copy()}copy(){const e=new o(this._buffer);return e._link=this._link,e._offset=this._offset,e._deletedCount=this._deletedCount,e._offsets=this._offsets,e._count=this._count,e}peekId(){const e=this._offset+10+6*this.boundsCount+0;return e>=this._buffer.length?0:this._buffer[e]}next(){let e=0;for(;this._offset<this._buffer.length&&e++<100&&(-1===this._offset?this._offset=0:this._offset+=10+6*this.boundsCount,this.id===n););return this.id!==n&&this._offset<this._buffer.length}delete(e){const t=this._offset,r=this.lookup(e);if(r)for(this.id=4294967295,++this._deletedCount;this.next()&&this.id===e;)this.id=4294967295,++this._deletedCount;return this._offset=t,r}lookup(e){const t=this._offset;if((0,i.isNone)(this._offsets.instance)){this._offsets.instance=new Map;const e=this.copy();e._offset=-1;let t=0;for(;e.next();)e.id!==t&&(this._offsets.instance.set(e.id,e._offset),t=e.id)}return!!this._offsets.instance.has(e)&&(this._offset=this._offsets.instance.get(e),this.id!==n||(this._offset=t,!1))}_computeCount(){const e=this._offset;let t=0;for(this._offset=-1;this.next();)t++;return this._offset=e,t}constructor(e){this._offset=-1,this._link=null,this._count=0,this._deletedCount=0,this._offsets={instance:null},this._buffer=e}}})),t.register("2oYYI",(function(r,s){e(r.exports,"Geometry",(function(){return h}));var i=t("1CpCt"),n=t("dQZqM"),a=t("hc9lx"),o=t("9PGNx"),u=t("4radX");class h{destroy(){for(const[e,t]of this._vaos)(0,i.isSome)(t)&&t.dispose(!1);this._indexBuffer=(0,i.destroyMaybe)(this._indexBuffer),this._vertexBuffer=(0,i.destroyMaybe)(this._vertexBuffer)}insert(e,t,r){if(!e.records.byteLength)return;const s=e.stride;if(this._vertexBuffer&&this._indexBuffer){const r=e.indices.byteLength/4,n=e.vertices.byteLength/s;this._indexBuffer.ensure(r),this._vertexBuffer.ensure(n);const{vertices:a,indices:u}=e,h=o.DisplayRecordReader.from(e.records),f=this._vertexBuffer.insert(a,0,a.byteLength/s,0),l=this._indexBuffer.insert(u,0,u.byteLength/4,f);if(h.forEach((e=>{e.indexFrom+=l,e.vertexFrom+=f})),(0,i.unwrapOrThrow)(this._records,"Expected records to be defined").link(h),t)this._indicesInvalid=!0;else if(this._displayList){const e=h.getCursor();for(;e.next();)this._displayList.addRecord(e)}}else{const r=e.indices.byteLength/4,i=e.vertices.byteLength/s,n=s/Uint32Array.BYTES_PER_ELEMENT;this._records=o.DisplayRecordReader.from(e.records),this._indexBuffer=new(0,a.Buffer)("index",r,1),this._vertexBuffer=new(0,a.Buffer)("vertex",i,n),this._indexBuffer.insert(e.indices,0,e.indices.byteLength/4,0),this._vertexBuffer.insert(e.vertices,0,e.vertices.byteLength/s,0),t&&(this._indicesInvalid=!0)}}remove(e){if(!(0,i.isNone)(this._records))for(const t of e){const e=this._records.getCursor();if(!e.lookup(t))continue;const r=e.indexFrom,s=e.vertexFrom;let i=e.indexCount,n=e.vertexCount;for(;e.next()&&e.id===t;)i+=e.indexCount,n+=e.vertexCount;this._indexBuffer.free(r,i),this._vertexBuffer.free(s,n,!0),this._records.delete(t)}}getVAO(e,t,r,s){if(!this._vertexBuffer||!this._indexBuffer||(0,i.isNone)(this._records)||!this._vertexBuffer.bufferSize)return null;const n=s?1:0;let a=this._vaos.get(n);(this._vertexBuffer.invalidated||this._indexBuffer.invalidated||s&&this._indexBuffer.invalidatedComputeBuffer)&&((0,i.applySome)(a,(e=>e.dispose(!1))),a=null),this._vertexBuffer.upload(),this._indexBuffer.upload();const o=this._indexBuffer.getGPUBuffer(e,1===n),h=this._vertexBuffer.getGPUBuffer(e);return a||(a=new(0,u.VertexArrayObject)(e,r,t,{geometry:h},o),this._vaos.set(n,a)),a}forEachCommand(e){if(!(0,i.isNone)(this._records)){if(this._sortIndices(this._records),!this._displayList){const e=this._cursorIndexOrder;this._displayList=n.FeatureDisplayList.from(this,this.geometryType,this._records.getCursor(),e)}this._displayList.forEach(e)}}_sortIndices(e){const t=!!this._indexBuffer.bufferSize;if(!this._indicesInvalid)return;this._indicesInvalid=!1;let r=0;const s=e.getCursor(),i=[],n=[],a=[];for(;s.next();)n.push(s.index),a.push(s.sortKey),i.push(s.id);n.sort(((e,t)=>{const r=a[t],s=a[e];return s===r?i[t]-i[e]:r-s}));const o=e.getCursor(),u=t?this._indexBuffer.getCPUBuffer():this._vertexBuffer.getCPUBuffer();for(const e of n){if(!o.seekIndex(e))throw new Error("Expected to find index");if(t){const{indexFrom:e,indexCount:t}=o;o.indexFrom=r;for(let s=0;s<t;s++)this._indexBuffer.set(r++,u.array[e+s])}else{const{vertexFrom:e,vertexCount:t}=o,s=this._vertexBuffer.strideInt,i=e*s,n=i+t*s;o.vertexFrom=r/s;for(let e=i;e<n;e++)this._vertexBuffer.set(r++,u.array[e])}}this._cursorIndexOrder=n,this._displayList=null}constructor(e,t){this._vaos=new Map,this._indicesInvalid=!1,this.geometryType=e}}})),t.register("dQZqM",(function(r,s){e(r.exports,"FeatureDisplayList",(function(){return o}));var i=t("1CpCt"),n=t("h8K44");class a{get indexEnd(){return this.indexFrom+this.indexCount}extend(e){this.indexCount+=e}constructor(e,t,r,s,i){this.target=e,this.geometryType=t,this.materialKey=r,this.indexFrom=s,this.indexCount=i}}class o{static from(e,t,r,s){const n=new o(e,t);if((0,i.isSome)(s))for(const e of s)r.seekIndex(e),n.addRecord(r);else for(;r.next();)n.addRecord(r);return n}addRecord(e){const t=this._target,r=this.geometryType,s=e.materialKey;let o=e.indexFrom,u=e.indexCount;const h=e.vertexFrom,f=e.vertexCount;if(u||(o=h,u=f),(0,i.isNone)(this._head)){const e=new a(t,r,s,o,u);return void(this._head=new(0,n.List)(e))}let l=null,d=this._head;for(;d;){if(o<d.data.indexFrom)return this._insert(s,o,u,l,d);l=d,d=d.next}this._insert(s,o,u,l,null)}forEach(e){(0,i.isSome)(this._head)&&this._head.forEach(e)}*infos(){if((0,i.isSome)(this._head))for(const e of this._head.values())yield e}_insert(e,t,r,s,o){if((0,i.isNone)(s)&&(0,i.isNone)(o)){const s=new a(this._target,this.geometryType,e,t,r);this._head=new(0,n.List)(s)}return(0,i.isNone)(s)&&(0,i.isSome)(o)?this._insertAtHead(e,t,r,o):(0,i.isSome)(s)&&(0,i.isNone)(o)?this._insertAtEnd(e,t,r,s):(0,i.isSome)(s)&&(0,i.isSome)(o)?this._insertAtMiddle(e,t,r,s,o):void 0}_insertAtHead(e,t,r,s){const i=t+r;if(e===s.data.materialKey&&i===s.data.indexFrom)s.data.indexFrom=t,s.data.indexCount+=r;else{const i=new a(this._target,this.geometryType,e,t,r);this._head=new(0,n.List)(i),this._head.next=s}}_insertAtEnd(e,t,r,s){if(s.data.materialKey===e&&s.data.indexEnd===t)s.data.indexCount+=r;else{const i=new a(this._target,this.geometryType,e,t,r),o=new(0,n.List)(i);s.next=o}}_insertAtMiddle(e,t,r,s,i){const o=t+r;if(s.data.materialKey===e&&s.data.indexEnd===t)s.data.indexCount+=r,s.data.materialKey===i.data.materialKey&&s.data.indexEnd===i.data.indexFrom&&(s.data.indexCount+=i.data.indexCount,s.next=i.next);else if(e===i.data.materialKey&&o===i.data.indexFrom)i.data.indexFrom=t,i.data.indexCount+=r;else{const o=new a(this._target,this.geometryType,e,t,r),u=new(0,n.List)(o);s.next=u,u.next=i}}constructor(e,t){this.geometryType=0,this._target=e,this.geometryType=t}}})),t.register("h8K44",(function(r,s){e(r.exports,"List",(function(){return n})),e(r.exports,"FreeList",(function(){return a}));var i=t("1CpCt");class n{*values(){let e=this;for(;e;)yield e.data,e=e.next}forEach(e){let t=this;for(;t;)e(t.data),t=t.next}find(e){return e(this.data)?this:this.next?.find(e)}max(e,t=this){const r=e(this.data)>e(t.data)?this:t;return this.next?this.next.max(e,r):r}remove(e,t=null){return this===e?t?(t.next=this.next,t):this.next:this.next.remove(e,this)}get last(){return this.next?this.next.last:this}constructor(e){if(!Array.isArray(e))return void(this.data=e);this.data=e[0];let t=this;for(let r=1;r<e.length;r++)t.next=new n([e[r]]),t=t.next}}class a{get head(){return this._head}maxAvailableSpace(){if((0,i.isNone)(this._head))return 0;const e=this._head.max((e=>e.end-e.start));return e.data.end-e.data.start}firstFit(e){if((0,i.isNone)(this._head))return null;let t=null,r=this._head;for(;r;){const s=r.data.end-r.data.start;if(s===e)return t?t.next=r.next:this._head=r.next,r.data.start;if(s>e){const t=r.data.start;return r.data.start+=e,t}t=r,r=r.next}return null}free(e,t){const r=e+t;if((0,i.isNone)(this._head)){const t=new n({start:e,end:r});return void(this._head=t)}if(r<=this._head.data.start){if(r===this._head.data.start)return void(this._head.data.start-=t);const s=new n({start:e,end:r});return s.next=this._head,void(this._head=s)}let s=this._head,a=s.next;for(;a;){if(a.data.start>=r){if(s.data.end===e){if(s.data.end+=t,s.data.end===a.data.start){const e=a.data.end-a.data.start;return s.data.end+=e,void(s.next=a.next)}return}if(a.data.start===r)return void(a.data.start-=t);const i=new n({start:e,end:r});return i.next=s.next,void(s.next=i)}s=a,a=a.next}if(e===s.data.end)return void(s.data.end+=t);const o=new n({start:e,end:r});s.next=o}constructor(e){this._head=null,(0,i.isNone)(e)||(this._head=new n(e))}}})),t.register("hc9lx",(function(r,s){e(r.exports,"Buffer",(function(){return h}));var i=t("1CpCt"),n=t("jaeeT"),a=t("h8K44"),o=t("g0mVO"),u=t("l3QXd");class h{get elementSize(){return this._cpu.length/this.strideInt}get invalidated(){return this.bufferSize&&!this._gpu}get invalidatedComputeBuffer(){return this.bufferSize&&!this._gpuComputeTriangles}invalidate(){this._invalidateTriangleBuffer(),(0,i.applySome)(this._gpu,(e=>e.dispose())),this._gpu=null}_invalidateTriangleBuffer(){(0,i.applySome)(this._gpuComputeTriangles,(e=>e.dispose())),this._gpuComputeTriangles=null}destroy(){(0,i.applySome)(this._gpu,(e=>e.dispose())),(0,i.applySome)(this._gpuComputeTriangles,(e=>e.dispose())),(0,i.applySome)(this._cpu,(e=>e.destroy())),(0,i.applySome)(this._cpu2,(e=>e.destroy()))}clear(){this.dirty.start=1/0,this.dirty.end=0,this.freeList=new(0,a.FreeList)({start:0,end:this._cpu.length/this.strideInt}),this.fillPointer=0}ensure(e){if(!(this.maxAvailableSpace()>=e)&&e*this.strideInt>this._cpu.length-this.fillPointer){this.invalidate();const t=this._cpu.length/this.strideInt,r=Math.round(1.25*(t+e)),s=r*this.strideInt;this._cpu.expand(s*Uint32Array.BYTES_PER_ELEMENT),this.freeList.free(t,r-t)}}set(e,t){this._cpu.array[e]!==t&&(this._cpu.array[e]=t,this.dirty.start=Math.min(e,this.dirty.start),this.dirty.end=Math.max(e,this.dirty.end))}getGPUBuffer(e,t=!1){if(!this.bufferSize)return null;if(t){if("index"!==this.bufferType)throw new Error("Tired to get triangle buffer, but target is not an index buffer");return(0,i.isNone)(this._gpuComputeTriangles)&&(this._gpuComputeTriangles=this._createComputeBuffer(e)),this._gpuComputeTriangles}return(0,i.isNone)(this._gpu)&&(this._gpu=this._createBuffer(e)),this._gpu}getCPUBuffer(){if(!this._cpu2){const e=this._cpu.slice();this._cpu2=e}return this._cpu2.length!==this._cpu.length&&this._cpu2.expand(this._cpu.length*this._cpu.array.BYTES_PER_ELEMENT),this._cpu2.set(this._cpu),this._cpu2}get bufferSize(){return this._cpu.length/this.strideInt}maxAvailableSpace(){return this.freeList.maxAvailableSpace()}insert(e,t,r,s){const n=r*this.strideInt;if(!n)return 0;const a=t*this.strideInt*Uint32Array.BYTES_PER_ELEMENT,o=new Uint32Array(e,a,n),u=(0,i.unwrapOrThrow)(this.freeList.firstFit(r),"First fit region must be defined")*this.strideInt,h=n,f=u/this.strideInt-t;if(0!==s)for(let e=0;e<o.length;e++)o[e]+=s;return this._cpu.array.set(o,u),this.dirty.start=Math.min(this.dirty.start,u),this.dirty.end=Math.max(this.dirty.end,u+h),this.fillPointer=Math.max(this.fillPointer,u+h),f}free(e,t,r){const s=e*this.strideInt,i=(e+t)*this.strideInt;if(!0===r)for(let r=e;r!==e+t;r++)this._cpu.array[r*this.strideInt]=2147450879;this.dirty.start=Math.min(this.dirty.start,s),this.dirty.end=Math.max(this.dirty.end,i),this.freeList.free(e,t)}upload(){if(this.dirty.end){if(this._invalidateTriangleBuffer(),(0,i.isNone)(this._gpu))return this.dirty.start=1/0,void(this.dirty.end=0);this._gpu.setSubDataFromView(this._cpu.array,this.dirty.start,this.dirty.start,this.dirty.end),this.dirty.start=1/0,this.dirty.end=0}}_createBuffer(e){const t=u.Usage.DYNAMIC_DRAW;return"index"===this.bufferType?o.BufferObject.createIndex(e,t,this._cpu.array):o.BufferObject.createVertex(e,t,this._cpu.array)}_createComputeBuffer(e){const t=u.Usage.DYNAMIC_DRAW,r=new Uint32Array(this.fillPointer/3);for(let e=0;e<this.fillPointer;e+=3)r[e/3]=this._cpu.array[e];return o.BufferObject.createIndex(e,t,r)}constructor(e,t,r){const s=n.TypedBuffer.create(t*r*Uint32Array.BYTES_PER_ELEMENT);this.size=t,this.strideInt=r,this.bufferType=e,this.dirty={start:1/0,end:0},this._gpu=null,this._cpu=s,this.clear()}}})),t.register("jaeeT",(function(r,s){e(r.exports,"TypedBuffer",(function(){return u}));var i=t("5HTPH"),n=t("1CpCt"),a=t("h8K44");const o=(0,i.default)("esri-2d-log-allocations");class u{get array(){return this._array}get length(){return this._array.length}static create(e){const t=f.acquire(e);return new u(t)}expand(e){const t=f.acquire(e);t.set(this._array),f.release(this._array),this._array=t}destroy(){f.release(this._array)}set(e,t){this._array.set(e._array,t)}slice(){const e=f.acquire(this._array.byteLength);return e.set(this._array),new u(e)}constructor(e){this._array=e}}class h{static get BYTE_LENGTH(){return 64e6}get buffer(){return this._data}allocate(e){const t=this._freeList.firstFit(e);return(0,n.isNone)(t)?null:new Uint32Array(this._data,t,e/Uint32Array.BYTES_PER_ELEMENT)}free(e){this._freeList.free(e.byteOffset,e.byteLength)}constructor(){this._data=new ArrayBuffer(h.BYTE_LENGTH),this._freeList=new(0,a.FreeList)({start:0,end:this._data.byteLength})}}const f=new class{get _bytesTotal(){return this._pages.length*h.BYTE_LENGTH}acquire(e){if(this._bytesAllocated+=e,o&&console.log(`Allocating ${e}, (${this._bytesAllocated} / ${this._bytesTotal})`),e>h.BYTE_LENGTH)return new Uint32Array(e/Uint32Array.BYTES_PER_ELEMENT);for(const t of this._pages){const r=t.allocate(e);if((0,n.isSome)(r))return r}return(0,n.unwrapOrThrow)(this._addPage().allocate(e),"Expected to allocate page")}release(e){this._bytesAllocated-=e.byteLength,o&&console.log(`Freeing ${e.byteLength}, (${this._bytesAllocated} / ${this._bytesTotal})`);const t=this._pagesByBuffer.get(e.buffer);t&&t.free(e)}_addPage(){const e=new h;return this._pages.push(e),this._pagesByBuffer.set(e.buffer,e),e}constructor(){this._bytesAllocated=0,this._pages=[],this._pagesByBuffer=new Map,this._addPage()}}})),t.register("iuimx",(function(r,s){e(r.exports,"default",(function(){return h}));var i=t("j6uz9"),n=t("8Y9g8"),a=t("hTI69");t("aX9sh"),t("5HTPH"),t("gHCNy");var o=t("qA6zg");let u=class extends n.HandleOwner{destroy(){this.tiles.clear(),this.layer=this.layerView=this.tileInfoView=this.tiles=null}get updating(){return this.isUpdating()}acquireTile(e){const t=this.createTile(e);return t.once("isReady",(()=>this.notifyChange("updating"))),this.tiles.set(e.id,t),t}forceAttributeTextureUpload(){}forEachTile(e){this.tiles.forEach(e)}releaseTile(e){this.tiles.delete(e.key.id),this.disposeTile(e)}isUpdating(){let e=!0;return this.tiles.forEach((t=>{e=e&&t.isReady})),!e}setHighlight(){}invalidateLabels(){}requestUpdate(){this.layerView.requestUpdate()}constructor(e){super(e),this.tiles=new Map}};(0,i._)([(0,a.property)()],u.prototype,"layer",void 0),(0,i._)([(0,a.property)()],u.prototype,"layerView",void 0),(0,i._)([(0,a.property)()],u.prototype,"tileInfoView",void 0),(0,i._)([(0,a.property)()],u.prototype,"updating",null),u=(0,i._)([(0,o.subclass)("esri.views.2d.layers.features.tileRenderers.BaseTileRenderer")],u);const h=u})),t.register("7lvxD",(function(r,s){e(r.exports,"getVisualVariableSizeValueRepresentationRatio",(function(){return f})),e(r.exports,"convertVisualVariables",(function(){return p}));var i=t("1CpCt"),n=t("jCR4P"),a=t("9IkRH"),o=t("aPQ4T"),u=t("eyQUy"),h=t("jdyxA");function f(e,t){if(!e||!t)return e;switch(t){case"radius":case"distance":return 2*e;case"diameter":case"width":return e;case"area":return Math.sqrt(e)}return e}function l(e){return e.map((e=>function(e){return{value:e.value,size:(0,n.toPt)(e.size)}}(e)))}function d(e){if("string"==typeof e||"number"==typeof e)return(0,n.toPt)(e);const t=e;return{type:"size",expression:t.expression,stops:l(t.stops)}}const c=e=>{const t=[],r=[],s=l(e),i=s.length;for(let e=0;e<6;e++){const a=s[Math.min(e,i-1)];t.push(a.value),r.push(null==a.size?o.NAN_MAGIC_NUMBER:(0,n.pt2px)(a.size))}return{values:new Float32Array(t),sizes:new Float32Array(r)}};function p(e){const t=e&&e.length>0?{}:null,r=t?{}:null;if(!t)return{vvFields:t,vvRanges:r};for(const s of e)if(s.field&&(t[s.type]=s.field),"size"===s.type){r.size||(r.size={});const e=s;switch((0,h.getTypeOfSizeVisualVariable)(e)){case u.WGLVVFlag.SIZE_MINMAX_VALUE:r.size.minMaxValue={minDataValue:e.minDataValue,maxDataValue:e.maxDataValue,minSize:d(e.minSize),maxSize:d(e.maxSize)};break;case u.WGLVVFlag.SIZE_SCALE_STOPS:r.size.scaleStops={stops:l(e.stops)};break;case u.WGLVVFlag.SIZE_FIELD_STOPS:if(e.levels){const t={};for(const r in e.levels)t[r]=c(e.levels[r]);r.size.fieldStops={type:"level-dependent",levels:t}}else r.size.fieldStops={type:"static",...c(e.stops)};break;case u.WGLVVFlag.SIZE_UNIT_VALUE:r.size.unitValue={unit:e.valueUnit,valueRepresentation:e.valueRepresentation}}}else if("color"===s.type)r.color=y(s);else if("opacity"===s.type)r.opacity=_(s);else if("rotation"===s.type){const e=s;r.rotation={type:e.rotationType}}return{vvFields:t,vvRanges:r}}function _(e){const t={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if("string"==typeof e.field){if(!e.stops)return null;{if(e.stops.length>8)return null;const r=e.stops;for(let e=0;e<8;++e){const s=r[Math.min(e,r.length-1)];t.values[e]=s.value,t.opacities[e]=s.opacity}}}else{if(!(e.stops&&e.stops.length>=0))return null;{const r=e.stops&&e.stops.length>=0&&e.stops[0].opacity;for(let e=0;e<8;e++)t.values[e]=1/0,t.opacities[e]=r}}return t}function x(e,t,r){e[4*t+0]=r.r/255,e[4*t+1]=r.g/255,e[4*t+2]=r.b/255,e[4*t+3]=r.a}function y(e){if((0,i.isNone)(e))return null;if(e.normalizationField)return null;const t={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};if("string"==typeof e.field){if(!e.stops)return null;{if(e.stops.length>8)return null;t.field=e.field;const r=e.stops;for(let e=0;e<8;++e){const s=r[Math.min(e,r.length-1)];t.values[e]=s.value,x(t.colors,e,s.color)}}}else{if(!(e.stops&&e.stops.length>=0))return null;{const r=e.stops&&e.stops.length>=0&&e.stops[0].color;for(let e=0;e<8;e++)t.values[e]=1/0,x(t.colors,e,r)}}for(let e=0;e<32;e+=4)(0,a.premultiplyAlpha)(t.colors,e,!0);return t}})),t.register("9C7Je",(function(r,s){e(r.exports,"WGLFeatureView",(function(){return f}));var i=t("5HTPH"),n=t("lHg4e"),a=t("4ZNdX"),o=t("faj3Z"),u=t("eyQUy");const h=(0,i.default)("featurelayer-order-by-server-enabled");class f extends o.FeatureContainer{renderChildren(e){this.attributeView.update(),this.hasAnimation&&e.painter.effects.integrate.draw(e,e.attributeView),super.renderChildren(e)}hasEmptyAttributeView(){return this.attributeView.isEmpty()}isUpdating(){return this.attributeView.isUpdating()}hitTest(e){const t=(0,n.createResolver)();return this._pointToCallbacks.push({point:e,resolver:t}),this.requestRender(),t.promise}onTileData(e,t){const r=h&&"orderBy"in this._layer&&this._layer.orderBy,s=r?.length&&!r[0].valueExpression&&r[0].field,i=r&&this._layerView.orderByFields===s;e.patch(t,i),this.contains(e)||this.addChild(e),this.requestRender()}onTileError(e){this.contains(e)||this.addChild(e)}updateTransitionProperties(e,t){super.updateTransitionProperties(e,t),this._layerView.featureEffectView.transitionStep(e,t),this._layerView.featureEffectView.transitioning&&this.requestRender()}doRender(e){const{minScale:t,maxScale:r}=this._layer,s=e.state.scale;s<=(t||1/0)&&s>=r&&super.doRender(e)}onAttributeStoreUpdate(){this.hasLabels&&this._layerView.view.labelManager.requestUpdate(),this._onUpdate()}get hasAnimation(){return this.hasLabels}setStencilReference(e){const{rendererSchema:t}=e.rendererInfo;if("dot-density"===t.type&&t.dotSize>1){const e=1;for(const t of this.children)t.stencilRef=t.key.level+e}else super.setStencilReference(e)}get hasLabels(){if("sublayers"in this._layer)return this._layer.sublayers.some((e=>e.labelingInfo&&e.labelingInfo.length&&e.labelsVisible));const e=this._layer.featureReduction,t=e&&"labelingInfo"in e&&e.labelsVisible&&e.labelingInfo&&e.labelingInfo.length;return this._layer.labelingInfo&&this._layer.labelingInfo.length&&this._layer.labelsVisible||!!t}prepareRenderPasses(e){const t=e.registerRenderPass({name:"label",brushes:[a.brushes.label],target:()=>this.hasLabels?this.children:null,drawPhase:u.WGLDrawPhase.LABEL|u.WGLDrawPhase.LABEL_ALPHA}),r=e.registerRenderPass({name:"geometry",brushes:[a.brushes.fill,a.brushes.dotDensity,a.brushes.line,a.brushes.marker,a.brushes.heatmap,a.brushes.pieChart,a.brushes.text],target:()=>this.children,enableDefaultDraw:()=>!this._layerView.featureEffectView.hasEffects,effects:[{apply:e.effects.outsideEffect,enable:()=>this._layerView.featureEffectView.hasEffects,args:()=>this._layerView.featureEffectView.excludedEffects},{apply:e.effects.insideEffect,enable:()=>this._layerView.featureEffectView.hasEffects,args:()=>this._layerView.featureEffectView.includedEffects},{apply:e.effects.hittest,enable:()=>!!this._pointToCallbacks.length,args:()=>this._pointToCallbacks}]}),s=e.registerRenderPass({name:"highlight",brushes:[a.brushes.fill,a.brushes.dotDensity,a.brushes.line,a.brushes.marker,a.brushes.pieChart,a.brushes.text],target:()=>this.children,drawPhase:u.WGLDrawPhase.HIGHLIGHT,enableDefaultDraw:()=>!1,effects:[{apply:e.effects.highlight,enable:()=>!!this._layerView.hasHighlight()}]});return[...super.prepareRenderPasses(e),r,s,t]}constructor(e,t,r,s){super(e),this._pointToCallbacks=[],this._layer=r,this._layerView=t,this._onUpdate=s}}})),t.register("jocF1",(function(t,r){e(t.exports,"DISPLAY_ID_TEXEL_MASK",(function(){return s})),e(t.exports,"DISPLAY_ID_TYPE_FEATURE",(function(){return n})),e(t.exports,"DISPLAY_ID_TYPE_AGGREGATE",(function(){return a})),e(t.exports,"getDisplayIdType",(function(){return o})),e(t.exports,"getDisplayIdTexel",(function(){return u})),e(t.exports,"getDisplayIdFilterMask",(function(){return h})),e(t.exports,"isAggregateId",(function(){return f})),e(t.exports,"createDisplayId",(function(){return l}));const s=8388607,i=8388608,n=0,a=1,o=e=>(e&i)>>>23,u=e=>e&s,h=e=>o(e)===a?254:255;function f(e){return o(e)===a}function l(e,t){return((t?i:0)|e)>>>0}})),t.register("4lnuk",(function(t,r){e(t.exports,"createDebugLogger",(function(){return s})),e(t.exports,"DEBUG_ATTR_UPDATES",(function(){return i}));const s=(e,t)=>e&&((...e)=>t.warn("DEBUG:",...e))||(()=>null),i=!1})),t.register("c4cvq",(function(t,r){e(t.exports,"radToByte",(function(){return o})),e(t.exports,"degToByte",(function(){return u})),e(t.exports,"log2",(function(){return h})),e(t.exports,"between",(function(){return f}));Number.POSITIVE_INFINITY;const s=Math.PI,i=128/s,n=1/Math.LN2;function a(e,t){return(e%=t)>=0?e:e+t}function o(e){return a(e*i,256)}function u(e){return a(.7111111111111111*e,256)}function h(e){return Math.log(e)*n}function f(e,t,r){return e>=t&&e<=r||e>=r&&e<=t}})),t.register("3Icya",(function(t,r){e(t.exports,"e",(function(){return a}));var s,i,n={exports:{}};s=n,void 0!==(i=function(){function e(e,r,i){i=i||2;var n,a,o,h,f,l,d,c=r&&r.length,p=c?r[0]*i:e.length,_=t(e,0,p,i,!0),x=[];if(!_||_.next===_.prev)return x;if(c&&(_=u(e,r,_,i)),e.length>80*i){n=o=e[0],a=h=e[1];for(var y=i;y<p;y+=i)(f=e[y])<n&&(n=f),(l=e[y+1])<a&&(a=l),f>o&&(o=f),l>h&&(h=l);d=0!==(d=Math.max(o-n,h-a))?1/d:0}return s(_,x,i,n,a,d),x}function t(e,t,r,s,i){var n,a;if(i===L(e,t,r,s)>0)for(n=t;n<r;n+=s)a=S(n,e[n],e[n+1],a);else for(n=r-s;n>=t;n-=s)a=S(n,e[n],e[n+1],a);if(a&&v(a,a.next)){var o=a.next;C(a),a=o}return a}function r(e,t){if(!e)return e;t||(t=e);var r,s=e;do{if(r=!1,s.steiner||!v(s,s.next)&&0!==g(s.prev,s,s.next))s=s.next;else{var i=s.prev;if(C(s),(s=t=i)===s.next)break;r=!0}}while(r||s!==t);return t}function s(e,t,u,h,f,l,d){if(e){!d&&l&&c(e,h,f,l);for(var p,_,x=e;e.prev!==e.next;)if(p=e.prev,_=e.next,l?n(e,h,f,l):i(e))t.push(p.i/u),t.push(e.i/u),t.push(_.i/u),C(e),e=_.next,x=_.next;else if((e=_)===x){d?1===d?s(e=a(r(e),t,u),t,u,h,f,l,2):2===d&&o(e,t,u,h,f,l):s(r(e),t,u,h,f,l,1);break}}}function i(e){var t=e.prev,r=e,s=e.next;if(g(t,r,s)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(x(t.x,t.y,r.x,r.y,s.x,s.y,i.x,i.y)&&g(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function n(e,t,r,s){var i=e.prev,n=e,a=e.next;if(g(i,n,a)>=0)return!1;for(var o=i.x<n.x?i.x<a.x?i.x:a.x:n.x<a.x?n.x:a.x,u=i.y<n.y?i.y<a.y?i.y:a.y:n.y<a.y?n.y:a.y,h=i.x>n.x?i.x>a.x?i.x:a.x:n.x>a.x?n.x:a.x,f=i.y>n.y?i.y>a.y?i.y:a.y:n.y>a.y?n.y:a.y,l=p(o,u,t,r,s),d=p(h,f,t,r,s),c=e.prevZ,_=e.nextZ;c&&c.z>=l&&_&&_.z<=d;){if(c!==e.prev&&c!==e.next&&x(i.x,i.y,n.x,n.y,a.x,a.y,c.x,c.y)&&g(c.prev,c,c.next)>=0)return!1;if(c=c.prevZ,_!==e.prev&&_!==e.next&&x(i.x,i.y,n.x,n.y,a.x,a.y,_.x,_.y)&&g(_.prev,_,_.next)>=0)return!1;_=_.nextZ}for(;c&&c.z>=l;){if(c!==e.prev&&c!==e.next&&x(i.x,i.y,n.x,n.y,a.x,a.y,c.x,c.y)&&g(c.prev,c,c.next)>=0)return!1;c=c.prevZ}for(;_&&_.z<=d;){if(_!==e.prev&&_!==e.next&&x(i.x,i.y,n.x,n.y,a.x,a.y,_.x,_.y)&&g(_.prev,_,_.next)>=0)return!1;_=_.nextZ}return!0}function a(e,t,s){var i=e;do{var n=i.prev,a=i.next.next;!v(n,a)&&m(n,i,i.next,a)&&T(n,a)&&T(a,n)&&(t.push(n.i/s),t.push(i.i/s),t.push(a.i/s),C(i),C(i.next),i=e=a),i=i.next}while(i!==e);return r(i)}function o(e,t,i,n,a,o){var u=e;do{for(var h=u.next.next;h!==u.prev;){if(u.i!==h.i&&y(u,h)){var f=E(u,h);return u=r(u,u.next),f=r(f,f.next),s(u,t,i,n,a,o),void s(f,t,i,n,a,o)}h=h.next}u=u.next}while(u!==e)}function u(e,s,i,n){var a,o,u,f=[];for(a=0,o=s.length;a<o;a++)(u=t(e,s[a]*n,a<o-1?s[a+1]*n:e.length,n,!1))===u.next&&(u.steiner=!0),f.push(_(u));for(f.sort(h),a=0;a<f.length;a++)i=r(i=l(f[a],i),i.next);return i}function h(e,t){return e.x-t.x}function f(e){if(e.next.prev===e)return e;let t=e;for(;;){const r=t.next;if(r.prev===t||r===t||r===e)break;t=r}return t}function l(e,t){var s=function(e,t){var r,s=t,i=e.x,n=e.y,a=-1/0;do{if(n<=s.y&&n>=s.next.y&&s.next.y!==s.y){var o=s.x+(n-s.y)*(s.next.x-s.x)/(s.next.y-s.y);if(o<=i&&o>a){if(a=o,o===i){if(n===s.y)return s;if(n===s.next.y)return s.next}r=s.x<s.next.x?s:s.next}}s=s.next}while(s!==t);if(!r)return null;if(i===a)return r;var u,h=r,f=r.x,l=r.y,c=1/0;s=r;do{i>=s.x&&s.x>=f&&i!==s.x&&x(n<l?i:a,n,f,l,n<l?a:i,n,s.x,s.y)&&(u=Math.abs(n-s.y)/(i-s.x),T(s,e)&&(u<c||u===c&&(s.x>r.x||s.x===r.x&&d(r,s)))&&(r=s,c=u)),s=s.next}while(s!==h);return r}(e,t);if(!s)return t;var i=E(s,e),n=r(s,s.next);let a=f(i);return r(a,a.next),n=f(n),f(t===s?n:t)}function d(e,t){return g(e.prev,e,t.prev)<0&&g(t.next,e,e.next)<0}function c(e,t,r,s){var i=e;do{null===i.z&&(i.z=p(i.x,i.y,t,r,s)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,r,s,i,n,a,o,u,h=1;do{for(r=e,e=null,n=null,a=0;r;){for(a++,s=r,o=0,t=0;t<h&&(o++,s=s.nextZ);t++);for(u=h;o>0||u>0&&s;)0!==o&&(0===u||!s||r.z<=s.z)?(i=r,r=r.nextZ,o--):(i=s,s=s.nextZ,u--),n?n.nextZ=i:e=i,i.prevZ=n,n=i;r=s}n.nextZ=null,h*=2}while(a>1)}(i)}function p(e,t,r,s,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-s)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function _(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function x(e,t,r,s,i,n,a,o){return(i-a)*(t-o)-(e-a)*(n-o)>=0&&(e-a)*(s-o)-(r-a)*(t-o)>=0&&(r-a)*(n-o)-(i-a)*(s-o)>=0}function y(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&m(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&(T(e,t)&&T(t,e)&&function(e,t){var r=e,s=!1,i=(e.x+t.x)/2,n=(e.y+t.y)/2;do{r.y>n!=r.next.y>n&&r.next.y!==r.y&&i<(r.next.x-r.x)*(n-r.y)/(r.next.y-r.y)+r.x&&(s=!s),r=r.next}while(r!==e);return s}(e,t)&&(g(e.prev,e,t.prev)||g(e,t.prev,t))||v(e,t)&&g(e.prev,e,e.next)>0&&g(t.prev,t,t.next)>0)}function g(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function v(e,t){return e.x===t.x&&e.y===t.y}function m(e,t,r,s){var i=w(g(e,t,r)),n=w(g(e,t,s)),a=w(g(r,s,e)),o=w(g(r,s,t));return i!==n&&a!==o||!(0!==i||!b(e,r,t))||!(0!==n||!b(e,s,t))||!(0!==a||!b(r,e,s))||!(0!==o||!b(r,t,s))}function b(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function w(e){return e>0?1:e<0?-1:0}function T(e,t){return g(e.prev,e,e.next)<0?g(e,t,e.next)>=0&&g(e,e.prev,t)>=0:g(e,t,e.prev)<0||g(e,e.next,t)<0}function E(e,t){var r=new V(e.i,e.x,e.y),s=new V(t.i,t.x,t.y),i=e.next,n=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,s.next=r,r.prev=s,n.next=s,s.prev=n,s}function S(e,t,r,s){var i=new V(e,t,r);return s?(i.next=s.next,i.prev=s,s.next.prev=i,s.next=i):(i.prev=i,i.next=i),i}function C(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function V(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function L(e,t,r,s){for(var i=0,n=t,a=r-s;n<r;n+=s)i+=(e[a]-e[n])*(e[n+1]+e[a+1]),a=n;return i}return e.deviation=function(e,t,r,s){var i=t&&t.length,n=i?t[0]*r:e.length,a=Math.abs(L(e,0,n,r));if(i)for(var o=0,u=t.length;o<u;o++){var h=t[o]*r,f=o<u-1?t[o+1]*r:e.length;a-=Math.abs(L(e,h,f,r))}var l=0;for(o=0;o<s.length;o+=3){var d=s[o]*r,c=s[o+1]*r,p=s[o+2]*r;l+=Math.abs((e[d]-e[p])*(e[c+1]-e[d+1])-(e[d]-e[c])*(e[p+1]-e[d+1]))}return 0===a&&0===l?0:Math.abs((l-a)/a)},e.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},s=0,i=0;i<e.length;i++){for(var n=0;n<e[i].length;n++)for(var a=0;a<t;a++)r.vertices.push(e[i][n][a]);i>0&&(s+=e[i-1].length,r.holes.push(s))}return r},e}())&&(s.exports=i);const a=n.exports})),t.register("iqtPh",(function(t,r){e(t.exports,"DECLUTTER_TILES",(function(){return s})),e(t.exports,"COLLISION_GRID_CELL_SIZE",(function(){return i})),e(t.exports,"DECLUTTER_BUDGET",(function(){return n})),e(t.exports,"FADE_DURATION",(function(){return a}));const s=!0,i=32,n=1.5,a=200})),t.register("033AK",(function(r,s){e(r.exports,"TiledDisplayObject",(function(){return o}));var i=t("52822"),n=t("5aS5k"),a=t("fdGvv");class o extends n.DisplayObject{destroy(){this.texture&&(this.texture.dispose(),this.texture=null)}setTransform(e,t){const r=t/(e.resolution*e.pixelRatio),s=this.transforms.tileMat3,[n,a]=e.toScreenNoRotation([0,0],[this.x,this.y]),o=this.width/this.rangeX*r,u=this.height/this.rangeY*r;(0,i.s)(s,o,0,0,0,u,0,n,a,1),(0,i.m)(this.transforms.dvs,e.displayViewMat3,s)}constructor(e,t,r,s,i,n=s,o=i){super(),this.triangleCountReportedInDebug=0,this.triangleCount=0,this.texture=null,this.key=new(0,a.default)(e),this.x=t,this.y=r,this.width=s,this.height=i,this.rangeX=n,this.rangeY=o}}})),t.register("htRPC",(function(r,s){e(r.exports,"default",(function(){return f}));var i=t("5HTPH"),n=t("eyQUy"),a=t("eqJSJ"),o=t("c48sV"),u=t("bVXM2");const h=(e,t)=>e.key.level-t.key.level!=0?e.key.level-t.key.level:e.key.row-t.key.row!=0?e.key.row-t.key.row:e.key.col-t.key.col;class f extends a.default{get requiresDedicatedFBO(){return!1}renderChildren(e){this.sortChildren(h),this.setStencilReference(e),super.renderChildren(e)}createRenderParams(e){const{state:t}=e,r=super.createRenderParams(e);return r.requiredLevel=this._tileInfoView.getClosestInfoForScale(t.scale).level,r.displayLevel=this._tileInfoView.tileInfo.scaleToZoom(t.scale),r}prepareRenderPasses(e){const t=super.prepareRenderPasses(e);return t.push(e.registerRenderPass({name:"stencil",brushes:[u.default],drawPhase:n.WGLDrawPhase.DEBUG|n.WGLDrawPhase.MAP|n.WGLDrawPhase.HIGHLIGHT,target:()=>this.getStencilTarget()})),(0,i.default)("esri-tiles-debug")&&t.push(e.registerRenderPass({name:"tileInfo",brushes:[o.default],drawPhase:n.WGLDrawPhase.DEBUG,target:()=>this.children})),t}getStencilTarget(){return this.children}updateTransforms(e){for(const t of this.children){const r=this._tileInfoView.getTileResolution(t.key);t.setTransform(e,r)}}setStencilReference(e){let t=1;for(const e of this.children)e.stencilRef=t++}constructor(e){super(),this._tileInfoView=e}}}));
//# sourceMappingURL=SymbolTileRenderer.cee69f83.js.map
