!function(){function e(e){return e&&e.__esModule?e.default:e}function t(e,t,r,n){Object.defineProperty(e,t,{get:r,set:n,enumerable:!0,configurable:!0})}var r=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire594f;r.register("j6c7r",(function(n,a){t(n.exports,"encodeGeometry",(function(){return S})),t(n.exports,"queryToQueryStringParameters",(function(){return x})),t(n.exports,"executeQuery",(function(){return g})),t(n.exports,"runQuery",(function(){return P})),t(n.exports,"executeQueryPBF",(function(){return E})),t(n.exports,"executeQueryPBFBuffer",(function(){return F})),t(n.exports,"executeQueryForIds",(function(){return R})),t(n.exports,"executeQueryForCount",(function(){return v})),t(n.exports,"executeQueryForExtent",(function(){return j}));var i=r("8TSCy"),o=r("2TvXO"),u=r("9pNSx"),s=r("7qybv"),l=r("kYueh"),c=r("79LpT"),f=r("5On35"),y=r("bPDFo"),d=r("6JnOG"),p=r("4JATB"),m="Layer does not support extent calculation.";function S(e,t){if(t&&"extent"===e.type)return"".concat(e.xmin,",").concat(e.ymin,",").concat(e.xmax,",").concat(e.ymax);if(t&&"point"===e.type)return"".concat(e.x,",").concat(e.y);var r=e.toJSON();return delete r.spatialReference,JSON.stringify(r)}function x(e,t){var r=e.geometry,n=e.toJSON();delete n.compactGeometryEnabled,delete n.defaultSpatialReferenceEnabled;var a,i,o=n,u=e.outSpatialReference;if((0,s.isSome)(r)&&(a=r.spatialReference,i=r.spatialReference.wkid||JSON.stringify(r.spatialReference),o.geometryType=(0,c.getJsonType)(r),o.geometry=S(r,e.compactGeometryEnabled),o.inSR=i),n.groupByFieldsForStatistics&&(o.groupByFieldsForStatistics=n.groupByFieldsForStatistics.join(",")),n.objectIds&&(o.objectIds=n.objectIds.join(",")),n.orderByFields&&(o.orderByFields=n.orderByFields.join(",")),!n.outFields||!n.returnDistinctValues&&(null!=t&&t.returnCountOnly||null!=t&&t.returnExtentOnly||null!=t&&t.returnIdsOnly)?delete o.outFields:-1!==n.outFields.indexOf("*")?o.outFields="*":o.outFields=n.outFields.join(","),n.outSR?o.outSR=n.outSR.wkid||JSON.stringify(n.outSR):r&&(n.returnGeometry||n.returnCentroid)&&(o.outSR=o.inSR),n.returnGeometry&&delete n.returnGeometry,n.outStatistics&&(o.outStatistics=JSON.stringify(n.outStatistics)),n.pixelSize&&(o.pixelSize=JSON.stringify(n.pixelSize)),n.quantizationParameters&&(e.defaultSpatialReferenceEnabled&&(0,s.isSome)(a)&&(0,s.isSome)(e.quantizationParameters)&&(0,s.isSome)(e.quantizationParameters.extent)&&a.equals(e.quantizationParameters.extent.spatialReference)&&delete n.quantizationParameters.extent.spatialReference,o.quantizationParameters=JSON.stringify(n.quantizationParameters)),n.parameterValues&&(o.parameterValues=JSON.stringify(n.parameterValues)),n.rangeValues&&(o.rangeValues=JSON.stringify(n.rangeValues)),n.dynamicDataSource&&(o.layer=JSON.stringify({source:n.dynamicDataSource}),delete n.dynamicDataSource),n.timeExtent){var l=n.timeExtent,f=l.start,y=l.end;null==f&&null==y||(o.time=f===y?f:"".concat(null==f?"null":f,",").concat(null==y?"null":y)),delete n.timeExtent}return e.defaultSpatialReferenceEnabled&&(0,s.isSome)(a)&&(0,s.isSome)(u)&&a.equals(u)&&(o.defaultSR=o.inSR,delete o.inSR,delete o.outSR),o}function g(e,t,r,n){return b.apply(this,arguments)}function b(){return(b=i.asyncToGenerator(e(o).mark((function t(r,n,a,i){var u;return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,s.isSome)(n.timeExtent)||!n.timeExtent.isEmpty){e.next=4;break}e.t0={data:{features:[]}},e.next=7;break;case 4:return e.next=6,P(r,n,"json",i);case 6:e.t0=e.sent;case 7:return u=e.t0,e.abrupt("return",((0,p.applyFeatureSetZUnitScaling)(n,a,u.data),u));case 9:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function E(e,t,r,n){return O.apply(this,arguments)}function O(){return(O=i.asyncToGenerator(e(o).mark((function t(r,n,a,i){var u,l;return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,s.isSome)(n.timeExtent)||!n.timeExtent.isEmpty){e.next=2;break}return e.abrupt("return",Promise.resolve({data:a.createFeatureResult()}));case 2:return e.next=4,F(r,n,i);case 4:return u=e.sent,l=u,e.abrupt("return",(l.data=(0,d.parsePBFFeatureQuery)(u.data,a),l));case 7:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function F(e,t,r){return P(e,t,"pbf",r)}function R(e,t,r){return(0,s.isSome)(t.timeExtent)&&t.timeExtent.isEmpty?Promise.resolve({data:{objectIds:[]}}):P(e,t,"json",r,{returnIdsOnly:!0})}function v(e,t,r){return(0,s.isSome)(t.timeExtent)&&t.timeExtent.isEmpty?Promise.resolve({data:{count:0}}):P(e,t,"json",r,{returnIdsOnly:!0,returnCountOnly:!0})}function j(e,t,r){return(0,s.isSome)(t.timeExtent)&&t.timeExtent.isEmpty?Promise.resolve({data:{count:0,extent:null}}):P(e,t,"json",r,{returnExtentOnly:!0,returnCountOnly:!0}).then((function(e){var t=e.data;if(t.hasOwnProperty("extent"))return e;if(t.features)throw new Error(m);if(t.hasOwnProperty("count"))throw new Error(m);return e}))}function P(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o="string"==typeof e?(0,l.urlToObject)(e):e,c=t.geometry?[t.geometry]:[];return n.responseType="pbf"===r?"array-buffer":"json",(0,f.normalizeCentralMeridian)(c,null,n).then((function(e){var c=e&&e[0];(0,s.isSome)(c)&&((t=t.clone()).geometry=c);var f=(0,y.mapParameters)(i.objectSpread({},o.query,{f:r},a,x(t,a)));return(0,u.default)((0,l.join)(o.path,"query"),i.objectSpread({},n,{query:i.objectSpread({},f,n.query)}))}))}}))}();
//# sourceMappingURL=query.03a6449f.js.map
