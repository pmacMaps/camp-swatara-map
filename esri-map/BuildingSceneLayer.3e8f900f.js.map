{"mappings":"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","sources":["node_modules/@arcgis/core/layers/support/capabilities.js","node_modules/@arcgis/core/layers/support/FetchAssociatedFeatureLayer.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nconst t={attachment:{supportsContentType:!1,supportsExifInfo:!1,supportsKeywords:!1,supportsName:!1,supportsSize:!1},data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:!1},editing:{supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsGeometryUpdate:!1,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:!1,supportsDelete:!1,supportsEditing:!1,supportsChangeTracking:!1,supportsQuery:!1,supportsQueryAttachments:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:!1,supportsExceedsLimitStatistics:!1},queryRelated:{supportsCount:!1,supportsOrderBy:!1,supportsPagination:!1},query:{maxRecordCount:0,maxRecordCountFactor:0,standardMaxRecordCount:0,supportsCacheHint:!1,supportsCentroid:!1,supportsCompactGeometry:!1,supportsDefaultSpatialReference:!1,supportsDisjointSpatialRelationship:!1,supportsDistance:!1,supportsDistinct:!1,supportsExtent:!1,supportsFormatPBF:!1,supportsGeometryProperties:!1,supportsHavingClause:!1,supportsHistoricMoment:!1,supportsMaxRecordCountFactor:!1,supportsOrderBy:!1,supportsPagination:!1,supportsPercentileStatistics:!1,supportsQuantization:!1,supportsQuantizationEditMode:!1,supportsQueryByOthers:!1,supportsQueryGeometry:!1,supportsResultType:!1,supportsSqlExpression:!1,supportsStandardizedQueriesOnly:!1,supportsTopFeaturesQuery:!1,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsStatistics:!1,tileMaxRecordCount:0}};export{t as zeroCapabilities};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{id as t}from\"../../kernel.js\";import r from\"../../request.js\";import{isNone as e,isSome as a}from\"../../core/maybe.js\";import{throwIfAbortError as i}from\"../../core/promiseUtils.js\";import s from\"../FeatureLayer.js\";import n from\"../../portal/Portal.js\";import o from\"../../portal/PortalItem.js\";class l{constructor(t,r,e,a){this.parsedUrl=t,this.portalItem=r,this.apiKey=e,this.signal=a,this.rootDocument=null;const i=this.parsedUrl.path.match(/^(.*)\\/SceneServer\\/layers\\/([\\d]*)\\/?$/i);i&&(this.urlParts={root:i[1],layerId:parseInt(i[2],10)})}async fetch(){var t;if(!this.urlParts)return null;const r=null!=(t=this.portalItem)?t:await this._portalItemFromServiceItemId();if(e(r))return this._loadFromUrl();const a=await this._findAndLoadRelatedPortalItem(r);return e(a)?null:this._loadFeatureLayerFromPortalItem(a)}async fetchPortalItem(){var t;if(!this.urlParts)return null;const r=null!=(t=this.portalItem)?t:await this._portalItemFromServiceItemId();return e(r)?null:this._findAndLoadRelatedPortalItem(r)}async _fetchRootDocument(){if(a(this.rootDocument))return this.rootDocument;if(e(this.urlParts))return this.rootDocument={},{};const t={query:{f:\"json\",token:this.apiKey},responseType:\"json\",signal:this.signal},i=`${this.urlParts.root}/SceneServer`;try{const e=await r(i,t);this.rootDocument=e.data}catch{this.rootDocument={}}return this.rootDocument}async _fetchServiceOwningPortalUrl(){var e;const a=null==(e=t)?void 0:e.findServerInfo(this.parsedUrl.path);if(null!=a&&a.owningSystemUrl)return a.owningSystemUrl;const s=this.parsedUrl.path.replace(/(.*\\/rest)\\/.*/i,\"$1\")+\"/info\";try{const t=(await r(s,{query:{f:\"json\"},responseType:\"json\",signal:this.signal})).data.owningSystemUrl;if(t)return t}catch(n){i(n)}return null}async _findAndLoadRelatedPortalItem(t){try{return(await t.fetchRelatedItems({relationshipType:\"Service2Service\",direction:\"reverse\"},{signal:this.signal})).find((t=>\"Feature Service\"===t.type))||null}catch(r){return i(r),null}}async _loadFeatureLayerFromPortalItem(t){await t.load({signal:this.signal});const r=await this._findMatchingAssociatedSublayerUrl(t.url);return new s({url:r,portalItem:t}).load({signal:this.signal})}async _loadFromUrl(){const t=await this._findMatchingAssociatedSublayerUrl(`${this.urlParts.root}/FeatureServer`);return new s({url:t}).load({signal:this.signal})}async _findMatchingAssociatedSublayerUrl(t){const e=t.replace(/^(.*FeatureServer)(\\/[\\d]*\\/?)?$/i,\"$1\"),a={query:{f:\"json\"},responseType:\"json\",authMode:\"no-prompt\",signal:this.signal},i=this.urlParts.layerId,s=this._fetchRootDocument(),n=r(e,a),[o,l]=await Promise.all([n,s]),c=l&&l.layers,h=o.data&&o.data.layers;if(!Array.isArray(h))throw new Error(\"expected layers array\");if(Array.isArray(c))for(let r=0;r<Math.min(c.length,h.length);r++){if(c[r].id===i)return`${e}/${h[r].id}`}else if(i<h.length)return`${e}/${h[i].id}`;throw new Error(\"could not find matching associated sublayer\")}async _portalItemFromServiceItemId(){const t=(await this._fetchRootDocument()).serviceItemId;if(!t)return null;const r=new o({id:t,apiKey:this.apiKey}),e=await this._fetchServiceOwningPortalUrl();a(e)&&(r.portal=new n({url:e}));try{return r.load({signal:this.signal})}catch(s){return i(s),null}}}export{l as FetchAssociatedFeatureLayer};\n"],"names":["$ffc852515e584065$export$73da638de15a4d78","attachment","supportsContentType","supportsExifInfo","supportsKeywords","supportsName","supportsSize","data","isVersioned","supportsAttachment","supportsM","supportsZ","editing","supportsDeleteByAnonymous","supportsDeleteByOthers","supportsGeometryUpdate","supportsGlobalId","supportsReturnServiceEditsInSourceSpatialReference","supportsRollbackOnFailure","supportsUpdateByAnonymous","supportsUpdateByOthers","supportsUpdateWithoutM","supportsUploadWithItemId","metadata","supportsAdvancedFieldProperties","operations","supportsCalculate","supportsTruncate","supportsValidateSql","supportsAdd","supportsDelete","supportsEditing","supportsChangeTracking","supportsQuery","supportsQueryAttachments","supportsResizeAttachments","supportsSync","supportsUpdate","supportsExceedsLimitStatistics","queryRelated","supportsCount","supportsOrderBy","supportsPagination","query","maxRecordCount","maxRecordCountFactor","standardMaxRecordCount","supportsCacheHint","supportsCentroid","supportsCompactGeometry","supportsDefaultSpatialReference","supportsDisjointSpatialRelationship","supportsDistance","supportsDistinct","supportsExtent","supportsFormatPBF","supportsGeometryProperties","supportsHavingClause","supportsHistoricMoment","supportsMaxRecordCountFactor","supportsPercentileStatistics","supportsQuantization","supportsQuantizationEditMode","supportsQueryByOthers","supportsQueryGeometry","supportsResultType","supportsSqlExpression","supportsStandardizedQueriesOnly","supportsTopFeaturesQuery","supportsSpatialAggregationStatistics","supportedSpatialAggregationStatistics","envelope","centroid","convexHull","supportsStatistics","tileMaxRecordCount","$8TSCy","parcelRequire","$7d4688677bb88def$export$a0231f2d739c1fc3","t1","r1","e1","a1","this","parsedUrl","portalItem","apiKey","signal","rootDocument","i1","path","match","urlParts","root","layerId","parseInt","key","asyncToGenerator","$parcel$interopDefault","$2TvXO","mark","_callee","t2","r2","a2","_this","_portalItemFromServiceItemId","_ctx","t0","$7qybv","isNone","_loadFromUrl","_findAndLoadRelatedPortalItem","sent","_loadFeatureLayerFromPortalItem","t3","r3","t4","i2","e2","isSome","f","token","responseType","concat","$9pNSx","default","e3","a3","s1","t5","$dLARP","id","findServerInfo","owningSystemUrl","replace","$10vEZ","throwIfAbortError","t6","fetchRelatedItems","relationshipType","direction","find","t7","type","t8","r4","load","_findMatchingAssociatedSublayerUrl","url","$g15Jq","t9","t10","e4","a4","i3","s2","n1","ref","o1","l2","c","h","r5","authMode","_fetchRootDocument","Promise","all","slicedToArray","call","layers","Array","isArray","Error","Math","min","length","t11","r6","e5","serviceItemId","$iYaGG","_fetchServiceOwningPortalUrl","portal","$ajJOT"],"version":3,"file":"BuildingSceneLayer.3e8f900f.js.map"}