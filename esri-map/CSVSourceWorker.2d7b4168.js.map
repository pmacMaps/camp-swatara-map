{"mappings":"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","sources":["node_modules/@arcgis/core/layers/graphics/data/QueryEngine.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{PositionHint as e,indexOf as t}from\"../../../core/arrayUtils.js\";import i from\"../../../core/Error.js\";import{clone as s}from\"../../../core/lang.js\";import{removeMaybe as r,destroyMaybe as a,isNone as n,isSome as o}from\"../../../core/maybe.js\";import{MemCacheStorage as u,MemCache as c}from\"../../../core/MemCache.js\";import{getMetersPerUnitForSR as h}from\"../../../core/unitUtils.js\";import{create as l,set as m,NEGATIVE_INFINITY as p,expandWithAABB as f}from\"../../../geometry/support/aaBoundingBox.js\";import{fromValues as d,create as y}from\"../../../geometry/support/aaBoundingRect.js\";import{getBoundsXY as g}from\"../../../geometry/support/boundsUtils.js\";import{fromJSON as x,isExtent as _,isPolygon as w}from\"../../../geometry/support/jsonUtils.js\";import{normalizeCentralMeridian as S}from\"../../../geometry/support/normalizeUtils.js\";import{equals as F,isValid as R}from\"../../../geometry/support/spatialReferenceUtils.js\";import{convertFromGeometry as Q}from\"../featureConversionUtils.js\";import{getWhereClause as I,validateFields as j,validateWhere as E,validateHaving as b,hasInvalidFieldType as A}from\"./attributeSupport.js\";import{project as T,checkProjectionSupport as k,projectMany as C}from\"./projectionSupport.js\";import{queryCapabilities as B}from\"./QueryEngineCapabilities.js\";import{QueryEngineResult as q,SnappingTypes as v}from\"./QueryEngineResult.js\";import{getSpatialQueryOperator as z,canQueryWithRBush as O,checkSpatialQuerySupport as G}from\"./spatialQuerySupport.js\";import{getTimeExtent as M,getTimeOperator as P}from\"./timeSupport.js\";import{cleanFromGeometryEngine as U,QUERY_ENGINE_EMPTY_RESULT as Z,normalizeQuery as N,getGeometry as D}from\"./utils.js\";import H from\"../../support/FieldsIndex.js\";import{loadArcade as L}from\"../../../support/arcadeOnDemand.js\";import{noBudget as J}from\"../../../views/support/Scheduler.js\";function V(e){return e.every((e=>\"exceedslimit\"!==e.statisticType))}const W=\"feature-store:unsupported-query\";class ${constructor(e,t=null,i,s,r){this.attributes=e,this.geometry=i,this.centroid=s,this.filterFlags=r,this.groupId=-1,this.displayId=t}}const K=new u(2e6);let X=0;class Y{constructor(e){this.capabilities={query:B},this.geometryType=e.geometryType,this.hasM=e.hasM,this.hasZ=e.hasZ,this.objectIdField=e.objectIdField,this.spatialReference=e.spatialReference,this.definitionExpression=e.definitionExpression,this.featureStore=e.featureStore,this.aggregateAdapter=e.aggregateAdapter,this._changeHandle=this.featureStore.events.on(\"changed\",(()=>this.clearCache())),this.timeInfo=e.timeInfo,e.cacheSpatialQueries&&(this._geometryQueryCache=new c(X+++\"$$\",K)),this.fieldsIndex=new H(e.fields),e.scheduler&&e.priority&&(this._frameTask=e.scheduler.registerTask(e.priority))}destroy(){this._frameTask=r(this._frameTask),this.clearCache(),a(this._geometryQueryCache),this._changeHandle=r(this._changeHandle),a(this.fieldsIndex)}get featureAdapter(){return this.featureStore.featureAdapter}get fullExtent(){const e=this.featureStore.fullBounds;return n(e)?null:{xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:U(this.spatialReference)}}get timeExtent(){return this.timeInfo?(this._timeExtent||(this._timeExtent=M(this.timeInfo,this.featureStore)),this._timeExtent):null}clearCache(){this._geometryQueryCache?.clear(),this._allItems=null,this._timeExtent=null}async executeQuery(e,t){try{return(await this._executeQuery(e,{},t)).createQueryResponse()}catch(i){if(i!==Z)throw i;return new q([],e,this).createQueryResponse()}}async executeQueryForCount(e={},t){try{return(await this._executeQuery(e,{returnGeometry:!1,returnCentroid:!1,outSR:null},t)).createQueryResponseForCount()}catch(i){if(i!==Z)throw i;return 0}}async executeQueryForExtent(e,t){const i=e.outSR;try{const s=await this._executeQuery(e,{returnGeometry:!0,returnCentroid:!1,outSR:null},t),r=s.size;if(!r)return{count:0,extent:null};m(te,p),this.featureStore.forEachBounds(s.items,(e=>f(te,e)),ee);const a={xmin:te[0],ymin:te[1],xmax:te[3],ymax:te[4],spatialReference:U(this.spatialReference)};this.hasZ&&isFinite(te[2])&&isFinite(te[5])&&(a.zmin=te[2],a.zmax=te[5]);const n=T(a,s.spatialReference,i);if(n.spatialReference=U(i||this.spatialReference),n.xmax-n.xmin==0){const e=h(n.spatialReference);n.xmin-=e,n.xmax+=e}if(n.ymax-n.ymin==0){const e=h(n.spatialReference);n.ymin-=e,n.ymax+=e}if(this.hasZ&&null!=n.zmin&&null!=n.zmax&&n.zmax-n.zmin==0){const e=h(n.spatialReference);n.zmin-=e,n.zmax+=e}return{count:r,extent:n}}catch(s){if(s===Z)return{count:0,extent:null};throw s}}async executeQueryForIds(e,t){return this.executeQueryForIdSet(e,t).then((e=>Array.from(e)))}async executeQueryForIdSet(e,t){try{const i=await this._executeQuery(e,{returnGeometry:!0,returnCentroid:!1,outSR:null},t),s=i.items,r=new Set;return await this._reschedule((()=>{for(const e of s)r.add(i.featureAdapter.getObjectId(e))}),t),r}catch(i){if(i===Z)return new Set;throw i}}async executeQueryForSnapping(e,t){const{point:i,distance:s,types:r}=e;if(r===v.NONE)return{candidates:[]};const a=await this._reschedule((()=>this._checkQuerySupport(e.query)),t),o=!F(i.spatialReference,this.spatialReference);o&&await k(i.spatialReference,this.spatialReference);const u=\"number\"==typeof s?s:s.x,c=\"number\"==typeof s?s:s.y,h={xmin:i.x-u,xmax:i.x+u,ymin:i.y-c,ymax:i.y+c,spatialReference:i.spatialReference},l=o?T(h,this.spatialReference):h;if(!l)return{candidates:[]};const m=(await S(x(i),null,{signal:t}))[0],p=(await S(x(l),null,{signal:t}))[0];if(n(m)||n(p))return{candidates:[]};const f=new q(this._searchFeatures(this._getQueryBBoxes(p.toJSON())),a,this);await this._reschedule((()=>this._executeObjectIdsQuery(f)),t),await this._reschedule((()=>this._executeTimeQuery(f)),t),await this._reschedule((()=>this._executeAttributesQuery(f)),t);const d=m.toJSON(),y=o?T(d,this.spatialReference):d,g=o?Math.max(l.xmax-l.xmin,l.ymax-l.ymin)/2:s;return f.createSnappingResponse({...e,point:y,distance:g},i.spatialReference)}async executeQueryForLatestObservations(e,t){if(!this.timeInfo||!this.timeInfo.trackIdField)throw new i(W,\"Missing timeInfo or timeInfo.trackIdField\",{query:e,timeInfo:this.timeInfo});try{const i=await this._executeQuery(e,{},t);return await this._reschedule((()=>this._filterLatest(i)),t),i.createQueryResponse()}catch(s){if(s!==Z)throw s;return new q([],e,this).createQueryResponse()}}async executeQueryForSummaryStatistics(e={},t,i){const{field:s,normalizationField:r,valueExpression:a}=t;return(await this._getQueryEngineResultForStats(e,{field:s,normalizationField:r,valueExpression:a},i)).createSummaryStatisticsResponse(t)}async executeQueryForUniqueValues(e={},t,i){const{field:s,valueExpression:r}=t;return(await this._getQueryEngineResultForStats(e,{field:s,valueExpression:r},i)).createUniqueValuesResponse(t)}async executeQueryForClassBreaks(e={},t,i){const{field:s,normalizationField:r,valueExpression:a}=t;return(await this._getQueryEngineResultForStats(e,{field:s,normalizationField:r,valueExpression:a},i)).createClassBreaksResponse(t)}async executeQueryForHistogram(e={},t,i){const{field:s,normalizationField:r,valueExpression:a}=t;return(await this._getQueryEngineResultForStats(e,{field:s,normalizationField:r,valueExpression:a},i)).createHistogramResponse(t)}async _schedule(e,t){return o(this._frameTask)?this._frameTask.schedule(e,t):e(J)}async _reschedule(e,t){return o(this._frameTask)?this._frameTask.reschedule(e,t):e(J)}_getAll(e){return n(this._allItems)&&(this._allItems=this.featureStore.toArray()),new q(this._allItems,e,this)}async _executeQuery(e,t,i){e=s(e),e=await this._schedule((()=>N(e,this.definitionExpression,this.spatialReference)),i),e=await this._reschedule((()=>this._checkQuerySupport(e)),i),e={...e,...t};const r=await this._reschedule((()=>this._executeSceneFilterQuery(e,i)),i),a=await this._reschedule((()=>this._executeGeometryQuery(e,r,i)),i);return await this._reschedule((()=>this._executeAggregateIdsQuery(a)),i),await this._reschedule((()=>this._executeObjectIdsQuery(a)),i),await this._reschedule((()=>this._executeTimeQuery(a)),i),await this._reschedule((()=>this._executeAttributesQuery(a)),i),a}async _executeSceneFilterQuery(e,t){if(n(e.sceneFilter))return null;const{outSR:i,returnGeometry:s,returnCentroid:r}=e,a=this.featureStore.featureSpatialReference,o=e.sceneFilter.geometry,u=n(a)||F(a,o.spatialReference)?o:T(o,a);if(!u)return null;const c=s||r,h=R(i)&&!F(this.spatialReference,i)&&c?async e=>this._project(e,i):e=>e,l=this.featureAdapter,m=this._searchFeatures(this._getQueryBBoxes(u));if(\"disjoint\"===e.sceneFilter.spatialRelationship){if(!m.length)return null;const i=new Set;for(const e of m)i.add(l.getObjectId(e));const s=await this._reschedule((()=>this.featureStore.toArray()),t),r=await this._reschedule((async()=>{const r=await z(\"esriSpatialRelDisjoint\",u,this.geometryType,this.hasZ,this.hasM),a=e=>!i.has(l.getObjectId(e))||r(l.getGeometry(e)),n=await this._runSpatialFilter(s,a,t);return new q(n,e,this)}),t);return h(r)}if(!m.length)return new q([],e,this);if(this._canExecuteSinglePass(u,e))return h(new q(m,e,this));const p=await z(\"esriSpatialRelContains\",u,this.geometryType,this.hasZ,this.hasM),f=await this._runSpatialFilter(m,(e=>p(l.getGeometry(e))),t);return h(new q(f,e,this))}async _executeGeometryQuery(i,s,r){if(o(s)&&0===s.items.length)return s;i=o(s)?s.query:i;const{geometry:a,outSR:u,spatialRel:c,returnGeometry:h,returnCentroid:l}=i,m=this.featureStore.featureSpatialReference,p=!a||n(m)||F(m,a.spatialReference)?a:T(a,m),f=h||l,d=R(u)&&!F(this.spatialReference,u),y=this._geometryQueryCache&&n(s)?d&&f?JSON.stringify({originalFilterGeometry:a,spatialRelationship:c,outSpatialReference:u}):JSON.stringify({originalFilterGeometry:a,spatialRelationship:c}):null,g=y?this._geometryQueryCache.get(y):null;if(o(g))return new q(g,i,this);const x=async e=>(d&&f&&await this._project(e,u),y&&this._geometryQueryCache.put(y,e.items,e.items.length+1),e);if(!p)return x(o(s)?s:this._getAll(i));const _=this.featureAdapter;let w=this._searchFeatures(this._getQueryBBoxes(a));if(\"esriSpatialRelDisjoint\"===c){if(!w.length)return x(o(s)?s:this._getAll(i));const e=new Set;for(const i of w)e.add(_.getObjectId(i));const t=o(s)?s.items:await this._reschedule((()=>this.featureStore.toArray()),r),a=await this._reschedule((async()=>{const s=await z(c,p,this.geometryType,this.hasZ,this.hasM),a=t=>!e.has(_.getObjectId(t))||s(_.getGeometry(t)),n=await this._runSpatialFilter(t,a,r);return new q(n,i,this)}),r);return x(a)}if(o(s)){const i=new e;w=w.filter((e=>t(s.items,e,s.items.length,i)>=0))}if(!w.length){const e=new q([],i,this);return y&&this._geometryQueryCache.put(y,e.items,1),e}if(this._canExecuteSinglePass(p,i))return x(new q(w,i,this));const S=await z(c,p,this.geometryType,this.hasZ,this.hasM),Q=await this._runSpatialFilter(w,(e=>S(_.getGeometry(e))),r);return x(new q(Q,i,this))}_executeAggregateIdsQuery(e){if(0===e.items.length||!e.query.aggregateIds||!e.query.aggregateIds.length||n(this.aggregateAdapter))return;const t=new Set;for(const s of e.query.aggregateIds){this.aggregateAdapter.getFeatureObjectIds(s).forEach((e=>t.add(e)))}const i=this.featureAdapter.getObjectId;e.items=e.items.filter((e=>t.has(i(e))))}_executeObjectIdsQuery(e){if(0===e.items.length||!e.query.objectIds||!e.query.objectIds.length)return;const t=new Set(e.query.objectIds),i=this.featureAdapter.getObjectId;e.items=e.items.filter((e=>t.has(i(e))))}_executeTimeQuery(e){if(0===e.items.length)return;const t=P(this.timeInfo,e.query.timeExtent,this.featureAdapter);n(t)||(e.items=e.items.filter(t))}_executeAttributesQuery(e){if(0===e.items.length)return;const t=I(e.query.where,this.fieldsIndex);if(t){if(!t.isStandardized)throw new TypeError(\"Where clause is not standardized\");e.items=e.items.filter((e=>t.testFeature(e,this.featureAdapter)))}}async _runSpatialFilter(e,t,i){if(!t)return e;if(n(this._frameTask))return e.filter((e=>t(e)));let s=0;const r=new Array,a=async n=>{for(;s<e.length;){const o=e[s++];t(o)&&(r.push(o),n.madeProgress()),n.done&&await this._reschedule((e=>a(e)),i)}};return this._reschedule((e=>a(e)),i).then((()=>r))}_filterLatest(e){const{trackIdField:t,startTimeField:i,endTimeField:s}=this.timeInfo,r=s||i,a=new Map,n=this.featureAdapter.getAttribute;for(const o of e.items){const e=n(o,t),i=n(o,r),s=a.get(e);(!s||i>n(s,r))&&a.set(e,o)}e.items=Array.from(a.values())}_canExecuteSinglePass(e,t){const{spatialRel:i}=t;return O(e)&&(\"esriSpatialRelEnvelopeIntersects\"===i||\"esriGeometryPoint\"===this.geometryType&&(\"esriSpatialRelIntersects\"===i||\"esriSpatialRelContains\"===i||\"esriSpatialRelWithin\"===i))}async _project(e,t){if(!t||F(this.spatialReference,t))return e;const i=this.featureAdapter,s=await C(e.items.map((e=>D(this.geometryType,this.hasZ,this.hasM,i.getGeometry(e)))),this.spatialReference,t);return e.items=s.map(((t,s)=>i.cloneWithGeometry(e.items[s],Q(t,this.hasZ,this.hasM)))),e}_getQueryBBoxes(e){if(O(e)){if(_(e))return[d(e.xmin,e.ymin,e.xmax,e.ymax)];if(w(e))return e.rings.map((e=>d(Math.min(e[0][0],e[2][0]),Math.min(e[0][1],e[2][1]),Math.max(e[0][0],e[2][0]),Math.max(e[0][1],e[2][1]))))}return[g(y(),e)]}_searchFeatures(e){for(const i of e)this.featureStore.forEachInBounds(i,(e=>ie.add(e)));const t=Array.from(ie.values());return ie.clear(),t}async _checkStatisticsSupport(e,t){if(e.distance<0||null!=e.geometryPrecision||e.multipatchOption||e.pixelSize||e.relationParam||e.text||e.outStatistics||e.groupByFieldsForStatistics||e.having||e.orderByFields)throw new i(W,\"Unsupported query options\",{query:e});return this._checkAttributesQuerySupport(e),Promise.all([this._checkStatisticsParamsSupport(t),G(e,this.geometryType,this.spatialReference),k(this.spatialReference,e.outSR)]).then((()=>e))}async _checkStatisticsParamsSupport(e){let t=[];if(e.valueExpression){const{arcadeUtils:i}=await L();t=i.extractFieldNames(e.valueExpression)}if(e.field&&t.push(e.field),e.normalizationField&&t.push(e.normalizationField),!t.length)throw new i(W,\"params should have at least a field or valueExpression\",{params:e});j(this.fieldsIndex,t,\"params contains missing fields\")}async _checkQuerySupport(e){if(e.distance<0||null!=e.geometryPrecision||e.multipatchOption||e.pixelSize||e.relationParam||e.text)throw new i(W,\"Unsupported query options\",{query:e});return this._checkAttributesQuerySupport(e),this._checkStatisticsQuerySupport(e),Promise.all([G(e,this.geometryType,this.spatialReference),k(this.spatialReference,e.outSR)]).then((()=>e))}_checkAttributesQuerySupport(e){const{outFields:t,orderByFields:s,returnDistinctValues:r,outStatistics:a}=e,n=a?a.map((e=>e.outStatisticFieldName&&e.outStatisticFieldName.toLowerCase())).filter(Boolean):[];if(s&&s.length>0){const e=\" asc\",t=\" desc\",i=s.map((i=>{const s=i.toLowerCase();return s.includes(e)?s.split(e)[0]:s.includes(t)?s.split(t)[0]:i})).filter((e=>!n.includes(e)));j(this.fieldsIndex,i,\"orderByFields contains missing fields\")}if(t&&t.length>0)j(this.fieldsIndex,t,\"outFields contains missing fields\");else if(r)throw new i(W,\"outFields should be specified for returnDistinctValues\",{query:e});E(this.fieldsIndex,e.where)}_checkStatisticsQuerySupport(e){const{outStatistics:t,groupByFieldsForStatistics:s,having:r}=e,a=s&&s.length,n=t&&t.length;if(r){if(!a||!n)throw new i(W,\"outStatistics and groupByFieldsForStatistics should be specified with having\",{query:e});b(this.fieldsIndex,r,t)}if(n){if(!V(t))return;const r=t.map((e=>e.onStatisticField)).filter(Boolean);j(this.fieldsIndex,r,\"onStatisticFields contains missing fields\"),a&&j(this.fieldsIndex,s,\"groupByFieldsForStatistics contains missing fields\");for(const s of t){const{onStatisticField:t,statisticType:r}=s;if((\"percentile_disc\"===r||\"percentile_cont\"===r)&&\"statisticParameters\"in s){const{statisticParameters:t}=s;if(!t)throw new i(W,\"statisticParamters should be set for percentile type\",{definition:s,query:e})}else if(\"count\"!==r&&t&&A(t,this.fieldsIndex))throw new i(W,\"outStatistics contains non-numeric fields\",{definition:s,query:e})}}}async _getQueryEngineResultForStats(e,t,i){e=s(e);try{e=await this._schedule((()=>N(e,this.definitionExpression,this.spatialReference)),i),e=await this._reschedule((()=>this._checkStatisticsSupport(e,t)),i);const s=await this._reschedule((()=>this._executeSceneFilterQuery(e,i)),i),r=await this._reschedule((()=>this._executeGeometryQuery(e,s,i)),i);return await this._reschedule((()=>this._executeAggregateIdsQuery(r)),i),await this._reschedule((()=>this._executeObjectIdsQuery(r)),i),await this._reschedule((()=>this._executeTimeQuery(r)),i),await this._reschedule((()=>this._executeAttributesQuery(r)),i),r}catch(r){if(r!==Z)throw r;return new q([],e,this)}}}const ee=l(),te=l(),ie=new Set;export{$ as Feature,Y as QueryEngine};\n"],"names":["$aX9sh","parcelRequire","$eb3f96edc7dcf97b$var$W","$eb3f96edc7dcf97b$var$K","$4B4sQ","MemCacheStorage","$eb3f96edc7dcf97b$var$X","$eb3f96edc7dcf97b$export$b9b7dd41af1fba2c","destroy","this","_frameTask","$1CpCt","removeMaybe","clearCache","destroyMaybe","_geometryQueryCache","_changeHandle","fieldsIndex","featureAdapter","featureStore","fullExtent","e","fullBounds","isNone","xmin","ymin","xmax","ymax","spatialReference","$4JNri","cleanFromGeometryEngine","timeExtent","timeInfo","_timeExtent","$UbUrW","getTimeExtent","clear","_allItems","async","t","_executeQuery","createQueryResponse","i","QUERY_ENGINE_EMPTY_RESULT","$a9gdw","QueryEngineResult","returnGeometry","returnCentroid","outSR","createQueryResponseForCount","s","r","size","count","extent","$ccOFp","set","$eb3f96edc7dcf97b$var$te","NEGATIVE_INFINITY","forEachBounds","items","expandWithAABB","$eb3f96edc7dcf97b$var$ee","a","hasZ","isFinite","zmin","zmax","n","$haPYR","project","e1","$zPXCh","getMetersPerUnitForSR","e2","e3","s1","executeQueryForIdSet","then","Array","from","Set","_reschedule","add","getObjectId","i1","point","distance","types","SnappingTypes","NONE","candidates","_checkQuerySupport","query","o","$fau59","equals","checkProjectionSupport","u","x","c","y","h","l","m","$hq5aB","normalizeCentralMeridian","$86d4E","fromJSON","signal","p","f","_searchFeatures","_getQueryBBoxes","toJSON","_executeObjectIdsQuery","_executeTimeQuery","_executeAttributesQuery","d","g","Math","max","createSnappingResponse","trackIdField","$bPmsI","default","_filterLatest","field","normalizationField","valueExpression","_getQueryEngineResultForStats","createSummaryStatisticsResponse","createUniqueValuesResponse","createClassBreaksResponse","createHistogramResponse","isSome","schedule","$cM1Gj","noBudget","reschedule","_getAll","toArray","$itGIg","clone","_schedule","normalizeQuery","definitionExpression","_executeSceneFilterQuery","_executeGeometryQuery","_executeAggregateIdsQuery","sceneFilter","featureSpatialReference","geometry","isValid","_project","spatialRelationship","length","r1","$hOW65","getSpatialQueryOperator","geometryType","hasM","_runSpatialFilter","has","getGeometry","_canExecuteSinglePass","spatialRel","JSON","stringify","originalFilterGeometry","outSpatialReference","get","put","_","w","t1","a1","i2","PositionHint","filter","indexOf","S","Q","aggregateIds","aggregateAdapter","getFeatureObjectIds","forEach","objectIds","getTimeOperator","$7CVm9","getWhereClause","where","isStandardized","TypeError","testFeature","push","madeProgress","done","startTimeField","endTimeField","Map","getAttribute","values","canQueryWithRBush","projectMany","map","cloneWithGeometry","$8RZNq","convertFromGeometry","isExtent","$19dbe","fromValues","isPolygon","rings","min","$772GK","getBoundsXY","create","forEachInBounds","$eb3f96edc7dcf97b$var$ie","geometryPrecision","multipatchOption","pixelSize","relationParam","text","outStatistics","groupByFieldsForStatistics","having","orderByFields","_checkAttributesQuerySupport","Promise","all","_checkStatisticsParamsSupport","checkSpatialQuerySupport","arcadeUtils","$QiKdE","loadArcade","extractFieldNames","params","validateFields","_checkStatisticsQuerySupport","outFields","returnDistinctValues","outStatisticFieldName","toLowerCase","Boolean","includes","split","validateWhere","validateHaving","every","statisticType","$eb3f96edc7dcf97b$var$V","onStatisticField","r2","hasInvalidFieldType","definition","statisticParameters","t2","_checkStatisticsSupport","constructor","capabilities","$11H8e","queryCapabilities","objectIdField","events","on","cacheSpatialQueries","MemCache","$38xmB","fields","scheduler","priority","registerTask"],"version":3,"file":"CSVSourceWorker.2d7b4168.js.map"}